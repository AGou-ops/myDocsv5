<!DOCTYPE html><html lang="en" dir="ltr" data-has-toc data-has-sidebar data-theme="dark" class="astro-bguv2lll"> <head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>SpringCloud微服务电商系统在Kubernetes集群中上线详细教程 | AGou's Docsv5</title><link rel="canonical"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><meta name="generator" content="Astro v4.4.15"/><meta name="generator" content="Starlight v0.21.1"/><meta property="og:title" content="SpringCloud微服务电商系统在Kubernetes集群中上线详细教程"/><meta property="og:type" content="article"/><meta property="og:url"/><meta property="og:locale" content="en"/><meta property="og:description" content="This is a document about SpringCloud微服务电商系统在Kubernetes集群中上线详细教程."/><meta property="og:site_name" content="AGou's Docsv5"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="SpringCloud微服务电商系统在Kubernetes集群中上线详细教程"/><meta name="twitter:description" content="This is a document about SpringCloud微服务电商系统在Kubernetes集群中上线详细教程."/><meta name="description" content="This is a document about SpringCloud微服务电商系统在Kubernetes集群中上线详细教程."/><script>
	window.StarlightThemeProvider = (() => {
		const storedTheme =
			typeof localStorage !== 'undefined' && localStorage.getItem('starlight-theme');
		const theme =
			storedTheme ||
			(window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark');
		document.documentElement.dataset.theme = theme === 'light' ? 'light' : 'dark';
		return {
			updatePickers(theme = storedTheme || 'auto') {
				document.querySelectorAll('starlight-theme-select').forEach((picker) => {
					const select = picker.querySelector('select');
					if (select) select.value = theme;
					/** @type {HTMLTemplateElement | null} */
					const tmpl = document.querySelector(`#theme-icons`);
					const newIcon = tmpl && tmpl.content.querySelector('.' + theme);
					if (newIcon) {
						const oldIcon = picker.querySelector('svg.label-icon');
						if (oldIcon) {
							oldIcon.replaceChildren(...newIcon.cloneNode(true).childNodes);
						}
					}
				});
			},
		};
	})();
</script><template id="theme-icons"><svg aria-hidden="true" class="light astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M5 12a1 1 0 0 0-1-1H3a1 1 0 0 0 0 2h1a1 1 0 0 0 1-1Zm.64 5-.71.71a1 1 0 0 0 0 1.41 1 1 0 0 0 1.41 0l.71-.71A1 1 0 0 0 5.64 17ZM12 5a1 1 0 0 0 1-1V3a1 1 0 0 0-2 0v1a1 1 0 0 0 1 1Zm5.66 2.34a1 1 0 0 0 .7-.29l.71-.71a1 1 0 1 0-1.41-1.41l-.66.71a1 1 0 0 0 0 1.41 1 1 0 0 0 .66.29Zm-12-.29a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.71-.71a1.004 1.004 0 1 0-1.43 1.41l.73.71ZM21 11h-1a1 1 0 0 0 0 2h1a1 1 0 0 0 0-2Zm-2.64 6A1 1 0 0 0 17 18.36l.71.71a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.76-.66ZM12 6.5a5.5 5.5 0 1 0 5.5 5.5A5.51 5.51 0 0 0 12 6.5Zm0 9a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7Zm0 3.5a1 1 0 0 0-1 1v1a1 1 0 0 0 2 0v-1a1 1 0 0 0-1-1Z"/></svg> <svg aria-hidden="true" class="dark astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.64 13a1 1 0 0 0-1.05-.14 8.049 8.049 0 0 1-3.37.73 8.15 8.15 0 0 1-8.14-8.1 8.59 8.59 0 0 1 .25-2A1 1 0 0 0 8 2.36a10.14 10.14 0 1 0 14 11.69 1 1 0 0 0-.36-1.05Zm-9.5 6.69A8.14 8.14 0 0 1 7.08 5.22v.27a10.15 10.15 0 0 0 10.14 10.14 9.784 9.784 0 0 0 2.1-.22 8.11 8.11 0 0 1-7.18 4.32v-.04Z"/></svg> <svg aria-hidden="true" class="auto astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg> </template><link rel="stylesheet" href="/_astro/index.BsC2KTtW.css" /><script type="module" src="/_astro/hoisted.bf4k8FkQ.js"></script>
<script type="module" src="/_astro/page.CZ0TFQCk.js"></script></head> <body class="astro-bguv2lll"> <a href="#_top" class="astro-7q3lir66">Skip to content</a>  <div class="page sl-flex astro-vrdttmbt"> <header class="header astro-vrdttmbt"><div class="header sl-flex astro-kmkmnagf"> <div class="title-wrapper sl-flex astro-kmkmnagf"> <a href="/" class="site-title sl-flex astro-m46x6ez3">  <img class="astro-m46x6ez3" alt="" src="/_astro/logo.BdruG-BK.png" width="200" height="200">  <span class="astro-m46x6ez3"> AGou&#39;s Docsv5 </span> </a>  </div> <div class="sl-flex astro-kmkmnagf"> <site-search data-translations="{&#34;placeholder&#34;:&#34;Search&#34;}" class="astro-v37mnknz"> <button data-open-modal disabled class="astro-v37mnknz">  <svg aria-label="Search" class="astro-v37mnknz astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.71 20.29 18 16.61A9 9 0 1 0 16.61 18l3.68 3.68a.999.999 0 0 0 1.42 0 1 1 0 0 0 0-1.39ZM11 18a7 7 0 1 1 0-14 7 7 0 0 1 0 14Z"/></svg>  <span class="sl-hidden md:sl-block astro-v37mnknz" aria-hidden="true">Search</span> <svg aria-label="(Press / to Search)" class="sl-hidden md:sl-block astro-v37mnknz astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 2H7a5 5 0 0 0-5 5v10a5 5 0 0 0 5 5h10a5 5 0 0 0 5-5V7a5 5 0 0 0-5-5Zm3 15a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V7a3 3 0 0 1 3-3h10a3 3 0 0 1 3 3v10Z"/><path d="M15.293 6.707a1 1 0 1 1 1.414 1.414l-8.485 8.486a1 1 0 0 1-1.414-1.415l8.485-8.485Z"/></svg>  </button> <dialog style="padding:0" aria-label="Search" class="astro-v37mnknz"> <div class="dialog-frame sl-flex astro-v37mnknz">  <button data-close-modal class="sl-flex md:sl-hidden astro-v37mnknz"> Cancel </button> <div class="search-container astro-v37mnknz"> <div id="starlight__search" class="astro-v37mnknz"></div> </div> </div> </dialog> </site-search>    </div> <div class="sl-hidden md:sl-flex right-group astro-kmkmnagf"> <div class="sl-flex social-icons astro-kmkmnagf"> <a href="https://github.com/AGou-ops" rel="me" class="sl-flex astro-wy4te6ga"><span class="sr-only astro-wy4te6ga">GitHub</span><svg aria-hidden="true" class="astro-wy4te6ga astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"/></svg> </a> </div> <starlight-theme-select>  <label style="--sl-select-width: 6.25em" class="astro-4yphtoen"> <span class="sr-only astro-4yphtoen">Select theme</span> <svg aria-hidden="true" class="icon label-icon astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg>  <select value="auto" class="astro-4yphtoen"> <option value="dark" class="astro-4yphtoen">Dark</option><option value="light" class="astro-4yphtoen">Light</option><option value="auto" selected="true" class="astro-4yphtoen">Auto</option> </select> <svg aria-hidden="true" class="icon caret astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </label>  </starlight-theme-select>  <script>
	StarlightThemeProvider.updatePickers();
</script>   </div> </div> </header> <nav class="sidebar astro-vrdttmbt" aria-label="Main"> <starlight-menu-button class="astro-jif73yzw"> <button aria-expanded="false" aria-label="Menu" aria-controls="starlight__sidebar" class="sl-flex md:sl-hidden astro-jif73yzw"> <svg aria-hidden="true" class="astro-jif73yzw astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M3 8h18a1 1 0 1 0 0-2H3a1 1 0 0 0 0 2Zm18 8H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Zm0-5H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Z"/></svg>  </button> </starlight-menu-button>    <div id="starlight__sidebar" class="sidebar-pane astro-vrdttmbt"> <div class="sidebar-content sl-flex astro-vrdttmbt"> <ul class="top-level astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">🔗 Links</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="https://agou-ops.cn" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">⭐️ Go to myBlog</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">guide</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/guide/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">index</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">CloudNative</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">index</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">CICD</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/argocd-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ArgoCD Basic</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">GitLab</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/gitlab/gitlab-backup-move/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">GitLab Backup-Move</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/gitlab/gitlab-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">GitLab Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/gitlab/gitlab-reset-passwd/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">GitLab reset passwd</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/gogs-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Gogs Basic</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Jenkins</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/docker-jenkins-执行宿主机命令/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker Jenkins 执行宿主机命令</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/generic-webhook-trigger/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Generic Webhook Trigger</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/jenkins-backup-restore/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jenkins Backup Restore</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/jenkins-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jenkins Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/jenkins-issues/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jenkins issues</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/jenkins-plugins/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jenkins Plugins</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/jenkins-共享库/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jenkins 共享库</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/jenkins-删除构建历史/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jenkins 删除构建历史</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/jenkins-流水线实例/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jenkins 流水线实例</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/jenkins-镜像加速/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jenkins 镜像加速</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/jenkinsfile-sample/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jenkinsfile Sample</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/jenkinsfile-自定义函数/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jenkinsfile 自定义函数</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/pipeline-build-parameters/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Pipeline build parameters</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/邮件通知模板/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">邮件通知模板</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jira-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jira Basic</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Sonarqube</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/sonarqube/sonarqube-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Sonarqube Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/sonarqube/sonarqube-with-jenkins/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Sonarqube with Jenkins</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/发布方式/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">发布方式</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">CloudComptering</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Aliyun</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/cloudcomptering/aliyun/untitled/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Untitled</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cloudcomptering/amazon-eks-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Amazon EKS Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cloudcomptering/amazon-web-services/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Amazon Web Services</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cloudcomptering/microsoft-azure/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Microsoft Azure</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/consul-入门/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Consul 入门</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Docker</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-compose/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker Compose</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-network/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker Network</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-openvswitch/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker openvswitch</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-portainer/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker Portainer</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-private-registry/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker Private Registry</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-remote-access/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker Remote Access</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-volume/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker Volume</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-固定ip及跨主机互通/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker 固定IP及跨主机互通</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-容器间通过主机名互相访问/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker 容器间通过主机名互相访问</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-清理/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker 清理</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-示例及多架构构建/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker 示例及多架构构建</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/dockerfile/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">DockerFile</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/ssh-docker-container/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">SSH Docker container</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/dubbo-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Dubbo Basic</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">ELFK</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/elastic-stack-beats/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Elastic Stack Beats</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/elk-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ELK basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/elk-kafka-filebeat/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ELK-Kafka-Filebeat</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/elk-redis缓存以及日志分流/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ELK-Redis缓存以及日志分流</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/es-3rd-part-plugins/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ES 3rd part Plugins</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/es-docker三节点部署/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ES Docker三节点部署</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/es-配置文件详解/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ES 配置文件详解</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/filebeat-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Filebeat basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/kafka-elfk分布式日志收集/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Kafka-ELFK分布式日志收集</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/kafka-redis-elfk分布式日志收集/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Kafka-Redis-ELFK分布式日志收集</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/logstash-basic-plugins/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Logstash Basic - Plugins</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/logstash-日志分流/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Logstash 日志分流</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/syslog-elk日志收集/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">syslog-ELK日志收集</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/tcp-elk日志收集/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">TCP-ELK日志收集</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/使用-docker-compose-部署-elk/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">使用 docker-compose 部署 ELK</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/收集javatomcat日志/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">收集Java、Tomcat日志</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/部署elk-kafka-filebeat日志收集分析系统/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">部署ELK-Kafka-Filebeat日志收集分析系统</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/grafana-loki-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Grafana Loki Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/istio-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Istio Basic</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">k8s</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/cilium-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">cilium Basic</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Helm</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/helm/charts/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">charts</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/helm/helm-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Helm Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/helm/helmgotemplate/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Helm（Go）template</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Installation</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/installation/k8s-debian12二进制安装/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">k8s Debian12二进制安装</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/installation/kubeadm-快速部署手册/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Kubeadm 快速部署手册</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/installation/kubernetes-二进制安装/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Kubernetes 二进制安装</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/installation/使用-kubeadm-部署单master/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">使用 Kubeadm 部署（单master）</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/installation/使用-kubespray-部署/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">使用 Kubespray 部署</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/installation/使用国内源及相关小工具/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">使用国内源及相关小工具</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/installation/常用组件安装/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">常用组件安装</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/k3d/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">k3d</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/k8s-command/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">k8s command</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/k8s-图解大全/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">k8s 图解大全</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/k8s-网络相关/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">k8s 网络相关</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/k8s概念及原理相关/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">k8s概念及原理相关</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/kompose-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">kompose Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/kubeadm-快速部署k8s集群/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Kubeadm 快速部署k8s集群</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/kubenetes远程调试工具/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">kubenetes远程调试工具</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/kubernetes-rest-api/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Kubernetes REST API</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/kubernetes-with-jenkins-cicd/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Kubernetes with Jenkins CICD</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/kubernetes-yaml-quicklystart/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Kubernetes Yaml quicklystart</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/kustmoize-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">kustmoize Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/metalb-部署与简单测试/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MetaLB 部署与简单测试</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/minikube-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Minikube Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/prometheus-grafana全方位监控kubernetes集群/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Prometheus-Grafana全方位监控Kubernetes集群</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Quicklystart</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/一-kubernetes概述/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">一 Kubernetes概述</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/七-控制器配置清单/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">七 控制器配置清单</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/三-集群部署/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">三 集群部署</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/九-ingress-控制器/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">九 ingress 控制器</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/二-核心组件及附件/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">二 核心组件及附件</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/五-配置清单使用/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">五 配置清单使用</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/八-service-配置清单/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">八 Service 配置清单</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/六-pod-配置清单/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">六 POD 配置清单</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/十-pod-存储卷/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">十 POD 存储卷</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/十一-配置信息容器化/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">十一 配置信息容器化</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/十七-调度策略/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">十七 调度策略</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/十三-用户认证系统/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">十三 用户认证系统</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/十九-容器资源限制/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">十九 容器资源限制</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/十二-statefulset-控制器/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">十二 StatefulSet 控制器</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/十五-dashboard/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">十五 dashboard</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/十八-高级调度设置/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">十八 高级调度设置</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/十六-网络通信/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">十六 网络通信</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/十四-用户权限系统/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">十四 用户权限系统</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/四-入门命令/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">四 入门命令</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/remote-access-k8s/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Remote access k8s</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/xfs-recovery/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">xfs recovery</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">实战案例</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/实战案例/cert-manager自动颁发证书/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">cert-manager自动颁发证书</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/实战案例/helm安装zookeeper集群/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">helm安装zookeeper集群</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/实战案例/jenkins结合/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">jenkins结合</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/实战案例/k8s中使用traefik基础/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">k8s中使用traefik（基础）</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/实战案例/k8s安装apollo配置中心/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">k8s安装Apollo配置中心</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/实战案例/k8s安装minio对象存储/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">k8s安装MinIO对象存储</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/实战案例/rbac-实战案例/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">RBAC 实战案例</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/实战案例/springcloud微服务电商系统在kubernetes集群中上线详细教程/" aria-current="page" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">SpringCloud微服务电商系统在Kubernetes集群中上线详细教程</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/实战案例/使用csr-api创建用户/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">使用CSR API创建用户</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/实战案例/其他实战案例/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">其他实战案例</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">小技巧</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/小技巧/使用curl访问k8s的rest-api/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">使用curl访问k8s的REST API</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/小技巧/强制删除namespace/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">强制删除namespace</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Prometheus</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/prometheus/influxdbtelegraf-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">influxDB、Telegraf Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/prometheus/prometheus-alertmanager/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Prometheus-AlertManager</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/prometheus/prometheus-consul服务发现/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Prometheus-Consul（服务发现）</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/prometheus/prometheus-in-docker/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Prometheus in Docker</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/prometheus/prometheus-安装与部署grafana/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Prometheus 安装与部署、Grafana</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/prometheus/prometheus-进阶/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Prometheus 进阶</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">LinuxBasics</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">index</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Ansible</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/ansible/ansible-ad-hoc-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ansible Ad-hoc Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/ansible/ansible-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ansible Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/ansible/ansible-best-practices/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ansible Best Practices</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/ansible/ansible-inventory/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ansible inventory</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/ansible/ansible-modules/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ansible modules</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/ansible/ansible-playbook-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ansible Playbook Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/ansible/ansible-tower/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ansible Tower</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Cache</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Nuster</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/cache/nuster/nuster-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nuster Basic</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Varnish</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/cache/varnish/varnish-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">varnish Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/cache/varnish/varnish-参考示例/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">varnish 参考示例</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/cache/varnish/varnish-架构工作原理及简单配置/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">varnish 架构、工作原理及简单配置</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/certbot-nginx-ssl/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">CertBot Nginx SSL</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">DataBases</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Etcd</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/etcd/etcd-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">etcd Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/etcd/etcd-备份与恢复/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">etcd 备份与恢复</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/etcd/etcd-添加leaner节点/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">etcd 添加leaner节点</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/etcd/etcdctl-快速手册/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">etcdctl 快速手册</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">MongoDB</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mongodb/mongodb-backup/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MongoDB Backup</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mongodb/mongodb-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MongoDB Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mongodb/mongodb-cluster/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MongoDB Cluster</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mongodb/mongodb-installation/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MongoDB Installation</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mongodb/mongodb-sharded-cluster/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MongoDB Sharded-Cluster</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mongodb/mongodb-异构数据平台迁移/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MongoDB 异构数据平台迁移</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mongodb/mongodumprestoreoplog高级备份/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">mongodump（restore）oplog高级备份</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">MySQL</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mariadb-log/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MariaDB Log</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-auth-cli/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL Auth CLI</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-backup-client-tools/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL BackUP - Client Tools</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-cluster/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL Cluster</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-configuration/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL Configuration</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-cursor/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL Cursor</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-data_type/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL Data_Type</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-explain/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL EXPLAIN</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-function/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL Function</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-internal_function/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL Internal_function</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-stored-procedure/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL Stored Procedure</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-transaction/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL Transaction</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-小技巧/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL 小技巧</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-快速手册/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL 快速手册</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-约束/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL 约束</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Redis</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/redis/redis-backup/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redis Backup</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/redis/redis-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redis Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/redis/redis-cluster/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redis Cluster</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/redis/redis-codis/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redis Codis</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/redis/redis-ha/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redis  HA</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/redis/redis-installation/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redis Installation</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/redis/redis-sentinel/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redis Sentinel</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/redis/redis-进阶/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redis 进阶</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/redis/缓存穿透缓存击穿缓存雪崩/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">缓存穿透、缓存击穿、缓存雪崩</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">DHCP-PXE-Cobbler</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/dhcp-pxe-cobbler/cobbler-centos/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Cobbler CentOS</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/dhcp-pxe-cobbler/dhcp-简单使用/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">DHCP 简单使用</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/dhcp-pxe-cobbler/pxe-centos/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">PXE CentOS</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/dnsmasq/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">dnsmasq</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/fail2ban-简单使用/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Fail2ban 简单使用</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">FileSystem</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Ceph</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/ceph/ceph-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ceph Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/ceph/ceph-cluster-移除/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ceph Cluster 移除</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/ceph/ceph-deploy-集群快速部署/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ceph-deploy 集群快速部署</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/ceph/ceph-manager-dashboard/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ceph Manager Dashboard</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/ceph/ceph-rgw/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ceph RGW</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/ceph/ceph-部署问题汇总/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ceph 部署问题汇总</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/ceph/cephadm-部署octopus/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Cephadm 部署octopus</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/ceph/cephfs/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">CephFS</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">FastDFS</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/fastdfs/fastdfs-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">FastDFS Basic</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">GlusterFS</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/glusterfs/临时/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">临时</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">MinIO</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/minio/minio-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MinIO Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/minio/minio-in-docker/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MinIO in Docker</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/nfs-基础及实战/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">NFS 基础及实战</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/samba-基础及实战/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">SAMBA 基础及实战</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/smbconf详解/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">smb.conf详解</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/tftp/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">TFTP</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/vsftp-基础及实战/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">vsFTP 基础及实战</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/firewalld-iptables快速手册/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Firewalld IPtables快速手册</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/inotifywait-文件监控/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">inotifywait 文件监控</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/jumpserver/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">JumpServer</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/k3s-k3d-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">k3s - k3d Basic</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Kafka</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/kafka/cmak/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">CMAK</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/kafka/kafka-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Kafka Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/kafka/使用-docker-compose-部署-kafka/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">使用 docker-compose 部署 Kafka</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/keepalived/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">keepalived</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">KVM</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/kvm/kvm_installsh/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">kvm_install.sh</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/kvm/kvm-2-vmware-station/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">KVM 2 VMware Station</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/kvm/kvm-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">KVM Basic</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/linux-压测大全/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Linux 压测大全</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/linux诊断/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Linux诊断</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">LoadBalancer</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">HAProxy</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/haproxy/haproxy-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">HAProxy Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/haproxy/haproxy-in-docker/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">HAProxy in Docker</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/haproxy/haproxy-参考示例/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">HAProxy 参考示例</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/haproxy/haproxy-配置详解/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">HAProxy 配置详解</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/haproxy/keepalived-haproxy/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Keepalived - HAProxy</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Keepalived-Nginx</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/keepalived-nginx/nginx-keepalived实现高可用集群/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx - keepalived实现高可用集群</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/keepalived-nginx/nginx-keepalived快速配置及脚本/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx - keepalived快速配置及脚本</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">LVS</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/lvs/ipvsadm-参数/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ipvsadm 参数</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/lvs/lvs-keepalived/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">LVS - keepalived</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/lvs/lvs-四种模型详解/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">LVS 四种模型详解</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/lvs/lvs-简单应用/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">LVS 简单应用</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/lvs/lvs-调度算法/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">LVS 调度算法</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/lvs/lvs-进阶配置/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">LVS 进阶配置</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/lsyncd/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">lsyncd</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/lvm-讲解/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">lvm 讲解</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Makefile</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/makefile/makefile-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Makefile Basic</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Nexus</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/nexus/nexus-basic-maven-私服/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nexus Basic - Maven 私服</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/nexus/nexus-yum-私服/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nexus - yum 私服</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/nexus/nexus-批量上传脚本/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">nexus 批量上传脚本</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/openvpn-for-centos/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">OpenVPN for CentOS</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/powerdns/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">PowerDNS</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">PVE</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/pve/pve-issues/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">PVE issues</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/pve/pve-初始化相关/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">PVE 初始化相关</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/pve/pve-制作镜像模板/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">PVE 制作镜像模板</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">RabbitMQ</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/rabbitmq/rabbitmq-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">RabbitMQ Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/rabbitmq/rabbitmq-mirror-queue/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">RabbitMQ Mirror Queue</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/rabbitmq/rabbitmq-on-docker/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">RabbitMQ on Docker</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/rsync-inotifysersync/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">rsync - inotify（sersync）</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Shell</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/shell/command/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">command</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/shell/linux-shell-实用命令及使用场景/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Linux Shell 实用命令及使用场景</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/shell/shell-getopts-样例/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Shell getopts 样例</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/shell/userful-shell/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">userful-shell</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/snmp配置/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">snmp配置</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/split-logrotate/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Split - Logrotate</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">SpringBoot</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/springboot/springboot-in-docker/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">SpringBoot in Docker</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/springboot/springboot-quicklystart/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">SpringBoot Quicklystart</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/sql-review/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">SQL review</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/ssh-tunnel/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">SSH Tunnel</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/tcpdump-wireshark/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Tcpdump - Wireshark</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Terraform</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/terraform/terraform-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Terraform Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/terraform/terraform-examples/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Terraform Examples</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/terraform/terraform-variable/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Terraform Variable</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/useful-command/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Useful Command</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/vagrant/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Vagrant</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/vim-tricks/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">vim tricks</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/vps-节点搭建/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">VPS 节点搭建</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Web-Servers</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Apache</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/apache/lamp-快速部署/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">LAMP 快速部署</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Jvm-Tomcat</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/jvm-tomcat/jvm-monitor-tools/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jvm Monitor Tools</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/jvm-tomcat/tomcat-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Tomcat Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/jvm-tomcat/tomcat-clusternginx/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Tomcat Cluster（nginx）</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/jvm-tomcat/tomcat-sessionmemcached/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Tomcat Session（memcached）</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/jvm-tomcat/tomcat-sessionredis-with-nginx/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Tomcat Session（Redis with Nginx）</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/jvm-tomcat/tomcat-调优/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Tomcat 调优</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/jvm-tomcat/tomcat中间件方方面面储备知识/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Tomcat中间件方方面面储备知识</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Nginx</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/https-配置及优化/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">HTTPS  配置及优化</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-cache/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx Cache</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-php-fpm/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx php-fpm</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-rewrite/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx Rewrite</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-try_files/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx try_files</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-uwsgi-部署django/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx - uWSGI 部署Django</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-内置变量/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx 内置变量</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-反向代理/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx 反向代理</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-平滑升级与回滚/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx 平滑升级与回滚</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-快速配置手册/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx 快速配置手册</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-性能优化与安全/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx 性能优化与安全</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-爬虫限制/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx 爬虫限制</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-编译及制作包/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx 编译及制作包</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-负载均衡/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx 负载均衡</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-高级模块/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx 高级模块</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Others</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/others/nodejs-with-ssl-nginx/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Node.js with ssl - nginx</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/others/使用logrotate切割nginx日志/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">使用logrotate切割nginx日志</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/others/检查服务器是否支持gzip/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">检查服务器是否支持gzip</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Problems</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/problems/rewrite参数处理问题/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">rewrite参数处理问题</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">PHP</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/php/php-优化及安全配置/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">PHP 优化及安全配置</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Python-Django</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/python-django/access-to-database/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Access to Database</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/python-django/django-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Django Basic</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/windows-useful-cmd/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Windows useful cmd</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/wireguard-vpn-for-ubuntu/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">WireGuard VPN for Ubuntu</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Zabbix</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/zabbix/zabbix-agent执行远程命令/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Zabbix agent执行远程命令</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/zabbix/zabbix-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Zabbix Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/zabbix/zabbix-安装中文包/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Zabbix 安装中文包</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/zabbix/zabbix-详细介绍/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Zabbix 详细介绍</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/zabbix/zabbix-钉钉报警/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Zabbix 钉钉报警</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Zookeeper</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/zookeeper/zookeeper-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Zookeeper Basic</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/自建dns/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">自建dns</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/自建邮箱服务器/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">自建邮箱服务器</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/蓝鲸运维平台/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">蓝鲸运维平台</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">ProgramLang</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/programlang/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">index</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Golang</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-errors-handler/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang Errors - handler</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-file-operate/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang File Operate</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-fmt占位符/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang fmt占位符</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-function/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang Function</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-interface/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang Interface</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-json/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang Json</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-package-manage/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang Package manage</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-pkgs/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang Pkgs</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-pointer/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang Pointer</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-project-layout/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang Project Layout</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-testing/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang Testing</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-并发/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang 并发</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/gorm包/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">gorm包</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/string-operate/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">String Operate</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Lua</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/programlang/lua/lua-baisc/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Lua Baisc</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/lua/lua-continue-ex/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Lua continue Ex</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Scripts</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/scripts/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">index</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">shell</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/scripts/shell/centos-sys-information/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">CentOS sys information</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/scripts/shell/dokcer-镜像备份/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Dokcer 镜像备份</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/scripts/shell/nginx-log-check/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx Log Check</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/scripts/shell/redis-tools/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redis tools</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">resort-file-from-csv</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/scripts/shell/resort-file-from-csv/resort-file/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">resort-file</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/scripts/shell/rsync/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Rsync</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/scripts/shell/shell-并发/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Shell 并发</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/scripts/shell/日常巡检shell/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">日常巡检Shell</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">windows</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/scripts/windows/通用修改dns/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">通用修改dns</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Interview</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/interview/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">index</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/pdf面试题集合/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">PDF面试题集合</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">工作面试题</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/interview/工作面试题/dba数据库运维工程师/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">DBA数据库运维工程师</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/工作面试题/devops面试题/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Devops面试题</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/工作面试题/docker面试题/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">docker面试题</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/工作面试题/es面试题/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">es面试题</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/工作面试题/etcd面试题/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">etcd面试题</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/工作面试题/go语言相关/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Go语言相关</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/工作面试题/go语言相关续-文章汇总/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Go语言相关（续-文章汇总）</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/工作面试题/k8s面试题整理/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">K8s面试题整理</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/工作面试题/linux相关的性能优化面试题/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">linux相关的性能优化面试题</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/工作面试题/mysql面试题/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">mysql面试题</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/工作面试题/nginx面试题/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">nginx面试题</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/工作面试题/nginx面试题含答案续/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">nginx面试题含答案（续）</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/工作面试题/redis面试题1/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redis面试题1</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/工作面试题/redis面试题1含答案续/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redis面试题1含答案（续）</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/工作面试题/redis面试题2/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redis面试题2</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/工作面试题/shell脚本相关/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">shell脚本相关</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/工作面试题/sre基础必会核心实战面试题/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">SRE基础必会核心实战面试题</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/工作面试题/sre高级运维面试题/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">SRE高级运维面试题</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/工作面试题/公司产品上云流程规范/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">公司产品上云流程规范</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/工作面试题/日志收集efk/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">日志收集EFK</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/工作面试题/来自网络-1/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">来自网络-1</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/工作面试题/来自群友-1/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">来自群友-1</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/工作面试题/系统运维故障相关/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">系统运维故障相关</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/工作面试题/资深运维架构设计规划/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">资深运维架构设计规划</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/工作面试题/运维安全相关/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">运维安全相关</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/工作面试题/运维必会面试题-快速突击/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">运维必会面试题-快速突击</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/工作面试题/运维监控体系/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">运维监控体系</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/工作面试题/运维网络基础/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">运维网络基础</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/工作面试题/运维面试话术自我介绍/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">运维面试话术自我介绍</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">杂项-自用</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/interview/杂项-自用/临时2/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">临时2</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/杂项-自用/临时复习用很乱/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">临时复习用（很乱）</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/interview/选择公司/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">选择公司</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/面试博文链接集合/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">面试博文链接集合</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">WORK</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">AnHeng</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/work/anheng/telegraf/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">telegraf</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/work/anheng/流水线-工作流引擎/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">流水线 工作流引擎</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li> </ul>  <div class="md:sl-hidden"> <div class="mobile-preferences sl-flex astro-wu23bvmt"> <div class="sl-flex social-icons astro-wu23bvmt"> <a href="https://github.com/AGou-ops" rel="me" class="sl-flex astro-wy4te6ga"><span class="sr-only astro-wy4te6ga">GitHub</span><svg aria-hidden="true" class="astro-wy4te6ga astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"/></svg> </a> </div> <starlight-theme-select>  <label style="--sl-select-width: 6.25em" class="astro-4yphtoen"> <span class="sr-only astro-4yphtoen">Select theme</span> <svg aria-hidden="true" class="icon label-icon astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg>  <select value="auto" class="astro-4yphtoen"> <option value="dark" class="astro-4yphtoen">Dark</option><option value="light" class="astro-4yphtoen">Light</option><option value="auto" selected="true" class="astro-4yphtoen">Auto</option> </select> <svg aria-hidden="true" class="icon caret astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </label>  </starlight-theme-select>  <script>
	StarlightThemeProvider.updatePickers();
</script>   </div>  </div> </div> </div> </nav> <div class="main-frame astro-vrdttmbt">  <div class="lg:sl-flex astro-67yu43on"> <aside class="right-sidebar-container astro-67yu43on"> <div class="right-sidebar astro-67yu43on"> <div class="lg:sl-hidden astro-pb3aqygn"><mobile-starlight-toc data-min-h="2" data-max-h="3" class="astro-doynk5tl"><nav aria-labelledby="starlight__on-this-page--mobile" class="astro-doynk5tl"><details id="starlight__mobile-toc" class="astro-doynk5tl"><summary id="starlight__on-this-page--mobile" class="sl-flex astro-doynk5tl"><div class="toggle sl-flex astro-doynk5tl">On this page<svg aria-hidden="true" class="caret astro-doynk5tl astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </div><span class="display-current astro-doynk5tl"></span></summary><div class="dropdown astro-doynk5tl"><ul class="isMobile astro-g2bywc46" style="--depth: 0;"> <li class="astro-g2bywc46" style="--depth: 0;"> <a href="#_top" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Overview</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#1微服务架构及理论概述" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">1.微服务架构及理论概述</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#11单体架构与微服务架构的区别" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">1.1.单体架构与微服务架构的区别</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#12微服务组件架构图" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">1.2.微服务组件架构图</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#13微服务注册中心" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">1.3.微服务注册中心</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#14不同的部署环境对于程序配置文件如何管理" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">1.4.不同的部署环境对于程序配置文件如何管理</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#2微服务迁移至kubernetes平台流程" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">2.微服务迁移至kubernetes平台流程</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#21项目迁移到k8s平台流程" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">2.1.项目迁移到K8S平台流程</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#22传统部署与k8s部署的区别" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">2.2.传统部署与K8S部署的区别</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#3微服务程序前期环境准备配置编译制作镜像" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">3.微服务程序前期环境准备（配置、编译、制作镜像）</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#31simple-microservice微服务项目介绍" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">3.1.simple-microservice微服务项目介绍</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#32simple微服务部署到k8s逻辑架构" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">3.2.simple微服务部署到K8S逻辑架构</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#33准备微服务各程序的配置文件" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">3.3.准备微服务各程序的配置文件</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#34制作微服务程序所使用的的底层系统镜像" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">3.4.制作微服务程序所使用的的底层系统镜像</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#35调整protal微服务中连接gateway网关的地址" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">3.5.调整Protal微服务中连接Gateway网关的地址</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#36部署ingress用于将微服务程序发布到互联网" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">3.6.部署Ingress用于将微服务程序发布到互联网</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#4在kubernetes集群部署simple微服务项目" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">4.在kubernetes集群部署simple微服务项目</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#41部署simple微服务程序的mysql数据库环境" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.1.部署simple微服务程序的mysql数据库环境</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#42部署eureka微服务注册中心" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.2.部署eureka微服务注册中心</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#43配置各个微服务程序连接eureka集群的地址" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.3.配置各个微服务程序连接Eureka集群的地址</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#44将各个程序代码编译成可部署的程序" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.4.将各个程序代码编译成可部署的程序</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#43中部署gateway网关服务" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.3.中部署Gateway网关服务</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#44编写快速部署微服务到k8s集群的脚本" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.4.编写快速部署微服务到K8S集群的脚本</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#45使用脚本部署order订单服务" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.5.使用脚本部署Order订单服务</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#46使用脚本部署product商品服务" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.6.使用脚本部署Product商品服务</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#47使用脚本部署stock库存服务" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.7.使用脚本部署Stock库存服务</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#48使用脚本部署portal前端首页" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.8.使用脚本部署Portal前端首页</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#49查看eureka注册中心中各个微服务的信息" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.9.查看Eureka注册中心中各个微服务的信息</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#410使用simple微服务电商平台" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.10.使用simple微服务电商平台</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#5基于k8s集群的微服务的扩容与升级" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">5.基于K8S集群的微服务的扩容与升级</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#51微服务的扩容" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">5.1.微服务的扩容</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#52微服务的升级" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">5.2.微服务的升级</span> </a>  </li> </ul>  </li> </ul> </div></details></nav></mobile-starlight-toc></div><div class="right-sidebar-panel sl-hidden lg:sl-block astro-pb3aqygn"><div class="sl-container astro-pb3aqygn"><starlight-toc data-min-h="2" data-max-h="3"><nav aria-labelledby="starlight__on-this-page"><h2 id="starlight__on-this-page">On this page</h2><ul class="astro-g2bywc46" style="--depth: 0;"> <li class="astro-g2bywc46" style="--depth: 0;"> <a href="#_top" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Overview</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#1微服务架构及理论概述" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">1.微服务架构及理论概述</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#11单体架构与微服务架构的区别" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">1.1.单体架构与微服务架构的区别</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#12微服务组件架构图" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">1.2.微服务组件架构图</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#13微服务注册中心" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">1.3.微服务注册中心</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#14不同的部署环境对于程序配置文件如何管理" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">1.4.不同的部署环境对于程序配置文件如何管理</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#2微服务迁移至kubernetes平台流程" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">2.微服务迁移至kubernetes平台流程</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#21项目迁移到k8s平台流程" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">2.1.项目迁移到K8S平台流程</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#22传统部署与k8s部署的区别" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">2.2.传统部署与K8S部署的区别</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#3微服务程序前期环境准备配置编译制作镜像" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">3.微服务程序前期环境准备（配置、编译、制作镜像）</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#31simple-microservice微服务项目介绍" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">3.1.simple-microservice微服务项目介绍</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#32simple微服务部署到k8s逻辑架构" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">3.2.simple微服务部署到K8S逻辑架构</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#33准备微服务各程序的配置文件" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">3.3.准备微服务各程序的配置文件</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#34制作微服务程序所使用的的底层系统镜像" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">3.4.制作微服务程序所使用的的底层系统镜像</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#35调整protal微服务中连接gateway网关的地址" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">3.5.调整Protal微服务中连接Gateway网关的地址</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#36部署ingress用于将微服务程序发布到互联网" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">3.6.部署Ingress用于将微服务程序发布到互联网</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#4在kubernetes集群部署simple微服务项目" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">4.在kubernetes集群部署simple微服务项目</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#41部署simple微服务程序的mysql数据库环境" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.1.部署simple微服务程序的mysql数据库环境</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#42部署eureka微服务注册中心" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.2.部署eureka微服务注册中心</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#43配置各个微服务程序连接eureka集群的地址" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.3.配置各个微服务程序连接Eureka集群的地址</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#44将各个程序代码编译成可部署的程序" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.4.将各个程序代码编译成可部署的程序</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#43中部署gateway网关服务" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.3.中部署Gateway网关服务</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#44编写快速部署微服务到k8s集群的脚本" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.4.编写快速部署微服务到K8S集群的脚本</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#45使用脚本部署order订单服务" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.5.使用脚本部署Order订单服务</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#46使用脚本部署product商品服务" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.6.使用脚本部署Product商品服务</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#47使用脚本部署stock库存服务" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.7.使用脚本部署Stock库存服务</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#48使用脚本部署portal前端首页" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.8.使用脚本部署Portal前端首页</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#49查看eureka注册中心中各个微服务的信息" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.9.查看Eureka注册中心中各个微服务的信息</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#410使用simple微服务电商平台" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.10.使用simple微服务电商平台</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#5基于k8s集群的微服务的扩容与升级" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">5.基于K8S集群的微服务的扩容与升级</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#51微服务的扩容" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">5.1.微服务的扩容</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#52微服务的升级" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">5.2.微服务的升级</span> </a>  </li> </ul>  </li> </ul> </nav></starlight-toc></div></div> </div> </aside> <div class="main-pane astro-67yu43on">  <main data-pagefind-body lang="en" dir="ltr" class="astro-bguv2lll">    <div class="content-panel astro-7nkwcw3z"> <div class="sl-container astro-7nkwcw3z"> <h1 id="_top" class="astro-j6tvhyss">SpringCloud微服务电商系统在Kubernetes集群中上线详细教程</h1>  </div> </div>  <div class="content-panel astro-7nkwcw3z"> <div class="sl-container astro-7nkwcw3z"> <div class="sl-markdown-content"> <h1 id="springcloud微服务电商系统在kubernetes集群中上线详细教程">SpringCloud微服务电商系统在Kubernetes集群中上线详细教程</h1>
<blockquote>
<p>该文章来自：<a href="https://jiangxl.blog.csdn.net/article/details/121740024">https://jiangxl.blog.csdn.net/article/details/121740024</a></p>
<p>仅做个人备份学习使用。</p>
</blockquote>
<h2 id="1微服务架构及理论概述">1.<a href="https://so.csdn.net/so/search?q=%E5%BE%AE%E6%9C%8D%E5%8A%A1&#x26;spm=1001.2101.3001.7020">微服务</a>架构及理论概述</h2>
<p>程序<a href="https://so.csdn.net/so/search?q=%E6%9E%B6%E6%9E%84&#x26;spm=1001.2101.3001.7020">架构</a>一共经历了3个阶段：单体架构、SOA架构、微服务架构。</p>
<p>微服务系统应用由原来的单体变成几十到几百个不同的工程，会产生例如包括服务间的依赖，服务如何拆封，内部接口规范，数据传递等等问题，尤其是服务拆分，需要团队熟悉业务流程，懂得取舍，要保证拆分的粒度服务既符合“高内聚，低耦合”的基本原则，还要兼顾业务的发展以及公司的愿景，要还要说服团队成员为之努力，并且积极投入，在多方中间取得平衡。</p>
<p>微服务从概念上讲就是将一个大的平台拆分成几个独立的小模块，这些模块有自己专门的数据库服务，即使这个单独模块出现了故障，也不会影响整个平台的使用，例如一个平台中有订单模块、新闻模块、咨询模块，即使新闻模块宕机了，订单模块、新闻模块依然工作正常，也不会造成整个网站的瘫痪。</p>
<p>对于微服务版本迭代而言，只需要针对特定功能所在的子项目上线即可，版本迭代更加灵活，而单体程序版本迭代，哪怕只是一个小小的功能也需要对整个系统进行更新。</p>
<p>目前主流的程序架构就是微服务系统，运用的技术栈更加丰富，例如kubernetes、CI/CD、Devops等等。</p>
<p>微服务项目在kubernetes环境部署主要有两种实现方式：无状态的部署、istio微服务网格部署。</p>
<p>可以把微服务理解为是一个大的框架，在这个框架里面内嵌各个子系统。</p>
<h3 id="11单体架构与微服务架构的区别">1.1.单体架构与微服务架构的区别</h3>
<p><strong>微服务的特点：</strong></p>
<ul>
<li>系统服务独立化
<ul>
<li>每个子项目系统都会独立开发、部署，有效的避免一个服务的bug影响整个系统的使用</li>
</ul>
</li>
<li>技术栈灵活
<ul>
<li>每个子系统之间约定一个通信方式，例如MQ、API等，不再像单体服务那么的局限性</li>
</ul>
</li>
<li>独立部署
<ul>
<li>每个微服务系统都独立部署，都有单独的war包，即使其中一个服务异常宕机，也不会对整个平台产生影响</li>
</ul>
</li>
<li>扩展性强
<ul>
<li>每个微服务都可以部署多套，配合注册中心实现负载均衡能力</li>
</ul>
</li>
<li>独立数据
<ul>
<li>每个微服务都有独立的存储组件，比如数据库、缓存等，互不影响</li>
</ul>
</li>
</ul>
<p><strong>单体服务的特点</strong></p>
<ul>
<li>易于部署
<ul>
<li>单体服务只有一个程序包，只需要部署一个服务即可完成整个系统的建设</li>
</ul>
</li>
<li>易于测试
<ul>
<li>测试用例也只需要设计一个即可</li>
</ul>
</li>
</ul>
<p><strong>单体服务的不足</strong></p>
<ul>
<li>代码量级巨大，难以维护，如果系统中存在bug，修复起来牵扯功能太多，故障百出</li>
<li>构建、部署的成本巨大，服务都集成在一起，启动的时间也会非常缓慢</li>
<li>新人上手较难，如果整个服务也没有注释的情况下，新的开发人员上手会非常难</li>
</ul>
<p><strong>微服务与单体服务架构上的不同</strong></p>
<blockquote>
<p>单体服务：程序包只有一个，开发团队可能有一群人，用户之间访问程序包即可获取系统信息，后端对应一个数据库</p>
<p>微服务：程序包有多个，每个程序包都是不同的功能结合，且每个微服务程序都有自己的单独数据库存储数据，所有的微服务信息都会存储到注册中心，网关程序在最前面，当用户有请求进来后，首先发送给网关服务，然后网关根据注册中心的数据，将不同功能的请求转发给不同的微服务程序</p>
</blockquote>
<p><img src="https://cdn.agou-ops.cn/others/caf1d3f6f0f4405ea879f6408a54faf5.png" alt="在这里插入图片描述"></p>
<h3 id="12微服务组件架构图">1.2.微服务组件架构图</h3>
<p>以电商平台为例，描述一个购买商品的微服务之间调用流程</p>
<p>用户首先访问到平台的静态首页，发送一个搜索请求从前端页面提交给微服务的网关服务，网关服务是对外的，也就是不管用户要操作什么请求，都需要由网关服务转发给具体的微服务，因为网关服务是入口，因此网关服务一般都是多台做成的负载均衡，搜索请求到达网关服务后，网关服务会根据请求的功能转发到搜索服务的程序上，搜索出来商品后，会调用商品服务程序，查看商品的详细情况，用户选择完商品后，商品服务再调用订单服务，完成订单的创建，再由订单服务调用支付服务，完成商品的购买。</p>
<p>所有的微服务接口信息都会注册到注册中心，当程序启动成功就会自动注册到注册中心，注册中心也会起到一个负载均衡的作用，根据网关的API请求，在注册中心上找到特定的微服务程序进行转发。</p>
<p>微服务程序还有自己的一套配置中心，保存着各个微服务的配置文件，所有的微服务程序可能都有自己独立的后端组件，比如MySQL、Redis、MQ、分布式存储。</p>
<p>微服务之间的通信可以采用接口API、MQ、RPAC等机制</p>
<p>微服务在kubernetes集群中部署时可以采用无状态服务的部署，对于数据库、Redis、MQ、存储还是建议部署在k8s集群之外。</p>
<p>注册中心与微服务之间的联系：发现微服务—>微服务注册到注册中心—>进行心跳监测，异常的节点会踢出</p>
<p>微服务程序的门户网站会配置Gateway网关服务的地址，由门户网站用户请求的微服务信息，转发给Gateway网关程序，所有的微服务都会注册在Eureka注册中心中，Gateway网关会将请求通过注册中心转发给对应的微服务程序。
<img src="https://cdn.agou-ops.cn/others/0225cafb98dd43d98ddd102cf1203791.png" alt="在这里插入图片描述"></p>
<h3 id="13微服务注册中心">1.3.微服务注册中心</h3>
<p>微服务面对着很多问题：</p>
<ul>
<li>如何记录一个微服务副本的接口地址，如何对多个微服务节点组成的集群做负载均衡</li>
<li>符合判断集群中某一个微服务是否可用</li>
</ul>
<p>微服务面临的这些问题都可以通过注册中心去解决，在注册中心中可用记录某一个微服务的所有副本节点，当一个副本节点挂掉了，注册中心也会将其踢出集群，注册中心会将一个微服务的所有副本节点自动形成一个负载均衡</p>
<p>在微服务中配合注册中心地址之后，程序一旦启动，无需配置注册中心，且能够自动注册到注册中心</p>
<p>微服务接入注册中心流程：微服务程序---->注册---->注册中心服务器</p>
<p>注册中心调用微服务流程：微服务网关程序---->注册/查询微服务（调用微服务）---->注册中心---->微服务程序</p>
<p>当然也可以不适用注册中心，k8s自身的功能就有服务发现自动形成负载均衡，也可以用健康检查监控服务的运行状况</p>
<p>目前主流的注册中心：Eureka、Nacos</p>
<h3 id="14不同的部署环境对于程序配置文件如何管理">1.4.不同的部署环境对于程序配置文件如何管理</h3>
<p>可以通过以下四种方式来管理不同环境使用不同的配置文件</p>
<ul>
<li>kubernetes configmap资源
<ul>
<li>可以根据线上、预发布、测试环境编写不同的configmap资源，然后将其挂载到对应的deployment资源上</li>
</ul>
</li>
<li>docker 容器启动脚本entrypoint.sh
<ul>
<li>根据环境的不同在entrypoint.sh声明环境变量，运行特定的配置文件</li>
</ul>
</li>
<li>java启动命令控制
<ul>
<li>java程序可以同时存在多个程序配置文件，可以在配置文件中声明各自的变量，然后使用<code dir="auto">java --spring.profiles.active=xxx xxx.jar</code>的方式来指定不同环境的配置文件</li>
</ul>
</li>
<li>使用开源的统一配置中心程序，比如市面上主流的Apollo以及Disconf，这两款程序都有自己的图形化管理系统，配置可视化</li>
</ul>
<h2 id="2微服务迁移至kubernetes平台流程">2.微服务迁移至kubernetes平台流程</h2>
<h3 id="21项目迁移到k8s平台流程">2.1.项目迁移到K8S平台流程</h3>
<p><img src="https://cdn.agou-ops.cn/others/47633ea793f24a4b8727059870501e50.png" alt="在这里插入图片描述">
项目迁移到K8S平台大致流程分为以下几个阶段：</p>
<ul>
<li>制作程序镜像
<ul>
<li>在K8s环境，所有的程序都是以Docker镜像来运行的，一个镜像包含了文件系统、程序的运行环境、程序本身，可以通过Dockerfile的形式制作镜像</li>
</ul>
</li>
<li>使用资源控制器管理Pod资源
<ul>
<li>程序镜像运行需要依靠Pod资源，需要有Pod控制器去管理Pod资源</li>
<li>常见的Pod控制器：Deployment（无状态程序部署）、Statefulset（有状态程序部署）、Job/CronJob（批量处理）</li>
</ul>
</li>
<li>将Pod资源使用服务发现对外进行暴露
<ul>
<li>Services资源注意通过label标签与Pod进行关联，实现对一组Pod的自动负载均衡以及服务发现</li>
<li>Services资源支持Cluster、Nodeport、LoadBalancer三种类型</li>
</ul>
</li>
<li>对外发布应用程序
<ul>
<li>可以使用单独的nginx容器去反向代理Cordns解析的services名称将Pod应用对外发布</li>
<li>也可以使用ingress+services的方式将应用程序对外发布，使用ingress的前提是必须可以通过域名访问应用</li>
<li>架构图如下
<img src="https://cdn.agou-ops.cn/others/4450dd7d3c994bb78ca36b43af66e28a.png" alt="在这里插入图片描述"></li>
</ul>
</li>
<li>后期的日志收集与监控
<ul>
<li>当应用在K8s程序运行后，对于程序的日志比如nginx、tomcat这些日志文件都不会做持久化，因此就需要考虑对日志进行收集，可以采用Filebeat+ELK方式对程序日志进行收集</li>
<li>使用Prometheus+Grafana对整个K8s平台进行全方面监控</li>
</ul>
</li>
</ul>
<h3 id="22传统部署与k8s部署的区别">2.2.传统部署与K8S部署的区别</h3>
<blockquote>
<p><strong>传统方式部署项目方式：</strong></p>
<p>首先由开发人员提交代码到Gitlab代码仓库，Jenkins触发更新从Gitlab上获取最新代码，通过maven将代码编译成war包或者jar包，再由Jenkins通过写好的自动化部署脚本或者Ansible自动化程序将war包部署到程序所在的云主机，云主机一定会是多台组成的负载均衡集群，将负载均衡VIP与域名进行绑定，用户通过访问域名由负载均衡转发至对应的后台主机。</p>
<p>传统架构运维环境一般由zabbix监控系统进行监控，日志采集会使用ELK平台。</p>
</blockquote>
<p><img src="https://cdn.agou-ops.cn/others/e34c94fc97e0416cb21cd00879244103.png" alt="在这里插入图片描述"></p>
<blockquote>
<p><strong>Kubernetes平台部署项目方式：</strong></p>
<p>首先由开发人员提交代码到Gitlab代码仓库，Jenkins触发更新从Gitlab上获取最新代码，通过写好流水线将程序打包成Docker镜像并推送至Harbor仓库，再由Jenkins调用K8s的Master Api将程序的镜像采用Deployment控制器部署到K8s集群，再由service资源暴露pod资源，最后由ingress或者nginx资源将程序发布到互联网。</p>
</blockquote>
<p><img src="https://cdn.agou-ops.cn/others/3ca0d364bdc24690a04d4ca95eb1cb05.png" alt="在这里插入图片描述"></p>
<h2 id="3微服务程序前期环境准备配置编译制作镜像">3.微服务程序前期环境准备（配置、编译、制作镜像）</h2>
<h3 id="31simple-microservice微服务项目介绍">3.1.simple-microservice微服务项目介绍</h3>
<p>本次使用的微服务为spring cloud的电商平台项目</p>
<p>项目名称：simple-microservice</p>
<p>simple-microservice微服务的各个程序：</p>
<ul>
<li>eureka-service（注册中心）</li>
<li>gateway-service（网管服务）</li>
<li>order-service（订单服务）</li>
<li>product-service（商品服务）</li>
<li>portal-service（门户网站）</li>
<li>stock-service（库存服务）</li>
</ul>
<p>用户请求首先到Protal前端页面，也就是程序的首页，在首页的各项功能操作都会由Gateway网关服务转发到各自的微服务程序上，比如请求一个订单服务，订单服务会事先注册到Eureka中，由Gateway将请求发送给Eureka，再由Eureka转发给具体的微服务程序，这些微服务程序都有自己单独的数据库服务。</p>
<p>微服务程序的门户网站会配置Gateway网关服务的地址，由门户网站用户请求的微服务信息，转发给Gateway网关程序，所有的微服务都会注册在Eureka注册中心中，Gateway网关会将请求通过注册中心转发给对应的微服务程序。
<img src="https://cdn.agou-ops.cn/others/b89c6c882bbe4a2d9ab53f97d5fe1f35.png" alt="在这里插入图片描述"></p>
<p>该微服务程序代码可以托管在gitlab代码仓库中，我们可以建立多个分支模拟从开发到上线的流程，理念：分别创建5个分支，在每个分支中增加对应的代码，最后合并到master分支，也可以直接就在master分支上新增配置文件，我是直接拉取dev1分支，只有程序代码的分支，然后新增一系列配置，最后上线。</p>
<p>拉取dev1分支，进行一系列配置的话，首先要把master分支里的protal程序代码同步到dev1分支里，因为dev1的protal程序代码有点bug，整个微服务运行完毕后，order订单服务会报错。</p>
<p>分别有五个分支：</p>
<ul>
<li>dev1：交付代码</li>
<li>dev2：新增程序打包的Dockerfile文件</li>
<li>dev3：新增K8s资源编排Yaml文件</li>
<li>dev4：微服务链路监控</li>
<li>dev5：新功能代码更新上线</li>
<li>master：上线版本</li>
</ul>
<p><img src="https://cdn.agou-ops.cn/others/258d6fe2cd114cd58843209bdf1f85de.png" alt="在这里插入图片描述"></p>
<h3 id="32simple微服务部署到k8s逻辑架构">3.2.simple微服务部署到K8S逻辑架构</h3>
<p><strong>simple-microservice微服务部署到k8s平台主要分为如下几个步骤：</strong></p>
<ul>
<li>修改程序配置文件，将数据库等各组件地址修改为当前环境</li>
<li>将各个微服务程序使用Maven编译成可部署的jar包</li>
<li>编写Dockerfile将程序做成docker镜像</li>
</ul>
<p><strong>对K8S环境的要求：</strong></p>
<p>一套完整的K8S集群、有cordns可以解析Service地址、Harbor镜像仓库、Nginx容器将项目发布到互联网或者INgress资源将项目发布到互联网。</p>
<p><strong>微服务部署到K8S环境之后架构是怎样的</strong></p>
<blockquote>
<p>首先用户访问网站的域名，请求达到前端页面，点击前端页面中的功能跳转到不同的微服务，比如商品服务，将商品服务的请求交个Gateway网关服务，由网关服务转发给商品的微服务程序Product，各个微服务之间的调用，都从Eureka注册中心读取各个微服务的信息完成调度，Product（商品）、Order（订单）、Stock（库存）都有单独的数据库，MySQL数据部署在K8S集群之外。</p>
<p>服务发布到互联网采用Nginx而不采用Ingress，Nginx可以配置更多的参数，将Nginx容器运行在每一个Node主机上，映射Node主机的80/443端口，通过在hosts文件里绑定node主机ip+程序域名的方式访问微服务。</p>
</blockquote>
<p><img src="https://cdn.agou-ops.cn/others/60f3e04a6fb3410cbdc1f54eee6a7c4e.png" alt="在这里插入图片描述"></p>
<h3 id="33准备微服务各程序的配置文件">3.3.准备微服务各程序的配置文件</h3>
<p>在使用Maven之前，首先将程序的配置文件进行修改，编译成功之后再想修改配置文件内容，就需要重新编译了，将每个微服务的环境地址都修改成自己环境的地址。</p>
<p>拉取dev1分支展开全新配置</p>
<h4 id="331创建微服务各个程序的prod配置文件">3.3.1.创建微服务各个程序的prod配置文件</h4>
<p>eureka（注册中心）、gateway（网关）、order（订单）、portal（首页）、product（商品）、stock（库存）这几个微服务程序都需要配置，新建一个prod的配置文件，用于线上生产环境</p>
<p>order（订单）、product（商品）、stock（库存）这些微服务有两个包，分别是xxx-biz和xxx-api，只需要部署biz目录下的jar包即可，api的目录只是存在一些依赖</p>
<p>order（订单）、product（商品）、stock（库存）这些微服务都有自己单独的数据库</p>
<p>先将prod的配置文件创建出来，待eureka项目部署完成后，再进行进一步的修改，最后将程序编译</p>
<p><strong>1.eureka-service配置文件</strong></p>
<div class="expressive-code"><link rel="stylesheet" href="/_astro/ec.pjkke.css"><script type="module" src="/_astro/ec.sgewm.js"></script><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.创建一个prod的配置文件</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/simple-microservice-dev1]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cd eureka-service/src/main/resources/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/simple-microservice-dev1/eureka-service/src/main/resources]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cp application-fat.yml application-prod.yml</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.程序使用prod的配置文件运行</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/simple-microservice-dev1/eureka-service/src/main/resources]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim application.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">server:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">port:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">8080</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#809191;--1:#616671">#eureka的端口号</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">spring:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">application:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">legendshop-basic-eureka</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">profiles:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">active:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">prod</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#809191;--1:#616671">#将这里修改为prod就会调用prod配置文件</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.配置eureka服务的配置文件</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/simple-microservice-dev1/eureka-service/src/main/resources]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim application-prod.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">eureka:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">server:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">renewal-percent-threshold:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">0.9</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">enable-self-preservation:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">false</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">eviction-interval-timer-in-ms:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">40000</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">instance:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">hostname:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">127.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.1</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">prefer-ip-address:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">client:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">register-with-eureka:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">false</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">serviceUrl:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">defaultZone:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">http://127.0.0.1:</span><span style="--0:#D6DEEB;--1:#403F53">${</span><span style="--0:#C5E478;--1:#3C63B3">server</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3C63B3">port</span><span style="--0:#D6DEEB;--1:#403F53">}</span><span style="--0:#ECC48D;--1:#3C63B3">/eureka/</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">fetch-registry:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">false</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.创建一个prod的配置文件[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1]\# cd eureka-service/src/main/resources/[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/eureka-service/src/main/resources]\# cp application-fat.yml application-prod.yml2.程序使用prod的配置文件运行[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/eureka-service/src/main/resources]\# vim application.ymlserver:  port: 8080        #eureka的端口号spring:  application:    name: legendshop-basic-eureka  profiles:    active: prod    #将这里修改为prod就会调用prod配置文件3.配置eureka服务的配置文件[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/eureka-service/src/main/resources]\# vim application-prod.ymleureka:  server:    renewal-percent-threshold: 0.9    enable-self-preservation: false    eviction-interval-timer-in-ms: 40000  instance:    hostname: 127.0.0.1    prefer-ip-address: true  client:    register-with-eureka: false    serviceUrl:      defaultZone: http://127.0.0.1:${server.port}/eureka/    fetch-registry: false"><div></div></button></div></figure></div>
<p><strong>2.gateway-service配置文件</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.创建一个prod的配置文件</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/simple-microservice-dev1]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cd gateway-service/src/main/resources/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/simple-microservice-dev1/gateway-service/src/main/resources]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cp application-fat.yml application-prod.yml</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.程序使用prod的配置文件运行</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/simple-microservice-dev1/gateway-service/src/main/resources]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cat application.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">server:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">port:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">spring:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">profiles:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">active:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">prod</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">application:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">@artifactId@</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.配置程序配置文件</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/simple-microservice-dev1/gateway-service/src/main/resources]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim application-prod.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">······</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">eureka:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">instance:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">prefer-ip-address:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">client:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">register-with-eureka:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">fetch-registry:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">service-url:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">defaultZone:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">http://eureka-0.eureka-service:8080/eureka/</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#809191;--1:#616671">#修改eureka地址</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.创建一个prod的配置文件[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1]\# cd gateway-service/src/main/resources/[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/gateway-service/src/main/resources]\# cp application-fat.yml application-prod.yml2.程序使用prod的配置文件运行[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/gateway-service/src/main/resources]\# cat application.ymlserver:  port: 8080spring:  profiles:    active: prod  application:    name: @artifactId@3.配置程序配置文件[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/gateway-service/src/main/resources]\# vim application-prod.yml······eureka:  instance:    prefer-ip-address: true  client:    register-with-eureka: true    fetch-registry: true    service-url:      defaultZone: http://eureka-0.eureka-service:8080/eureka/      #修改eureka地址"><div></div></button></div></figure></div>
<p><strong>3.order-service配置文件</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.创建一个prod的配置文件</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/simple-microservice-dev1]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cd order-service/order-service-biz/src/main/resources/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/simple-microservice-dev1/order-service/order-service-biz/src/main/resources]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cp application-fat.yml application-prod.yml</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.程序使用prod的配置文件运行</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/simple-microservice-dev1/order-service/order-service-biz/src/main/resources]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim application.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">server:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">port:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">spring:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">profiles:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">active:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">prod</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">application:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">order-service</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.配置程序配置文件</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/simple-microservice-dev1/order-service/order-service-biz/src/main/resources]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim application-prod.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">spring:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">datasource:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">url:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">jdbc:mysql://192.168.20.11:3306/tb_order?characterEncoding=utf-8</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#809191;--1:#616671">#mysql数据库地址</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">username:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">password:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">123456</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">driver-class-name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">com.mysql.jdbc.Driver</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">eureka:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">instance:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">prefer-ip-address:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">client:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">register-with-eureka:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">fetch-registry:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">service-url:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">defaultZone:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">http://eureka-0.eureka-service:8080/eureka/</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#809191;--1:#616671">#eureka地址</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.创建一个prod的配置文件[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1]\# cd order-service/order-service-biz/src/main/resources/[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/order-service/order-service-biz/src/main/resources]\# cp application-fat.yml application-prod.yml2.程序使用prod的配置文件运行[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/order-service/order-service-biz/src/main/resources]\# vim application.ymlserver:  port: 8080spring:  profiles:    active: prod  application:    name: order-service3.配置程序配置文件[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/order-service/order-service-biz/src/main/resources]\# vim application-prod.ymlspring:  datasource:    url: jdbc:mysql://192.168.20.11:3306/tb_order?characterEncoding=utf-8     #mysql数据库地址    username: root    password: 123456    driver-class-name: com.mysql.jdbc.Drivereureka:  instance:    prefer-ip-address: true  client:    register-with-eureka: true    fetch-registry: true    service-url:      defaultZone: http://eureka-0.eureka-service:8080/eureka/      #eureka地址"><div></div></button></div></figure></div>
<p><strong>5.product-service配置文件</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.创建一个prod的配置文件</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/simple-microservice-dev1]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cd product-service/product-service-biz/src/main/resources/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/simple-microservice-dev1/product-service/product-service-biz/src/main/resources]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cp application-fat.yml application-prod.yml</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.程序使用prod的配置文件运行</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/simple-microservice-dev1/product-service/product-service-biz/src/main/resources]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim application.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">server:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">port:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">spring:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">profiles:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">active:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">prod</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">application:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">product-service</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.配置程序配置文件</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/simple-microservice-dev1/product-service/product-service-biz/src/main/resources]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim application-prod.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">spring:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">datasource:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">url:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">jdbc:mysql://192.168.20.11:3306/tb_product?characterEncoding=utf-8</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#809191;--1:#616671">#数据库地址</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">username:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">password:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">123456</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">driver-class-name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">com.mysql.jdbc.Driver</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">eureka:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">instance:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">prefer-ip-address:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">client:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">register-with-eureka:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">fetch-registry:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">service-url:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">defaultZone:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">http://eureka-0.eureka-service:8080/eureka/</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#809191;--1:#616671">#eureka地址</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.创建一个prod的配置文件[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1]\# cd product-service/product-service-biz/src/main/resources/[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/product-service/product-service-biz/src/main/resources]\# cp application-fat.yml application-prod.yml2.程序使用prod的配置文件运行[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/product-service/product-service-biz/src/main/resources]\# vim application.ymlserver:  port: 8080spring:  profiles:    active: prod  application:    name: product-service3.配置程序配置文件[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/product-service/product-service-biz/src/main/resources]\# vim application-prod.ymlspring:  datasource:    url: jdbc:mysql://192.168.20.11:3306/tb_product?characterEncoding=utf-8     #数据库地址    username: root    password: 123456    driver-class-name: com.mysql.jdbc.Drivereureka:  instance:    prefer-ip-address: true  client:    register-with-eureka: true    fetch-registry: true    service-url:      defaultZone: http://eureka-0.eureka-service:8080/eureka/      #eureka地址"><div></div></button></div></figure></div>
<p><strong>6.stock-service配置文件</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.创建一个prod的配置文件</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/simple-microservice-dev1]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cd stock-service/stock-service-biz/src/main/resources/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/simple-microservice-dev1/stock-service/stock-service-biz/src/main/resources]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cp application-fat.yml application-prod.yml</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.程序使用prod的配置文件运行</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/simple-microservice-dev1/stock-service/stock-service-biz/src/main/resources]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim application.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">server:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">port:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">spring:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">profiles:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">active:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">prod</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">application:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">stock-service</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.配置程序配置文件</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/simple-microservice-dev1/stock-service/stock-service-biz/src/main/resources]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim application-prod.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">spring:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">datasource:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">url:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">jdbc:mysql://192.168.20.11:3306/tb_stock?characterEncoding=utf-8</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#809191;--1:#616671">#数据库地址</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">username:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">password:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">123456</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">driver-class-name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">com.mysql.jdbc.Driver</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">eureka:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">instance:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">prefer-ip-address:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">client:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">register-with-eureka:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">fetch-registry:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">service-url:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">defaultZone:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">http://eureka-service.eureka:8080/eureka/</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#809191;--1:#616671">#eureka地址</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.创建一个prod的配置文件[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1]\# cd stock-service/stock-service-biz/src/main/resources/[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/stock-service/stock-service-biz/src/main/resources]\# cp application-fat.yml application-prod.yml2.程序使用prod的配置文件运行[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/stock-service/stock-service-biz/src/main/resources]\# vim application.ymlserver:  port: 8080spring:  profiles:    active: prod  application:    name: stock-service3.配置程序配置文件[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/stock-service/stock-service-biz/src/main/resources]\# vim application-prod.ymlspring:  datasource:    url: jdbc:mysql://192.168.20.11:3306/tb_stock?characterEncoding=utf-8   #数据库地址    username: root    password: 123456    driver-class-name: com.mysql.jdbc.Drivereureka:  instance:    prefer-ip-address: true  client:    register-with-eureka: true    fetch-registry: true    service-url:      defaultZone: http://eureka-service.eureka:8080/eureka/      #eureka地址"><div></div></button></div></figure></div>
<p><strong>4.portal-service配置文件</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.创建一个prod的配置文件</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/simple-microservice-dev1]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cd portal-service/src/main/resources/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/simple-microservice-dev1/portal-service/src/main/resources]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cp application-fat.yml application-prod.yml</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.程序使用prod的配置文件运行</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/simple-microservice-dev1/portal-service/src/main/resources]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim application.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">server:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">port:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">undertow:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">io-threads:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">worker-threads:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">256</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">buffer-size:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1024</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">direct-buffers:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">spring:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">application:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">portal-service</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">profiles:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">active:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">prod</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.配置程序配置文件</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/simple-microservice-dev1/portal-service/src/main/resources]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim application-prod.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">eureka:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">instance:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">prefer-ip-address:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">client:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">service-url:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">defaultZone:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">http://eureka-0.eureka-service:8080/eureka/</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#809191;--1:#616671">#指定eureka地址</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">register-with-eureka:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">fetch-registry:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">······</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.创建一个prod的配置文件[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1]\# cd portal-service/src/main/resources/[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/portal-service/src/main/resources]\# cp application-fat.yml application-prod.yml2.程序使用prod的配置文件运行[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/portal-service/src/main/resources]\# vim application.ymlserver:  port: 8080  undertow:    io-threads: 16    worker-threads: 256    buffer-size: 1024    direct-buffers: truespring:  application:    name: portal-service  profiles:    active: prod3.配置程序配置文件[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/portal-service/src/main/resources]\# vim application-prod.ymleureka:  instance:    prefer-ip-address: true  client:    service-url:      defaultZone: http://eureka-0.eureka-service:8080/eureka/      #指定eureka地址    register-with-eureka: true    fetch-registry: true······"><div></div></button></div></figure></div>
<h4 id="332调整每个微服务的pom文件增加prod环境">3.3.2.调整每个微服务的pom文件增加prod环境</h4>
<p>由于我们新加了一个prod线上环境的配置文件，因此也需要在pom.xml中配置，配置完成后可以编译一下，看看是否可以做成可部署的程序包</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.安装maven</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> yum -y install java-1.8.0-openjdk maven</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.调整pom.xml增加prod环境配置</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 simple-microservice-dev1]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim pom.xml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">······</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#809191;--1:#616671">#65行左右</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">&#x3C;profile></span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">&#x3C;id>prod&#x3C;/id></span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">&#x3C;properties></span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">&#x3C;profileActive>prod&#x3C;/profileActive></span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">&#x3C;/properties></span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">&#x3C;/profile></span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">&#x3C;/profiles></span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">······</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.编译程序</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/simple-microservice-dev1]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> mvn clean package -D maven.test.skip=true -P prod</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.查看编译成功的war包</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/simple-microservice-dev1]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> find </span><span style="--0:#C5E478;--1:#3C63B3">.</span><span style="--0:#D6DEEB;--1:#403F53"> -name </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">*.jar</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">./basic-common/basic-common-core/target/basic-common-core.jar</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">./eureka-service/target/eureka-service.jar</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">./gateway-service/target/gateway-service.jar</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">./order-service/order-service-api/target/order-service-api.jar</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">./order-service/order-service-biz/target/order-service-biz.jar</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">./portal-service/target/portal-service.jar</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">./product-service/product-service-api/target/product-service-api.jar</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">./product-service/product-service-biz/target/product-service-biz.jar</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">./stock-service/stock-service-api/target/stock-service-api.jar</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">./stock-service/stock-service-biz/target/stock-service-biz.jar</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.安装maven[root@binary-k8s-master1 ~]\# yum -y install java-1.8.0-openjdk maven2.调整pom.xml增加prod环境配置[root@binary-k8s-master1 simple-microservice-dev1]\# vim pom.xml······      #65行左右    <profile>      <id>prod</id>      <properties>        <profileActive>prod</profileActive>      </properties>    </profile>  </profiles>······2.编译程序[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1]\# mvn clean package -D maven.test.skip=true -P prod3.查看编译成功的war包[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1]\# find . -name &#x22;*.jar&#x22;./basic-common/basic-common-core/target/basic-common-core.jar./eureka-service/target/eureka-service.jar./gateway-service/target/gateway-service.jar./order-service/order-service-api/target/order-service-api.jar./order-service/order-service-biz/target/order-service-biz.jar./portal-service/target/portal-service.jar./product-service/product-service-api/target/product-service-api.jar./product-service/product-service-biz/target/product-service-biz.jar./stock-service/stock-service-api/target/stock-service-api.jar./stock-service/stock-service-biz/target/stock-service-biz.jar"><div></div></button></div></figure></div>
<h3 id="34制作微服务程序所使用的的底层系统镜像">3.4.制作微服务程序所使用的的底层系统镜像</h3>
<h4 id="341为程序环境构建底层系统镜像">3.4.1.为程序环境构建底层系统镜像</h4>
<p>由于是SpringCloud微服务系统，SpringCloud属于JAVA语言开发的项目，因此要有JAVA启动环境。</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.拉取centos7.5作为底层容器</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> docker pull centos:7.5.1804</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.启动容器</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> docker run -itd centos:7.5.1804</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.进入系统容器进行环境配置</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> docker exec -it 462237f9a0a bash</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#安装java环境</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@2fcfb51f04e0 /]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> yum -y install java-1.8.0-openjdk net-tools</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@2fcfb51f04e0 /]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> java  -version</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">openjdk</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">version</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">1.8.0_302</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">OpenJDK</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Runtime</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Environment</span><span style="--0:#D6DEEB;--1:#403F53"> (build </span><span style="--0:#F78C6C;--1:#AA0982">1.8</span><span style="--0:#ECC48D;--1:#3C63B3">.0_302-b08</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">OpenJDK</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">64</span><span style="--0:#ECC48D;--1:#3C63B3">-Bit</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Server</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">VM</span><span style="--0:#D6DEEB;--1:#403F53"> (build </span><span style="--0:#F78C6C;--1:#AA0982">25.302</span><span style="--0:#ECC48D;--1:#3C63B3">-b08,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">mixed</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">mode</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@2fcfb51f04e0 /]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> mkdir /data/simple-microservice -p</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#调整系统时区</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@2fcfb51f04e0 /]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> yum -y intall tzdata</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@2fcfb51f04e0 /]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">4.将容器提交为镜像</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> docker commit 2fcfb51f04e0 centos-java:v1</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">5.配置Harbor镜像仓库</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /etc/docker/daemon.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"registry-mirrors"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://9wn5tbfh.mirror.aliyuncs.com</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">],</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"insecure-registries"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">192.168.20.10</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl restart docker</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">6.提交镜像到Harbor仓库</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> docker login -u admin -p Harbor12345 192.168.20.10</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> docker tag centos-java:v1 192.168.20.11/base/centos-java:v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> docker push 192.168.20.11/base/centos-java:v1</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.拉取centos7.5作为底层容器[root@binary-k8s-master1 ~]\# docker pull centos:7.5.18042.启动容器[root@binary-k8s-master1 ~]\# docker run -itd centos:7.5.18043.进入系统容器进行环境配置[root@binary-k8s-master1 ~]\# docker exec -it 462237f9a0a bash[root@2fcfb51f04e0 /]\# yum -y install java-1.8.0-openjdk net-tools[root@2fcfb51f04e0 /]\# java  -versionopenjdk version &#x22;1.8.0_302&#x22;OpenJDK Runtime Environment (build 1.8.0_302-b08)OpenJDK 64-Bit Server VM (build 25.302-b08, mixed mode)[root@2fcfb51f04e0 /]\# mkdir /data/simple-microservice -p[root@2fcfb51f04e0 /]\# yum -y intall tzdata[root@2fcfb51f04e0 /]\# ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime4.将容器提交为镜像[root@binary-k8s-master1 ~]\# docker commit 2fcfb51f04e0 centos-java:v15.配置Harbor镜像仓库[root@binary-k8s-master1 ~]\# vim /etc/docker/daemon.json{  &#x22;registry-mirrors&#x22;: [&#x22;https://9wn5tbfh.mirror.aliyuncs.com&#x22;],  &#x22;insecure-registries&#x22;: [&#x22;192.168.20.10&#x22;]}[root@binary-k8s-master1 ~]\# systemctl restart docker6.提交镜像到Harbor仓库[root@binary-k8s-master1 ~]\# docker login -u admin -p Harbor12345 192.168.20.10[root@binary-k8s-master1 ~]\# docker tag centos-java:v1 192.168.20.11/base/centos-java:v1[root@binary-k8s-master1 ~]\# docker push 192.168.20.11/base/centos-java:v1"><div></div></button></div></figure></div>
<h4 id="342为每个微服务程序编写dockerfile">3.4.2.为每个微服务程序编写Dockerfile</h4>
<p><strong>设计概念：</strong></p>
<p>采用3.3.1中制作的底层镜像</p>
<p>第一步：在镜像里面创建<code dir="auto">/data/simple-microservice/微服务名称</code>这样的目录用于存放程序的jar包</p>
<p>第二步：将程序的jar包拷贝至镜像中</p>
<p>第三步：生成一个启动脚本，由于服务名称都不一样也就是每个程序的路径都不同，想要做到一个底层镜像多个程序复用，那么就需要在启动脚本里手动指定程序的路径，在脚本中指定程序的部署路径以及日志路径</p>
<p>第四步：暴露8080端口</p>
<p>将Dockerfile放到程序编译的目录也就是与src在同一目录</p>
<p><strong>1.eureka-service服务</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">在4.2.2.会写</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="在4.2.2.会写"><div></div></button></div></figure></div>
<p><strong>2.gateway-service服务</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/simple-microservice-dev1/gateway-service]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim Dockerfile</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">FROM</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#ECC48D;--1:#3C63B3">.20.11/base/centos-java:v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">RUN</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">mkdir</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/simple-microservice/gateway-service</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-p</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">COPY</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">./target/gateway-service.jar</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/simple-microservice/gateway-service/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">RUN</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">echo</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-e</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">#!/bin/bash \njava -jar /data/simple-microservice/gateway-service/gateway-service.jar > /data/simple-microservice/gateway-service/gateway-service.log &#x26; \ntail -f /data/simple-microservice/gateway-service/gateway-service.log</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">></span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/entrypoint.sh</span><span style="--0:#D6DEEB;--1:#403F53"> &#x26;&#x26; </span><span style="--0:#82AAFF;--1:#3C63B3">chmod</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">a+x</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/entrypoint.sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">EXPOSE</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">ENTRYPOINT</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/entrypoint.sh</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/gateway-service]\# vim DockerfileFROM 192.168.20.11/base/centos-java:v1RUN mkdir /data/simple-microservice/gateway-service -pCOPY ./target/gateway-service.jar /data/simple-microservice/gateway-service/RUN echo -e &#x22;#!/bin/bash \njava -jar /data/simple-microservice/gateway-service/gateway-service.jar > /data/simple-microservice/gateway-service/gateway-service.log &#x26; \ntail -f /data/simple-microservice/gateway-service/gateway-service.log&#x22; > /data/entrypoint.sh &#x26;&#x26; chmod a+x /data/entrypoint.shEXPOSE 8080ENTRYPOINT /data/entrypoint.sh"><div></div></button></div></figure></div>
<p><strong>3.order-service服务</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/simple-microservice-dev1/order-service/order-service-biz]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim Dockerfile</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">FROM</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#ECC48D;--1:#3C63B3">.20.11/base/centos-java:v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">RUN</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">mkdir</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/simple-microservice/order-service</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-p</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">COPY</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">./target/order-service-biz.jar</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/simple-microservice/order-service/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">RUN</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">echo</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-e</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">#!/bin/bash \njava -jar /data/simple-microservice/order-service/order-service-biz.jar > /data/simple-microservice/order-service/order-service-biz.log &#x26; \ntail -f /data/simple-microservice/order-service/order-service-biz.log</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">></span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/entrypoint.sh</span><span style="--0:#D6DEEB;--1:#403F53"> &#x26;&#x26; </span><span style="--0:#82AAFF;--1:#3C63B3">chmod</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">a+x</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/entrypoint.sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">EXPOSE</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">ENTRYPOINT</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/entrypoint.sh</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/order-service/order-service-biz]\# vim DockerfileFROM 192.168.20.11/base/centos-java:v1RUN mkdir /data/simple-microservice/order-service -pCOPY ./target/order-service-biz.jar /data/simple-microservice/order-service/RUN echo -e &#x22;#!/bin/bash \njava -jar /data/simple-microservice/order-service/order-service-biz.jar > /data/simple-microservice/order-service/order-service-biz.log &#x26; \ntail -f /data/simple-microservice/order-service/order-service-biz.log&#x22; > /data/entrypoint.sh &#x26;&#x26; chmod a+x /data/entrypoint.shEXPOSE 8080ENTRYPOINT /data/entrypoint.sh"><div></div></button></div></figure></div>
<p><strong>4.portal-service服务</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/simple-microservice-dev1/portal-service]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim Dockerfile</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">FROM</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#ECC48D;--1:#3C63B3">.20.11/base/centos-java:v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">RUN</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">mkdir</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/simple-microservice/portal-service</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-p</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">COPY</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">./target/portal-service.jar</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/simple-microservice/portal-service/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">RUN</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">echo</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-e</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">#!/bin/bash \njava -jar /data/simple-microservice/portal-service/portal-service.jar > /data/simple-microservice/portal-service/portal-service.log &#x26; \ntail -f /data/simple-microservice/portal-service/portal-service.log</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">></span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/entrypoint.sh</span><span style="--0:#D6DEEB;--1:#403F53"> &#x26;&#x26; </span><span style="--0:#82AAFF;--1:#3C63B3">chmod</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">a+x</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/entrypoint.sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">EXPOSE</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">ENTRYPOINT</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/entrypoint.sh</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/portal-service]\# vim DockerfileFROM 192.168.20.11/base/centos-java:v1RUN mkdir /data/simple-microservice/portal-service -pCOPY ./target/portal-service.jar /data/simple-microservice/portal-service/RUN echo -e &#x22;#!/bin/bash \njava -jar /data/simple-microservice/portal-service/portal-service.jar > /data/simple-microservice/portal-service/portal-service.log &#x26; \ntail -f /data/simple-microservice/portal-service/portal-service.log&#x22; > /data/entrypoint.sh &#x26;&#x26; chmod a+x /data/entrypoint.shEXPOSE 8080ENTRYPOINT /data/entrypoint.sh"><div></div></button></div></figure></div>
<p><strong>5.product-service服务</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/simple-microservice-dev1/product-service/product-service-biz]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim Dockerfile</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">FROM</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#ECC48D;--1:#3C63B3">.20.11/base/centos-java:v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">RUN</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">mkdir</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/simple-microservice/product-service</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-p</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">COPY</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">./target/product-service-biz.jar</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/simple-microservice/product-service/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">RUN</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">echo</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-e</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">#!/bin/bash \njava -jar /data/simple-microservice/product-service/product-service-biz.jar > /data/simple-microservice/product-service/product-service-biz.log &#x26; \ntail -f /data/simple-microservice/product-service/product-service-biz.log</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">></span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/entrypoint.sh</span><span style="--0:#D6DEEB;--1:#403F53"> &#x26;&#x26; </span><span style="--0:#82AAFF;--1:#3C63B3">chmod</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">a+x</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/entrypoint.sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">EXPOSE</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">ENTRYPOINT</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/entrypoint.sh</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/product-service/product-service-biz]\# vim DockerfileFROM 192.168.20.11/base/centos-java:v1RUN mkdir /data/simple-microservice/product-service -pCOPY ./target/product-service-biz.jar /data/simple-microservice/product-service/RUN echo -e &#x22;#!/bin/bash \njava -jar /data/simple-microservice/product-service/product-service-biz.jar > /data/simple-microservice/product-service/product-service-biz.log &#x26; \ntail -f /data/simple-microservice/product-service/product-service-biz.log&#x22; > /data/entrypoint.sh &#x26;&#x26; chmod a+x /data/entrypoint.shEXPOSE 8080ENTRYPOINT /data/entrypoint.sh"><div></div></button></div></figure></div>
<p><strong>6.stock-service服务</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/simple-microservice-dev1/stock-service/stock-service-biz]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cat Dockerfile</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">FROM</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#ECC48D;--1:#3C63B3">.20.11/base/centos-java:v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">RUN</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">mkdir</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/simple-microservice/stock-service</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-p</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">COPY</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">./target/stock-service-biz.jar</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/simple-microservice/stock-service/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">RUN</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">echo</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-e</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">#!/bin/bash \njava -jar /data/simple-microservice/stock-service/stock-service-biz.jar > /data/simple-microservice/stock-service/stock-service-biz.log &#x26; \ntail -f /data/simple-microservice/stock-service/stock-service-biz.log</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">></span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/entrypoint.sh</span><span style="--0:#D6DEEB;--1:#403F53"> &#x26;&#x26; </span><span style="--0:#82AAFF;--1:#3C63B3">chmod</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">a+x</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/entrypoint.sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">EXPOSE</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">ENTRYPOINT</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/entrypoint.sh</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/stock-service/stock-service-biz]\# cat DockerfileFROM 192.168.20.11/base/centos-java:v1RUN mkdir /data/simple-microservice/stock-service -pCOPY ./target/stock-service-biz.jar /data/simple-microservice/stock-service/RUN echo -e &#x22;#!/bin/bash \njava -jar /data/simple-microservice/stock-service/stock-service-biz.jar > /data/simple-microservice/stock-service/stock-service-biz.log &#x26; \ntail -f /data/simple-microservice/stock-service/stock-service-biz.log&#x22; > /data/entrypoint.sh &#x26;&#x26; chmod a+x /data/entrypoint.shEXPOSE 8080ENTRYPOINT /data/entrypoint.sh"><div></div></button></div></figure></div>
<h3 id="35调整protal微服务中连接gateway网关的地址">3.5.调整Protal微服务中连接Gateway网关的地址</h3>
<p>Protal是我们电商平台的门户网站，也就是前端首页，在Protal微服务中会填写好其他微服务程序的地址，Gateway网关程序的地址就是写死在Protal项目的js里，在我们定义好Gateway网关服务的域名后，就要将域名写入到对应的js文件里，否则当项目启动之后是无法调通的。</p>
<p>需要修改下列这四个文件</p>
<p>portal-service/src/main/resources/static/js/orderList.js</p>
<p>portal-service/src/main/resources/static/js/productList.js
<img src="https://cdn.agou-ops.cn/others/d0e207db0cb54e6296ca185728e5ed1c.png" alt="在这里插入图片描述"></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">打开这四个文件，将里面的gateway.ctnrs.com域名修改为gateway.jiangxl.com域名</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim修改命令：%s/gateway.ctnrs.com/gateway.jiangxl.com/g</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="打开这四个文件，将里面的gateway.ctnrs.com域名修改为gateway.jiangxl.com域名vim修改命令：%s/gateway.ctnrs.com/gateway.jiangxl.com/g"><div></div></button></div></figure></div>
<h3 id="36部署ingress用于将微服务程序发布到互联网">3.6.部署Ingress用于将微服务程序发布到互联网</h3>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.下载ingress部署的yaml文件</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> wget https://raw.githubusercontent.com/kubernetes/ingress-nginx/nginx-0.30.0/deploy/static/mandatory.yaml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> wget https://raw.githubusercontent.com/kubernetes/ingress-nginx/nginx-0.30.0/deploy/static/provider/baremetal/service-nodeport.yaml</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.调整ingress</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">nodeport端口</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/ingress]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim service-nodeport.yaml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">······</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">ports:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">http</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">port:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">80</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">targetPort:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">80</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">nodePort:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">80</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">protocol:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">TCP</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">https</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">port:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">443</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">targetPort:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">443</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">nodePort:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">443</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">protocol:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">TCP</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">······</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.部署ingress</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/springcloud/ingress]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl apply -f mandatory.yaml</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">4.查看ingress部署的结果</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get all -n ingress-nginx</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                                            </span><span style="--0:#ECC48D;--1:#3C63B3">READY</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">STATUS</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">RESTARTS</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">pod/nginx-ingress-controller-766867958b-n7dwj</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">49</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                    </span><span style="--0:#ECC48D;--1:#3C63B3">TYPE</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#ECC48D;--1:#3C63B3">CLUSTER-IP</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">EXTERNAL-IP</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">PORT</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#82AAFF;--1:#3C63B3">S</span><span style="--0:#D6DEEB;--1:#403F53">)                 </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">service/ingress-nginx</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">NodePort</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">10.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.107</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">80</span><span style="--0:#ECC48D;--1:#3C63B3">:80/TCP,443:443/TCP</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">49</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                                       </span><span style="--0:#ECC48D;--1:#3C63B3">READY</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">UP-TO-DATE</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">AVAILABLE</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">deployment.apps/nginx-ingress-controller</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">            </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">           </span><span style="--0:#F78C6C;--1:#AA0982">49</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                                                  </span><span style="--0:#ECC48D;--1:#3C63B3">DESIRED</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">CURRENT</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">READY</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">replicaset.apps/nginx-ingress-controller-766867958b</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#F78C6C;--1:#AA0982">49</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.下载ingress部署的yaml文件[root@binary-k8s-master1 ~]\# wget https://raw.githubusercontent.com/kubernetes/ingress-nginx/nginx-0.30.0/deploy/static/mandatory.yaml[root@binary-k8s-master1 ~]\# wget https://raw.githubusercontent.com/kubernetes/ingress-nginx/nginx-0.30.0/deploy/static/provider/baremetal/service-nodeport.yaml2.调整ingress nodeport端口[root@binary-k8s-master1 ~/springcloud/ingress]\# vim service-nodeport.yaml······  ports:    - name: http      port: 80      targetPort: 80      nodePort: 80      protocol: TCP    - name: https      port: 443      targetPort: 443      nodePort: 443      protocol: TCP······3.部署ingress[root@binary-k8s-master1 ~/springcloud/ingress]\# kubectl apply -f mandatory.yaml4.查看ingress部署的结果[root@binary-k8s-master1 ~]\# kubectl get all -n ingress-nginxNAME                                            READY   STATUS    RESTARTS   AGEpod/nginx-ingress-controller-766867958b-n7dwj   1/1     Running   0          49mNAME                    TYPE       CLUSTER-IP   EXTERNAL-IP   PORT(S)                 AGEservice/ingress-nginx   NodePort   10.0.0.107   <none>        80:80/TCP,443:443/TCP   49mNAME                                       READY   UP-TO-DATE   AVAILABLE   AGEdeployment.apps/nginx-ingress-controller   1/1     1            1           49mNAME                                                  DESIRED   CURRENT   READY   AGEreplicaset.apps/nginx-ingress-controller-766867958b   1         1         1       49m"><div></div></button></div></figure></div>
<h2 id="4在kubernetes集群部署simple微服务项目">4.在kubernetes集群部署simple微服务项目</h2>
<p>simple微服务项目在K8S集群中部署，只有eureka服务采用statefulset控制器部署，其余所有微服务均采用deployment控制器部署，所有的微服务通过ingress发布在互联网。</p>
<p><strong>simple微服务电商项目在K8S集群部署流程</strong></p>
<p>1）部署simple电商微服务项目的数据库环境</p>
<p>2）在K8S中部署Eureka注册中心</p>
<p>3）修改每个微服务的配置文件，指定eureka注册中心集群的地址</p>
<p>4）使用maven将每个微服务构建成可部署的jar包</p>
<p>5）部署Gateway关服务</p>
<p>6）部署protal、order、product、stock服务</p>
<h3 id="41部署simple微服务程序的mysql数据库环境">4.1.部署simple微服务程序的mysql数据库环境</h3>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.安装MySQL数据库</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@harbor-mysql </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> rpm -ivh http://repo.mysql.com/yum/mysql-5.6-community/el/7/x86_64/mysql-community-release-el7-5.noarch.rpm</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@harbor-mysql </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53">  yum install mysql-community-server</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.启动MySQL</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@harbor-mysql </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl start mysqld</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@harbor-mysql </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl enable mysqld</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.设置数据库密码</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@harbor-mysql </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> mysqladmin -u root password </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">123456</span><span style="--0:#D9F5DD;--1:#111111">'</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">4.创建order（订单）、product（商品）、stock（库存）微服务的数据库</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@harbor-mysql </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> mysql -uroot -p123456</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">mysql></span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">create</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">database</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">tb_order</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">Query</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">OK,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">row</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">affected</span><span style="--0:#D6DEEB;--1:#403F53"> (0.00 </span><span style="--0:#ECC48D;--1:#3C63B3">sec</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">mysql></span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">create</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">database</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">tb_product</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">Query</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">OK,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">row</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">affected</span><span style="--0:#D6DEEB;--1:#403F53"> (0.01 </span><span style="--0:#ECC48D;--1:#3C63B3">sec</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">mysql></span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">create</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">database</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">tb_stock</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">Query</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">OK,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">row</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">affected</span><span style="--0:#D6DEEB;--1:#403F53"> (0.00 </span><span style="--0:#ECC48D;--1:#3C63B3">sec</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">5.导入数据库数据</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#将数据库文件传到数据库服务器</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 simple-microservice-dev1]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> scp -r db root@192.168.20.11:/root</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#导入order数据库的数据</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">mysql></span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">use</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">tb_order</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">mysql></span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">source</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/root/db/order.sql</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#导入product数据库的数据</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">mysql></span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">use</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">tb_product</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">mysql></span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">source</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/root/db/product.sql</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#导入stock数据库的数据</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">mysql></span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">use</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">tb_stock</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">mysql></span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">source</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/root/db/stock.sql</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">6.允许数据库远程访问</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">mysql></span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">grant</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">all</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">privileges</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">on</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#ECC48D;--1:#3C63B3">.</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">root</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#3C63B3">@</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">%</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">identified</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">by</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">123456</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">with</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">grant</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">option</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">Query</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">OK,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">rows</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">affected</span><span style="--0:#D6DEEB;--1:#403F53"> (0.00 </span><span style="--0:#ECC48D;--1:#3C63B3">sec</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.安装MySQL数据库[root@harbor-mysql ~]\# rpm -ivh http://repo.mysql.com/yum/mysql-5.6-community/el/7/x86_64/mysql-community-release-el7-5.noarch.rpm[root@harbor-mysql ~]\#  yum install mysql-community-server2.启动MySQL[root@harbor-mysql ~]\# systemctl start mysqld[root@harbor-mysql ~]\# systemctl enable mysqld3.设置数据库密码[root@harbor-mysql ~]\# mysqladmin -u root password &#x27;123456&#x27;4.创建order（订单）、product（商品）、stock（库存）微服务的数据库[root@harbor-mysql ~]\# mysql -uroot -p123456mysql> create database tb_order;Query OK, 1 row affected (0.00 sec)mysql> create database tb_product;Query OK, 1 row affected (0.01 sec)mysql> create database tb_stock;Query OK, 1 row affected (0.00 sec)5.导入数据库数据[root@binary-k8s-master1 simple-microservice-dev1]\# scp -r db root@192.168.20.11:/rootmysql> use tb_ordermysql> source /root/db/order.sqlmysql> use tb_productmysql> source /root/db/product.sqlmysql> use tb_stock;mysql> source /root/db/stock.sql6.允许数据库远程访问mysql> grant all privileges on *.* to &#x27;root&#x27;@&#x27;%&#x27; identified by &#x27;123456&#x27; with grant option;Query OK, 0 rows affected (0.00 sec)"><div></div></button></div></figure></div>
<h3 id="42部署eureka微服务注册中心">4.2.部署eureka微服务注册中心</h3>
<p>Eureka在整个微服务架构中起到至关重要的的作用，必须保证Eureka服务高可用。</p>
<p>Eureka服务采用statefulset有状态应用部署方式再K8S集群中进行部署。</p>
<p>Eureka本身就可以利用自身的服务发现来实现集群的高可用，只需要在Eureka配置文件中指定各个Eureka节点的地址就可以实现。</p>
<p>将程序部署在K8S之后，如何能够保证每个Eureka Pod的地址唯一不变，就需要用到Statefulset控制器采用有状态的应用部署，使用Statefulset控制器之后，每个Pod的名称都是唯一不变的，并且每个Pod都有一个DNS服务发现地址，通过这个DNS地址就可以请求到Pod中的服务，主要是coredns组件来实现的，因此集群还需要安装有coredns服务，我们可以将每一个Eureka Pod的DNS服务发现地址写入到Eureka的配置文件中，每个Eureka节点相互注册，最终形成高可用集群。</p>
<p>Statefulset+Headless部署的程序DNS名格式：<code dir="auto">&#x3C;statefulsetName-index>.&#x3C;service-name>.&#x3C;namespace-name>.svc.cluster.local</code>后面的.svc.cluster.local可以去掉，K8S默认就是.svc.cluster.local。</p>
<p><code dir="auto">&#x3C;statefulsetName-index></code>就是Pod的名称，-index是每一个Pod名称后面的数字编号，Statefulset控制器部署好的Pod，会在每一个Pod名称后面加上一个数字编号，从0开始，一次累加，保证所有的Pod都有一个独立的访问入口</p>
<p><code dir="auto">&#x3C;service-name></code>是程序的service资源的名称</p>
<p><code dir="auto">&#x3C;namespace-name></code>是程序所在的namespace名称</p>
<p>我们的Eureka规定的节点数为3个，也就是最终statefulset会启动3个Pod副本组成Eureka集群。</p>
<h4 id="421修改eureka配置文件增加各节点地址">4.2.1.修改Eureka配置文件增加各节点地址</h4>
<p>Eureka集群节点每个Pod副本服务发现地址如下，需要将其配置在eureka中</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">http://eureka-0.eureka-service.simple-ms`</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">`http://eureka-0.eureka-service.simple-ms`</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">`http://eureka-0.eureka-service.simple-ms</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="http://eureka-0.eureka-service.simple-ms&#x60;&#x60;http://eureka-0.eureka-service.simple-ms&#x60;&#x60;http://eureka-0.eureka-service.simple-ms"><div></div></button></div></figure></div>
<p>修改Eureka的配置文件，采用Dns服务发现地址的形式将每个节点的地址都写在配置文件中，当Eureka启动之后，每个节点都会相互发现最终形成高可用集群。</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.修改Eureka配置文件中的节点地址</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 eureka-service]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim src/main/resources/application-prod.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">eureka:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">server:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">renewal-percent-threshold:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">0.9</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">enable-self-preservation:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">false</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">eviction-interval-timer-in-simple-ms:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">40000</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">instance:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">hostname:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">127.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.1</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">prefer-ip-address:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">false</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">client:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">register-with-eureka:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">serviceUrl:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">defaultZone:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">http://eureka-0.eureka.simple-ms:</span><span style="--0:#D6DEEB;--1:#403F53">${</span><span style="--0:#C5E478;--1:#3C63B3">server</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3C63B3">port</span><span style="--0:#D6DEEB;--1:#403F53">}</span><span style="--0:#ECC48D;--1:#3C63B3">/eureka/,http://eureka-1.eureka.simple-ms:</span><span style="--0:#D6DEEB;--1:#403F53">${</span><span style="--0:#C5E478;--1:#3C63B3">server</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3C63B3">port</span><span style="--0:#D6DEEB;--1:#403F53">}</span><span style="--0:#ECC48D;--1:#3C63B3">/eureka/,http://eureka-2.eureka.simple-ms:</span><span style="--0:#D6DEEB;--1:#403F53">${</span><span style="--0:#C5E478;--1:#3C63B3">server</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3C63B3">port</span><span style="--0:#D6DEEB;--1:#403F53">}</span><span style="--0:#ECC48D;--1:#3C63B3">/eureka/</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">fetch-registry:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.使用maven将最新的Eureka编译</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 simple-microservice-dev1]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> mvn clean package -D maven.test.skip=true -P prod</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">注意：只能在项目最外层的目录中执行mvn</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">clean</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">package</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.修改Eureka配置文件中的节点地址[root@binary-k8s-master1 eureka-service]\# vim src/main/resources/application-prod.ymleureka:  server:    renewal-percent-threshold: 0.9    enable-self-preservation: false    eviction-interval-timer-in-simple-ms: 40000  instance:    hostname: 127.0.0.1    prefer-ip-address: false  client:    register-with-eureka: true    serviceUrl:      defaultZone: http://eureka-0.eureka.simple-ms:${server.port}/eureka/,http://eureka-1.eureka.simple-ms:${server.port}/eureka/,http://eureka-2.eureka.simple-ms:${server.port}/eureka/    fetch-registry: true2.使用maven将最新的Eureka编译[root@binary-k8s-master1 simple-microservice-dev1]\# mvn clean package -D maven.test.skip=true -P prod注意：只能在项目最外层的目录中执行mvn clean package"><div></div></button></div></figure></div>
<h4 id="422调整eureka的dockerfile">4.2.2.调整Eureka的Dockerfile</h4>
<p>由于我们在Eureka配置文件中配置的是以dns名称来互相发现对方，并不是以IP地址形式发现，因此我们需要配置Dockerfile，在启动程序时将配置文件中的hostname字段值修改为当前Pod的dns名称。</p>
<p>因为我们的Eureka是多Pod组成的高可用集群，因此不能将dns名称写死在配置文件中，不然每个Pod都是同样的地址，集群是组件不成功的，所以就需要在Dockerfile中定义程序启动命令时，将dns名称地址设置成变量，由Pod资源将变量值传入到启动命令中，程序启动时就会用Pod的dns名称地址替换掉配置文件中的IP地址。</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.修改DOckerfile文件内容</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 eureka-service]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim Dockerfile</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">FROM</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#ECC48D;--1:#3C63B3">.20.11/base/centos-java:v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">RUN</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">mkdir</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/simple-microservice/eureka-service</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-p</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">COPY</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">./target/eureka-service.jar</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/simple-microservice/eureka-service/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">RUN</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">echo</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-e</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">#!/bin/bash \njava -jar -Deureka.instance.hostname=${</span><span style="--0:#C5E478;--1:#3C63B3">MY_POD_NAME</span><span style="--0:#ECC48D;--1:#9B504E">}.eureka.simple-ms /data/simple-microservice/eureka-service/eureka-service.jar > /data/simple-microservice/eureka-service/eureka-service.log &#x26; \ntail -f /data/simple-microservice/eureka-service/eureka-service.log</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">></span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/entrypoint.sh</span><span style="--0:#D6DEEB;--1:#403F53"> &#x26;&#x26; </span><span style="--0:#82AAFF;--1:#3C63B3">chmod</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">a+x</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/entrypoint.sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">EXPOSE</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">ENTRYPOINT</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/entrypoint.sh</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.修改DOckerfile文件内容[root@binary-k8s-master1 eureka-service]\# vim DockerfileFROM 192.168.20.11/base/centos-java:v1RUN mkdir /data/simple-microservice/eureka-service -pCOPY ./target/eureka-service.jar /data/simple-microservice/eureka-service/RUN echo -e &#x22;#!/bin/bash \njava -jar -Deureka.instance.hostname=${MY_POD_NAME}.eureka.simple-ms /data/simple-microservice/eureka-service/eureka-service.jar > /data/simple-microservice/eureka-service/eureka-service.log &#x26; \ntail -f /data/simple-microservice/eureka-service/eureka-service.log&#x22; > /data/entrypoint.sh &#x26;&#x26; chmod a+x /data/entrypoint.shEXPOSE 8080ENTRYPOINT /data/entrypoint.sh"><div></div></button></div></figure></div>
<p>启动命令单独拉出来看一下，<code dir="auto">-Deureka.instance.hostname</code>这个参数表示修改配置文件中hostname参数的值，<code dir="auto">${MY_POD_NAME}</code>这个变量使从deployment资源文件中定义的env变量，将Pod的名称赋给MY_POD_NAME变量，最后引入到启动命令中，最后在配置文件中hostname字段的值应该是<code dir="auto">eureka-0.eureka-service.simple-ms</code></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">java</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-jar</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--1:#3C63B3"><span style="--0:#82AAFF">-Deureka.instance.hostname=${</span><span style="--0:#C5E478">MY_POD_NAME</span><span style="--0:#82AAFF">}.eureka-service.simple-ms</span></span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/simple-microservice/eureka-service/eureka-service.jar</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="java -jar -Deureka.instance.hostname=${MY_POD_NAME}.eureka-service.simple-ms /data/simple-microservice/eureka-service/eureka-service.jar"><div></div></button></div></figure></div>
<h4 id="423构建eureka服务的docker镜像">4.2.3.构建Eureka服务的Docker镜像</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 eureka-service]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> docker build -t  192.168.20.11/simple-microservice/eureka-service:v1 </span><span style="--0:#C5E478;--1:#3C63B3">.</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 eureka-service]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> docker images </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">grep</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">eureka</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">192.168.20.11/simp-microservice/eureka-service</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#ECC48D;--1:#3C63B3">v1</span><span style="--0:#D6DEEB;--1:#403F53">                  </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">dc64fc9ba09</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#ECC48D;--1:#3C63B3">About</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">a</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">minute</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ago</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">800</span><span style="--0:#ECC48D;--1:#3C63B3">MB</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 eureka-service]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> docker push 192.168.20.11/simple-microservice/eureka-service:v1</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 eureka-service]\# docker build -t  192.168.20.11/simple-microservice/eureka-service:v1 .[root@binary-k8s-master1 eureka-service]\# docker images | grep eureka192.168.20.11/simp-microservice/eureka-service        v1                  1dc64fc9ba09        About a minute ago   800MB[root@binary-k8s-master1 eureka-service]\# docker push 192.168.20.11/simple-microservice/eureka-service:v1"><div></div></button></div></figure></div>
<h4 id="424编写eureka部署yaml资源文件">4.2.4.编写Eureka部署YAML资源文件</h4>
<p><strong>1）创建命名空间</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">1.创建命名空间</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># kubectl create ns simple-ms</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">namespace/simple-ms created</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">2.创建资源编排YAML文件存放路径</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[</span><span style="--0:#ECC48D;--1:#3C63B3">root@binary-k8s-master1 ~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#ECC48D;--1:#3C63B3">\# mkdir springcloud/simple-microservice-dev1/k8s/</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.创建命名空间# kubectl create ns simple-msnamespace/simple-ms created2.创建资源编排YAML文件存放路径[root@binary-k8s-master1 ~]\# mkdir springcloud/simple-microservice-dev1/k8s/"><div></div></button></div></figure></div>
<p><strong>2）登录Harbor</strong></p>
<p>可以不在每一个Node节点使用docker login登陆Harbor仓库，可以将Harbor仓库的认证信息做成secret，通过使用secret的方式连接Harbor。</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl create secret docker-registry registry-pull-secret --docker-server=192.168.20.11 --docker-username=admin --docker-password=Harbor12345 --docker-email=admin@ctnrs.com -n simple-ms</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 ~]\# kubectl create secret docker-registry registry-pull-secret --docker-server=192.168.20.11 --docker-username=admin --docker-password=Harbor12345 --docker-email=admin@ctnrs.com -n simple-ms"><div></div></button></div></figure></div>
<p><strong>3）编写资源YAML文件</strong></p>
<p>eureka要做成集群式的服务，所以要采用statefulset控制器部署，并采用headless service保证statefulset创建的pod名称唯一性，最后通过ingress将eureka服务发布在互联网环境。</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[</span><span style="--0:#ECC48D;--1:#3C63B3">root@binary-k8s-master1 k8s</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#ECC48D;--1:#3C63B3">\# vim eureka-deploy.yaml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#ingress资源</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">apiVersion</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">extensions/v1beta1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">kind</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">Ingress</span><span style="--0:#D6DEEB;--1:#403F53">           </span><span style="--0:#809191;--1:#616671">#类型为ingress</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">metadata</span><span style="--0:#D6DEEB;--1:#403F53">:             </span><span style="--0:#809191;--1:#616671">#定义元数据信息：资源名称、资源所在的命名空间</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">name</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">eureka</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">namespace</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">simple-ms</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">spec</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">rules</span><span style="--0:#D6DEEB;--1:#403F53">:                  </span><span style="--0:#809191;--1:#616671">#定义ingress规则</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">- </span><span style="--0:#7FDBCA;--1:#111111">host</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">eureka.jiangxl.com</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#809191;--1:#616671">#定义eureka使用的域名</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">http</span><span style="--0:#D6DEEB;--1:#403F53">:                   </span><span style="--0:#809191;--1:#616671">#采用http类型的访问方式</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">paths</span><span style="--0:#D6DEEB;--1:#403F53">:                  </span><span style="--0:#809191;--1:#616671">#定义程序的url路径</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">- </span><span style="--0:#7FDBCA;--1:#111111">path</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">/</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">backend</span><span style="--0:#D6DEEB;--1:#403F53">:                </span><span style="--0:#809191;--1:#616671">#针对定义的程序路径关于对应的后端service资源</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">serviceName</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">eureka</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">servicePort</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#headless service资源</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">apiVersion</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">kind</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">Service</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">metadata</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">name</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">eureka</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">namespace</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">simple-ms</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">spec</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">clusterIP</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">None</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#809191;--1:#616671">#ClusterIP资源设置为Node就代表headless类型的service</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">ports</span><span style="--0:#D6DEEB;--1:#403F53">:            </span><span style="--0:#809191;--1:#616671">#定义暴露的eureka端口号</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">- </span><span style="--0:#7FDBCA;--1:#111111">port</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">name</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">eureka</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">selector</span><span style="--0:#D6DEEB;--1:#403F53">:           </span><span style="--0:#809191;--1:#616671">#标签选择器，关联后端pod</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">project</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">simple</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">app</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">eureka</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#statefulset资源</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">apiVersion</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">apps/v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">kind</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">StatefulSet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">metadata</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">name</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">eureka</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">namespace</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">simple-ms</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">spec</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">replicas</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#809191;--1:#616671">#副本数</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">selector</span><span style="--0:#D6DEEB;--1:#403F53">:                 </span><span style="--0:#809191;--1:#616671">#标签选择器</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">matchLabels</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">project</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">simple</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">app</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">eureka</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">serviceName</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">eureka</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">           </span><span style="--0:#809191;--1:#616671">#service的名称，也就是将来的pod名称</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">template</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">metadata</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">labels</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">project</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">simple</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">app</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">eureka</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">spec</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">imagePullSecrets</span><span style="--0:#D6DEEB;--1:#403F53">:           </span><span style="--0:#809191;--1:#616671">#harbor镜像仓库的凭据信息</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">- </span><span style="--0:#7FDBCA;--1:#111111">name</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">registry-pull-secret</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">containers</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">- </span><span style="--0:#7FDBCA;--1:#111111">name</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">eureka</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">image</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">192.168.20.11/simple-microservice/eureka-service:v1</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">ports</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">- </span><span style="--0:#7FDBCA;--1:#111111">protocol</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">TCP</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">containerPort</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">env</span><span style="--0:#D6DEEB;--1:#403F53">:              </span><span style="--0:#809191;--1:#616671">#增加一个环境变量，变量名为MY_POD_NAME，值为pod的名称，这个变量信息会传入dockerfile中</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">- </span><span style="--0:#7FDBCA;--1:#111111">name</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">MY_POD_NAME</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">valueFrom</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#7FDBCA;--1:#111111">fieldRef</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#7FDBCA;--1:#111111">fieldPath</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">metadata.name</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">resources</span><span style="--0:#D6DEEB;--1:#403F53">:            </span><span style="--0:#809191;--1:#616671">#资源配额</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">requests</span><span style="--0:#D6DEEB;--1:#403F53">:           </span><span style="--0:#809191;--1:#616671">#最小资源限制，cpu为0.5，内存为256M</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">cpu</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">0.5</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">memory</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">256Mi</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">limits</span><span style="--0:#D6DEEB;--1:#403F53">:           </span><span style="--0:#809191;--1:#616671">#最大资源限制，cpu为1，内存为1G</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">cpu</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">1</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">memory</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">1Gi</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">readinessProbe</span><span style="--0:#D6DEEB;--1:#403F53">:         </span><span style="--0:#809191;--1:#616671">#就绪性健康检查</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">tcpSocket</span><span style="--0:#D6DEEB;--1:#403F53">:          </span><span style="--0:#809191;--1:#616671">#以tcp 8080端口作为健康检查的机制</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">port</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">initialDelaySeconds</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">60</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#809191;--1:#616671">#容器启动60秒后进行检测</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">periodSeconds</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">10</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#809191;--1:#616671">#探测的频率</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">livenessProbe</span><span style="--0:#D6DEEB;--1:#403F53">:            </span><span style="--0:#809191;--1:#616671">#存活性健康检查</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">tcpSocket</span><span style="--0:#D6DEEB;--1:#403F53">:            </span><span style="--0:#809191;--1:#616671">#以tcp 8080端口作为健康检查的机制</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">port</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">initialDelaySeconds</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">60</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#809191;--1:#616671">#容器启动60秒后进行检查</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">periodSeconds</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">10</span><span style="--0:#D6DEEB;--1:#403F53">           </span><span style="--0:#809191;--1:#616671">#探测的频率为10秒一次</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 k8s]\# vim eureka-deploy.yaml---#ingress资源apiVersion: extensions/v1beta1kind: Ingress           #类型为ingressmetadata:             #定义元数据信息：资源名称、资源所在的命名空间  name: eureka  namespace: simple-msspec:  rules:                  #定义ingress规则    - host: eureka.jiangxl.com          #定义eureka使用的域名      http:                   #采用http类型的访问方式        paths:                  #定义程序的url路径        - path: /          backend:                #针对定义的程序路径关于对应的后端service资源            serviceName: eureka            servicePort: 8080---#headless service资源apiVersion: v1kind: Servicemetadata:  name: eureka  namespace: simple-msspec:  clusterIP: None       #ClusterIP资源设置为Node就代表headless类型的service  ports:            #定义暴露的eureka端口号  - port: 8080    name: eureka  selector:           #标签选择器，关联后端pod    project: simple    app: eureka---#statefulset资源apiVersion: apps/v1kind: StatefulSetmetadata:  name: eureka  namespace: simple-msspec:  replicas: 3               #副本数  selector:                 #标签选择器    matchLabels:      project: simple      app: eureka  serviceName: &#x22;eureka&#x22;           #service的名称，也就是将来的pod名称  template:    metadata:      labels:        project: simple        app: eureka    spec:      imagePullSecrets:           #harbor镜像仓库的凭据信息      - name: registry-pull-secret      containers:      - name: eureka        image: 192.168.20.11/simple-microservice/eureka-service:v1        ports:          - protocol: TCP            containerPort: 8080        env:              #增加一个环境变量，变量名为MY_POD_NAME，值为pod的名称，这个变量信息会传入dockerfile中          - name: MY_POD_NAME            valueFrom:              fieldRef:                fieldPath: metadata.name        resources:            #资源配额          requests:           #最小资源限制，cpu为0.5，内存为256M            cpu: 0.5            memory: 256Mi          limits:           #最大资源限制，cpu为1，内存为1G            cpu: 1            memory: 1Gi        readinessProbe:         #就绪性健康检查          tcpSocket:          #以tcp 8080端口作为健康检查的机制            port: 8080          initialDelaySeconds: 60     #容器启动60秒后进行检测          periodSeconds: 10         #探测的频率        livenessProbe:            #存活性健康检查          tcpSocket:            #以tcp 8080端口作为健康检查的机制            port: 8080          initialDelaySeconds: 60       #容器启动60秒后进行检查          periodSeconds: 10           #探测的频率为10秒一次"><div></div></button></div></figure></div>
<h4 id="425在k8s集群中部署eureka注册中心">4.2.5.在K8S集群中部署Eureka注册中心</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.部署eureka服务</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl apply -f eureka-deploy.yaml</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.查看部署的资源状态</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get all -n simple-ms</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">           </span><span style="--0:#ECC48D;--1:#3C63B3">READY</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">STATUS</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">RESTARTS</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">pod/eureka-0</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">12</span><span style="--0:#ECC48D;--1:#3C63B3">h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">pod/eureka-1</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">12</span><span style="--0:#ECC48D;--1:#3C63B3">h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">pod/eureka-2</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">12</span><span style="--0:#ECC48D;--1:#3C63B3">h</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">             </span><span style="--0:#ECC48D;--1:#3C63B3">TYPE</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#ECC48D;--1:#3C63B3">CLUSTER-IP</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">EXTERNAL-IP</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">PORT</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#82AAFF;--1:#3C63B3">S</span><span style="--0:#D6DEEB;--1:#403F53">)    </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">service/eureka</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">ClusterIP</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">None</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">8080</span><span style="--0:#ECC48D;--1:#3C63B3">/TCP</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">13</span><span style="--0:#ECC48D;--1:#3C63B3">h</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                      </span><span style="--0:#ECC48D;--1:#3C63B3">READY</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">statefulset.apps/eureka</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#ECC48D;--1:#3C63B3">/3</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">13</span><span style="--0:#ECC48D;--1:#3C63B3">h</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.查看eureka的ingress状态</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get ingress -n simple-ms</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">CLASS</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">HOSTS</span><span style="--0:#D6DEEB;--1:#403F53">                </span><span style="--0:#ECC48D;--1:#3C63B3">ADDRESS</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#ECC48D;--1:#3C63B3">PORTS</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">eureka</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">eureka.jiangxl.com</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">10.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.107</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">80</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">13</span><span style="--0:#ECC48D;--1:#3C63B3">h</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.部署eureka服务[root@binary-k8s-master1 k8s]\# kubectl apply -f eureka-deploy.yaml2.查看部署的资源状态[root@binary-k8s-master1 k8s]\# kubectl get all -n simple-msNAME           READY   STATUS    RESTARTS   AGEpod/eureka-0   1/1     Running   1          12hpod/eureka-1   1/1     Running   0          12hpod/eureka-2   1/1     Running   0          12hNAME             TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)    AGEservice/eureka   ClusterIP   None         <none>        8080/TCP   13hNAME                      READY   AGEstatefulset.apps/eureka   3/3     13h3.查看eureka的ingress状态[root@binary-k8s-master1 k8s]\# kubectl get ingress -n simple-msNAME     CLASS    HOSTS                ADDRESS      PORTS   AGEeureka   <none>   eureka.jiangxl.com   10.0.0.107   80      13h"><div></div></button></div></figure></div>
<p>首先在本地hosts文件中绑定eureka域名解析，然后在浏览器中输入eureka.jiangxl.com访问eureka服务。</p>
<p><img src="https://cdn.agou-ops.cn/others/dac8c49c10904c4591acb933a094c0d7.png" alt="在这里插入图片描述"></p>
<h3 id="43配置各个微服务程序连接eureka集群的地址">4.3.配置各个微服务程序连接Eureka集群的地址</h3>
<p>在程序的配置文件中填写eureka集群所有节点的服务发现地址</p>
<p><strong>1.gateway-service配置文件</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># vim gateway-service/src/main/resources/application-prod.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">······</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">eureka</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">instance</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">prefer-ip-address</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#FF5874;--1:#A54A4A">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">client</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">register-with-eureka</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#FF5874;--1:#A54A4A">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">fetch-registry</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#FF5874;--1:#A54A4A">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">service-url</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">defaultZone</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">http://eureka-0.eureka.simple-ms:8080/eureka,http://eureka-1.eureka.simple-ms:8080/eureka,http://eureka-2.eureka.simple-ms:8080/eureka</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="# vim gateway-service/src/main/resources/application-prod.yml······eureka:  instance:    prefer-ip-address: true  client:    register-with-eureka: true    fetch-registry: true    service-url:      defaultZone: http://eureka-0.eureka.simple-ms:8080/eureka,http://eureka-1.eureka.simple-ms:8080/eureka,http://eureka-2.eureka.simple-ms:8080/eureka"><div></div></button></div></figure></div>
<p><strong>2.order-service配置文件</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># vim order-service/order-service-biz/src/main/resources/application-prod.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">spring</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">datasource</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">url</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">jdbc:mysql://192.168.20.11:3306/tb_order?characterEncoding=utf-8</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">username</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">root</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">password</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">123456</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">driver-class-name</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">com.mysql.jdbc.Driver</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">eureka</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">instance</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">prefer-ip-address</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#FF5874;--1:#A54A4A">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">client</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">register-with-eureka</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#FF5874;--1:#A54A4A">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">fetch-registry</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#FF5874;--1:#A54A4A">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">service-url</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">defaultZone</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">http://eureka-0.eureka.simple-ms:8080/eureka,http://eureka-1.eureka.simple-ms:8080/eureka,http://eureka-2.eureka.simple-ms:8080/eureka</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="# vim order-service/order-service-biz/src/main/resources/application-prod.ymlspring:  datasource:    url: jdbc:mysql://192.168.20.11:3306/tb_order?characterEncoding=utf-8    username: root    password: 123456    driver-class-name: com.mysql.jdbc.Drivereureka:  instance:    prefer-ip-address: true  client:    register-with-eureka: true    fetch-registry: true    service-url:      defaultZone: http://eureka-0.eureka.simple-ms:8080/eureka,http://eureka-1.eureka.simple-ms:8080/eureka,http://eureka-2.eureka.simple-ms:8080/eureka"><div></div></button></div></figure></div>
<p><strong>3.product-service配置文件</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># vim product-service/product-service-biz/src/main/resources/application-prod.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">spring</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">datasource</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">url</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">jdbc:mysql://192.168.20.11:3306/tb_product?characterEncoding=utf-8</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">username</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">root</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">password</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">123456</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">driver-class-name</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">com.mysql.jdbc.Driver</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">eureka</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">instance</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">prefer-ip-address</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#FF5874;--1:#A54A4A">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">client</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">register-with-eureka</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#FF5874;--1:#A54A4A">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">fetch-registry</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#FF5874;--1:#A54A4A">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">service-url</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">defaultZone</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">http://eureka-0.eureka.simple-ms:8080/eureka,http://eureka-1.eureka.simple-ms:8080/eureka,http://eureka-2.eureka.simple-ms:8080/eureka</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="# vim product-service/product-service-biz/src/main/resources/application-prod.ymlspring:  datasource:    url: jdbc:mysql://192.168.20.11:3306/tb_product?characterEncoding=utf-8    username: root    password: 123456    driver-class-name: com.mysql.jdbc.Drivereureka:  instance:    prefer-ip-address: true  client:    register-with-eureka: true    fetch-registry: true    service-url:      defaultZone: http://eureka-0.eureka.simple-ms:8080/eureka,http://eureka-1.eureka.simple-ms:8080/eureka,http://eureka-2.eureka.simple-ms:8080/eureka"><div></div></button></div></figure></div>
<p><strong>4.stock-service配置文件</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># vim stock-service/stock-service-biz/src/main/resources/application-prod.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">spring</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">datasource</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">url</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">jdbc:mysql://192.168.20.11:3306/tb_stock?characterEncoding=utf-8</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">username</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">root</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">password</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">123456</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">driver-class-name</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">com.mysql.jdbc.Driver</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">eureka</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">instance</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">prefer-ip-address</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#FF5874;--1:#A54A4A">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">client</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">register-with-eureka</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#FF5874;--1:#A54A4A">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">fetch-registry</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#FF5874;--1:#A54A4A">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">service-url</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">defaultZone</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">http://eureka-0.eureka.simple-ms:8080/eureka,http://eureka-1.eureka.simple-ms:8080/eureka,http://eureka-2.eureka.simple-ms:8080/eureka</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="# vim stock-service/stock-service-biz/src/main/resources/application-prod.ymlspring:  datasource:    url: jdbc:mysql://192.168.20.11:3306/tb_stock?characterEncoding=utf-8    username: root    password: 123456    driver-class-name: com.mysql.jdbc.Drivereureka:  instance:    prefer-ip-address: true  client:    register-with-eureka: true    fetch-registry: true    service-url:      defaultZone: http://eureka-0.eureka.simple-ms:8080/eureka,http://eureka-1.eureka.simple-ms:8080/eureka,http://eureka-2.eureka.simple-ms:8080/eureka"><div></div></button></div></figure></div>
<p><strong>5.portal-service配置文件</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># vim portal-service/src/main/resources/application-prod.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">eureka</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">instance</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">prefer-ip-address</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#FF5874;--1:#A54A4A">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">client</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">service-url</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">defaultZone</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">http://eureka-0.eureka.simple-ms:8080/eureka,http://eureka-1.eureka.simple-ms:8080/eureka,http://eureka-2.eureka.simple-ms:8080/eureka</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">register-with-eureka</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#FF5874;--1:#A54A4A">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">fetch-registry</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#FF5874;--1:#A54A4A">true</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">······</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="# vim portal-service/src/main/resources/application-prod.ymleureka:  instance:    prefer-ip-address: true  client:    service-url:      defaultZone: http://eureka-0.eureka.simple-ms:8080/eureka,http://eureka-1.eureka.simple-ms:8080/eureka,http://eureka-2.eureka.simple-ms:8080/eureka    register-with-eureka: true    fetch-registry: true······"><div></div></button></div></figure></div>
<h3 id="44将各个程序代码编译成可部署的程序">4.4.将各个程序代码编译成可部署的程序</h3>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 simple-microservice-dev1]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> mvn clean package -D maven.test.skip=true -P prod</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 simple-microservice-dev1]\# mvn clean package -D maven.test.skip=true -P prod"><div></div></button></div></figure></div>
<h3 id="43中部署gateway网关服务">4.3.中部署Gateway网关服务</h3>
<h4 id="431将gateway程序打包成docker镜像">4.3.1.将Gateway程序打包成docker镜像</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 gateway-service]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> docker build -t 192.168.20.11/simple-microservice/gateway-service:v1 </span><span style="--0:#C5E478;--1:#3C63B3">.</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 gateway-service]\# docker build -t 192.168.20.11/simple-microservice/gateway-service:v1 ."><div></div></button></div></figure></div>
<h4 id="432在k8s集群中部署gateway网关服务">4.3.2.在K8S集群中部署Gateway网关服务</h4>
<p>所有程序的资源YAML文件都存放在/root/springcloud/simple-microservice-dev1/k8s路径。</p>
<p>微服务程序的话就不需要有状态应用部署了，直接采用deployment无状态应用部署的控制器，字段配置和eureka服务的statefulset配置参数几乎是一样的，微服务的各个程序也都采用有deployment控制器去部署，每个程序的yaml文件也只有名字、使用的镜像不同，其余所有参数均一致。</p>
<p>gateway是网关服务，需要配置一个ingress和service资源，将其发布在集群之外。</p>
<p>字段配置和statefulset的一致，不再做注释信息</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># vim gateway-deploy.yaml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#ingress资源YAML</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">apiVersion</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">extensions/v1beta1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">kind</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">Ingress</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">metadata</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">name</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">gateway</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">namespace</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">simple-ms</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">spec</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">rules</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">- </span><span style="--0:#7FDBCA;--1:#111111">host</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">gateway.jiangxl.com</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">http</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">paths</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">- </span><span style="--0:#7FDBCA;--1:#111111">path</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">/</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">backend</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">serviceName</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">gateway</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">servicePort</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#service资源YAML</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">apiVersion</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">kind</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">Service</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">metadata</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">name</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">gateway</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">namespace</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">simple-ms</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">spec</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">ports</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">- </span><span style="--0:#7FDBCA;--1:#111111">port</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">name</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">gateway</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">selector</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">project</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">simple</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">app</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">gateway</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#deployment资源YAML</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">apiVersion</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">apps/v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">kind</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">Deployment</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">metadata</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">name</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">gateway</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">namespace</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">simple-ms</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">spec</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">replicas</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#809191;--1:#616671">#副本数设置1个，后续再加</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">selector</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">matchLabels</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">project</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">simple</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">app</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">gateway</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">template</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">metadata</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">labels</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">project</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">simple</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">app</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">gateway</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">spec</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">imagePullSecrets</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">- </span><span style="--0:#7FDBCA;--1:#111111">name</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">registry-pull-secret</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">containers</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">- </span><span style="--0:#7FDBCA;--1:#111111">name</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">gateway</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">image</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">192.168.20.11/simple-microservice/gateway-service:v1</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">imagePullPolicy</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">Always</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">ports</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">- </span><span style="--0:#7FDBCA;--1:#111111">protocol</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">TCP</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">containerPort</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">resources</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">requests</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">cpu</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">0.5</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">memory</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">256Mi</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">limits</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">cpu</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">1</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">memory</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">1Gi</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">readinessProbe</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">tcpSocket</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">port</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">initialDelaySeconds</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">60</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">periodSeconds</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">10</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">livenessProbe</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">tcpSocket</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">port</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">initialDelaySeconds</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">60</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">periodSeconds</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">10</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="# vim gateway-deploy.yaml---#ingress资源YAMLapiVersion: extensions/v1beta1kind: Ingressmetadata:  name: gateway  namespace: simple-msspec:  rules:    - host: gateway.jiangxl.com      http:        paths:        - path: /          backend:            serviceName: gateway            servicePort: 8080---#service资源YAMLapiVersion: v1kind: Servicemetadata:  name: gateway  namespace: simple-msspec:  ports:  - port: 8080    name: gateway  selector:    project: simple    app: gateway---#deployment资源YAMLapiVersion: apps/v1kind: Deploymentmetadata:  name: gateway  namespace: simple-msspec:  replicas: 1         #副本数设置1个，后续再加  selector:    matchLabels:      project: simple      app: gateway  template:    metadata:      labels:        project: simple        app: gateway    spec:      imagePullSecrets:      - name: registry-pull-secret      containers:      - name: gateway        image: 192.168.20.11/simple-microservice/gateway-service:v1        imagePullPolicy: Always        ports:          - protocol: TCP            containerPort: 8080        resources:          requests:            cpu: 0.5            memory: 256Mi          limits:            cpu: 1            memory: 1Gi        readinessProbe:          tcpSocket:            port: 8080          initialDelaySeconds: 60          periodSeconds: 10        livenessProbe:          tcpSocket:            port: 8080          initialDelaySeconds: 60          periodSeconds: 10"><div></div></button></div></figure></div>
<h4 id="433在k8s集群中部署gateway网关服务">4.3.3.在K8S集群中部署Gateway网关服务</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.部署网关服务</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl apply -f gateway-deploy.yaml</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.查看gateway</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">pod资源的状态</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get pod -n simple-ms</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                       </span><span style="--0:#ECC48D;--1:#3C63B3">READY</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">STATUS</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">RESTARTS</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">eureka-0</span><span style="--0:#D6DEEB;--1:#403F53">                   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">d12h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">eureka-1</span><span style="--0:#D6DEEB;--1:#403F53">                   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">d12h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">eureka-2</span><span style="--0:#D6DEEB;--1:#403F53">                   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">d12h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">gateway-7c687f6c45-mcwpf</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">m2s</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.查看deployment和svc的资源状态</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get deploy,svc -n simple-ms</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                      </span><span style="--0:#ECC48D;--1:#3C63B3">READY</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">UP-TO-DATE</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">AVAILABLE</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">deployment.apps/gateway</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">            </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">           </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">h</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">              </span><span style="--0:#ECC48D;--1:#3C63B3">TYPE</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#ECC48D;--1:#3C63B3">CLUSTER-IP</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">EXTERNAL-IP</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">PORT</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#82AAFF;--1:#3C63B3">S</span><span style="--0:#D6DEEB;--1:#403F53">)    </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">service/eureka</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">ClusterIP</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">None</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">8080</span><span style="--0:#ECC48D;--1:#3C63B3">/TCP</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">d13h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">service/gateway</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">ClusterIP</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">10.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.188</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">8080</span><span style="--0:#ECC48D;--1:#3C63B3">/TCP</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">h</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">4.查看gateway</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ingress资源状态</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get ingress -n simple-ms</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#ECC48D;--1:#3C63B3">CLASS</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">HOSTS</span><span style="--0:#D6DEEB;--1:#403F53">                 </span><span style="--0:#ECC48D;--1:#3C63B3">ADDRESS</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#ECC48D;--1:#3C63B3">PORTS</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">eureka</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">eureka.jiangxl.com</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#F78C6C;--1:#AA0982">10.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.107</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">80</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">d13h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">gateway</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">gateway.jiangxl.com</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">10.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.107</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">80</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">h</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.部署网关服务[root@binary-k8s-master1 k8s]\# kubectl apply -f gateway-deploy.yaml2.查看gateway pod资源的状态[root@binary-k8s-master1 k8s]\# kubectl get pod -n simple-msNAME                       READY   STATUS    RESTARTS   AGEeureka-0                   1/1     Running   1          2d12heureka-1                   1/1     Running   0          2d12heureka-2                   1/1     Running   0          2d12hgateway-7c687f6c45-mcwpf   1/1     Running   0          2m2s3.查看deployment和svc的资源状态[root@binary-k8s-master1 k8s]\# kubectl get deploy,svc -n simple-msNAME                      READY   UP-TO-DATE   AVAILABLE   AGEdeployment.apps/gateway   1/1     1            1           17hNAME              TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)    AGEservice/eureka    ClusterIP   None         <none>        8080/TCP   2d13hservice/gateway   ClusterIP   10.0.0.188   <none>        8080/TCP   17h4.查看gateway ingress资源状态[root@binary-k8s-master1 k8s]\# kubectl get ingress -n simple-msNAME      CLASS    HOSTS                 ADDRESS      PORTS   AGEeureka    <none>   eureka.jiangxl.com    10.0.0.107   80      2d13hgateway   <none>   gateway.jiangxl.com   10.0.0.107   80      17h"><div></div></button></div></figure></div>
<h3 id="44编写快速部署微服务到k8s集群的脚本">4.4.编写快速部署微服务到K8S集群的脚本</h3>
<p>由于微服务程序众多，并且每个程序在K8S集群部署的流程也基本一样，因此我们编写一个部署脚本，只要准备好程序的jar包以及资源YAML文件就可以将其一键部署到K8S集群，当前也可以通过Helm来实现。</p>
<p><strong>1.脚本内容</strong></p>
<p>实现逻辑：</p>
<p>1.将harbor仓库的地址、所有微服务的名称、k8s yaml文件的路径、微服务代码所在的路径都定义成环境变量。</p>
<p>2.如果只想部署其中一个微服务的话，通过位置传参的方式来实现，也就是再定义一个微服务名称的变量，变量值为KaTeX parse error: Expected ’}’, got ‘EOF’ at end of input: {1:-{service_list}}，将要部署的微服务名称通过位置传参的方式，将值传入到service_list变量名里，覆盖原service_list变量值，实现单个微服务的部署，如果没有使用位置参数，那么默认部署全部的微服务。</p>
<p>3.进入微服务代码所在的路径。然后通过for循环的方式，遍历service_list变量中的各个微服务，然后本次循环的微服务代码路径，判断是否有包含biz的目录，如果有biz目录则切入到biz目录，然后通过变量的形式定义镜像名称，构建镜像、推送至镜像仓库。</p>
<p>4.将最新打包好的docker进在yaml文件中通过sed命令替换，最后在k8s集群中部署这个微服务。</p>
<p><code dir="auto">${1:-${service_list}}</code>：这个的意思就是如果<code dir="auto">$1</code>位置参数没有传入值，那么service_list变量的值就是<code dir="auto">$service_list</code>变量的值，相当于一个判断。</p>
<p>本脚本可以自动化完成微服务到K8S集群的一个部署，包括程序的编译、打包成docker镜像、推荐镜像到Harbor仓库，最后将程序部署到K8S集群</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#!/bin/bash</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">registry_addr</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#ECC48D;--1:#3C63B3">.20.11</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">service_list</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">eureka-service gateway-service order-service product-service stock-service portal-service</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">service_list</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D7DBE0;--1:#403F53">${1</span><span style="--0:#7FDBCA;--1:#097174">:-</span><span style="--0:#D6DEEB;--1:#403F53">${</span><span style="--0:#C5E478;--1:#3C63B3">service_list</span><span style="--1:#403F53"><span style="--0:#D6DEEB">}</span><span style="--0:#D7DBE0">}</span></span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">current_dir</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/root/springcloud/simple-microservice-dev1/k8s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">service_dir</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--1:#3C63B3"><span style="--0:#ECC48D">$(</span><span style="--0:#82AAFF">dirname</span><span style="--0:#ECC48D"> </span><span style="--0:#C5E478">$current_dir</span><span style="--0:#ECC48D">)</span></span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">cd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">$service_dir</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#mvn clean package -Dmaven.test.skip=true</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">for</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">service</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">in</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">$service_list</span><span style="--0:#D6DEEB;--1:#403F53">; </span><span style="--0:#C792EA;--1:#8D46B4">do</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#C5E478;--1:#3C63B3">cd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">$service_dir</span><span style="--0:#ECC48D;--1:#3C63B3">/</span><span style="--0:#C5E478;--1:#3C63B3">$service</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#C5E478;--1:#3C63B3">biz_count</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--1:#3C63B3"><span style="--0:#ECC48D">`</span><span style="--0:#82AAFF">ls</span><span style="--0:#ECC48D"> </span></span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--1:#3C63B3"><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">grep</span><span style="--0:#ECC48D"> biz </span></span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--1:#3C63B3"><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">wc</span><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">-l</span><span style="--0:#ECC48D">`</span></span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#C792EA;--1:#8D46B4">if</span><span style="--0:#D6DEEB;--1:#403F53"> [ </span><span style="--0:#C5E478;--1:#3C63B3">$biz_count</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">-eq</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> ];</span><span style="--0:#C792EA;--1:#8D46B4">then</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#C5E478;--1:#3C63B3">cd</span><span style="--0:#D6DEEB;--1:#403F53"> ${</span><span style="--0:#C5E478;--1:#3C63B3">service</span><span style="--0:#D6DEEB;--1:#403F53">}</span><span style="--0:#ECC48D;--1:#3C63B3">-biz</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#C792EA;--1:#8D46B4">fi</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#C5E478;--1:#3C63B3">service_name</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--1:#3C63B3"><span style="--0:#ECC48D">`</span><span style="--0:#C5E478">echo</span><span style="--0:#ECC48D"> </span><span style="--0:#C5E478">$service</span><span style="--0:#ECC48D"> </span></span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--1:#3C63B3"><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">awk</span><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">-F-</span><span style="--0:#ECC48D"> </span></span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">{print $1}</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#3C63B3">`</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#C5E478;--1:#3C63B3">image_name</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">${</span><span style="--0:#C5E478;--1:#3C63B3">registry_addr</span><span style="--0:#D6DEEB;--1:#403F53">}</span><span style="--0:#ECC48D;--1:#3C63B3">/simple-microservice/</span><span style="--0:#D6DEEB;--1:#403F53">${</span><span style="--0:#C5E478;--1:#3C63B3">service</span><span style="--0:#D6DEEB;--1:#403F53">}</span><span style="--0:#ECC48D;--1:#3C63B3">:v1</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#C5E478;--1:#3C63B3">yaml_name</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">${</span><span style="--0:#C5E478;--1:#3C63B3">service_name</span><span style="--0:#D6DEEB;--1:#403F53">}</span><span style="--0:#ECC48D;--1:#3C63B3">-deploy.yaml</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#82AAFF;--1:#3C63B3">docker</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">build</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-t</span><span style="--0:#D6DEEB;--1:#403F53"> ${</span><span style="--0:#C5E478;--1:#3C63B3">image_name</span><span style="--0:#D6DEEB;--1:#403F53">} </span><span style="--0:#ECC48D;--1:#3C63B3">.</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#82AAFF;--1:#3C63B3">docker</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">push</span><span style="--0:#D6DEEB;--1:#403F53"> ${</span><span style="--0:#C5E478;--1:#3C63B3">image_name</span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#82AAFF;--1:#3C63B3">sed</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-i</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-r</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">s#(image: )(.*)#\1</span><span style="--0:#C5E478;--1:#3C63B3">$image_name</span><span style="--0:#ECC48D;--1:#9B504E">#</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> ${</span><span style="--0:#C5E478;--1:#3C63B3">current_dir</span><span style="--0:#D6DEEB;--1:#403F53">}</span><span style="--0:#ECC48D;--1:#3C63B3">/</span><span style="--0:#D6DEEB;--1:#403F53">${</span><span style="--0:#C5E478;--1:#3C63B3">yaml_name</span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">apply</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-f</span><span style="--0:#D6DEEB;--1:#403F53"> ${</span><span style="--0:#C5E478;--1:#3C63B3">current_dir</span><span style="--0:#D6DEEB;--1:#403F53">}</span><span style="--0:#ECC48D;--1:#3C63B3">/</span><span style="--0:#D6DEEB;--1:#403F53">${</span><span style="--0:#C5E478;--1:#3C63B3">yaml_name</span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">done</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="#!/bin/bashregistry_addr=192.168.20.11service_list=&#x22;eureka-service gateway-service order-service product-service stock-service portal-service&#x22;service_list=${1:-${service_list}}current_dir=/root/springcloud/simple-microservice-dev1/k8sservice_dir=$(dirname $current_dir)cd $service_dir#mvn clean package -Dmaven.test.skip=truefor service in $service_list; do   cd $service_dir/$service   biz_count=&#x60;ls | grep biz | wc -l&#x60;   if [ $biz_count -eq 1 ];then      cd ${service}-biz   fi   service_name=&#x60;echo $service | awk -F- &#x27;{print $1}&#x27;&#x60;   image_name=${registry_addr}/simple-microservice/${service}:v1   yaml_name=${service_name}-deploy.yaml   docker build -t ${image_name} .   docker push ${image_name}   sed -i -r &#x22;s#(image: )(.*)#\1$image_name#&#x22; ${current_dir}/${yaml_name}   kubectl apply -f ${current_dir}/${yaml_name}done"><div></div></button></div></figure></div>
<p><strong>2.脚本使用方式</strong></p>
<p>执行本脚本前提是必须先将程序部署的YAML文件准备好，放在/root/springcloud/simple-microservice-dev1/k8s路径</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">脚本的用法：</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">sh</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">deploy_k8s.sh</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">微服务名称</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="脚本的用法：sh deploy_k8s.sh 微服务名称"><div></div></button></div></figure></div>
<h3 id="45使用脚本部署order订单服务">4.5.使用脚本部署Order订单服务</h3>
<h4 id="451编写资源部署yaml文件">4.5.1.编写资源部署YAML文件</h4>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># vim order-deploy.yaml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">apiVersion</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">apps/v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">kind</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">Deployment</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">metadata</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">name</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">order</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">namespace</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">simple-ms</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">spec</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">replicas</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">1</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">selector</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">matchLabels</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">project</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">simple</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">app</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">order</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">template</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">metadata</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">labels</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">project</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">simple</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">app</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">order</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">spec</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">imagePullSecrets</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">- </span><span style="--0:#7FDBCA;--1:#111111">name</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">registry-pull-secret</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">containers</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">- </span><span style="--0:#7FDBCA;--1:#111111">name</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">order</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">image</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">192.168.20.11/simple-microservice/order-service:v1</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">imagePullPolicy</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">Always</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">ports</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">- </span><span style="--0:#7FDBCA;--1:#111111">protocol</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">TCP</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">containerPort</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">resources</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">requests</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">cpu</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">0.5</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">memory</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">256Mi</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">limits</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">cpu</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">1</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">memory</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">1Gi</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">readinessProbe</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">tcpSocket</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">port</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">initialDelaySeconds</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">60</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">periodSeconds</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">10</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">livenessProbe</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">tcpSocket</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">port</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">initialDelaySeconds</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">60</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">periodSeconds</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">10</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="# vim order-deploy.yamlapiVersion: apps/v1kind: Deploymentmetadata:  name: order  namespace: simple-msspec:  replicas: 1  selector:    matchLabels:      project: simple      app: order  template:    metadata:      labels:        project: simple        app: order    spec:      imagePullSecrets:      - name: registry-pull-secret      containers:      - name: order        image: 192.168.20.11/simple-microservice/order-service:v1        imagePullPolicy: Always        ports:          - protocol: TCP            containerPort: 8080        resources:          requests:            cpu: 0.5            memory: 256Mi          limits:            cpu: 1            memory: 1Gi        readinessProbe:          tcpSocket:            port: 8080          initialDelaySeconds: 60          periodSeconds: 10        livenessProbe:          tcpSocket:            port: 8080          initialDelaySeconds: 60          periodSeconds: 10"><div></div></button></div></figure></div>
<h4 id="452在k8s集群中部署order订单服务">4.5.2在K8S集群中部署Order订单服务</h4>
<p><strong>1.使用脚本将Order服务部署到K8S集群</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> sh deploy_k8s.sh order-service</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">执行完脚本，order程序的docker镜像已经制作好并且推送到了harbor仓库，已经使用sed命令将镜像的名称在yaml中替换成了最新的镜像，部署到了K8S集群</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 k8s]\# sh deploy_k8s.sh order-service执行完脚本，order程序的docker镜像已经制作好并且推送到了harbor仓库，已经使用sed命令将镜像的名称在yaml中替换成了最新的镜像，部署到了K8S集群"><div></div></button></div></figure></div>
<p><img src="https://cdn.agou-ops.cn/others/be81d4ca75f14ea1afd933b7e4f34ea5.png" alt="在这里插入图片描述"></p>
<p><strong>2.查看程序资源的状态</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.查看pod的状态</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get all -n simple-ms</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                          </span><span style="--0:#ECC48D;--1:#3C63B3">READY</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">STATUS</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">RESTARTS</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">pod/eureka-0</span><span style="--0:#D6DEEB;--1:#403F53">                  </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">d15h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">pod/eureka-1</span><span style="--0:#D6DEEB;--1:#403F53">                  </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">d15h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">pod/eureka-2</span><span style="--0:#D6DEEB;--1:#403F53">                  </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">d15h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">pod/gateway-8665d5d56-tx2m8</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">39</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">pod/order-6694f4c474-cp5d6</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">35</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.查看deployment资源的状态</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get deploy -n simple-ms</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#ECC48D;--1:#3C63B3">READY</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">UP-TO-DATE</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">AVAILABLE</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">gateway</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">            </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">           </span><span style="--0:#F78C6C;--1:#AA0982">21</span><span style="--0:#ECC48D;--1:#3C63B3">h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">order</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">            </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">           </span><span style="--0:#F78C6C;--1:#AA0982">36</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.查看pod的状态[root@binary-k8s-master1 k8s]\# kubectl get all -n simple-msNAME                          READY   STATUS    RESTARTS   AGEpod/eureka-0                  1/1     Running   1          2d15hpod/eureka-1                  1/1     Running   0          2d15hpod/eureka-2                  1/1     Running   0          2d15hpod/gateway-8665d5d56-tx2m8   1/1     Running   0          39mpod/order-6694f4c474-cp5d6    1/1     Running   0          35m2.查看deployment资源的状态[root@binary-k8s-master1 k8s]\# kubectl get deploy -n simple-msNAME      READY   UP-TO-DATE   AVAILABLE   AGEgateway   1/1     1            1           21horder     1/1     1            1           36m"><div></div></button></div></figure></div>
<h3 id="46使用脚本部署product商品服务">4.6.使用脚本部署Product商品服务</h3>
<h4 id="461编写资源部署yaml文件">4.6.1.编写资源部署YAML文件</h4>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># vim product-deploy.yaml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">apiVersion</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">apps/v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">kind</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">Deployment</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">metadata</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">name</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">product</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">namespace</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">simple-ms</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">spec</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">replicas</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">1</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">selector</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">matchLabels</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">project</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">simple</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">app</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">product</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">template</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">metadata</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">labels</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">project</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">simple</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">app</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">product</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">spec</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">imagePullSecrets</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">- </span><span style="--0:#7FDBCA;--1:#111111">name</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">registry-pull-secret</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">containers</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">- </span><span style="--0:#7FDBCA;--1:#111111">name</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">product</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">image</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">192.168.20.11/simple-microservice/product-service:v1</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">imagePullPolicy</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">Always</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">ports</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">- </span><span style="--0:#7FDBCA;--1:#111111">protocol</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">TCP</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">containerPort</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">resources</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">requests</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">cpu</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">0.5</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">memory</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">256Mi</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">limits</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">cpu</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">1</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">memory</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">1Gi</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">readinessProbe</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">tcpSocket</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">port</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">initialDelaySeconds</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">60</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">periodSeconds</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">10</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">livenessProbe</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">tcpSocket</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">port</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">initialDelaySeconds</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">60</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">periodSeconds</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">10</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="# vim product-deploy.yamlapiVersion: apps/v1kind: Deploymentmetadata:  name: product  namespace: simple-msspec:  replicas: 1  selector:    matchLabels:      project: simple      app: product  template:    metadata:      labels:        project: simple        app: product    spec:      imagePullSecrets:      - name: registry-pull-secret      containers:      - name: product        image: 192.168.20.11/simple-microservice/product-service:v1        imagePullPolicy: Always        ports:          - protocol: TCP            containerPort: 8080        resources:          requests:            cpu: 0.5            memory: 256Mi          limits:            cpu: 1            memory: 1Gi        readinessProbe:          tcpSocket:            port: 8080          initialDelaySeconds: 60          periodSeconds: 10        livenessProbe:          tcpSocket:            port: 8080          initialDelaySeconds: 60          periodSeconds: 10"><div></div></button></div></figure></div>
<h4 id="462在k8s集群中熟不熟product商品服务">4.6.2.在K8S集群中熟不熟Product商品服务</h4>
<p><strong>1.使用脚本在K8S集群中部署product服务</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> sh deploy_k8s.sh product-service</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 k8s]\# sh deploy_k8s.sh product-service"><div></div></button></div></figure></div>
<p><img src="https://cdn.agou-ops.cn/others/72e772fd74a1497188734a6e1fd3d28e.png" alt="在这里插入图片描述"></p>
<p><strong>2.查看程序资源的状态</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.查看pod的状态</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get pod -n simple-ms</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                       </span><span style="--0:#ECC48D;--1:#3C63B3">READY</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">STATUS</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">RESTARTS</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">eureka-1</span><span style="--0:#D6DEEB;--1:#403F53">                   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">d16h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">eureka-2</span><span style="--0:#D6DEEB;--1:#403F53">                   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">d16h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">gateway-8665d5d56-tx2m8</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">74</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">order-6694f4c474-cp5d6</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">4</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">69</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">product-77c8bb6847-vbxnr</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">21</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.查看deployment资源的状态</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get deploy -n simple-ms</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#ECC48D;--1:#3C63B3">READY</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">UP-TO-DATE</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">AVAILABLE</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">gateway</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">            </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">           </span><span style="--0:#F78C6C;--1:#AA0982">21</span><span style="--0:#ECC48D;--1:#3C63B3">h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">order</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">            </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">           </span><span style="--0:#F78C6C;--1:#AA0982">72</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">product</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">            </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">           </span><span style="--0:#F78C6C;--1:#AA0982">24</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.查看pod的状态[root@binary-k8s-master1 k8s]\# kubectl get pod -n simple-msNAME                       READY   STATUS    RESTARTS   AGEeureka-1                   1/1     Running   3          2d16heureka-2                   1/1     Running   2          2d16hgateway-8665d5d56-tx2m8    1/1     Running   2          74morder-6694f4c474-cp5d6     1/1     Running   4          69mproduct-77c8bb6847-vbxnr   1/1     Running   2          21m2.查看deployment资源的状态[root@binary-k8s-master1 k8s]\# kubectl get deploy -n simple-msNAME      READY   UP-TO-DATE   AVAILABLE   AGEgateway   1/1     1            1           21horder     1/1     1            1           72mproduct   1/1     1            1           24m"><div></div></button></div></figure></div>
<h3 id="47使用脚本部署stock库存服务">4.7.使用脚本部署Stock库存服务</h3>
<h4 id="471编写资源部署yaml文件">4.7.1.编写资源部署YAML文件</h4>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># vim product-deploy.yaml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">apiVersion</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">apps/v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">kind</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">Deployment</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">metadata</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">name</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">product</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">namespace</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">simple-ms</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">spec</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">replicas</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">1</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">selector</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">matchLabels</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">project</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">simple</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">app</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">product</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">template</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">metadata</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">labels</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">project</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">simple</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">app</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">product</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">spec</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">imagePullSecrets</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">- </span><span style="--0:#7FDBCA;--1:#111111">name</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">registry-pull-secret</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">containers</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">- </span><span style="--0:#7FDBCA;--1:#111111">name</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">product</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">image</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">192.168.20.11/simple-microservice/product-service:v1</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">imagePullPolicy</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">Always</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">ports</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">- </span><span style="--0:#7FDBCA;--1:#111111">protocol</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">TCP</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">containerPort</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">resources</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">requests</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">cpu</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">0.5</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">memory</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">256Mi</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">limits</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">cpu</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">1</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">memory</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">1Gi</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">readinessProbe</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">tcpSocket</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">port</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">initialDelaySeconds</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">60</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">periodSeconds</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">10</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">livenessProbe</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">tcpSocket</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">port</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">initialDelaySeconds</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">60</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">periodSeconds</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">10</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="# vim product-deploy.yamlapiVersion: apps/v1kind: Deploymentmetadata:  name: product  namespace: simple-msspec:  replicas: 1  selector:    matchLabels:      project: simple      app: product  template:    metadata:      labels:        project: simple        app: product    spec:      imagePullSecrets:      - name: registry-pull-secret      containers:      - name: product        image: 192.168.20.11/simple-microservice/product-service:v1        imagePullPolicy: Always        ports:          - protocol: TCP            containerPort: 8080        resources:          requests:            cpu: 0.5            memory: 256Mi          limits:            cpu: 1            memory: 1Gi        readinessProbe:          tcpSocket:            port: 8080          initialDelaySeconds: 60          periodSeconds: 10        livenessProbe:          tcpSocket:            port: 8080          initialDelaySeconds: 60          periodSeconds: 10"><div></div></button></div></figure></div>
<h4 id="472在k8s集群中部署stock库存服务">4.7.2.在K8S集群中部署Stock库存服务</h4>
<p><strong>1.使用脚本在K8S集群中部署stock服务</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> sh deploy_k8s.sh stock-service</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 k8s]\# sh deploy_k8s.sh stock-service"><div></div></button></div></figure></div>
<p><img src="https://cdn.agou-ops.cn/others/34720b14a59e4d8e97e5d887beff8a9d.png" alt="在这里插入图片描述"></p>
<p><strong>2.查看程序资源的状态</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.查看pod的状态</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get pod -n simple-ms</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                       </span><span style="--0:#ECC48D;--1:#3C63B3">READY</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">STATUS</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">RESTARTS</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">eureka-0</span><span style="--0:#D6DEEB;--1:#403F53">                   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">5</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">d16h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">eureka-1</span><span style="--0:#D6DEEB;--1:#403F53">                   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">d16h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">eureka-2</span><span style="--0:#D6DEEB;--1:#403F53">                   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">d16h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">gateway-8665d5d56-tx2m8</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">112</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">order-6694f4c474-cp5d6</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">4</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">107</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">product-77c8bb6847-vbxnr</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">59</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">stock-6cf98bb445-mxf7b</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">30</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.查看deployment资源的状态</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get deploy -n simple-ms</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#ECC48D;--1:#3C63B3">READY</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">UP-TO-DATE</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">AVAILABLE</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">gateway</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">            </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">           </span><span style="--0:#F78C6C;--1:#AA0982">22</span><span style="--0:#ECC48D;--1:#3C63B3">h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">order</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">            </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">           </span><span style="--0:#F78C6C;--1:#AA0982">108</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">product</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">            </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">           </span><span style="--0:#F78C6C;--1:#AA0982">60</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">stock</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">/2</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#D6DEEB;--1:#403F53">            </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#D6DEEB;--1:#403F53">           </span><span style="--0:#F78C6C;--1:#AA0982">31</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.查看pod的状态[root@binary-k8s-master1 ~]\# kubectl get pod -n simple-msNAME                       READY   STATUS    RESTARTS   AGEeureka-0                   1/1     Running   5          2d16heureka-1                   1/1     Running   3          2d16heureka-2                   1/1     Running   2          2d16hgateway-8665d5d56-tx2m8    1/1     Running   2          112morder-6694f4c474-cp5d6     1/1     Running   4          107mproduct-77c8bb6847-vbxnr   1/1     Running   2          59mstock-6cf98bb445-mxf7b     1/1     Running   0          30m2.查看deployment资源的状态[root@binary-k8s-master1 ~]\# kubectl get deploy -n simple-msNAME      READY   UP-TO-DATE   AVAILABLE   AGEgateway   1/1     1            1           22horder     1/1     1            1           108mproduct   1/1     1            1           60mstock     2/2     2            2           31m"><div></div></button></div></figure></div>
<h3 id="48使用脚本部署portal前端首页">4.8.使用脚本部署Portal前端首页</h3>
<h4 id="481编写资源部署yaml文件">4.8.1.编写资源部署YAML文件</h4>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># vim portal-deploy.yaml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">apiVersion</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">extensions/v1beta1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">kind</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">Ingress</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">metadata</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">name</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">portal</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">namespace</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">simple-ms</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">spec</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">rules</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">- </span><span style="--0:#7FDBCA;--1:#111111">host</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">portal.jiangxl.com</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">http</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">paths</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">- </span><span style="--0:#7FDBCA;--1:#111111">path</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">/</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">backend</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">serviceName</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">portal</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">servicePort</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">apiVersion</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">kind</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">Service</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">metadata</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">name</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">portal</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">namespace</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">simple-ms</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">spec</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">ports</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">- </span><span style="--0:#7FDBCA;--1:#111111">port</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">name</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">portal</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">selector</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">project</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">simple</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">app</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">portal</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">apiVersion</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">apps/v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">kind</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">Deployment</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">metadata</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">name</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">portal</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">namespace</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">simple-ms</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#111111">spec</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">replicas</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">1</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">selector</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">matchLabels</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">project</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">simple</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">app</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">portal</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#111111">template</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">metadata</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">labels</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">project</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">simple</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">app</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">portal</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#111111">spec</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">imagePullSecrets</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">- </span><span style="--0:#7FDBCA;--1:#111111">name</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">registry-pull-secret</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#7FDBCA;--1:#111111">containers</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">- </span><span style="--0:#7FDBCA;--1:#111111">name</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">portal</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">image</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">192.168.20.11/simple-microservice/portal-service:v1</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">imagePullPolicy</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">Always</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">ports</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">- </span><span style="--0:#7FDBCA;--1:#111111">protocol</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">TCP</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">containerPort</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">resources</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">requests</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">cpu</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">0.5</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">memory</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">256Mi</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">limits</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">cpu</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">1</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">memory</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">1Gi</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">readinessProbe</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">tcpSocket</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">port</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">initialDelaySeconds</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">60</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">periodSeconds</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">10</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#111111">livenessProbe</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">tcpSocket</span><span style="--0:#D6DEEB;--1:#403F53">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#7FDBCA;--1:#111111">port</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">initialDelaySeconds</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">60</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#7FDBCA;--1:#111111">periodSeconds</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">10</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="# vim portal-deploy.yamlapiVersion: extensions/v1beta1kind: Ingressmetadata:  name: portal  namespace: simple-msspec:  rules:    - host: portal.jiangxl.com      http:        paths:        - path: /          backend:            serviceName: portal            servicePort: 8080---apiVersion: v1kind: Servicemetadata:  name: portal  namespace: simple-msspec:  ports:  - port: 8080    name: portal  selector:    project: simple    app: portal---apiVersion: apps/v1kind: Deploymentmetadata:  name: portal  namespace: simple-msspec:  replicas: 1  selector:    matchLabels:      project: simple      app: portal  template:    metadata:      labels:        project: simple        app: portal    spec:      imagePullSecrets:      - name: registry-pull-secret      containers:      - name: portal        image: 192.168.20.11/simple-microservice/portal-service:v1        imagePullPolicy: Always        ports:          - protocol: TCP            containerPort: 8080        resources:          requests:            cpu: 0.5            memory: 256Mi          limits:            cpu: 1            memory: 1Gi        readinessProbe:          tcpSocket:            port: 8080          initialDelaySeconds: 60          periodSeconds: 10        livenessProbe:          tcpSocket:            port: 8080          initialDelaySeconds: 60          periodSeconds: 10"><div></div></button></div></figure></div>
<h4 id="482在k8s集群中熟不熟portal存服务">4.8.2.在K8S集群中熟不熟Portal存服务</h4>
<p><strong>1.使用脚本在K8S集群中部署portal服务</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> sh deploy_k8s.sh portal-service</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 k8s]\# sh deploy_k8s.sh portal-service"><div></div></button></div></figure></div>
<p><img src="https://cdn.agou-ops.cn/others/c452fabffdb24a97b0ec5dbfc8dbe6b5.png" alt="在这里插入图片描述"></p>
<p><strong>2.查看程序资源的状态</strong></p>
<p>到此为止，所有的simple电商平台的微服务程序以及全部部署完毕。</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.查看所有微服务的程序</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get all -n simple-ms</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                           </span><span style="--0:#ECC48D;--1:#3C63B3">READY</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">STATUS</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">RESTARTS</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">pod/eureka-0</span><span style="--0:#D6DEEB;--1:#403F53">                   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">5</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">d16h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">pod/eureka-1</span><span style="--0:#D6DEEB;--1:#403F53">                   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">d16h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">pod/eureka-2</span><span style="--0:#D6DEEB;--1:#403F53">                   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">d16h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">pod/gateway-8665d5d56-tx2m8</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">117</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">pod/order-6694f4c474-cp5d6</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">4</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">112</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">pod/portal-d5d55b784-7kntp</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">m53s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">pod/product-77c8bb6847-vbxnr</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">64</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">pod/stock-6cf98bb445-mxf7b</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">35</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">              </span><span style="--0:#ECC48D;--1:#3C63B3">TYPE</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#ECC48D;--1:#3C63B3">CLUSTER-IP</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">EXTERNAL-IP</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">PORT</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#82AAFF;--1:#3C63B3">S</span><span style="--0:#D6DEEB;--1:#403F53">)    </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">service/eureka</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">ClusterIP</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">None</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">8080</span><span style="--0:#ECC48D;--1:#3C63B3">/TCP</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">d18h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">service/gateway</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">ClusterIP</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">10.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.188</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">8080</span><span style="--0:#ECC48D;--1:#3C63B3">/TCP</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">22</span><span style="--0:#ECC48D;--1:#3C63B3">h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">service/portal</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">ClusterIP</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">10.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.190</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">8080</span><span style="--0:#ECC48D;--1:#3C63B3">/TCP</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">m53s</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                      </span><span style="--0:#ECC48D;--1:#3C63B3">READY</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">UP-TO-DATE</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">AVAILABLE</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">deployment.apps/gateway</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">            </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">           </span><span style="--0:#F78C6C;--1:#AA0982">22</span><span style="--0:#ECC48D;--1:#3C63B3">h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">deployment.apps/order</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">            </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">           </span><span style="--0:#F78C6C;--1:#AA0982">112</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">deployment.apps/portal</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">            </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">           </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">m53s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">deployment.apps/product</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">            </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">           </span><span style="--0:#F78C6C;--1:#AA0982">65</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">deployment.apps/stock</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">            </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">           </span><span style="--0:#F78C6C;--1:#AA0982">35</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                                 </span><span style="--0:#ECC48D;--1:#3C63B3">DESIRED</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">CURRENT</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">READY</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">replicaset.apps/gateway-8665d5d56</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#F78C6C;--1:#AA0982">117</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">replicaset.apps/order-6694f4c474</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#F78C6C;--1:#AA0982">112</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">replicaset.apps/portal-d5d55b784</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">m53s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">replicaset.apps/product-77c8bb6847</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#F78C6C;--1:#AA0982">64</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">replicaset.apps/stock-6cf98bb445</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#F78C6C;--1:#AA0982">35</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                      </span><span style="--0:#ECC48D;--1:#3C63B3">READY</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">statefulset.apps/eureka</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#ECC48D;--1:#3C63B3">/3</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">d18h</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.查看所有微服务的ingress资源</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get ingress -n simple-ms</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#ECC48D;--1:#3C63B3">CLASS</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">HOSTS</span><span style="--0:#D6DEEB;--1:#403F53">                 </span><span style="--0:#ECC48D;--1:#3C63B3">ADDRESS</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#ECC48D;--1:#3C63B3">PORTS</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">eureka</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">eureka.jiangxl.com</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#F78C6C;--1:#AA0982">10.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.107</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">80</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">d18h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">gateway</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">gateway.jiangxl.com</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">10.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.107</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">80</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">22</span><span style="--0:#ECC48D;--1:#3C63B3">h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">portal</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">portal.jiangxl.com</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#F78C6C;--1:#AA0982">10.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.107</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">80</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#ECC48D;--1:#3C63B3">m16s</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.查看所有微服务的程序[root@binary-k8s-master1 k8s]\# kubectl get all -n simple-msNAME                           READY   STATUS    RESTARTS   AGEpod/eureka-0                   1/1     Running   5          2d16hpod/eureka-1                   1/1     Running   3          2d16hpod/eureka-2                   1/1     Running   2          2d16hpod/gateway-8665d5d56-tx2m8    1/1     Running   2          117mpod/order-6694f4c474-cp5d6     1/1     Running   4          112mpod/portal-d5d55b784-7kntp     1/1     Running   0          2m53spod/product-77c8bb6847-vbxnr   1/1     Running   2          64mpod/stock-6cf98bb445-mxf7b     1/1     Running   0          35mNAME              TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)    AGEservice/eureka    ClusterIP   None         <none>        8080/TCP   2d18hservice/gateway   ClusterIP   10.0.0.188   <none>        8080/TCP   22hservice/portal    ClusterIP   10.0.0.190   <none>        8080/TCP   2m53sNAME                      READY   UP-TO-DATE   AVAILABLE   AGEdeployment.apps/gateway   1/1     1            1           22hdeployment.apps/order     1/1     1            1           112mdeployment.apps/portal    1/1     1            1           2m53sdeployment.apps/product   1/1     1            1           65mdeployment.apps/stock     1/1     1            1           35mNAME                                 DESIRED   CURRENT   READY   AGEreplicaset.apps/gateway-8665d5d56    1         1         1       117mreplicaset.apps/order-6694f4c474     1         1         1       112mreplicaset.apps/portal-d5d55b784     1         1         1       2m53sreplicaset.apps/product-77c8bb6847   1         1         1       64mreplicaset.apps/stock-6cf98bb445     1         1         1       35mNAME                      READY   AGEstatefulset.apps/eureka   3/3     2d18h2.查看所有微服务的ingress资源[root@binary-k8s-master1 k8s]\# kubectl get ingress -n simple-msNAME      CLASS    HOSTS                 ADDRESS      PORTS   AGEeureka    <none>   eureka.jiangxl.com    10.0.0.107   80      2d18hgateway   <none>   gateway.jiangxl.com   10.0.0.107   80      22hportal    <none>   portal.jiangxl.com    10.0.0.107   80      3m16s"><div></div></button></div></figure></div>
<h3 id="49查看eureka注册中心中各个微服务的信息">4.9.查看Eureka注册中心中各个微服务的信息</h3>
<p>每个微服务程序均在Eureka注册中心中注册完成。</p>
<p><img src="https://cdn.agou-ops.cn/others/feae01f050a440ed92aa5f948efd875f.png" alt="在这里插入图片描述"></p>
<h3 id="410使用simple微服务电商平台">4.10.使用simple微服务电商平台</h3>
<p>到4.8步骤之后，我们的simple微服务电商平台已经全部部署在K8S集群了，可以在本机hosts里绑定simple微服务的域名，操作电商平台。</p>
<p><img src="https://cdn.agou-ops.cn/others/11d0320836a54e1b96d6e6801bdb9f8b.png" alt="在这里插入图片描述"></p>
<p>这个微服务平台的背景图其实是京东的一张图而已，是不可以点的。</p>
<p><img src="https://cdn.agou-ops.cn/others/5de80a8717554409af8d9a14b6462e30.png" alt="在这里插入图片描述"></p>
<p>只能在商品服务中查询能购买的商品，然后进行购买，最后在订单服务中查询。</p>
<p>搜索商品时会调用product商品微服务，下单后，查询订单服务时会调用order订单服务。</p>
<p>点击查询商品服务，我们来下单一个美女观察一下效果，下单后会提示下单成功。</p>
<p><img src="https://cdn.agou-ops.cn/others/2776324a762543f5a9df8fc3fc0f6e19.png" alt="在这里插入图片描述"></p>
<p>点击查询订单服务就可以看到我吗下的订单了</p>
<p><img src="https://cdn.agou-ops.cn/others/91eee91044a3497986b5f0f788a95738.png" alt="在这里插入图片描述"></p>
<h2 id="5基于k8s集群的微服务的扩容与升级">5.基于K8S集群的微服务的扩容与升级</h2>
<h3 id="51微服务的扩容">5.1.微服务的扩容</h3>
<p>微服务在物理机环境运行时，网站并发量高的情况下，扩容只能去购买云服务器，然后搭建一套一模一样的服务，手动组成负载均衡集群，增加一台其实还好，如果要增加几十台，太费人工成本了。</p>
<p>当微服务迁移到K8S集群之后，扩容其实变得非常简单，只需要增加程序Pod的副本数就可以完成程序的扩容。</p>
<p>命令如下，以扩展order商品微服务为例。</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">将order商品服务的副本数调整为3个，原本是1个，现在扩容到3个</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl scale deploy order --replicas=3 -n simple-ms</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">deployment.apps/order</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">scaled</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">可以看到order订单服务目前已经有3个pod副本了</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get pod -n simple-ms</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                       </span><span style="--0:#ECC48D;--1:#3C63B3">READY</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">STATUS</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">RESTARTS</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">eureka-0</span><span style="--0:#D6DEEB;--1:#403F53">                   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">6</span><span style="--0:#ECC48D;--1:#3C63B3">m15s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">eureka-1</span><span style="--0:#D6DEEB;--1:#403F53">                   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">7</span><span style="--0:#ECC48D;--1:#3C63B3">m59s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">eureka-2</span><span style="--0:#D6DEEB;--1:#403F53">                   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">m40s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">gateway-848874fc9d-pwp9w</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">48</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">order-6694f4c474-cp5d6</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">4</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#ECC48D;--1:#3C63B3">h29m</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">order-6694f4c474-kh8hm</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">96</span><span style="--0:#ECC48D;--1:#3C63B3">s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">order-6694f4c474-rg7kw</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">96</span><span style="--0:#ECC48D;--1:#3C63B3">s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">portal-6fdcd765bd-mtq68</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">24</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">product-784d9f77b5-rxsf2</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">64</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">stock-6cf98bb445-l8gxb</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">133</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">缩容也很简单，将order的副本数缩减成1个</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl scale deploy order --replicas=1 -n simple-ms</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">deployment.apps/order</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">scaled</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">成功缩减到1个副本</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get pod -n simple-ms</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                       </span><span style="--0:#ECC48D;--1:#3C63B3">READY</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">STATUS</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">RESTARTS</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">eureka-0</span><span style="--0:#D6DEEB;--1:#403F53">                   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">m24s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">eureka-1</span><span style="--0:#D6DEEB;--1:#403F53">                   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">11</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">eureka-2</span><span style="--0:#D6DEEB;--1:#403F53">                   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">12</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">gateway-848874fc9d-pwp9w</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">51</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">order-6694f4c474-rg7kw</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">4</span><span style="--0:#ECC48D;--1:#3C63B3">m45s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">portal-6fdcd765bd-mtq68</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">27</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">product-784d9f77b5-rxsf2</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">67</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">stock-6cf98bb445-l8gxb</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">136</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="将order商品服务的副本数调整为3个，原本是1个，现在扩容到3个[root@binary-k8s-master1 k8s]\# kubectl scale deploy order --replicas=3 -n simple-msdeployment.apps/order scaled可以看到order订单服务目前已经有3个pod副本了[root@binary-k8s-master1 ~]\# kubectl get pod -n simple-msNAME                       READY   STATUS    RESTARTS   AGEeureka-0                   1/1     Running   1          6m15seureka-1                   1/1     Running   0          7m59seureka-2                   1/1     Running   1          9m40sgateway-848874fc9d-pwp9w   1/1     Running   0          48morder-6694f4c474-cp5d6     1/1     Running   4          3h29morder-6694f4c474-kh8hm     1/1     Running   0          96sorder-6694f4c474-rg7kw     1/1     Running   0          96sportal-6fdcd765bd-mtq68    1/1     Running   1          24mproduct-784d9f77b5-rxsf2   1/1     Running   0          64mstock-6cf98bb445-l8gxb     1/1     Running   0          133m缩容也很简单，将order的副本数缩减成1个[root@binary-k8s-master1 k8s]\# kubectl scale deploy order --replicas=1 -n simple-msdeployment.apps/order scaled成功缩减到1个副本[root@binary-k8s-master1 ~]\# kubectl get pod -n simple-msNAME                       READY   STATUS    RESTARTS   AGEeureka-0                   1/1     Running   1          9m24seureka-1                   1/1     Running   0          11meureka-2                   1/1     Running   1          12mgateway-848874fc9d-pwp9w   1/1     Running   0          51morder-6694f4c474-rg7kw     1/1     Running   0          4m45sportal-6fdcd765bd-mtq68    1/1     Running   1          27mproduct-784d9f77b5-rxsf2   1/1     Running   0          67mstock-6cf98bb445-l8gxb     1/1     Running   0          136m"><div></div></button></div></figure></div>
<h3 id="52微服务的升级">5.2.微服务的升级</h3>
<p>微服务在物理机环境更新时只需要拉取最新的代码，编译成jar包，在服务器上部署就可以了，但是微服务迁移到K8S集群之后，更新过程就变得比较复杂了，首先更新的代码，然后编译成jar包，再通过Dockerfile将jar包做成docker镜像，然后在k8s集群中部署，当然这些流程可以通过Jenkins实现自动化上线。</p>
<h4 id="521微调portal前端首页的代码">5.2.1.微调Portal前端首页的代码</h4>
<p>将平台的这些文件修改成jiangxl.com的内容完成一次portal前端首页的升级</p>
<p><img src="https://cdn.agou-ops.cn/others/6fff8cf3680744d9bd8f4340015acf60.png" alt="在这里插入图片描述"></p>
<p>首先找到记录这些文字的文件</p>
<p><img src="https://cdn.agou-ops.cn/others/c8b660cdf01f4e92aed03aa0005f48a4.png" alt="在这里插入图片描述"></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># vim templates/index.ftl</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># vim templates/orderList.ftl</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># vim templates/productList.ftl</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">进入文件后在末行模式输入：</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">%s/容器学院</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">www.ctnrs.com/jiangxl.com/g</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">%s/www.ctnrs.com/jiangxl.com/g</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">然后将所有的容器学院的文字删除</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="进入文件后在末行模式输入：%s/容器学院 www.ctnrs.com/jiangxl.com/g%s/www.ctnrs.com/jiangxl.com/g然后将所有的容器学院的文字删除"><div></div></button></div></figure></div>
<h4 id="522编译最新代码">5.2.2.编译最新代码</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 simple-microservice-dev1]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> mvn clean package -D maven.test.skip=true -P prod</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 simple-microservice-dev1]\# mvn clean package -D maven.test.skip=true -P prod"><div></div></button></div></figure></div>
<h4 id="523通过脚本将protal最新代码打包成镜像">5.2.3.通过脚本将Protal最新代码打包成镜像</h4>
<p>直接使用前面部署程序的脚本即可</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> sh deploy_k8s.sh portal-service</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 k8s]\# sh deploy_k8s.sh portal-service"><div></div></button></div></figure></div>
<h4 id="524升级k8s集群中的protal微服务">5.2.4.升级K8S集群中的Protal微服务</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl -n simple-ms set image deployment portal portal=192.168.20.11/simple-microservice/portal-service:v1 --record</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 k8s]\# kubectl -n simple-ms set image deployment portal portal=192.168.20.11/simple-microservice/portal-service:v1 --record"><div></div></button></div></figure></div>
<p>程序更新完成后刷新页面就可以看到我们更新的页面内容</p>
<p><img src="https://cdn.agou-ops.cn/others/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASmlhbmd4bH4=,size_20,color_FFFFFF,t_70,g_se,x_16.png" alt="在这里插入图片描述"></p> </div> <footer class="astro-3yyafb3n"> <div class="meta sl-flex astro-3yyafb3n">   </div> <div class="pagination-links astro-u2l5gyhi" dir="ltr"> <a href="/cloudnative/k8s/实战案例/rbac-实战案例/" rel="prev" class="astro-u2l5gyhi"> <svg aria-hidden="true" class="astro-u2l5gyhi astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.5rem;"><path d="M17 11H9.41l3.3-3.29a1.004 1.004 0 1 0-1.42-1.42l-5 5a1 1 0 0 0-.21.33 1 1 0 0 0 0 .76 1 1 0 0 0 .21.33l5 5a1.002 1.002 0 0 0 1.639-.325 1 1 0 0 0-.219-1.095L9.41 13H17a1 1 0 0 0 0-2Z"/></svg>  <span class="astro-u2l5gyhi"> Previous <br class="astro-u2l5gyhi"> <span class="link-title astro-u2l5gyhi">RBAC 实战案例</span> </span> </a> <a href="/cloudnative/k8s/实战案例/使用csr-api创建用户/" rel="next" class="astro-u2l5gyhi"> <svg aria-hidden="true" class="astro-u2l5gyhi astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.5rem;"><path d="M17.92 11.62a1.001 1.001 0 0 0-.21-.33l-5-5a1.003 1.003 0 1 0-1.42 1.42l3.3 3.29H7a1 1 0 0 0 0 2h7.59l-3.3 3.29a1.002 1.002 0 0 0 .325 1.639 1 1 0 0 0 1.095-.219l5-5a1 1 0 0 0 .21-.33 1 1 0 0 0 0-.76Z"/></svg>  <span class="astro-u2l5gyhi"> Next <br class="astro-u2l5gyhi"> <span class="link-title astro-u2l5gyhi">使用CSR API创建用户</span> </span> </a> </div>  </footer>  </div> </div>   </main> </div> </div>  </div> </div>  </body></html>