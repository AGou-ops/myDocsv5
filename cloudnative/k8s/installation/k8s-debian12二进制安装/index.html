<!DOCTYPE html><html lang="en" dir="ltr" data-has-toc data-has-sidebar data-theme="dark" class="astro-bguv2lll"> <head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>k8s Debian12äºŒè¿›åˆ¶å®‰è£… | AGou's Docsv5</title><link rel="canonical"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><meta name="generator" content="Astro v4.5.3"/><meta name="generator" content="Starlight v0.21.1"/><meta property="og:title" content="k8s Debian12äºŒè¿›åˆ¶å®‰è£…"/><meta property="og:type" content="article"/><meta property="og:url"/><meta property="og:locale" content="en"/><meta property="og:description" content="This is a document about k8s Debian12äºŒè¿›åˆ¶å®‰è£…."/><meta property="og:site_name" content="AGou's Docsv5"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="k8s Debian12äºŒè¿›åˆ¶å®‰è£…"/><meta name="twitter:description" content="This is a document about k8s Debian12äºŒè¿›åˆ¶å®‰è£…."/><meta name="description" content="This is a document about k8s Debian12äºŒè¿›åˆ¶å®‰è£…."/><script>
	window.StarlightThemeProvider = (() => {
		const storedTheme =
			typeof localStorage !== 'undefined' && localStorage.getItem('starlight-theme');
		const theme =
			storedTheme ||
			(window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark');
		document.documentElement.dataset.theme = theme === 'light' ? 'light' : 'dark';
		return {
			updatePickers(theme = storedTheme || 'auto') {
				document.querySelectorAll('starlight-theme-select').forEach((picker) => {
					const select = picker.querySelector('select');
					if (select) select.value = theme;
					/** @type {HTMLTemplateElement | null} */
					const tmpl = document.querySelector(`#theme-icons`);
					const newIcon = tmpl && tmpl.content.querySelector('.' + theme);
					if (newIcon) {
						const oldIcon = picker.querySelector('svg.label-icon');
						if (oldIcon) {
							oldIcon.replaceChildren(...newIcon.cloneNode(true).childNodes);
						}
					}
				});
			},
		};
	})();
</script><template id="theme-icons"><svg aria-hidden="true" class="light astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M5 12a1 1 0 0 0-1-1H3a1 1 0 0 0 0 2h1a1 1 0 0 0 1-1Zm.64 5-.71.71a1 1 0 0 0 0 1.41 1 1 0 0 0 1.41 0l.71-.71A1 1 0 0 0 5.64 17ZM12 5a1 1 0 0 0 1-1V3a1 1 0 0 0-2 0v1a1 1 0 0 0 1 1Zm5.66 2.34a1 1 0 0 0 .7-.29l.71-.71a1 1 0 1 0-1.41-1.41l-.66.71a1 1 0 0 0 0 1.41 1 1 0 0 0 .66.29Zm-12-.29a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.71-.71a1.004 1.004 0 1 0-1.43 1.41l.73.71ZM21 11h-1a1 1 0 0 0 0 2h1a1 1 0 0 0 0-2Zm-2.64 6A1 1 0 0 0 17 18.36l.71.71a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.76-.66ZM12 6.5a5.5 5.5 0 1 0 5.5 5.5A5.51 5.51 0 0 0 12 6.5Zm0 9a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7Zm0 3.5a1 1 0 0 0-1 1v1a1 1 0 0 0 2 0v-1a1 1 0 0 0-1-1Z"/></svg> <svg aria-hidden="true" class="dark astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.64 13a1 1 0 0 0-1.05-.14 8.049 8.049 0 0 1-3.37.73 8.15 8.15 0 0 1-8.14-8.1 8.59 8.59 0 0 1 .25-2A1 1 0 0 0 8 2.36a10.14 10.14 0 1 0 14 11.69 1 1 0 0 0-.36-1.05Zm-9.5 6.69A8.14 8.14 0 0 1 7.08 5.22v.27a10.15 10.15 0 0 0 10.14 10.14 9.784 9.784 0 0 0 2.1-.22 8.11 8.11 0 0 1-7.18 4.32v-.04Z"/></svg> <svg aria-hidden="true" class="auto astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg> </template><link rel="stylesheet" href="/_astro/index.BsC2KTtW.css" /><script type="module" src="/_astro/hoisted.bf4k8FkQ.js"></script>
<script type="module" src="/_astro/page.CZ0TFQCk.js"></script></head> <body class="astro-bguv2lll"> <a href="#_top" class="astro-7q3lir66">Skip to content</a>  <div class="page sl-flex astro-vrdttmbt"> <header class="header astro-vrdttmbt"><div class="header sl-flex astro-kmkmnagf"> <div class="title-wrapper sl-flex astro-kmkmnagf"> <a href="/" class="site-title sl-flex astro-m46x6ez3">  <img class="astro-m46x6ez3" alt="" src="/_astro/logo.BdruG-BK.png" width="200" height="200">  <span class="astro-m46x6ez3"> AGou&#39;s Docsv5 </span> </a>  </div> <div class="sl-flex astro-kmkmnagf"> <site-search data-translations="{&#34;placeholder&#34;:&#34;Search&#34;}" class="astro-v37mnknz"> <button data-open-modal disabled class="astro-v37mnknz">  <svg aria-label="Search" class="astro-v37mnknz astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.71 20.29 18 16.61A9 9 0 1 0 16.61 18l3.68 3.68a.999.999 0 0 0 1.42 0 1 1 0 0 0 0-1.39ZM11 18a7 7 0 1 1 0-14 7 7 0 0 1 0 14Z"/></svg>  <span class="sl-hidden md:sl-block astro-v37mnknz" aria-hidden="true">Search</span> <svg aria-label="(Press / to Search)" class="sl-hidden md:sl-block astro-v37mnknz astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 2H7a5 5 0 0 0-5 5v10a5 5 0 0 0 5 5h10a5 5 0 0 0 5-5V7a5 5 0 0 0-5-5Zm3 15a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V7a3 3 0 0 1 3-3h10a3 3 0 0 1 3 3v10Z"/><path d="M15.293 6.707a1 1 0 1 1 1.414 1.414l-8.485 8.486a1 1 0 0 1-1.414-1.415l8.485-8.485Z"/></svg>  </button> <dialog style="padding:0" aria-label="Search" class="astro-v37mnknz"> <div class="dialog-frame sl-flex astro-v37mnknz">  <button data-close-modal class="sl-flex md:sl-hidden astro-v37mnknz"> Cancel </button> <div class="search-container astro-v37mnknz"> <div id="starlight__search" class="astro-v37mnknz"></div> </div> </div> </dialog> </site-search>    </div> <div class="sl-hidden md:sl-flex right-group astro-kmkmnagf"> <div class="sl-flex social-icons astro-kmkmnagf"> <a href="https://github.com/AGou-ops" rel="me" class="sl-flex astro-wy4te6ga"><span class="sr-only astro-wy4te6ga">GitHub</span><svg aria-hidden="true" class="astro-wy4te6ga astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"/></svg> </a> </div> <starlight-theme-select>  <label style="--sl-select-width: 6.25em" class="astro-4yphtoen"> <span class="sr-only astro-4yphtoen">Select theme</span> <svg aria-hidden="true" class="icon label-icon astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg>  <select value="auto" class="astro-4yphtoen"> <option value="dark" class="astro-4yphtoen">Dark</option><option value="light" class="astro-4yphtoen">Light</option><option value="auto" selected="true" class="astro-4yphtoen">Auto</option> </select> <svg aria-hidden="true" class="icon caret astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </label>  </starlight-theme-select>  <script>
	StarlightThemeProvider.updatePickers();
</script>   </div> </div> </header> <nav class="sidebar astro-vrdttmbt" aria-label="Main"> <starlight-menu-button class="astro-jif73yzw"> <button aria-expanded="false" aria-label="Menu" aria-controls="starlight__sidebar" class="sl-flex md:sl-hidden astro-jif73yzw"> <svg aria-hidden="true" class="astro-jif73yzw astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M3 8h18a1 1 0 1 0 0-2H3a1 1 0 0 0 0 2Zm18 8H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Zm0-5H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Z"/></svg>  </button> </starlight-menu-button>    <div id="starlight__sidebar" class="sidebar-pane astro-vrdttmbt"> <div class="sidebar-content sl-flex astro-vrdttmbt"> <ul class="top-level astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">ğŸ”— Links</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="https://agou-ops.cn" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">â­ï¸ Go to myBlog</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">guide</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/guide/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">index</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">CloudNative</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">index</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">CICD</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/argocd-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ArgoCD Basic</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">GitLab</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/gitlab/gitlab-backup-move/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">GitLab Backup-Move</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/gitlab/gitlab-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">GitLab Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/gitlab/gitlab-reset-passwd/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">GitLab reset passwd</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/gogs-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Gogs Basic</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Jenkins</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/docker-jenkins-æ‰§è¡Œå®¿ä¸»æœºå‘½ä»¤/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker Jenkins æ‰§è¡Œå®¿ä¸»æœºå‘½ä»¤</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/generic-webhook-trigger/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Generic Webhook Trigger</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/jenkins-backup-restore/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jenkins Backup Restore</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/jenkins-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jenkins Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/jenkins-issues/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jenkins issues</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/jenkins-plugins/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jenkins Plugins</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/jenkins-å…±äº«åº“/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jenkins å…±äº«åº“</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/jenkins-åˆ é™¤æ„å»ºå†å²/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jenkins åˆ é™¤æ„å»ºå†å²</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/jenkins-æµæ°´çº¿å®ä¾‹/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jenkins æµæ°´çº¿å®ä¾‹</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/jenkins-é•œåƒåŠ é€Ÿ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jenkins é•œåƒåŠ é€Ÿ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/jenkinsfile-sample/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jenkinsfile Sample</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/jenkinsfile-è‡ªå®šä¹‰å‡½æ•°/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jenkinsfile è‡ªå®šä¹‰å‡½æ•°</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/pipeline-build-parameters/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Pipeline build parameters</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/é‚®ä»¶é€šçŸ¥æ¨¡æ¿/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">é‚®ä»¶é€šçŸ¥æ¨¡æ¿</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jira-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jira Basic</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Sonarqube</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/sonarqube/sonarqube-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Sonarqube Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/sonarqube/sonarqube-with-jenkins/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Sonarqube with Jenkins</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/å‘å¸ƒæ–¹å¼/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">å‘å¸ƒæ–¹å¼</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">CloudComptering</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Aliyun</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/cloudcomptering/aliyun/untitled/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Untitled</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cloudcomptering/amazon-eks-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Amazon EKS Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cloudcomptering/amazon-web-services/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Amazon Web Services</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cloudcomptering/microsoft-azure/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Microsoft Azure</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/consul-å…¥é—¨/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Consul å…¥é—¨</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Docker</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-compose/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker Compose</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-network/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker Network</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-openvswitch/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker openvswitch</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-portainer/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker Portainer</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-private-registry/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker Private Registry</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-remote-access/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker Remote Access</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-volume/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker Volume</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-å›ºå®šipåŠè·¨ä¸»æœºäº’é€š/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker å›ºå®šIPåŠè·¨ä¸»æœºäº’é€š</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-å®¹å™¨é—´é€šè¿‡ä¸»æœºåäº’ç›¸è®¿é—®/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker å®¹å™¨é—´é€šè¿‡ä¸»æœºåäº’ç›¸è®¿é—®</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-æ¸…ç†/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker æ¸…ç†</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-ç¤ºä¾‹åŠå¤šæ¶æ„æ„å»º/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker ç¤ºä¾‹åŠå¤šæ¶æ„æ„å»º</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/dockerfile/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">DockerFile</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/ssh-docker-container/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">SSH Docker container</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/dubbo-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Dubbo Basic</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">ELFK</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/elastic-stack-beats/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Elastic Stack Beats</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/elk-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ELK basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/elk-kafka-filebeat/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ELK-Kafka-Filebeat</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/elk-redisç¼“å­˜ä»¥åŠæ—¥å¿—åˆ†æµ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ELK-Redisç¼“å­˜ä»¥åŠæ—¥å¿—åˆ†æµ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/es-3rd-part-plugins/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ES 3rd part Plugins</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/es-dockerä¸‰èŠ‚ç‚¹éƒ¨ç½²/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ES Dockerä¸‰èŠ‚ç‚¹éƒ¨ç½²</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/es-é…ç½®æ–‡ä»¶è¯¦è§£/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ES é…ç½®æ–‡ä»¶è¯¦è§£</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/filebeat-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Filebeat basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/kafka-elfkåˆ†å¸ƒå¼æ—¥å¿—æ”¶é›†/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Kafka-ELFKåˆ†å¸ƒå¼æ—¥å¿—æ”¶é›†</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/kafka-redis-elfkåˆ†å¸ƒå¼æ—¥å¿—æ”¶é›†/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Kafka-Redis-ELFKåˆ†å¸ƒå¼æ—¥å¿—æ”¶é›†</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/logstash-basic-plugins/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Logstash Basic - Plugins</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/logstash-æ—¥å¿—åˆ†æµ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Logstash æ—¥å¿—åˆ†æµ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/syslog-elkæ—¥å¿—æ”¶é›†/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">syslog-ELKæ—¥å¿—æ”¶é›†</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/tcp-elkæ—¥å¿—æ”¶é›†/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">TCP-ELKæ—¥å¿—æ”¶é›†</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/ä½¿ç”¨-docker-compose-éƒ¨ç½²-elk/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ä½¿ç”¨ docker-compose éƒ¨ç½² ELK</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/æ”¶é›†javatomcatæ—¥å¿—/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">æ”¶é›†Javaã€Tomcatæ—¥å¿—</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/éƒ¨ç½²elk-kafka-filebeatæ—¥å¿—æ”¶é›†åˆ†æç³»ç»Ÿ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">éƒ¨ç½²ELK-Kafka-Filebeatæ—¥å¿—æ”¶é›†åˆ†æç³»ç»Ÿ</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/grafana-loki-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Grafana Loki Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/istio-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Istio Basic</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">k8s</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/cilium-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">cilium Basic</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Helm</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/helm/charts/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">charts</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/helm/helm-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Helm Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/helm/helmgotemplate/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Helmï¼ˆGoï¼‰template</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Installation</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/installation/k8s-debian12äºŒè¿›åˆ¶å®‰è£…/" aria-current="page" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">k8s Debian12äºŒè¿›åˆ¶å®‰è£…</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/installation/kubeadm-å¿«é€Ÿéƒ¨ç½²æ‰‹å†Œ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Kubeadm å¿«é€Ÿéƒ¨ç½²æ‰‹å†Œ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/installation/kubernetes-äºŒè¿›åˆ¶å®‰è£…/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Kubernetes äºŒè¿›åˆ¶å®‰è£…</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/installation/ä½¿ç”¨-kubeadm-éƒ¨ç½²å•master/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ä½¿ç”¨ Kubeadm éƒ¨ç½²ï¼ˆå•masterï¼‰</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/installation/ä½¿ç”¨-kubespray-éƒ¨ç½²/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ä½¿ç”¨ Kubespray éƒ¨ç½²</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/installation/ä½¿ç”¨å›½å†…æºåŠç›¸å…³å°å·¥å…·/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ä½¿ç”¨å›½å†…æºåŠç›¸å…³å°å·¥å…·</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/installation/å¸¸ç”¨ç»„ä»¶å®‰è£…/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">å¸¸ç”¨ç»„ä»¶å®‰è£…</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/k3d/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">k3d</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/k8s-command/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">k8s command</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/k8s-å›¾è§£å¤§å…¨/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">k8s å›¾è§£å¤§å…¨</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/k8s-ç½‘ç»œç›¸å…³/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">k8s ç½‘ç»œç›¸å…³</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/k8sæ¦‚å¿µåŠåŸç†ç›¸å…³/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">k8sæ¦‚å¿µåŠåŸç†ç›¸å…³</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/kompose-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">kompose Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/kubeadm-å¿«é€Ÿéƒ¨ç½²k8sé›†ç¾¤/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Kubeadm å¿«é€Ÿéƒ¨ç½²k8sé›†ç¾¤</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/kubenetesè¿œç¨‹è°ƒè¯•å·¥å…·/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">kubenetesè¿œç¨‹è°ƒè¯•å·¥å…·</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/kubernetes-rest-api/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Kubernetes REST API</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/kubernetes-with-jenkins-cicd/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Kubernetes with Jenkins CICD</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/kubernetes-yaml-quicklystart/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Kubernetes Yaml quicklystart</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/kustmoize-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">kustmoize Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/metalb-éƒ¨ç½²ä¸ç®€å•æµ‹è¯•/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MetaLB éƒ¨ç½²ä¸ç®€å•æµ‹è¯•</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/minikube-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Minikube Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/prometheus-grafanaå…¨æ–¹ä½ç›‘æ§kubernetesé›†ç¾¤/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Prometheus-Grafanaå…¨æ–¹ä½ç›‘æ§Kubernetesé›†ç¾¤</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Quicklystart</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/ä¸€-kubernetesæ¦‚è¿°/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ä¸€ Kubernetesæ¦‚è¿°</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/ä¸ƒ-æ§åˆ¶å™¨é…ç½®æ¸…å•/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ä¸ƒ æ§åˆ¶å™¨é…ç½®æ¸…å•</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/ä¸‰-é›†ç¾¤éƒ¨ç½²/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ä¸‰ é›†ç¾¤éƒ¨ç½²</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/ä¹-ingress-æ§åˆ¶å™¨/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ä¹ ingress æ§åˆ¶å™¨</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/äºŒ-æ ¸å¿ƒç»„ä»¶åŠé™„ä»¶/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">äºŒ æ ¸å¿ƒç»„ä»¶åŠé™„ä»¶</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/äº”-é…ç½®æ¸…å•ä½¿ç”¨/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">äº” é…ç½®æ¸…å•ä½¿ç”¨</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/å…«-service-é…ç½®æ¸…å•/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">å…« Service é…ç½®æ¸…å•</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/å…­-pod-é…ç½®æ¸…å•/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">å…­ POD é…ç½®æ¸…å•</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/å-pod-å­˜å‚¨å·/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">å POD å­˜å‚¨å·</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/åä¸€-é…ç½®ä¿¡æ¯å®¹å™¨åŒ–/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">åä¸€ é…ç½®ä¿¡æ¯å®¹å™¨åŒ–</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/åä¸ƒ-è°ƒåº¦ç­–ç•¥/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">åä¸ƒ è°ƒåº¦ç­–ç•¥</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/åä¸‰-ç”¨æˆ·è®¤è¯ç³»ç»Ÿ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">åä¸‰ ç”¨æˆ·è®¤è¯ç³»ç»Ÿ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/åä¹-å®¹å™¨èµ„æºé™åˆ¶/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">åä¹ å®¹å™¨èµ„æºé™åˆ¶</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/åäºŒ-statefulset-æ§åˆ¶å™¨/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">åäºŒ StatefulSet æ§åˆ¶å™¨</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/åäº”-dashboard/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">åäº” dashboard</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/åå…«-é«˜çº§è°ƒåº¦è®¾ç½®/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">åå…« é«˜çº§è°ƒåº¦è®¾ç½®</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/åå…­-ç½‘ç»œé€šä¿¡/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">åå…­ ç½‘ç»œé€šä¿¡</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/åå››-ç”¨æˆ·æƒé™ç³»ç»Ÿ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">åå›› ç”¨æˆ·æƒé™ç³»ç»Ÿ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/å››-å…¥é—¨å‘½ä»¤/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">å›› å…¥é—¨å‘½ä»¤</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/remote-access-k8s/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Remote access k8s</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/xfs-recovery/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">xfs recovery</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">å®æˆ˜æ¡ˆä¾‹</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/å®æˆ˜æ¡ˆä¾‹/cert-managerè‡ªåŠ¨é¢å‘è¯ä¹¦/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">cert-managerè‡ªåŠ¨é¢å‘è¯ä¹¦</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/å®æˆ˜æ¡ˆä¾‹/helmå®‰è£…zookeeperé›†ç¾¤/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">helmå®‰è£…zookeeperé›†ç¾¤</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/å®æˆ˜æ¡ˆä¾‹/jenkinsç»“åˆ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">jenkinsç»“åˆ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/å®æˆ˜æ¡ˆä¾‹/k8sä¸­ä½¿ç”¨traefikåŸºç¡€/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">k8sä¸­ä½¿ç”¨traefikï¼ˆåŸºç¡€ï¼‰</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/å®æˆ˜æ¡ˆä¾‹/k8så®‰è£…apolloé…ç½®ä¸­å¿ƒ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">k8så®‰è£…Apolloé…ç½®ä¸­å¿ƒ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/å®æˆ˜æ¡ˆä¾‹/k8så®‰è£…minioå¯¹è±¡å­˜å‚¨/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">k8så®‰è£…MinIOå¯¹è±¡å­˜å‚¨</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/å®æˆ˜æ¡ˆä¾‹/rbac-å®æˆ˜æ¡ˆä¾‹/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">RBAC å®æˆ˜æ¡ˆä¾‹</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/å®æˆ˜æ¡ˆä¾‹/springcloudå¾®æœåŠ¡ç”µå•†ç³»ç»Ÿåœ¨kubernetesé›†ç¾¤ä¸­ä¸Šçº¿è¯¦ç»†æ•™ç¨‹/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">SpringCloudå¾®æœåŠ¡ç”µå•†ç³»ç»Ÿåœ¨Kubernetesé›†ç¾¤ä¸­ä¸Šçº¿è¯¦ç»†æ•™ç¨‹</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/å®æˆ˜æ¡ˆä¾‹/ä½¿ç”¨csr-apiåˆ›å»ºç”¨æˆ·/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ä½¿ç”¨CSR APIåˆ›å»ºç”¨æˆ·</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/å®æˆ˜æ¡ˆä¾‹/å…¶ä»–å®æˆ˜æ¡ˆä¾‹/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">å…¶ä»–å®æˆ˜æ¡ˆä¾‹</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">å°æŠ€å·§</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/å°æŠ€å·§/ä½¿ç”¨curlè®¿é—®k8sçš„rest-api/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ä½¿ç”¨curlè®¿é—®k8sçš„REST API</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/å°æŠ€å·§/å¼ºåˆ¶åˆ é™¤namespace/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">å¼ºåˆ¶åˆ é™¤namespace</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Prometheus</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/prometheus/influxdbtelegraf-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">influxDBã€Telegraf Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/prometheus/prometheus-alertmanager/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Prometheus-AlertManager</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/prometheus/prometheus-consulæœåŠ¡å‘ç°/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Prometheus-Consulï¼ˆæœåŠ¡å‘ç°ï¼‰</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/prometheus/prometheus-in-docker/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Prometheus in Docker</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/prometheus/prometheus-å®‰è£…ä¸éƒ¨ç½²grafana/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Prometheus å®‰è£…ä¸éƒ¨ç½²ã€Grafana</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/prometheus/prometheus-è¿›é˜¶/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Prometheus è¿›é˜¶</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">LinuxBasics</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">index</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Ansible</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/ansible/ansible-ad-hoc-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ansible Ad-hoc Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/ansible/ansible-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ansible Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/ansible/ansible-best-practices/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ansible Best Practices</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/ansible/ansible-inventory/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ansible inventory</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/ansible/ansible-modules/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ansible modules</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/ansible/ansible-playbook-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ansible Playbook Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/ansible/ansible-tower/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ansible Tower</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Cache</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Nuster</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/cache/nuster/nuster-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nuster Basic</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Varnish</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/cache/varnish/varnish-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">varnish Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/cache/varnish/varnish-å‚è€ƒç¤ºä¾‹/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">varnish å‚è€ƒç¤ºä¾‹</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/cache/varnish/varnish-æ¶æ„å·¥ä½œåŸç†åŠç®€å•é…ç½®/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">varnish æ¶æ„ã€å·¥ä½œåŸç†åŠç®€å•é…ç½®</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/certbot-nginx-ssl/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">CertBot Nginx SSL</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">DataBases</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Etcd</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/etcd/etcd-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">etcd Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/etcd/etcd-å¤‡ä»½ä¸æ¢å¤/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">etcd å¤‡ä»½ä¸æ¢å¤</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/etcd/etcd-æ·»åŠ leanerèŠ‚ç‚¹/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">etcd æ·»åŠ leanerèŠ‚ç‚¹</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/etcd/etcdctl-å¿«é€Ÿæ‰‹å†Œ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">etcdctl å¿«é€Ÿæ‰‹å†Œ</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">MongoDB</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mongodb/mongodb-backup/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MongoDB Backup</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mongodb/mongodb-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MongoDB Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mongodb/mongodb-cluster/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MongoDB Cluster</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mongodb/mongodb-installation/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MongoDB Installation</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mongodb/mongodb-sharded-cluster/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MongoDB Sharded-Cluster</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mongodb/mongodb-å¼‚æ„æ•°æ®å¹³å°è¿ç§»/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MongoDB å¼‚æ„æ•°æ®å¹³å°è¿ç§»</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mongodb/mongodumprestoreoplogé«˜çº§å¤‡ä»½/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">mongodumpï¼ˆrestoreï¼‰oplogé«˜çº§å¤‡ä»½</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">MySQL</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mariadb-log/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MariaDB Log</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-auth-cli/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL Auth CLI</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-backup-client-tools/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL BackUP - Client Tools</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-cluster/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL Cluster</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-configuration/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL Configuration</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-cursor/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL Cursor</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-data_type/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL Data_Type</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-explain/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL EXPLAIN</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-function/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL Function</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-internal_function/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL Internal_function</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-stored-procedure/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL Stored Procedure</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-transaction/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL Transaction</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-å°æŠ€å·§/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL å°æŠ€å·§</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-å¿«é€Ÿæ‰‹å†Œ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL å¿«é€Ÿæ‰‹å†Œ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-çº¦æŸ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL çº¦æŸ</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Redis</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/redis/redis-backup/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redis Backup</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/redis/redis-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redis Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/redis/redis-cluster/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redis Cluster</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/redis/redis-codis/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redis Codis</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/redis/redis-ha/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redis  HA</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/redis/redis-installation/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redis Installation</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/redis/redis-sentinel/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redis Sentinel</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/redis/redis-è¿›é˜¶/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redis è¿›é˜¶</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/redis/ç¼“å­˜ç©¿é€ç¼“å­˜å‡»ç©¿ç¼“å­˜é›ªå´©/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ç¼“å­˜ç©¿é€ã€ç¼“å­˜å‡»ç©¿ã€ç¼“å­˜é›ªå´©</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">DHCP-PXE-Cobbler</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/dhcp-pxe-cobbler/cobbler-centos/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Cobbler CentOS</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/dhcp-pxe-cobbler/dhcp-ç®€å•ä½¿ç”¨/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">DHCP ç®€å•ä½¿ç”¨</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/dhcp-pxe-cobbler/pxe-centos/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">PXE CentOS</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/dnsmasq/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">dnsmasq</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/fail2ban-ç®€å•ä½¿ç”¨/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Fail2ban ç®€å•ä½¿ç”¨</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">FileSystem</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Ceph</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/ceph/ceph-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ceph Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/ceph/ceph-cluster-ç§»é™¤/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ceph Cluster ç§»é™¤</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/ceph/ceph-deploy-é›†ç¾¤å¿«é€Ÿéƒ¨ç½²/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ceph-deploy é›†ç¾¤å¿«é€Ÿéƒ¨ç½²</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/ceph/ceph-manager-dashboard/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ceph Manager Dashboard</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/ceph/ceph-rgw/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ceph RGW</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/ceph/ceph-éƒ¨ç½²é—®é¢˜æ±‡æ€»/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ceph éƒ¨ç½²é—®é¢˜æ±‡æ€»</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/ceph/cephadm-éƒ¨ç½²octopus/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Cephadm éƒ¨ç½²octopus</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/ceph/cephfs/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">CephFS</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">FastDFS</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/fastdfs/fastdfs-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">FastDFS Basic</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">GlusterFS</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/glusterfs/ä¸´æ—¶/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ä¸´æ—¶</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">MinIO</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/minio/minio-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MinIO Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/minio/minio-in-docker/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MinIO in Docker</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/nfs-åŸºç¡€åŠå®æˆ˜/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">NFS åŸºç¡€åŠå®æˆ˜</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/samba-åŸºç¡€åŠå®æˆ˜/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">SAMBA åŸºç¡€åŠå®æˆ˜</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/smbconfè¯¦è§£/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">smb.confè¯¦è§£</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/tftp/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">TFTP</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/vsftp-åŸºç¡€åŠå®æˆ˜/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">vsFTP åŸºç¡€åŠå®æˆ˜</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/firewalld-iptableså¿«é€Ÿæ‰‹å†Œ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Firewalld IPtableså¿«é€Ÿæ‰‹å†Œ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/inotifywait-æ–‡ä»¶ç›‘æ§/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">inotifywait æ–‡ä»¶ç›‘æ§</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/jumpserver/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">JumpServer</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/k3s-k3d-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">k3s - k3d Basic</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Kafka</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/kafka/cmak/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">CMAK</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/kafka/kafka-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Kafka Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/kafka/ä½¿ç”¨-docker-compose-éƒ¨ç½²-kafka/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ä½¿ç”¨ docker-compose éƒ¨ç½² Kafka</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/keepalived/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">keepalived</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">KVM</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/kvm/kvm_installsh/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">kvm_install.sh</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/kvm/kvm-2-vmware-station/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">KVM 2 VMware Station</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/kvm/kvm-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">KVM Basic</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/linux-å‹æµ‹å¤§å…¨/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Linux å‹æµ‹å¤§å…¨</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/linuxè¯Šæ–­/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Linuxè¯Šæ–­</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">LoadBalancer</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">HAProxy</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/haproxy/haproxy-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">HAProxy Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/haproxy/haproxy-in-docker/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">HAProxy in Docker</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/haproxy/haproxy-å‚è€ƒç¤ºä¾‹/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">HAProxy å‚è€ƒç¤ºä¾‹</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/haproxy/haproxy-é…ç½®è¯¦è§£/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">HAProxy é…ç½®è¯¦è§£</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/haproxy/keepalived-haproxy/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Keepalived - HAProxy</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Keepalived-Nginx</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/keepalived-nginx/nginx-keepalivedå®ç°é«˜å¯ç”¨é›†ç¾¤/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx - keepalivedå®ç°é«˜å¯ç”¨é›†ç¾¤</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/keepalived-nginx/nginx-keepalivedå¿«é€Ÿé…ç½®åŠè„šæœ¬/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx - keepalivedå¿«é€Ÿé…ç½®åŠè„šæœ¬</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">LVS</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/lvs/ipvsadm-å‚æ•°/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ipvsadm å‚æ•°</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/lvs/lvs-keepalived/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">LVS - keepalived</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/lvs/lvs-å››ç§æ¨¡å‹è¯¦è§£/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">LVS å››ç§æ¨¡å‹è¯¦è§£</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/lvs/lvs-ç®€å•åº”ç”¨/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">LVS ç®€å•åº”ç”¨</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/lvs/lvs-è°ƒåº¦ç®—æ³•/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">LVS è°ƒåº¦ç®—æ³•</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/lvs/lvs-è¿›é˜¶é…ç½®/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">LVS è¿›é˜¶é…ç½®</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/lsyncd/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">lsyncd</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/lvm-è®²è§£/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">lvm è®²è§£</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Makefile</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/makefile/makefile-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Makefile Basic</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Nexus</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/nexus/nexus-basic-maven-ç§æœ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nexus Basic - Maven ç§æœ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/nexus/nexus-yum-ç§æœ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nexus - yum ç§æœ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/nexus/nexus-æ‰¹é‡ä¸Šä¼ è„šæœ¬/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">nexus æ‰¹é‡ä¸Šä¼ è„šæœ¬</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/openvpn-for-centos/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">OpenVPN for CentOS</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/powerdns/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">PowerDNS</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">PVE</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/pve/pve-issues/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">PVE issues</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/pve/pve-åˆå§‹åŒ–ç›¸å…³/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">PVE åˆå§‹åŒ–ç›¸å…³</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/pve/pve-åˆ¶ä½œé•œåƒæ¨¡æ¿/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">PVE åˆ¶ä½œé•œåƒæ¨¡æ¿</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">RabbitMQ</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/rabbitmq/rabbitmq-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">RabbitMQ Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/rabbitmq/rabbitmq-mirror-queue/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">RabbitMQ Mirror Queue</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/rabbitmq/rabbitmq-on-docker/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">RabbitMQ on Docker</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/rsync-inotifysersync/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">rsync - inotifyï¼ˆsersyncï¼‰</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Shell</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/shell/command/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">command</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/shell/linux-shell-å®ç”¨å‘½ä»¤åŠä½¿ç”¨åœºæ™¯/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Linux Shell å®ç”¨å‘½ä»¤åŠä½¿ç”¨åœºæ™¯</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/shell/shell-getopts-æ ·ä¾‹/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Shell getopts æ ·ä¾‹</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/shell/userful-shell/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">userful-shell</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/snmpé…ç½®/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">snmpé…ç½®</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/split-logrotate/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Split - Logrotate</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">SpringBoot</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/springboot/springboot-in-docker/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">SpringBoot in Docker</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/springboot/springboot-quicklystart/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">SpringBoot Quicklystart</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/sql-review/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">SQL review</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/ssh-tunnel/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">SSH Tunnel</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/tcpdump-wireshark/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Tcpdump - Wireshark</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Terraform</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/terraform/terraform-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Terraform Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/terraform/terraform-examples/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Terraform Examples</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/terraform/terraform-variable/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Terraform Variable</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/useful-command/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Useful Command</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/vagrant/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Vagrant</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/vim-tricks/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">vim tricks</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/vps-èŠ‚ç‚¹æ­å»º/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">VPS èŠ‚ç‚¹æ­å»º</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Web-Servers</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Apache</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/apache/lamp-å¿«é€Ÿéƒ¨ç½²/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">LAMP å¿«é€Ÿéƒ¨ç½²</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Jvm-Tomcat</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/jvm-tomcat/jvm-monitor-tools/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jvm Monitor Tools</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/jvm-tomcat/tomcat-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Tomcat Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/jvm-tomcat/tomcat-clusternginx/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Tomcat Clusterï¼ˆnginxï¼‰</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/jvm-tomcat/tomcat-sessionmemcached/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Tomcat Sessionï¼ˆmemcachedï¼‰</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/jvm-tomcat/tomcat-sessionredis-with-nginx/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Tomcat Sessionï¼ˆRedis with Nginxï¼‰</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/jvm-tomcat/tomcat-è°ƒä¼˜/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Tomcat è°ƒä¼˜</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/jvm-tomcat/tomcatä¸­é—´ä»¶æ–¹æ–¹é¢é¢å‚¨å¤‡çŸ¥è¯†/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Tomcatä¸­é—´ä»¶æ–¹æ–¹é¢é¢å‚¨å¤‡çŸ¥è¯†</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Nginx</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/https-é…ç½®åŠä¼˜åŒ–/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">HTTPS  é…ç½®åŠä¼˜åŒ–</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-cache/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx Cache</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-php-fpm/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx php-fpm</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-rewrite/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx Rewrite</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-try_files/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx try_files</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-uwsgi-éƒ¨ç½²django/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx - uWSGI éƒ¨ç½²Django</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-å†…ç½®å˜é‡/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx å†…ç½®å˜é‡</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-åå‘ä»£ç†/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx åå‘ä»£ç†</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-å¹³æ»‘å‡çº§ä¸å›æ»š/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx å¹³æ»‘å‡çº§ä¸å›æ»š</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-å¿«é€Ÿé…ç½®æ‰‹å†Œ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx å¿«é€Ÿé…ç½®æ‰‹å†Œ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-æ€§èƒ½ä¼˜åŒ–ä¸å®‰å…¨/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx æ€§èƒ½ä¼˜åŒ–ä¸å®‰å…¨</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-çˆ¬è™«é™åˆ¶/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx çˆ¬è™«é™åˆ¶</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-ç¼–è¯‘åŠåˆ¶ä½œåŒ…/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx ç¼–è¯‘åŠåˆ¶ä½œåŒ…</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-è´Ÿè½½å‡è¡¡/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx è´Ÿè½½å‡è¡¡</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-é«˜çº§æ¨¡å—/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx é«˜çº§æ¨¡å—</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Others</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/others/nodejs-with-ssl-nginx/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Node.js with ssl - nginx</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/others/ä½¿ç”¨logrotateåˆ‡å‰²nginxæ—¥å¿—/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ä½¿ç”¨logrotateåˆ‡å‰²nginxæ—¥å¿—</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/others/æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦æ”¯æŒgzip/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦æ”¯æŒgzip</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Problems</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/problems/rewriteå‚æ•°å¤„ç†é—®é¢˜/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">rewriteå‚æ•°å¤„ç†é—®é¢˜</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">PHP</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/php/php-ä¼˜åŒ–åŠå®‰å…¨é…ç½®/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">PHP ä¼˜åŒ–åŠå®‰å…¨é…ç½®</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Python-Django</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/python-django/access-to-database/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Access to Database</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/python-django/django-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Django Basic</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/windows-useful-cmd/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Windows useful cmd</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/wireguard-vpn-for-ubuntu/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">WireGuard VPN for Ubuntu</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Zabbix</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/zabbix/zabbix-agentæ‰§è¡Œè¿œç¨‹å‘½ä»¤/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Zabbix agentæ‰§è¡Œè¿œç¨‹å‘½ä»¤</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/zabbix/zabbix-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Zabbix Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/zabbix/zabbix-å®‰è£…ä¸­æ–‡åŒ…/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Zabbix å®‰è£…ä¸­æ–‡åŒ…</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/zabbix/zabbix-è¯¦ç»†ä»‹ç»/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Zabbix è¯¦ç»†ä»‹ç»</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/zabbix/zabbix-é’‰é’‰æŠ¥è­¦/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Zabbix é’‰é’‰æŠ¥è­¦</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Zookeeper</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/zookeeper/zookeeper-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Zookeeper Basic</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/è‡ªå»ºdns/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">è‡ªå»ºdns</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/è‡ªå»ºé‚®ç®±æœåŠ¡å™¨/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">è‡ªå»ºé‚®ç®±æœåŠ¡å™¨</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/è“é²¸è¿ç»´å¹³å°/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">è“é²¸è¿ç»´å¹³å°</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">ProgramLang</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/programlang/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">index</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Golang</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-errors-handler/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang Errors - handler</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-file-operate/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang File Operate</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-fmtå ä½ç¬¦/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang fmtå ä½ç¬¦</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-function/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang Function</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-interface/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang Interface</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-json/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang Json</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-package-manage/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang Package manage</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-pkgs/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang Pkgs</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-pointer/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang Pointer</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-project-layout/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang Project Layout</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-testing/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang Testing</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-å¹¶å‘/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang å¹¶å‘</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/gormåŒ…/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">gormåŒ…</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/string-operate/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">String Operate</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Lua</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/programlang/lua/lua-baisc/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Lua Baisc</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/lua/lua-continue-ex/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Lua continue Ex</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Scripts</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/scripts/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">index</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">shell</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/scripts/shell/centos-sys-information/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">CentOS sys information</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/scripts/shell/dokcer-é•œåƒå¤‡ä»½/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Dokcer é•œåƒå¤‡ä»½</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/scripts/shell/nginx-log-check/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx Log Check</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/scripts/shell/redis-tools/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redis tools</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">resort-file-from-csv</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/scripts/shell/resort-file-from-csv/resort-file/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">resort-file</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/scripts/shell/rsync/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Rsync</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/scripts/shell/shell-å¹¶å‘/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Shell å¹¶å‘</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/scripts/shell/æ—¥å¸¸å·¡æ£€shell/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">æ—¥å¸¸å·¡æ£€Shell</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">windows</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/scripts/windows/é€šç”¨ä¿®æ”¹dns/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">é€šç”¨ä¿®æ”¹dns</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Interview</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/interview/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">index</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/pdfé¢è¯•é¢˜é›†åˆ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">PDFé¢è¯•é¢˜é›†åˆ</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">å·¥ä½œé¢è¯•é¢˜</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/interview/å·¥ä½œé¢è¯•é¢˜/dbaæ•°æ®åº“è¿ç»´å·¥ç¨‹å¸ˆ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">DBAæ•°æ®åº“è¿ç»´å·¥ç¨‹å¸ˆ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/å·¥ä½œé¢è¯•é¢˜/devopsé¢è¯•é¢˜/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Devopsé¢è¯•é¢˜</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/å·¥ä½œé¢è¯•é¢˜/dockeré¢è¯•é¢˜/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">dockeré¢è¯•é¢˜</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/å·¥ä½œé¢è¯•é¢˜/esé¢è¯•é¢˜/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">esé¢è¯•é¢˜</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/å·¥ä½œé¢è¯•é¢˜/etcdé¢è¯•é¢˜/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">etcdé¢è¯•é¢˜</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/å·¥ä½œé¢è¯•é¢˜/goè¯­è¨€ç›¸å…³/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Goè¯­è¨€ç›¸å…³</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/å·¥ä½œé¢è¯•é¢˜/goè¯­è¨€ç›¸å…³ç»­-æ–‡ç« æ±‡æ€»/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Goè¯­è¨€ç›¸å…³ï¼ˆç»­-æ–‡ç« æ±‡æ€»ï¼‰</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/å·¥ä½œé¢è¯•é¢˜/k8sé¢è¯•é¢˜æ•´ç†/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">K8sé¢è¯•é¢˜æ•´ç†</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/å·¥ä½œé¢è¯•é¢˜/linuxç›¸å…³çš„æ€§èƒ½ä¼˜åŒ–é¢è¯•é¢˜/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">linuxç›¸å…³çš„æ€§èƒ½ä¼˜åŒ–é¢è¯•é¢˜</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/å·¥ä½œé¢è¯•é¢˜/mysqlé¢è¯•é¢˜/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">mysqlé¢è¯•é¢˜</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/å·¥ä½œé¢è¯•é¢˜/nginxé¢è¯•é¢˜/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">nginxé¢è¯•é¢˜</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/å·¥ä½œé¢è¯•é¢˜/nginxé¢è¯•é¢˜å«ç­”æ¡ˆç»­/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">nginxé¢è¯•é¢˜å«ç­”æ¡ˆï¼ˆç»­ï¼‰</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/å·¥ä½œé¢è¯•é¢˜/redisé¢è¯•é¢˜1/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redisé¢è¯•é¢˜1</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/å·¥ä½œé¢è¯•é¢˜/redisé¢è¯•é¢˜1å«ç­”æ¡ˆç»­/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redisé¢è¯•é¢˜1å«ç­”æ¡ˆï¼ˆç»­ï¼‰</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/å·¥ä½œé¢è¯•é¢˜/redisé¢è¯•é¢˜2/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redisé¢è¯•é¢˜2</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/å·¥ä½œé¢è¯•é¢˜/shellè„šæœ¬ç›¸å…³/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">shellè„šæœ¬ç›¸å…³</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/å·¥ä½œé¢è¯•é¢˜/sreåŸºç¡€å¿…ä¼šæ ¸å¿ƒå®æˆ˜é¢è¯•é¢˜/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">SREåŸºç¡€å¿…ä¼šæ ¸å¿ƒå®æˆ˜é¢è¯•é¢˜</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/å·¥ä½œé¢è¯•é¢˜/sreé«˜çº§è¿ç»´é¢è¯•é¢˜/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">SREé«˜çº§è¿ç»´é¢è¯•é¢˜</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/å·¥ä½œé¢è¯•é¢˜/å…¬å¸äº§å“ä¸Šäº‘æµç¨‹è§„èŒƒ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">å…¬å¸äº§å“ä¸Šäº‘æµç¨‹è§„èŒƒ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/å·¥ä½œé¢è¯•é¢˜/æ—¥å¿—æ”¶é›†efk/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">æ—¥å¿—æ”¶é›†EFK</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/å·¥ä½œé¢è¯•é¢˜/æ¥è‡ªç½‘ç»œ-1/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">æ¥è‡ªç½‘ç»œ-1</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/å·¥ä½œé¢è¯•é¢˜/æ¥è‡ªç¾¤å‹-1/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">æ¥è‡ªç¾¤å‹-1</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/å·¥ä½œé¢è¯•é¢˜/ç³»ç»Ÿè¿ç»´æ•…éšœç›¸å…³/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ç³»ç»Ÿè¿ç»´æ•…éšœç›¸å…³</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/å·¥ä½œé¢è¯•é¢˜/èµ„æ·±è¿ç»´æ¶æ„è®¾è®¡è§„åˆ’/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">èµ„æ·±è¿ç»´æ¶æ„è®¾è®¡è§„åˆ’</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/å·¥ä½œé¢è¯•é¢˜/è¿ç»´å®‰å…¨ç›¸å…³/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">è¿ç»´å®‰å…¨ç›¸å…³</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/å·¥ä½œé¢è¯•é¢˜/è¿ç»´å¿…ä¼šé¢è¯•é¢˜-å¿«é€Ÿçªå‡»/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">è¿ç»´å¿…ä¼šé¢è¯•é¢˜-å¿«é€Ÿçªå‡»</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/å·¥ä½œé¢è¯•é¢˜/è¿ç»´ç›‘æ§ä½“ç³»/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">è¿ç»´ç›‘æ§ä½“ç³»</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/å·¥ä½œé¢è¯•é¢˜/è¿ç»´ç½‘ç»œåŸºç¡€/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">è¿ç»´ç½‘ç»œåŸºç¡€</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/å·¥ä½œé¢è¯•é¢˜/è¿ç»´é¢è¯•è¯æœ¯è‡ªæˆ‘ä»‹ç»/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">è¿ç»´é¢è¯•è¯æœ¯è‡ªæˆ‘ä»‹ç»</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">æ‚é¡¹-è‡ªç”¨</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/interview/æ‚é¡¹-è‡ªç”¨/ä¸´æ—¶2/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ä¸´æ—¶2</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/æ‚é¡¹-è‡ªç”¨/ä¸´æ—¶å¤ä¹ ç”¨å¾ˆä¹±/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ä¸´æ—¶å¤ä¹ ç”¨ï¼ˆå¾ˆä¹±ï¼‰</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/interview/é€‰æ‹©å…¬å¸/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">é€‰æ‹©å…¬å¸</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/é¢è¯•åšæ–‡é“¾æ¥é›†åˆ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">é¢è¯•åšæ–‡é“¾æ¥é›†åˆ</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">WORK</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">AnHeng</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/work/anheng/telegraf/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">telegraf</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/work/anheng/æµæ°´çº¿-å·¥ä½œæµå¼•æ“/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">æµæ°´çº¿ å·¥ä½œæµå¼•æ“</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li> </ul>  <div class="md:sl-hidden"> <div class="mobile-preferences sl-flex astro-wu23bvmt"> <div class="sl-flex social-icons astro-wu23bvmt"> <a href="https://github.com/AGou-ops" rel="me" class="sl-flex astro-wy4te6ga"><span class="sr-only astro-wy4te6ga">GitHub</span><svg aria-hidden="true" class="astro-wy4te6ga astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"/></svg> </a> </div> <starlight-theme-select>  <label style="--sl-select-width: 6.25em" class="astro-4yphtoen"> <span class="sr-only astro-4yphtoen">Select theme</span> <svg aria-hidden="true" class="icon label-icon astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg>  <select value="auto" class="astro-4yphtoen"> <option value="dark" class="astro-4yphtoen">Dark</option><option value="light" class="astro-4yphtoen">Light</option><option value="auto" selected="true" class="astro-4yphtoen">Auto</option> </select> <svg aria-hidden="true" class="icon caret astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </label>  </starlight-theme-select>  <script>
	StarlightThemeProvider.updatePickers();
</script>   </div>  </div> </div> </div> </nav> <div class="main-frame astro-vrdttmbt">  <div class="lg:sl-flex astro-67yu43on"> <aside class="right-sidebar-container astro-67yu43on"> <div class="right-sidebar astro-67yu43on"> <div class="lg:sl-hidden astro-pb3aqygn"><mobile-starlight-toc data-min-h="2" data-max-h="3" class="astro-doynk5tl"><nav aria-labelledby="starlight__on-this-page--mobile" class="astro-doynk5tl"><details id="starlight__mobile-toc" class="astro-doynk5tl"><summary id="starlight__on-this-page--mobile" class="sl-flex astro-doynk5tl"><div class="toggle sl-flex astro-doynk5tl">On this page<svg aria-hidden="true" class="caret astro-doynk5tl astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </div><span class="display-current astro-doynk5tl"></span></summary><div class="dropdown astro-doynk5tl"><ul class="isMobile astro-g2bywc46" style="--depth: 0;"> <li class="astro-g2bywc46" style="--depth: 0;"> <a href="#_top" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Overview</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#ä¸€é¢„å…ˆå‡†å¤‡" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">ä¸€ã€é¢„å…ˆå‡†å¤‡</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#11-æœåŠ¡å™¨è§’è‰²" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">1.1 æœåŠ¡å™¨è§’è‰²</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#12-ç³»ç»Ÿåˆå§‹åŒ–" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">1.2 ç³»ç»Ÿåˆå§‹åŒ–</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#13-hostsè®¾ç½®" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">1.3 hostsè®¾ç½®</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#14-å¯é€‰å®‰è£…supervisor" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">1.4 ï¼ˆå¯é€‰ï¼‰å®‰è£…supervisor</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#äºŒå®‰è£…criå®¹å™¨è¿è¡Œæ—¶åŠharborç§æœ‰ä»“" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">äºŒã€å®‰è£…CRIå®¹å™¨è¿è¡Œæ—¶åŠharborç§æœ‰ä»“</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#21-å®‰è£…containerd" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">2.1 å®‰è£…containerd</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#22-å®‰è£…harborç§æœ‰ä»“" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">2.2 å®‰è£…harborç§æœ‰ä»“</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#ä¸‰ä½¿ç”¨cfsslç”Ÿæˆè¯ä¹¦" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">ä¸‰ã€ä½¿ç”¨cfsslç”Ÿæˆè¯ä¹¦</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#31-å®‰è£…cfssl" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">3.1 å®‰è£…cfssl</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#32-åˆå§‹åŒ–åŠè¯´æ˜" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">3.2 åˆå§‹åŒ–åŠè¯´æ˜</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#å››éƒ¨ç½²masterèŠ‚ç‚¹" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">å››ã€éƒ¨ç½²masterèŠ‚ç‚¹</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#41-éƒ¨ç½²etcdé›†ç¾¤" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.1 éƒ¨ç½²etcdé›†ç¾¤</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#42-éƒ¨ç½²api-server" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.2 éƒ¨ç½²API server</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#43-éƒ¨ç½²controller-manager" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.3 éƒ¨ç½²controller-manager</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#44-éƒ¨ç½²kube-scheduler" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.4 éƒ¨ç½²kube-scheduler</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#45-é…ç½®kubectlæ‰€éœ€è¦çš„kubeconfig" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.5 é…ç½®kubectlæ‰€éœ€è¦çš„kubeconfig</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#46-éƒ¨ç½²nodeç›¸å…³ç»„ä»¶kube-proxykubelet" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.6 éƒ¨ç½²nodeç›¸å…³ç»„ä»¶kube-proxyã€kubelet</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#47-æ£€æŸ¥masterèŠ‚ç‚¹éƒ¨ç½²ç»“æœ" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.7 æ£€æŸ¥masterèŠ‚ç‚¹éƒ¨ç½²ç»“æœ</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#äº”éƒ¨ç½²nodeèŠ‚ç‚¹" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">äº”ã€éƒ¨ç½²nodeèŠ‚ç‚¹</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#51-éƒ¨ç½²kubelet" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">5.1 éƒ¨ç½²kubelet</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#52-éƒ¨ç½²kube-proxy" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">5.2 éƒ¨ç½²kube-proxy</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#53-æ£€æŸ¥nodeèŠ‚ç‚¹éƒ¨ç½²ç»“æœ" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">5.3 æ£€æŸ¥nodeèŠ‚ç‚¹éƒ¨ç½²ç»“æœ</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#å…­å…¶ä»–å¯é€‰ç»„ä»¶å®‰è£…" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">å…­ã€å…¶ä»–å¯é€‰ç»„ä»¶å®‰è£…</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#61-coredns" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">6.1 coredns</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#62-nginx-ingress" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">6.2 nginx ingress</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#63-é¢æ¿" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">6.3 é¢æ¿</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#ä¸ƒæœªå®Œå¾…ç»­" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">ä¸ƒã€æœªå®Œå¾…ç»­</span> </a>  </li> </ul> </div></details></nav></mobile-starlight-toc></div><div class="right-sidebar-panel sl-hidden lg:sl-block astro-pb3aqygn"><div class="sl-container astro-pb3aqygn"><starlight-toc data-min-h="2" data-max-h="3"><nav aria-labelledby="starlight__on-this-page"><h2 id="starlight__on-this-page">On this page</h2><ul class="astro-g2bywc46" style="--depth: 0;"> <li class="astro-g2bywc46" style="--depth: 0;"> <a href="#_top" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Overview</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#ä¸€é¢„å…ˆå‡†å¤‡" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">ä¸€ã€é¢„å…ˆå‡†å¤‡</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#11-æœåŠ¡å™¨è§’è‰²" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">1.1 æœåŠ¡å™¨è§’è‰²</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#12-ç³»ç»Ÿåˆå§‹åŒ–" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">1.2 ç³»ç»Ÿåˆå§‹åŒ–</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#13-hostsè®¾ç½®" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">1.3 hostsè®¾ç½®</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#14-å¯é€‰å®‰è£…supervisor" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">1.4 ï¼ˆå¯é€‰ï¼‰å®‰è£…supervisor</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#äºŒå®‰è£…criå®¹å™¨è¿è¡Œæ—¶åŠharborç§æœ‰ä»“" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">äºŒã€å®‰è£…CRIå®¹å™¨è¿è¡Œæ—¶åŠharborç§æœ‰ä»“</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#21-å®‰è£…containerd" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">2.1 å®‰è£…containerd</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#22-å®‰è£…harborç§æœ‰ä»“" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">2.2 å®‰è£…harborç§æœ‰ä»“</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#ä¸‰ä½¿ç”¨cfsslç”Ÿæˆè¯ä¹¦" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">ä¸‰ã€ä½¿ç”¨cfsslç”Ÿæˆè¯ä¹¦</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#31-å®‰è£…cfssl" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">3.1 å®‰è£…cfssl</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#32-åˆå§‹åŒ–åŠè¯´æ˜" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">3.2 åˆå§‹åŒ–åŠè¯´æ˜</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#å››éƒ¨ç½²masterèŠ‚ç‚¹" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">å››ã€éƒ¨ç½²masterèŠ‚ç‚¹</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#41-éƒ¨ç½²etcdé›†ç¾¤" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.1 éƒ¨ç½²etcdé›†ç¾¤</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#42-éƒ¨ç½²api-server" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.2 éƒ¨ç½²API server</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#43-éƒ¨ç½²controller-manager" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.3 éƒ¨ç½²controller-manager</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#44-éƒ¨ç½²kube-scheduler" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.4 éƒ¨ç½²kube-scheduler</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#45-é…ç½®kubectlæ‰€éœ€è¦çš„kubeconfig" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.5 é…ç½®kubectlæ‰€éœ€è¦çš„kubeconfig</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#46-éƒ¨ç½²nodeç›¸å…³ç»„ä»¶kube-proxykubelet" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.6 éƒ¨ç½²nodeç›¸å…³ç»„ä»¶kube-proxyã€kubelet</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#47-æ£€æŸ¥masterèŠ‚ç‚¹éƒ¨ç½²ç»“æœ" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.7 æ£€æŸ¥masterèŠ‚ç‚¹éƒ¨ç½²ç»“æœ</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#äº”éƒ¨ç½²nodeèŠ‚ç‚¹" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">äº”ã€éƒ¨ç½²nodeèŠ‚ç‚¹</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#51-éƒ¨ç½²kubelet" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">5.1 éƒ¨ç½²kubelet</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#52-éƒ¨ç½²kube-proxy" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">5.2 éƒ¨ç½²kube-proxy</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#53-æ£€æŸ¥nodeèŠ‚ç‚¹éƒ¨ç½²ç»“æœ" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">5.3 æ£€æŸ¥nodeèŠ‚ç‚¹éƒ¨ç½²ç»“æœ</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#å…­å…¶ä»–å¯é€‰ç»„ä»¶å®‰è£…" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">å…­ã€å…¶ä»–å¯é€‰ç»„ä»¶å®‰è£…</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#61-coredns" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">6.1 coredns</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#62-nginx-ingress" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">6.2 nginx ingress</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#63-é¢æ¿" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">6.3 é¢æ¿</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#ä¸ƒæœªå®Œå¾…ç»­" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">ä¸ƒã€æœªå®Œå¾…ç»­</span> </a>  </li> </ul> </nav></starlight-toc></div></div> </div> </aside> <div class="main-pane astro-67yu43on">  <main data-pagefind-body lang="en" dir="ltr" class="astro-bguv2lll">    <div class="content-panel astro-7nkwcw3z"> <div class="sl-container astro-7nkwcw3z"> <h1 id="_top" class="astro-j6tvhyss">k8s Debian12äºŒè¿›åˆ¶å®‰è£…</h1>  </div> </div>  <div class="content-panel astro-7nkwcw3z"> <div class="sl-container astro-7nkwcw3z"> <div class="sl-markdown-content"> <h2 id="ä¸€é¢„å…ˆå‡†å¤‡">ä¸€ã€é¢„å…ˆå‡†å¤‡</h2>
<h3 id="11-æœåŠ¡å™¨è§’è‰²">1.1 æœåŠ¡å™¨è§’è‰²</h3>
<p>ç¯å¢ƒä¿¡æ¯ï¼š</p>
<ul>
<li>k8sç‰ˆæœ¬ï¼šv1.25.12</li>
<li>Debian12(bookworm)ï¼šå†…æ ¸6.1.0-9-amd64</li>
</ul>

























<table><thead><tr><th>è§’è‰²</th><th>IP</th><th>ç»„ä»¶åˆ—è¡¨</th></tr></thead><tbody><tr><td>master</td><td>172.19.82.157</td><td>kube-apiserverã€kube-controller-manageã€kube-schedulerã€kubeletã€kube-proxyã€etcdã€containerd</td></tr><tr><td>node01</td><td>172.19.82.158</td><td>kubeletã€kube-proxyã€containerdã€etcd</td></tr><tr><td>node02</td><td>172.19.82.159</td><td>kubeletã€kube-proxyã€containerdã€etcd</td></tr></tbody></table>
<p>â„¹ç”±äºæ‰‹ä¸Šèµ„æºæœ‰é™ï¼Œæ‰€ä»¥æ­å»ºä¸€ä¸ªä¸€ä¸»ä¸¤ä»çš„é›†ç¾¤ï¼Œå¦‚æœåç»­æƒ³è¦æ‰©å±•çš„è¯ï¼Œä»…éœ€è¦å†æ·»åŠ masteræˆ–è€…nodeèŠ‚ç‚¹å³å¯ï¼Œæ­¤å¤–etcdå¯ä»¥éƒ¨ç½²åˆ°é›†ç¾¤ä¹‹å¤–å¹¶åšé«˜å¯ç”¨ã€‚</p>
<h3 id="12-ç³»ç»Ÿåˆå§‹åŒ–">1.2 ç³»ç»Ÿåˆå§‹åŒ–</h3>
<div class="expressive-code"><link rel="stylesheet" href="/_astro/ec.pjkke.css"><script type="module" src="/_astro/ec.sgewm.js"></script><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># ç¦ç”¨é˜²ç«å¢™</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">systemctl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">stop</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ufw</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">systemctl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">disable</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ufw</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># å…³é—­SELinuxï¼Œæˆ‘è¿™é‡Œcloudintå®‰è£…çš„ç³»ç»Ÿï¼Œæ²¡æœ‰é˜²ç«å¢™å’Œselinux</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">sed</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-i</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">s/enforcing/disabled/</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/selinux/config</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">setenforce</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">0</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># å…³é—­äº¤æ¢åˆ†åŒºswap</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">swap</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-a</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">sed</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-ri</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">s/.*swap.*/#&#x26;/</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/fstab</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># åŒæ­¥æ—¶åŒºä¸æ—¶é—´ï¼Œ**éå¸¸é‡è¦**</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">timedatectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">set-timezone</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Asia/Shanghai</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">ntpdate</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ntp.aliyun.com</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#809191;--1:#616671"># æ²¡æœ‰ntpdateçš„è¯ï¼Œéœ€è¦å®‰è£…ä¸€ä¸‹ï¼Œapt install ntpdate -y</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># é…ç½®ulimitï¼Œæœ€å¤§æ–‡ä»¶æ‰“å¼€æ•°ï¼Œä¼˜åŒ–linuxæ€§èƒ½ï¼Œé‡æ–°é€€å‡ºç™»å½•å½“å‰shellå³å¯ç”Ÿæ•ˆ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ulimit</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-SHn</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">65535</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">cat</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">>></span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/security/limits.conf</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">&#x3C;&#x3C;</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">EOF</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">root soft nofile 65536</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">root hard nofile 131072</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">root soft nproc 65535</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">root hard nproc 655350</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">root soft memlock unlimited</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">root hard memlock unlimited</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D9F5DD;--1:#111111">EOF</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># å®‰è£…ipvs</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">apt</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">install</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ipvsadm</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ipset</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">sysstat</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">conntrack</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-y</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># åŠ è½½</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">modprobe</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ip_vs</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">modprobe</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ip_vs_rr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">modprobe</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ip_vs_wrr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">modprobe</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ip_vs_sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">modprobe</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">nf_conntrack</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># å†™å…¥é…ç½®æ–‡ä»¶æ°¸ä¹…ç”Ÿæ•ˆ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">cat</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">>></span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/modules-load.d/ipvs.conf</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">&#x3C;&#x3C;</span><span style="--0:#D9F5DD;--1:#111111">EOF</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">ip_vs</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">ip_vs_rr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">ip_vs_wrr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">ip_vs_sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">nf_conntrack</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">ip_tables</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">ip_set</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">xt_set</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">ipt_set</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">ipt_rpfilter</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">ipt_REJECT</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">ipip</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D9F5DD;--1:#111111">EOF</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># é‡å¯æœåŠ¡ä»¥åŠ è½½æ¨¡å—</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">systemctl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">restart</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">systemd-modules-load.service</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># æ£€æŸ¥æ¨¡å—æ˜¯å¦åŠ è½½ï¼Œè¿™é‡Œå¯ä»¥rebootä¸€ä¸‹</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">lsmod</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">grep</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-e</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ip_vs</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-e</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">nf_conntrack</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># ä¿®æ”¹å†…æ ¸å‚æ•°ï¼ŒæŒ‰éœ€ä¿®æ”¹å³å¯</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">cat</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">></span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/sysctl.d/k8s.conf</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">&#x3C;&#x3C;</span><span style="--0:#D9F5DD;--1:#111111">EOF</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">net.ipv4.ip_forward = 1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">net.bridge.bridge-nf-call-iptables = 1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">fs.may_detach_mounts = 1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">vm.overcommit_memory=1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">vm.panic_on_oom=0</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">fs.inotify.max_user_watches=89100</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">fs.file-max=52706963</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">fs.nr_open=52706963</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">net.netfilter.nf_conntrack_max=2310720</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">net.ipv4.tcp_keepalive_time = 600</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">net.ipv4.tcp_keepalive_probes = 3</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">net.ipv4.tcp_keepalive_intvl =15</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">net.ipv4.tcp_max_tw_buckets = 36000</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">net.ipv4.tcp_tw_reuse = 1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">net.ipv4.tcp_max_orphans = 327680</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">net.ipv4.tcp_orphan_retries = 3</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">net.ipv4.tcp_syncookies = 1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">net.ipv4.tcp_max_syn_backlog = 16384</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">net.ipv4.ip_conntrack_max = 65536</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">net.ipv4.tcp_max_syn_backlog = 16384</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">net.ipv4.tcp_timestamps = 0</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">net.core.somaxconn = 16384</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">net.ipv6.conf.all.disable_ipv6 = 0</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">net.ipv6.conf.default.disable_ipv6 = 0</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">net.ipv6.conf.lo.disable_ipv6 = 0</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">net.ipv6.conf.all.forwarding = 0</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D9F5DD;--1:#111111">EOF</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># ä½¿å…¶ç”Ÿæ•ˆ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">sysctl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--system</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="systemctl stop ufwsystemctl disable ufwsed -i &#x27;s/enforcing/disabled/&#x27; /etc/selinux/configsetenforce 0swap -ased -ri &#x27;s/.*swap.*/#&#x26;/&#x27; /etc/fstabtimedatectl set-timezone Asia/Shanghaintpdate ntp.aliyun.com    # æ²¡æœ‰ntpdateçš„è¯ï¼Œéœ€è¦å®‰è£…ä¸€ä¸‹ï¼Œapt install ntpdate -yulimit -SHn 65535cat >> /etc/security/limits.conf << EOFroot soft nofile 65536root hard nofile 131072root soft nproc 65535root hard nproc 655350root soft memlock unlimitedroot hard memlock unlimitedEOFapt install ipvsadm ipset sysstat conntrack -ymodprobe -- ip_vsmodprobe -- ip_vs_rrmodprobe -- ip_vs_wrrmodprobe -- ip_vs_shmodprobe -- nf_conntrackcat >> /etc/modules-load.d/ipvs.conf <<EOFip_vsip_vs_rrip_vs_wrrip_vs_shnf_conntrackip_tablesip_setxt_setipt_setipt_rpfilteript_REJECTipipEOFsystemctl restart systemd-modules-load.servicelsmod | grep -e ip_vs -e nf_conntrackcat > /etc/sysctl.d/k8s.conf <<EOFnet.ipv4.ip_forward = 1net.bridge.bridge-nf-call-iptables = 1fs.may_detach_mounts = 1vm.overcommit_memory=1vm.panic_on_oom=0fs.inotify.max_user_watches=89100fs.file-max=52706963fs.nr_open=52706963net.netfilter.nf_conntrack_max=2310720net.ipv4.tcp_keepalive_time = 600net.ipv4.tcp_keepalive_probes = 3net.ipv4.tcp_keepalive_intvl =15net.ipv4.tcp_max_tw_buckets = 36000net.ipv4.tcp_tw_reuse = 1net.ipv4.tcp_max_orphans = 327680net.ipv4.tcp_orphan_retries = 3net.ipv4.tcp_syncookies = 1net.ipv4.tcp_max_syn_backlog = 16384net.ipv4.ip_conntrack_max = 65536net.ipv4.tcp_max_syn_backlog = 16384net.ipv4.tcp_timestamps = 0net.core.somaxconn = 16384net.ipv6.conf.all.disable_ipv6 = 0net.ipv6.conf.default.disable_ipv6 = 0net.ipv6.conf.lo.disable_ipv6 = 0net.ipv6.conf.all.forwarding = 0EOFsysctl --system"><div></div></button></div></figure></div>
<h3 id="13-hostsè®¾ç½®">1.3 hostsè®¾ç½®</h3>
<h4 id="131-é€šè¿‡hostsæ–‡ä»¶é…ç½®">1.3.1 é€šè¿‡hostsæ–‡ä»¶é…ç½®</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">cat</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">>></span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/hosts</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">&#x3C;&#x3C;</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">EOF</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">172.19.82.157 master.k8s.local master</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">172.19.82.158 node01.k8s.local node01</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">172.19.82.159 node02.k8s.local node02</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D9F5DD;--1:#111111">EOF</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># æµ‹è¯•ç½‘ç»œè¿é€š</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">for</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">i</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">in</span><span style="--0:#D6DEEB;--1:#403F53"> master node01 node02; </span><span style="--0:#C792EA;--1:#8D46B4">do</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">ping</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-c</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">$i</span><span style="--0:#D6DEEB;--1:#403F53">; </span><span style="--0:#C792EA;--1:#8D46B4">done</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="cat >> /etc/hosts << EOF172.19.82.157 master.k8s.local master172.19.82.158 node01.k8s.local node01172.19.82.159 node02.k8s.local node02EOFfor i in master node01 node02; do ping -c 2 $i; done"><div></div></button></div></figure></div>
<h4 id="132-ä½¿ç”¨bind9-dnså·¥å…·">1.3.2 ä½¿ç”¨bind9 DNSå·¥å…·</h4>
<p>â„¹ä»…åœ¨ä¸€å°æœºå™¨ä¸Šå®‰è£…bind9å³å¯ï¼Œæˆ‘è¿™é‡Œé€‰æ‹©masterèŠ‚ç‚¹ï¼Œå¦‚æœæœ‰é«˜å¯ç”¨éœ€æ±‚çš„è¯å¯ä»¥å®‰è£…å¤šä¸ªbindåšé›†ç¾¤ã€‚</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># å®‰è£…bind9 DNSå·¥å…·</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">apt</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">install</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">bind9</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">dnsutils</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-y</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="apt install bind9 dnsutils -y"><div></div></button></div></figure></div>
<p>ä¿®æ”¹é…ç½®ï¼š</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/bind/named.conf.options</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># å†…å®¹å¦‚ä¸‹(åˆ æ‰äº†éƒ¨åˆ†æ³¨é‡Š)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">options</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">directory</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">/var/cache/bind</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">//</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">å½“DNSè§£æä¸åˆ°æ—¶ï¼Œè½¬å‘ç»™å…¶ä»–DNSæœåŠ¡å™¨</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">forwarders</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#82AAFF;--1:#3C63B3">8.8.8.8</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">};</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">dnssec-validation</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">auto</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">listen-on-v6</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">any</span><span style="--0:#D6DEEB;--1:#403F53">; };</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">};</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="vim /etc/bind/named.conf.optionsoptions {        directory &#x22;/var/cache/bind&#x22;;        // å½“DNSè§£æä¸åˆ°æ—¶ï¼Œè½¬å‘ç»™å…¶ä»–DNSæœåŠ¡å™¨        forwarders {                8.8.8.8;        };        dnssec-validation auto;        listen-on-v6 { any; };};"><div></div></button></div></figure></div>
<p><img src="https://cdn.agou-ops.cn/others/20230822111122.png" alt="image.png">
é…ç½®è§£æåŸŸä»¥åŠæ¨¡æ¿æ–‡ä»¶ï¼š</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># é…ç½®è§£æåŸŸ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/bind/named.conf.default-zones</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">//</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">æ­£å‘è§£æåŸŸ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">zone</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">k8s.local</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">IN</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C5E478;--1:#3C63B3">type</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">master</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">file</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">/etc/bind/db.k8s.local</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">};</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">//</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">åå‘è§£æåŸŸ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">zone</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">82.19.172.in-addr.zrpa</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">IN</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C5E478;--1:#3C63B3">type</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">master</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">file</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">/etc/bind/db.in-addr.k8s.local</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">};</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># å¤åˆ¶æ¨¡ç‰ˆæ–‡ä»¶</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">cp</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-a</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/bind/db.local</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/bind/db.k8s.local</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">cp</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-a</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/bind/db.127</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/bind/db.in-addr.k8s.local</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># é…ç½®æ­£å‘è§£ææ–‡ä»¶</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/bind/db.k8s.local</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">$TTL</span><span style="--0:#D6DEEB;--1:#403F53">    604800</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">@</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#ECC48D;--1:#3C63B3">IN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#ECC48D;--1:#3C63B3">SOA</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">dns.k8s.local.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">k8s.local.</span><span style="--0:#D6DEEB;--1:#403F53"> (</span></div></div><div class="ec-line"><div class="code"><span class="indent">                              </span><span style="--0:#82AAFF;--1:#3C63B3">2</span><span style="--0:#D6DEEB;--1:#403F53">         ; </span><span style="--0:#82AAFF;--1:#3C63B3">Serial</span></div></div><div class="ec-line"><div class="code"><span class="indent">                         </span><span style="--0:#82AAFF;--1:#3C63B3">604800</span><span style="--0:#D6DEEB;--1:#403F53">         ; </span><span style="--0:#82AAFF;--1:#3C63B3">Refresh</span></div></div><div class="ec-line"><div class="code"><span class="indent">                          </span><span style="--0:#82AAFF;--1:#3C63B3">86400</span><span style="--0:#D6DEEB;--1:#403F53">         ; </span><span style="--0:#82AAFF;--1:#3C63B3">Retry</span></div></div><div class="ec-line"><div class="code"><span class="indent">                        </span><span style="--0:#82AAFF;--1:#3C63B3">2419200</span><span style="--0:#D6DEEB;--1:#403F53">         ; </span><span style="--0:#82AAFF;--1:#3C63B3">Expire</span></div></div><div class="ec-line"><div class="code"><span class="indent">                         </span><span style="--0:#82AAFF;--1:#3C63B3">604800</span><span style="--0:#D6DEEB;--1:#403F53"> )       ; </span><span style="--0:#82AAFF;--1:#3C63B3">Negative</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Cache</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">TTL</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">@</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#ECC48D;--1:#3C63B3">IN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#ECC48D;--1:#3C63B3">NS</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#ECC48D;--1:#3C63B3">dns.k8s.local.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">dns</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">IN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#ECC48D;--1:#3C63B3">A</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#F78C6C;--1:#AA0982">172.19</span><span style="--0:#ECC48D;--1:#3C63B3">.82.157</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">master</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#ECC48D;--1:#3C63B3">IN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#ECC48D;--1:#3C63B3">A</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#F78C6C;--1:#AA0982">172.19</span><span style="--0:#ECC48D;--1:#3C63B3">.82.157</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">node01</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#ECC48D;--1:#3C63B3">IN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#ECC48D;--1:#3C63B3">A</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#F78C6C;--1:#AA0982">172.19</span><span style="--0:#ECC48D;--1:#3C63B3">.82.158</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">node02</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#ECC48D;--1:#3C63B3">IN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#ECC48D;--1:#3C63B3">A</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#F78C6C;--1:#AA0982">172.19</span><span style="--0:#ECC48D;--1:#3C63B3">.82.159</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># é…ç½®åå‘è§£ææ–‡ä»¶</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/bind/db.in-addr.k8s.local</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">$TTL</span><span style="--0:#D6DEEB;--1:#403F53">    604800</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">@</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#ECC48D;--1:#3C63B3">IN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#ECC48D;--1:#3C63B3">SOA</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">dns.k8s.local.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">k8s.local.</span><span style="--0:#D6DEEB;--1:#403F53"> (</span></div></div><div class="ec-line"><div class="code"><span class="indent">                              </span><span style="--0:#82AAFF;--1:#3C63B3">1</span><span style="--0:#D6DEEB;--1:#403F53">         ; </span><span style="--0:#82AAFF;--1:#3C63B3">Serial</span></div></div><div class="ec-line"><div class="code"><span class="indent">                         </span><span style="--0:#82AAFF;--1:#3C63B3">604800</span><span style="--0:#D6DEEB;--1:#403F53">         ; </span><span style="--0:#82AAFF;--1:#3C63B3">Refresh</span></div></div><div class="ec-line"><div class="code"><span class="indent">                          </span><span style="--0:#82AAFF;--1:#3C63B3">86400</span><span style="--0:#D6DEEB;--1:#403F53">         ; </span><span style="--0:#82AAFF;--1:#3C63B3">Retry</span></div></div><div class="ec-line"><div class="code"><span class="indent">                        </span><span style="--0:#82AAFF;--1:#3C63B3">2419200</span><span style="--0:#D6DEEB;--1:#403F53">         ; </span><span style="--0:#82AAFF;--1:#3C63B3">Expire</span></div></div><div class="ec-line"><div class="code"><span class="indent">                         </span><span style="--0:#82AAFF;--1:#3C63B3">604800</span><span style="--0:#D6DEEB;--1:#403F53"> )       ; </span><span style="--0:#82AAFF;--1:#3C63B3">Negative</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Cache</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">TTL</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">@</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#ECC48D;--1:#3C63B3">IN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#ECC48D;--1:#3C63B3">NS</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#ECC48D;--1:#3C63B3">dns.k8s.local.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">157</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">IN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#ECC48D;--1:#3C63B3">PTR</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">k8s.local.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">157</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">IN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#ECC48D;--1:#3C63B3">PTR</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">master.k8s.local.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">158</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">IN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#ECC48D;--1:#3C63B3">PTR</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">node01.k8s.local.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">159</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">IN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#ECC48D;--1:#3C63B3">PTR</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">node02.k8s.local.</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="vim /etc/bind/named.conf.default-zones// æ­£å‘è§£æåŸŸzone &#x22;k8s.local&#x22; IN {        type master;        file &#x22;/etc/bind/db.k8s.local&#x22;;};// åå‘è§£æåŸŸzone &#x22;82.19.172.in-addr.zrpa&#x22; IN {        type master;        file &#x22;/etc/bind/db.in-addr.k8s.local&#x22;;};cp -a /etc/bind/db.local /etc/bind/db.k8s.localcp -a /etc/bind/db.127 /etc/bind/db.in-addr.k8s.localvim /etc/bind/db.k8s.local$TTL    604800@       IN      SOA     dns.k8s.local. k8s.local. (                              2         ; Serial                         604800         ; Refresh                          86400         ; Retry                        2419200         ; Expire                         604800 )       ; Negative Cache TTL;@       IN      NS      dns.k8s.local.dns     IN      A       172.19.82.157master  IN      A       172.19.82.157node01  IN      A       172.19.82.158node02  IN      A       172.19.82.159vim /etc/bind/db.in-addr.k8s.local$TTL    604800@       IN      SOA     dns.k8s.local. k8s.local. (                              1         ; Serial                         604800         ; Refresh                          86400         ; Retry                        2419200         ; Expire                         604800 )       ; Negative Cache TTL;@       IN      NS      dns.k8s.local.157     IN      PTR     k8s.local.157     IN      PTR     master.k8s.local.158     IN      PTR     node01.k8s.local.159     IN      PTR     node02.k8s.local."><div></div></button></div></figure></div>
<p>é‡å¯æœåŠ¡åŠæµ‹è¯•ï¼š</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">systemctl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">restart</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">bind9</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># ä¿®æ”¹ä¸»æœºçš„é¦–é€‰DNSåœ°å€ä¸º172.19.82.157</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">cat</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/resolv.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">nameserver</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">172.19</span><span style="--0:#ECC48D;--1:#3C63B3">.82.157</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">nameserver</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">8.8</span><span style="--0:#ECC48D;--1:#3C63B3">.8.8</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># æµ‹è¯•</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">for</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">i</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">in</span><span style="--0:#D6DEEB;--1:#403F53"> master node01 node02; </span><span style="--0:#C792EA;--1:#8D46B4">do</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">dig</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">+short</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">$i</span><span style="--0:#ECC48D;--1:#3C63B3">.k8s.local</span><span style="--0:#D6DEEB;--1:#403F53">; </span><span style="--0:#C792EA;--1:#8D46B4">done</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># åº”å½“è¾“å‡ºï¼Œæˆªå›¾å¦‚ä¸‹</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">172.19.82.157</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">172.19.82.158</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">172.19.82.159</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="systemctl restart bind9cat /etc/resolv.confnameserver 172.19.82.157nameserver 8.8.8.8for i in master node01 node02; do dig +short $i.k8s.local; done172.19.82.157172.19.82.158172.19.82.159"><div></div></button></div></figure></div>
<p><img src="https://cdn.agou-ops.cn/others/20230822114543.png" alt="image.png"></p>
<h3 id="14-å¯é€‰å®‰è£…supervisor">1.4 ï¼ˆå¯é€‰ï¼‰å®‰è£…supervisor</h3>
<p>å®‰è£…supervisorç®€å•å®ç°æœåŠ¡â€œé«˜å¯ç”¨â€.
â„¹éå¿…é¡»ï¼Œä½¿ç”¨systemdæ¥ç®¡ç†ä¹Ÿå¯ä»¥.</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#82AAFF;--1:#3C63B3">apt</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">install</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">supervisor</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-y</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#809191;--1:#616671"># è®¾ç½®ä¸ºå¼€æœºè‡ªå¯ï¼Œå¹¶å¯åŠ¨</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#82AAFF;--1:#3C63B3">systemctl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">enable</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">supervisor</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--now</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="apt install supervisor -y systemctl enable supervisor --now"><div></div></button></div></figure></div>
<h2 id="äºŒå®‰è£…criå®¹å™¨è¿è¡Œæ—¶åŠharborç§æœ‰ä»“">äºŒã€å®‰è£…CRIå®¹å™¨è¿è¡Œæ—¶åŠharborç§æœ‰ä»“</h2>
<h3 id="21-å®‰è£…containerd">2.1 å®‰è£…containerd</h3>
<p>å®‰è£…æ–¹å¼æœ‰å¥½å‡ ç§ï¼ŒäºŒè¿›åˆ¶å®‰è£…ï¼Œä»“åº“å®‰è£…ä»¥åŠç¼–è¯‘å®‰è£…ã€‚</p>
<p>è¿™é‡Œæˆ‘ä½¿ç”¨äºŒè¿›åˆ¶è¿›è¡Œå®‰è£…ï¼Œä»“åº“å®‰è£…å‚è€ƒï¼š<a href="https://github.com/containerd/containerd/blob/main/docs/getting-started.md#option-2-from-apt-get-or-dnf">https://github.com/containerd/containerd/blob/main/docs/getting-started.md#option-2-from-apt-get-or-dnf</a>
ğŸ˜„ letâ€™s go~</p>
<h4 id="211-æ­¥éª¤ä¸€å®‰è£…containerd">2.1.1 æ­¥éª¤ä¸€å®‰è£…containerd</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># ä»https://github.com/containerd/containerd/releasesï¼Œä¸‹è½½containerdçš„äºŒè¿›åˆ¶åŒ…ï¼Œæ³¨æ„è½¯ä»¶åŒ…æ¶æ„.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">wget</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">https://github.com/containerd/containerd/releases/download/v1.6.23/containerd-1.6.23-linux-amd64.tar.gz</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tar</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Cxzvf</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">containerd-1.6.23-linux-amd64.tar.gz</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># å®‰è£…serviceæœåŠ¡</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">wget</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-O</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/lib/systemd/system/containerd.service</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">https://raw.githubusercontent.com/containerd/containerd/main/containerd.service</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># é‡è½½å¹¶å¯åŠ¨æœåŠ¡ï¼Œè®¾ç½®ä¸ºå¼€æœºè‡ªå¯åŠ¨</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">systemctl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">daemon-reload</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">systemctl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">enable</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">containerd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--now</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="wget https://github.com/containerd/containerd/releases/download/v1.6.23/containerd-1.6.23-linux-amd64.tar.gztar Cxzvf /usr/local containerd-1.6.23-linux-amd64.tar.gzwget -O /lib/systemd/system/containerd.service https://raw.githubusercontent.com/containerd/containerd/main/containerd.servicesystemctl daemon-reloadsystemctl enable containerd --now"><div></div></button></div></figure></div>
<p><img src="https://cdn.agou-ops.cn/others/20230822131441.png" alt="image.png"></p>
<h4 id="212-æ­¥éª¤äºŒå®‰è£…runc">2.1.2 æ­¥éª¤äºŒå®‰è£…runC</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#82AAFF;--1:#3C63B3">wget</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">https://github.com/opencontainers/runc/releases/download/v1.1.9/runc.amd64</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">install</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-m</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">755</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">runc.amd64</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/sbin/runc</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="wget https://github.com/opencontainers/runc/releases/download/v1.1.9/runc.amd64install -m 755 runc.amd64 /usr/local/sbin/runc"><div></div></button></div></figure></div>
<h4 id="213-æ­¥éª¤ä¸‰å®‰è£…cniæ’ä»¶">2.1.3 æ­¥éª¤ä¸‰å®‰è£…CNIæ’ä»¶</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">wget</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">https://github.com/containernetworking/plugins/releases/download/v1.3.0/cni-plugins-linux-amd64-v1.3.0.tgz</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># tar Cxzvf /usr/local/bin cni-plugins-linux-amd64-v1.3.0.tgz</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tar</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Cxzvf</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/opt/cni/bin</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">cni-plugins-linux-amd64-v1.3.0.tgz</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="wget https://github.com/containernetworking/plugins/releases/download/v1.3.0/cni-plugins-linux-amd64-v1.3.0.tgztar Cxzvf /opt/cni/bin cni-plugins-linux-amd64-v1.3.0.tgz"><div></div></button></div></figure></div>
<h4 id="214-é…ç½®containerdä½¿ç”¨systemd-cgroupé©±åŠ¨">2.1.4 é…ç½®containerdä½¿ç”¨systemd cgroupé©±åŠ¨</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># ç”Ÿæˆé»˜è®¤çš„é…ç½®æ–‡ä»¶</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">containerd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">config</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">default</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">tee</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/containerd/config.toml</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="containerd config default | tee /etc/containerd/config.toml"><div></div></button></div></figure></div>
<p><img src="https://cdn.agou-ops.cn/others/20230822132245.png" alt="image.png">
å¤§æ¦‚ç¬¬125è¡Œï¼Œä¿®æ”¹   <code dir="auto">SystemdCgroup</code> ä¸º<code dir="auto">true</code>.</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/containerd/config.toml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># ä¿®æ”¹é»˜è®¤çš„pauseå®¹å™¨é•œåƒåœ°å€ä¸ºé˜¿é‡Œäº‘å›½å†…æº</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">sandbox_image</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">registry.cn-hangzhou.aliyuncs.com/google_containers/pause:3.9</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="vim /etc/containerd/config.tomlsandbox_image = &#x22;registry.cn-hangzhou.aliyuncs.com/google_containers/pause:3.9&#x22;"><div></div></button></div></figure></div>
<p><img src="https://cdn.agou-ops.cn/others/20230822132616.png" alt="image.png">
å¤§æ¦‚ç¬¬61è¡Œã€‚
ä¿®æ”¹å®Œä¿å­˜ä¹‹åï¼Œé‡å¯<code dir="auto">systemctl restart containerd</code>.
æ£€æŸ¥è¿è¡ŒçŠ¶æ€ï¼š
<img src="https://cdn.agou-ops.cn/others/20230822132807.png" alt="image.png"></p>
<h4 id="215-å®‰è£…crictlå®¢æˆ·ç«¯å·¥å…·">2.1.5 å®‰è£…crictlå®¢æˆ·ç«¯å·¥å…·</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">wget</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">https://github.com/kubernetes-sigs/cri-tools/releases/download/v1.28.0/crictl-v1.28.0-linux-amd64.tar.gz</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tar</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">xf</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">crictl-v1.28.0-linux-amd64.tar.gz</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-C</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/bin</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># ç¼–å†™é»˜è®¤é…ç½®æ–‡ä»¶ï¼Œæ–¹ä¾¿å®¢æˆ·ç«¯ä½¿ç”¨</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">bash</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-c</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">cat > /etc/crictl.yaml</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#7FDBCA;--1:#097174">&#x3C;&#x3C;</span><span style="--0:#D9F5DD;--1:#111111">EOF</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">runtime-endpoint: unix:///run/containerd/containerd.sock</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">image-endpoint: unix:///run/containerd/containerd.sock</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">timeout: 10</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">debug: false</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D9F5DD;--1:#111111">EOF</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="wget https://github.com/kubernetes-sigs/cri-tools/releases/download/v1.28.0/crictl-v1.28.0-linux-amd64.tar.gztar xf crictl-v1.28.0-linux-amd64.tar.gz -C /usr/local/binbash -c &#x22;cat > /etc/crictl.yaml&#x22;  <<EOFruntime-endpoint: unix:///run/containerd/containerd.sockimage-endpoint: unix:///run/containerd/containerd.socktimeout: 10debug: falseEOF"><div></div></button></div></figure></div>
<p>æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ<code dir="auto">crictl ps</code>
<img src="https://cdn.agou-ops.cn/others/20230822133349.png" alt="image.png"></p>
<h3 id="22-å®‰è£…harborç§æœ‰ä»“">2.2 å®‰è£…harborç§æœ‰ä»“</h3>
<p>harborå»ºè®®éƒ¨ç½²åœ¨å…¶ä»–ä¸»æœºä¸Šï¼Œæ¯”å¦‚è¯´ä¸»æ§æœºï¼Œä¸k8sé›†ç¾¤åˆ†å‰²å¼€æ¥ï¼Œè¿™ä¸ªéšä¾¿ï¼Œçœ‹ä½ è‡ªå·±ã€‚</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># ä¸‹è½½ç¦»çº¿å®‰è£…åŒ…</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">wget</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">https://github.com/goharbor/harbor/releases/download/v2.8.4/harbor-offline-installer-v2.8.4.tgz</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tar</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">xzvf</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">harbor-offline-installer-v2.8.4.tgz</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># è¿è¡Œå®‰è£…ç¨‹åºå³å¯</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">sudo</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">./install.sh</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="wget https://github.com/goharbor/harbor/releases/download/v2.8.4/harbor-offline-installer-v2.8.4.tgztar xzvf harbor-offline-installer-v2.8.4.tgzsudo ./install.sh"><div></div></button></div></figure></div>
<p>åç»­æ­¥éª¤ç•¥.</p>
<h2 id="ä¸‰ä½¿ç”¨cfsslç”Ÿæˆè¯ä¹¦">ä¸‰ã€ä½¿ç”¨cfsslç”Ÿæˆè¯ä¹¦</h2>
<h3 id="31-å®‰è£…cfssl">3.1 å®‰è£…cfssl</h3>
<p>â„¹åœ¨masterèŠ‚ç‚¹æˆ–è€…ä¸»æ§æœºï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ä¸Šå®‰è£…cfsslå³å¯ï¼Œå…¶ä»–ä¸»æœºä¸éœ€è¦ã€‚</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">wget</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">https://github.com/cloudflare/cfssl/releases/download/v1.6.4/cfssl_1.6.4_linux_amd64</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">wget</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">https://github.com/cloudflare/cfssl/releases/download/v1.6.4/cfssljson_1.6.4_linux_amd64</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">wget</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">https://github.com/cloudflare/cfssl/releases/download/v1.6.4/cfssl-certinfo_1.6.4_linux_amd64</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">install</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-m</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">755</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">cfssl_1.6.4_linux_amd64</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/bin/cfssl</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">install</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-m</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">755</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">cfssljson_1.6.4_linux_amd64</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/bin/cfssl-json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">install</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-m</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">755</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">cfssl-certinfo_1.6.4_linux_amd64</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/bin/cfssl-certinfo</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="wget https://github.com/cloudflare/cfssl/releases/download/v1.6.4/cfssl_1.6.4_linux_amd64wget https://github.com/cloudflare/cfssl/releases/download/v1.6.4/cfssljson_1.6.4_linux_amd64wget https://github.com/cloudflare/cfssl/releases/download/v1.6.4/cfssl-certinfo_1.6.4_linux_amd64install -m 755 cfssl_1.6.4_linux_amd64 /usr/local/bin/cfsslinstall -m 755 cfssljson_1.6.4_linux_amd64 /usr/local/bin/cfssl-jsoninstall -m 755 cfssl-certinfo_1.6.4_linux_amd64 /usr/local/bin/cfssl-certinfo"><div></div></button></div></figure></div>
<p>æ£€æŸ¥å®‰è£…ï¼š
<img src="https://cdn.agou-ops.cn/others/20230822134549.png" alt="image.png"></p>
<h3 id="32-åˆå§‹åŒ–åŠè¯´æ˜">3.2 åˆå§‹åŒ–åŠè¯´æ˜</h3>
<p>åˆ›å»ºk8sé›†ç¾¤åŠetcdæ‰€éœ€è¦çš„è¯ä¹¦ç›®å½•ï¼š</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># ä¸‹é¢ä¸€ä¸ªå‘½ä»¤ä¸‰ä¸ªä¸»æœºéƒ½æ‰§è¡Œä¸€ä¸‹ã€‚</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">mkdir</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-pv</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/TLS/{etcd,k8s}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="mkdir -pv /etc/kubernetes/TLS/{etcd,k8s}"><div></div></button></div></figure></div>
<p>è¯´æ˜ï¼šä¸€å…±åˆ›å»ºäº†ä¸‰ä¸ªCAï¼Œåˆ†åˆ«ç”¨äºï¼š</p>
<ul>
<li>etcdé›†ç¾¤</li>
<li>apiserverã€controller managerã€kubeletã€kube-schedulerç­‰</li>
<li>front-proxy</li>
</ul>
<h2 id="å››éƒ¨ç½²masterèŠ‚ç‚¹">å››ã€éƒ¨ç½²masterèŠ‚ç‚¹</h2>
<h3 id="41-éƒ¨ç½²etcdé›†ç¾¤">4.1 éƒ¨ç½²etcdé›†ç¾¤</h3>
<h4 id="411-ä¸‹è½½å®‰è£…etcdå’ŒetcdctläºŒè¿›åˆ¶æ–‡ä»¶">4.1.1 ä¸‹è½½å®‰è£…etcdå’ŒetcdctläºŒè¿›åˆ¶æ–‡ä»¶</h4>
<p>æˆ‘ä»¬éœ€è¦åœ¨157ï¼Œ158å’Œ159ä¸‰å°æœºå™¨ä¸­éƒ½è£…ä¸Šetcdï¼Œä»¥ç»„æˆetcdé›†ç¾¤ï¼Œä¿è¯etcdçš„é«˜å¯ç”¨ã€‚</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># 157ï¼Œ158ï¼Œ159æœºå™¨ä¸Šï¼Œä¹Ÿå°±æ˜¯masterå’Œnode01ã€node02èŠ‚ç‚¹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># åˆ›å»ºetcdç”¨æˆ·</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">useradd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-s</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/sbin/nologin</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-M</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">etcd</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">wget</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">https://github.com/etcd-io/etcd/releases/download/v3.4.27/etcd-v3.4.27-linux-amd64.tar.gz</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tar</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">xf</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">etcd-v3.4.27-linux-amd64.tar.gz</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-C</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">mv</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/etcd-v3.4.27-linux-amd64</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/etcd-v3.4.27</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># åˆ›å»ºè½¯è¿æ¥æ–¹ä¾¿ä½¿ç”¨</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">ln</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-sv</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/etcd-v3.4.27/etcd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/bin</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">ln</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-sv</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/etcd-v3.4.27/etcdctl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/bin</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="useradd -s /sbin/nologin -M etcdwget https://github.com/etcd-io/etcd/releases/download/v3.4.27/etcd-v3.4.27-linux-amd64.tar.gztar xf etcd-v3.4.27-linux-amd64.tar.gz -C /usr/localmv /usr/local/etcd-v3.4.27-linux-amd64 /usr/local/etcd-v3.4.27ln -sv /usr/local/etcd-v3.4.27/etcd /usr/local/binln -sv /usr/local/etcd-v3.4.27/etcdctl /usr/local/bin"><div></div></button></div></figure></div>
<p>æ£€æŸ¥etcdå®‰è£…ç»“æœï¼š
<img src="https://cdn.agou-ops.cn/others/20230822141125.png" alt="image.png"></p>
<h4 id="412-ä¸ºetcdåˆ¶ä½œè¯ä¹¦">4.1.2 ä¸ºetcdåˆ¶ä½œè¯ä¹¦</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># ä»…åœ¨masterä¸»æœºä¸Šæ‰§è¡Œ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">cd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/TLS/etcd</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca-config.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"signing"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"default"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"expiry"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">87600h</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">},</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"profiles"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"etcd"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">         </span><span style="--0:#82AAFF;--1:#3C63B3">"expiry"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">87600h</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">         </span><span style="--0:#82AAFF;--1:#3C63B3">"usages"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"signing"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"key encipherment"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"server auth"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"client auth"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">]</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"CN"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">etcd CA</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"key"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"algo"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">rsa</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"size"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">2048</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">},</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"names"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"C"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">CN</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"L"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">HangZhou</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"ST"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">ZheJiang</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">cfssl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">gencert</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-initca</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca-csr.json</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">cfssl-json</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-bare</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># æ£€æŸ¥caç”Ÿæˆç»“æœï¼Œè§ä¸‹å›¾</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">cd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/TLS/etcd</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># å°†å¯èƒ½ç”¨åˆ°çš„IPåŠ åˆ°hostså­—æ®µé‡Œé¢ã€‚</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">etcd-server-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"CN"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">etcd</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"hosts"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"172.19.82.157"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"172.19.82.158"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"172.19.82.159"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"192.168.3.28"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"127.0.0.1"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"10.96.0.1"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">],</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"key"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"algo"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">rsa</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"size"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">2048</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">},</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"names"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"C"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">CN</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"L"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">HangZhou</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"ST"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">ZheJiang</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># ä½¿ç”¨ä¸Šé¢çš„è‡ªç­¾CAç­¾å‘etcdè¯ä¹¦</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">cfssl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">gencert</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-ca=ca.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-ca-key=ca-key.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-config=ca-config.json</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-profile=etcd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">etcd-server-csr.json</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">cfssl-json</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-bare</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">etcd-server</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="cd /etc/kubernetes/TLS/etcdvim ca-config.json{  &#x22;signing&#x22;: {    &#x22;default&#x22;: {      &#x22;expiry&#x22;: &#x22;87600h&#x22;    },    &#x22;profiles&#x22;: {      &#x22;etcd&#x22;: {         &#x22;expiry&#x22;: &#x22;87600h&#x22;,         &#x22;usages&#x22;: [            &#x22;signing&#x22;,            &#x22;key encipherment&#x22;,            &#x22;server auth&#x22;,            &#x22;client auth&#x22;        ]      }    }  }}vim ca-csr.json{    &#x22;CN&#x22;: &#x22;etcd CA&#x22;,    &#x22;key&#x22;: {        &#x22;algo&#x22;: &#x22;rsa&#x22;,        &#x22;size&#x22;: 2048    },    &#x22;names&#x22;: [        {            &#x22;C&#x22;: &#x22;CN&#x22;,            &#x22;L&#x22;: &#x22;HangZhou&#x22;,            &#x22;ST&#x22;: &#x22;ZheJiang&#x22;        }    ]}cfssl gencert -initca ca-csr.json | cfssl-json -bare cacd /etc/kubernetes/TLS/etcdvim etcd-server-csr.json{    &#x22;CN&#x22;: &#x22;etcd&#x22;,    &#x22;hosts&#x22;: [        &#x22;172.19.82.157&#x22;,        &#x22;172.19.82.158&#x22;,        &#x22;172.19.82.159&#x22;,        &#x22;192.168.3.28&#x22;,        &#x22;127.0.0.1&#x22;,        &#x22;10.96.0.1&#x22;    ],    &#x22;key&#x22;: {        &#x22;algo&#x22;: &#x22;rsa&#x22;,        &#x22;size&#x22;: 2048    },    &#x22;names&#x22;: [        {            &#x22;C&#x22;: &#x22;CN&#x22;,            &#x22;L&#x22;: &#x22;HangZhou&#x22;,            &#x22;ST&#x22;: &#x22;ZheJiang&#x22;        }    ]}cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=etcd etcd-server-csr.json | cfssl-json -bare etcd-server"><div></div></button></div></figure></div>
<p>é…ç½®æ–‡ä»¶å­—æ®µè§£é‡Šï¼š</p>
<blockquote>
<ul>
<li>CNï¼šCommon Nameï¼Œæµè§ˆå™¨ä½¿ç”¨è¯¥å­—æ®µéªŒè¯ç½‘å€æ˜¯å¦åˆæ³•ï¼Œä¸€èˆ¬å†™åŸŸåï¼Œéå¸¸é‡è¦</li>
<li>STï¼šStateï¼Œçœ</li>
<li>Lï¼šLocalityï¼Œåœ°åŒº</li>
<li>Oï¼šOrganization Nameï¼Œç»„ç»‡åç§°</li>
<li>OUï¼šOrganization Unit Nameï¼Œç»„ç»‡å•ä½åç§°</li>
</ul>
</blockquote>
<p>æ£€æŸ¥CAç”Ÿæˆç»“æœï¼š
<img src="https://cdn.agou-ops.cn/others/20230823104905.png" alt="image.png"></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">ca-config.jsonè§£æï¼š</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="ca-config.jsonè§£æï¼š"><div></div></button></div></figure></div>
<blockquote>
<p>expiryï¼šæœ‰æ•ˆæœŸä¸º200å¹´
profiles-serverï¼šå¯åŠ¨serverçš„æ—¶å€™éœ€è¦é…ç½®è¯ä¹¦
profiles-clientï¼šclientå»è¿æ¥serverçš„æ—¶å€™éœ€è¦è¯ä¹¦
profiles-peerï¼šåŒå‘è¯ä¹¦ï¼ŒæœåŠ¡ç«¯æ‰¾å®¢æˆ·ç«¯éœ€è¦è¯ä¹¦ï¼Œå®¢æˆ·ç«¯æ‰¾æœåŠ¡ç«¯éœ€è¦è¯ä¹¦
etcd-peer-csrè§£æï¼š</p>
<p>hostsï¼šetcdæœ‰å¯èƒ½éƒ¨ç½²åˆ°å“ªäº›ç»„ä»¶çš„IPéƒ½è¦å¡«è¿›æ¥
cfssl gencertï¼šç”Ÿæˆè¯ä¹¦
<img src="https://cdn.agou-ops.cn/others/20230823105545.png" alt="image.png"></p>
</blockquote>
<h4 id="413-é…ç½®åŠå¯åŠ¨etcdé›†ç¾¤">4.1.3 é…ç½®åŠå¯åŠ¨etcdé›†ç¾¤</h4>
<p>å¤åˆ¶è¯ä¹¦æ–‡ä»¶ï¼š</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># å¤åˆ¶3.3ä¸­ç”Ÿæˆçš„è¯ä¹¦åˆ°certsç›®å½•ï¼Œæ³¨æ„ï¼Œä¸‰ä¸ªä¸»æœºéƒ½è¦æ‰§è¡Œ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># node01ï¼Œè‡ªå·±åšå…å¯†å“¦ï¼Œè¿™é‡Œå°±ä¸æ•™äº†ã€‚</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">scp</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-r</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">master:/etc/kubernetes/TLS/etcd/</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#ECC48D;--1:#3C63B3">.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/TLS/etcd</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># node02</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">scp</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-r</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">master:/etc/kubernetes/TLS/etcd/</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#ECC48D;--1:#3C63B3">.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/TLS/etcd</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="scp -r master:/etc/kubernetes/TLS/etcd/*.pem /etc/kubernetes/TLS/etcdscp -r master:/etc/kubernetes/TLS/etcd/*.pem /etc/kubernetes/TLS/etcd"><div></div></button></div></figure></div>
<p>ç¼–å†™å¯åŠ¨è„šæœ¬ï¼š
âš æ³¨æ„ä»¥ä¸‹è„šæœ¬ä¸­ï¼Œnode01ï¼ˆ158ï¼‰ï¼Œnode02ï¼ˆ159ï¼‰ä¸»æœºä¸Šéƒ½è¦ä¿®æ”¹å¯¹åº”çš„ç›‘å¬åœ°å€ï¼Œä¸èƒ½ç…§æ¬.
éœ€è¦ä¿®æ”¹çš„åœ°æ–¹æœ‰ä»¥ä¸‹äº”å¤„ï¼š</p>
<ul>
<li><code dir="auto">--name</code></li>
<li><code dir="auto">--advertise-client-urls </code></li>
<li><code dir="auto">--initial-advertise-peer-urls</code></li>
<li><code dir="auto">--listen-peer-urls</code></li>
<li><code dir="auto">--listen-client-urls</code></li>
</ul>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># åœ¨157 masterä¸»æœºä¸Š</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/etcd-v3.4.27/etcd-startup.sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#!/usr/bin/env sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">./etcd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--name=etcd-server-157</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--advertise-client-urls=https://172.19.82.157:2379</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--cert-file=/etc/kubernetes/TLS/etcd/etcd-server.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--client-cert-auth=true</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--data-dir=/data/etcd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--experimental-initial-corrupt-check=true</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--experimental-watch-progress-notify-interval=5s</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--initial-advertise-peer-urls=https://172.19.82.157:2380</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--initial-cluster=etcd-server-157=https://172.19.82.157:2380,etcd-server-158=https://172.19.82.158:2380,etcd-server-159=https://172.19.82.159:2380</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--key-file=/etc/kubernetes/TLS/etcd/etcd-server-key.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--listen-client-urls=https://127.0.0.1:2379,https://172.19.82.157:2379</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--listen-metrics-urls=http://127.0.0.1:2381</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--listen-peer-urls=https://172.19.82.157:2380</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--peer-cert-file=/etc/kubernetes/TLS/etcd/etcd-server.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--peer-client-cert-auth=true</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--peer-key-file=/etc/kubernetes/TLS/etcd/etcd-server-key.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--peer-trusted-ca-file=/etc/kubernetes/TLS/etcd/ca.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--snapshot-count=10000</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--trusted-ca-file=/etc/kubernetes/TLS/etcd/ca.pem</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="# åœ¨157 masterä¸»æœºä¸Švim /usr/local/etcd-v3.4.27/etcd-startup.sh#!/usr/bin/env sh./etcd --name=etcd-server-157 \  --advertise-client-urls=https://172.19.82.157:2379 \  --cert-file=/etc/kubernetes/TLS/etcd/etcd-server.pem \  --client-cert-auth=true \  --data-dir=/data/etcd \  --experimental-initial-corrupt-check=true \  --experimental-watch-progress-notify-interval=5s \  --initial-advertise-peer-urls=https://172.19.82.157:2380 \  --initial-cluster=etcd-server-157=https://172.19.82.157:2380,etcd-server-158=https://172.19.82.158:2380,etcd-server-159=https://172.19.82.159:2380 \  --key-file=/etc/kubernetes/TLS/etcd/etcd-server-key.pem \  --listen-client-urls=https://127.0.0.1:2379,https://172.19.82.157:2379 \  --listen-metrics-urls=http://127.0.0.1:2381 \  --listen-peer-urls=https://172.19.82.157:2380 \  --peer-cert-file=/etc/kubernetes/TLS/etcd/etcd-server.pem \  --peer-client-cert-auth=true \  --peer-key-file=/etc/kubernetes/TLS/etcd/etcd-server-key.pem \  --peer-trusted-ca-file=/etc/kubernetes/TLS/etcd/ca.pem \  --snapshot-count=10000 \  --trusted-ca-file=/etc/kubernetes/TLS/etcd/ca.pem"><div></div></button></div></figure></div>
<p><img src="https://cdn.agou-ops.cn/others/20230823111335.png" alt="image.png">
ä¿®æ”¹è„šæœ¬åŠç›®å½•æƒé™ï¼š</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">chmod</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">+x</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/etcd-v3.4.27/etcd-startup.sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">chown</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-R</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">etcd:etcd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/etcd-v3.4.27/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">chown</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-R</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">etcd:etcd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/etcd/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">chown</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-R</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">etcd:etcd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/logs/etcd-server/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">chown</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-R</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">etcd:etcd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/TLS/etcd/</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="chmod +x /usr/local/etcd-v3.4.27/etcd-startup.shchown -R etcd:etcd /usr/local/etcd-v3.4.27/chown -R etcd:etcd /data/etcd/chown -R etcd:etcd /data/logs/etcd-server/chown -R etcd:etcd /etc/kubernetes/TLS/etcd/"><div></div></button></div></figure></div>
<p>åˆ›å»ºsupervisoré…ç½®æ–‡ä»¶ï¼š
ä¸‰ä¸ªä¸»æœºéƒ½å¾—æ‰§è¡Œï¼Œä¸åŒä¸»æœºåªéœ€è¦ä¿®æ”¹ä¸‹<code dir="auto">[program:etcd-server-157]</code>è¿™ä¸ªå³å¯ï¼Œæ¢æˆ158å’Œ159.</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/supervisor/conf.d/etcd-server.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[program:etcd-server-157]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">command</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/etcd-v3.4.27/etcd-startup.sh</span><span style="--0:#D6DEEB;--1:#403F53">                 ; </span><span style="--0:#82AAFF;--1:#3C63B3">the</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">program</span><span style="--0:#D6DEEB;--1:#403F53"> (relative </span><span style="--0:#ECC48D;--1:#3C63B3">uses</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">PATH,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">can</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">take</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">args</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">numprocs</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">                                                      ; </span><span style="--0:#82AAFF;--1:#3C63B3">number</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">of</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">processes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">copies</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">start</span><span style="--0:#D6DEEB;--1:#403F53"> (def </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">directory</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/etcd-v3.4.27</span><span style="--0:#D6DEEB;--1:#403F53">                               ; </span><span style="--0:#82AAFF;--1:#3C63B3">directory</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">cwd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">before</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">exec</span><span style="--0:#D6DEEB;--1:#403F53"> (def </span><span style="--0:#ECC48D;--1:#3C63B3">no</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">cwd</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">autostart</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53">                                                  ; </span><span style="--0:#82AAFF;--1:#3C63B3">start</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">at</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">supervisord</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">start</span><span style="--0:#D6DEEB;--1:#403F53"> (default: </span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">autorestart</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53">                                                ; </span><span style="--0:#82AAFF;--1:#3C63B3">retstart</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">at</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">unexpected</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">quit</span><span style="--0:#D6DEEB;--1:#403F53"> (default: </span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">startsecs</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">                                                    ; </span><span style="--0:#82AAFF;--1:#3C63B3">number</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">of</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">secs</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">prog</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">must</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">stay</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">running</span><span style="--0:#D6DEEB;--1:#403F53"> (def. </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">startretries</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#D6DEEB;--1:#403F53">                                                  ; </span><span style="--0:#82AAFF;--1:#3C63B3">max</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#809191;--1:#616671"># of serial start failures (default 3)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">exitcodes</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#ECC48D;--1:#3C63B3">,2</span><span style="--0:#D6DEEB;--1:#403F53">                                                   ; </span><span style="--0:#82AAFF;--1:#3C63B3">'expected'</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">exit</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">codes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">for</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">process</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#ECC48D;--1:#3C63B3">,2</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stopsignal</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">QUIT</span><span style="--0:#D6DEEB;--1:#403F53">                                                 ; </span><span style="--0:#82AAFF;--1:#3C63B3">signal</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">used</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kill</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">process</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#ECC48D;--1:#3C63B3">TERM</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stopwaitsecs</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">10</span><span style="--0:#D6DEEB;--1:#403F53">                                                 ; </span><span style="--0:#82AAFF;--1:#3C63B3">max</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">num</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">secs</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">wait</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">b4</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">SIGKILL</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#F78C6C;--1:#AA0982">10</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">user</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">etcd</span><span style="--0:#D6DEEB;--1:#403F53">                                                       ; </span><span style="--0:#82AAFF;--1:#3C63B3">setuid</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">this</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">UNIX</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">account</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">run</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">the</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">program</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">redirect_stderr</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53">                                            ; </span><span style="--0:#82AAFF;--1:#3C63B3">redirect</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">proc</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">stderr</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">stdout</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#82AAFF;--1:#3C63B3">false</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stdout_logfile</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/logs/etcd-server/etcd.stdout.log</span><span style="--0:#D6DEEB;--1:#403F53">           ; </span><span style="--0:#82AAFF;--1:#3C63B3">stdout</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">log</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">path,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">NONE</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">for</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">none</span><span style="--0:#D6DEEB;--1:#403F53">; </span><span style="--0:#82AAFF;--1:#3C63B3">default</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">AUTO</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stdout_logfile_maxbytes</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">64</span><span style="--0:#ECC48D;--1:#3C63B3">MB</span><span style="--0:#D6DEEB;--1:#403F53">                                    ; </span><span style="--0:#82AAFF;--1:#3C63B3">max</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#809191;--1:#616671"># logfile bytes b4 rotation (default 50MB)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stdout_logfile_backups</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">4</span><span style="--0:#D6DEEB;--1:#403F53">                                        ; </span><span style="--0:#809191;--1:#616671"># of stdout logfile backups (default 10)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stdout_capture_maxbytes</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">MB</span><span style="--0:#D6DEEB;--1:#403F53">                                     ; </span><span style="--0:#82AAFF;--1:#3C63B3">number</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">of</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">bytes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">in</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">capturemode</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stdout_events_enabled</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">false</span><span style="--0:#D6DEEB;--1:#403F53">                                     ; </span><span style="--0:#82AAFF;--1:#3C63B3">emit</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">events</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">on</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">stdout</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">writes</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#82AAFF;--1:#3C63B3">false</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="vim /etc/supervisor/conf.d/etcd-server.conf[program:etcd-server-157]command=/usr/local/etcd-v3.4.27/etcd-startup.sh                 ; the program (relative uses PATH, can take args)numprocs=1                                                      ; number of processes copies to start (def 1)directory=/usr/local/etcd-v3.4.27                               ; directory to cwd to before exec (def no cwd)autostart=true                                                  ; start at supervisord start (default: true)autorestart=true                                                ; retstart at unexpected quit (default: true)startsecs=0                                                    ; number of secs prog must stay running (def. 1)startretries=3                                                  ; max # of serial start failures (default 3)exitcodes=0,2                                                   ; &#x27;expected&#x27; exit codes for process (default 0,2)stopsignal=QUIT                                                 ; signal used to kill process (default TERM)stopwaitsecs=10                                                 ; max num secs to wait b4 SIGKILL (default 10)user=etcd                                                       ; setuid to this UNIX account to run the programredirect_stderr=true                                            ; redirect proc stderr to stdout (default false)stdout_logfile=/data/logs/etcd-server/etcd.stdout.log           ; stdout log path, NONE for none; default AUTOstdout_logfile_maxbytes=64MB                                    ; max # logfile bytes b4 rotation (default 50MB)stdout_logfile_backups=4                                        ; # of stdout logfile backups (default 10)stdout_capture_maxbytes=1MB                                     ; number of bytes in &#x27;capturemode&#x27; (default 0)stdout_events_enabled=false                                     ; emit events on stdout writes (default false)"><div></div></button></div></figure></div>
<p>é‡è½½supervisoré…ç½®æ–‡ä»¶ï¼š</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">supervisorctl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">update</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">supervisorctl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">status</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="supervisorctl updatesupervisorctl status"><div></div></button></div></figure></div>
<p><img src="https://cdn.agou-ops.cn/others/20230822151410.png" alt="image.png">
ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯ä»¥æŸ¥çœ‹é›†ç¾¤çŠ¶æ€ï¼ˆleaderæ˜¯è°ï¼Ÿï¼‰</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">etcdctl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-w</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">table</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--cacert=/etc/kubernetes/TLS/etcd/ca.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--cert=/etc/kubernetes/TLS/etcd/etcd-server.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--key=/etc/kubernetes/TLS/etcd/etcd-server-key.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--endpoints</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">https://172.19.82.157:2379</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">endpoint</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">status</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--cluster</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="etcdctl -w table --cacert=/etc/kubernetes/TLS/etcd/ca.pem --cert=/etc/kubernetes/TLS/etcd/etcd-server.pem --key=/etc/kubernetes/TLS/etcd/etcd-server-key.pem --endpoints https://172.19.82.157:2379 endpoint status --cluster"><div></div></button></div></figure></div>
<p><img src="https://cdn.agou-ops.cn/others/20230823111655.png" alt="image.png"></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">etcdctl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-w</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">table</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--cacert=/etc/kubernetes/TLS/etcd/ca.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--cert=/etc/kubernetes/TLS/etcd/etcd-server.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--key=/etc/kubernetes/TLS/etcd/etcd-server-key.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--endpoints</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">https://172.19.82.157:2379</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">member</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">list</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="etcdctl -w table --cacert=/etc/kubernetes/TLS/etcd/ca.pem --cert=/etc/kubernetes/TLS/etcd/etcd-server.pem --key=/etc/kubernetes/TLS/etcd/etcd-server-key.pem --endpoints https://172.19.82.157:2379 member list"><div></div></button></div></figure></div>
<p><img src="https://cdn.agou-ops.cn/others/20230823111723.png" alt="image.png"></p>
<h3 id="42-éƒ¨ç½²api-server">4.2 éƒ¨ç½²API server</h3>
<p>API serveræˆ‘å°±ä¸åšé›†ç¾¤äº†ï¼ˆå•èŠ‚ç‚¹ï¼‰ï¼Œæ–¹æ³•å…¶å®å’Œetcdå¤§å·®ä¸å·®.</p>
<h4 id="421-ä½¿ç”¨cfsslç”Ÿæˆè¯ä¹¦">4.2.1 ä½¿ç”¨cfsslç”Ÿæˆè¯ä¹¦</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># è¿™é‡Œç›´æ¥ä½¿ç”¨ä¸Šé¢etcdçš„è‡ªå»ºCAï¼Œå¦‚æœetcdéƒ¨ç½²åˆ°é›†ç¾¤ä¹‹å¤–çš„è¯ï¼Œå¯ä»¥é‡æ–°å»ºä¸ªCAä»¥ä½œåŒºåˆ†ã€‚</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># masterä¸»æœºä¸Š</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">cd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/TLS/k8s/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca-config.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"signing"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"default"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"expiry"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">87600h</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">},</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"profiles"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"kubernetes"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">         </span><span style="--0:#82AAFF;--1:#3C63B3">"expiry"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">87600h</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">         </span><span style="--0:#82AAFF;--1:#3C63B3">"usages"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"signing"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"key encipherment"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"server auth"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"client auth"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">]</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"CN"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">kubernetes</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"key"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"algo"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">rsa</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"size"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">2048</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">},</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"names"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"C"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">CN</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"L"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">HangZhou</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"ST"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">ZheJiang</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"O"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">k8s</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"OU"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">System</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">cfssl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">gencert</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-initca</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca-csr.json</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">cfssl-json</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-bare</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">-</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-apiserver-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"CN"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">kubernetes</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"hosts"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"127.0.0.1"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"kubernetes"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"kubernetes.default"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"kubernetes.default.svc"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"kubernetes.default.svc.cluster"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"kubernetes.default.svc.cluster.local"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"172.19.82.157"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"172.19.82.158"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"172.19.82.159"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"192.168.3.28"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"10.96.0.1"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">],</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"key"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"algo"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">rsa</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"size"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">2048</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">},</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"names"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"C"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">CN</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"L"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">HangZhou</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"ST"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">ZheJiang</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"O"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">k8s</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"OU"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">System</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">cfssl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">gencert</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-ca=ca.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-ca-key=ca-key.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-config=ca-config.json</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-profile=kubernetes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-apiserver-csr.json</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">cfssl-json</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-bare</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-apiserver</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># ç”Ÿæˆsa keyï¼Œåé¢ä¼šç”¨åˆ°</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">openssl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">genrsa</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-out</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">sa.key</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">2048</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">openssl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">rsa</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-in</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">sa.key</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-pubout</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-out</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">sa.pub</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">mkdir</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">proxy-client</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">cd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">proxy-client</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">front-proxy-ca-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"CA"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"expiry"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#82AAFF;--1:#3C63B3">"87600h"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">},</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"CN"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">kubernetes</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"key"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#82AAFF;--1:#3C63B3">"algo"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">rsa</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#82AAFF;--1:#3C63B3">"size"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">2048</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">cfssl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">gencert</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-initca</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">front-proxy-ca-csr.json</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">cfssl-json</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-bare</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">front-proxy-ca</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">front-proxy-client-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"CN"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">front-proxy-client</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"key"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#82AAFF;--1:#3C63B3">"algo"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">rsa</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#82AAFF;--1:#3C63B3">"size"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">2048</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">cfssl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">gencert</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">-ca=front-proxy-ca.pem </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">-ca-key=front-proxy-ca-key.pem  </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">-config=../ca-config.json   </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">-profile=kubernetes </span><span style="--0:#ECC48D;--1:#3C63B3">front-proxy-client-csr.json</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">cfssl-json</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-bare</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">front-proxy-client</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="cd /etc/kubernetes/TLS/k8s/vim ca-config.json{  &#x22;signing&#x22;: {    &#x22;default&#x22;: {      &#x22;expiry&#x22;: &#x22;87600h&#x22;    },    &#x22;profiles&#x22;: {      &#x22;kubernetes&#x22;: {         &#x22;expiry&#x22;: &#x22;87600h&#x22;,         &#x22;usages&#x22;: [            &#x22;signing&#x22;,            &#x22;key encipherment&#x22;,            &#x22;server auth&#x22;,            &#x22;client auth&#x22;        ]      }    }  }}vim ca-csr.json{    &#x22;CN&#x22;: &#x22;kubernetes&#x22;,    &#x22;key&#x22;: {        &#x22;algo&#x22;: &#x22;rsa&#x22;,        &#x22;size&#x22;: 2048    },    &#x22;names&#x22;: [        {            &#x22;C&#x22;: &#x22;CN&#x22;,            &#x22;L&#x22;: &#x22;HangZhou&#x22;,            &#x22;ST&#x22;: &#x22;ZheJiang&#x22;,            &#x22;O&#x22;: &#x22;k8s&#x22;,            &#x22;OU&#x22;: &#x22;System&#x22;        }    ]}cfssl gencert -initca ca-csr.json | cfssl-json -bare ca -vim kube-apiserver-csr.json{    &#x22;CN&#x22;: &#x22;kubernetes&#x22;,    &#x22;hosts&#x22;: [        &#x22;127.0.0.1&#x22;,        &#x22;kubernetes&#x22;,        &#x22;kubernetes.default&#x22;,        &#x22;kubernetes.default.svc&#x22;,        &#x22;kubernetes.default.svc.cluster&#x22;,        &#x22;kubernetes.default.svc.cluster.local&#x22;,        &#x22;172.19.82.157&#x22;,        &#x22;172.19.82.158&#x22;,        &#x22;172.19.82.159&#x22;,        &#x22;192.168.3.28&#x22;,        &#x22;10.96.0.1&#x22;    ],    &#x22;key&#x22;: {        &#x22;algo&#x22;: &#x22;rsa&#x22;,        &#x22;size&#x22;: 2048    },    &#x22;names&#x22;: [        {            &#x22;C&#x22;: &#x22;CN&#x22;,            &#x22;L&#x22;: &#x22;HangZhou&#x22;,            &#x22;ST&#x22;: &#x22;ZheJiang&#x22;,            &#x22;O&#x22;: &#x22;k8s&#x22;,      &#x22;OU&#x22;: &#x22;System&#x22;        }    ]}cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=kubernetes kube-apiserver-csr.json | cfssl-json -bare kube-apiserveropenssl genrsa -out sa.key 2048openssl rsa -in sa.key -pubout -out sa.pubmkdir proxy-clientcd proxy-clientvim front-proxy-ca-csr.json{  &#x22;CA&#x22;:{    &#x22;expiry&#x22;:&#x22;87600h&#x22;  },  &#x22;CN&#x22;: &#x22;kubernetes&#x22;,  &#x22;key&#x22;: {     &#x22;algo&#x22;: &#x22;rsa&#x22;,     &#x22;size&#x22;: 2048  }}cfssl gencert -initca front-proxy-ca-csr.json | cfssl-json -bare front-proxy-cavim front-proxy-client-csr.json{  &#x22;CN&#x22;: &#x22;front-proxy-client&#x22;,  &#x22;key&#x22;: {     &#x22;algo&#x22;: &#x22;rsa&#x22;,     &#x22;size&#x22;: 2048  }}cfssl gencert \-ca=front-proxy-ca.pem \-ca-key=front-proxy-ca-key.pem  \-config=../ca-config.json   \-profile=kubernetes front-proxy-client-csr.json | cfssl-json -bare front-proxy-client"><div></div></button></div></figure></div>
<p><img src="https://cdn.agou-ops.cn/others/20230823114325.png" alt="image.png"></p>
<h4 id="422-éƒ¨ç½²api-server">4.2.2 éƒ¨ç½²api-server</h4>
<p>ä»“åº“åœ°å€ï¼š<a href="https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG/CHANGELOG-1.25.md#v12512">https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG/CHANGELOG-1.25.md#v12512</a></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">wget</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">https://dl.k8s.io/v1.25.12/kubernetes-server-linux-amd64.tar.gz</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tar</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">xf</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes-server-linux-amd64.tar.gz</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-C</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">cd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/kubernetes</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># åˆ é™¤ä¸å¿…è¦çš„æºç å’Œæ–‡ä»¶</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">rm</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-f</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes-src.tar.gz</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">rm</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-rf</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">server/bin/</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#ECC48D;--1:#3C63B3">.tar</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">rm</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-rf</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">server/bin/</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#ECC48D;--1:#3C63B3">_tag</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># æ·»åŠ è½¯è¿æ¥æ–¹ä¾¿ä½¿ç”¨</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">ln</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-sv</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/kubernetes/server/bin/</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/bin/</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="wget https://dl.k8s.io/v1.25.12/kubernetes-server-linux-amd64.tar.gztar xf kubernetes-server-linux-amd64.tar.gz -C /usr/local/cd /usr/local/kubernetesrm -f kubernetes-src.tar.gzrm -rf server/bin/*.tarrm -rf server/bin/*_tagln -sv /usr/local/kubernetes/server/bin/* /usr/local/bin/"><div></div></button></div></figure></div>
<p>å¯åŠ¨è„šæœ¬ï¼š</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">mkdir</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/config</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/kubernetes/server/bin/kube-apiserver-startup.sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#!/usr/bin/env sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># ä¸‹é¢çš„certå’Œkeyç»Ÿç»Ÿç”¨ä¸€å¥—å°±å¥½äº†ã€‚</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#!/usr/bin/env sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">./kube-apiserver</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--v=2</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--logtostderr=true</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--allow-privileged=true</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--bind-address=172.19.82.157</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--secure-port=6443</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--advertise-address=157</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--service-cluster-ip-range=10.244.0.0/12</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--service-node-port-range=30000-40000</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--etcd-servers=https://172.19.82.157:2379,https://172.19.82.158:2379,https://172.19.82.159:2379</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--etcd-cafile=/etc/kubernetes/TLS/etcd/ca.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--etcd-certfile=/etc/kubernetes/TLS/etcd/etcd-server.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--etcd-keyfile=/etc/kubernetes/TLS/etcd/etcd-server-key.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--client-ca-file=/etc/kubernetes/TLS/k8s/ca.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--tls-cert-file=/etc/kubernetes/TLS/k8s/kube-apiserver.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--tls-private-key-file=/etc/kubernetes/TLS/k8s/kube-apiserver-key.pem</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3C63B3">--kubelet-client-certificate</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/TLS/k8s/kube-apiserver.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3C63B3">--kubelet-client-key</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/TLS/k8s/kube-apiserver-key.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3C63B3">--service-account-key-file</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/TLS/k8s/sa.pub</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3C63B3">--service-account-signing-key-file</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/TLS/k8s/sa.key</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3C63B3">--service-account-issuer</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">https://kubernetes.default.svc.cluster.local</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3C63B3">--kubelet-preferred-address-types</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">InternalIP,ExternalIP,Hostname</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3C63B3">--enable-admission-plugins</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">NamespaceLifecycle,LimitRanger,ServiceAccount,DefaultStorageClass,DefaultTolerationSeconds,NodeRestriction,ResourceQuota</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3C63B3">--authorization-mode</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">Node,RBAC</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3C63B3">--enable-bootstrap-token-auth</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3C63B3">--requestheader-client-ca-file</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/TLS/k8s/proxy-client/front-proxy-ca.pem</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3C63B3">--proxy-client-cert-file</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/TLS/k8s/proxy-client/front-proxy-client.pem</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3C63B3">--proxy-client-key-file</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/TLS/k8s/proxy-client/front-proxy-client-key.pem</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3C63B3">--requestheader-allowed-names</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">front-proxy-client</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3C63B3">--requestheader-group-headers</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">X-Remote-Group</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3C63B3">--requestheader-extra-headers-prefix</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">X-Remote-Extra-</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3C63B3">--requestheader-username-headers</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">X-Remote-User</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">chmod</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">+x</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/kubernetes/server/bin/kube-apiserver-startup.sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">mkdir</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-pv</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/logs/kubernetes/kube-apiserver</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="mkdir /etc/kubernetes/configvim /usr/local/kubernetes/server/bin/kube-apiserver-startup.sh#!/usr/bin/env sh# ä¸‹é¢çš„certå’Œkeyç»Ÿç»Ÿç”¨ä¸€å¥—å°±å¥½äº†ã€‚#!/usr/bin/env sh./kube-apiserver \  --v=2  \  --logtostderr=true  \  --allow-privileged=true  \  --bind-address=172.19.82.157  \  --secure-port=6443  \  --advertise-address=157 \  --service-cluster-ip-range=10.244.0.0/12 \  --service-node-port-range=30000-40000  \  --etcd-servers=https://172.19.82.157:2379,https://172.19.82.158:2379,https://172.19.82.159:2379 \  --etcd-cafile=/etc/kubernetes/TLS/etcd/ca.pem \  --etcd-certfile=/etc/kubernetes/TLS/etcd/etcd-server.pem \  --etcd-keyfile=/etc/kubernetes/TLS/etcd/etcd-server-key.pem \  --client-ca-file=/etc/kubernetes/TLS/k8s/ca.pem \  --tls-cert-file=/etc/kubernetes/TLS/k8s/kube-apiserver.pem \  --tls-private-key-file=/etc/kubernetes/TLS/k8s/kube-apiserver-key.pem  --kubelet-client-certificate=/etc/kubernetes/TLS/k8s/kube-apiserver.pem \  --kubelet-client-key=/etc/kubernetes/TLS/k8s/kube-apiserver-key.pem \  --service-account-key-file=/etc/kubernetes/TLS/k8s/sa.pub  \  --service-account-signing-key-file=/etc/kubernetes/TLS/k8s/sa.key  \  --service-account-issuer=https://kubernetes.default.svc.cluster.local \  --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname  \  --enable-admission-plugins=NamespaceLifecycle,LimitRanger,ServiceAccount,DefaultStorageClass,DefaultTolerationSeconds,NodeRestriction,ResourceQuota  \  --authorization-mode=Node,RBAC  \  --enable-bootstrap-token-auth=true  \  --requestheader-client-ca-file=/etc/kubernetes/TLS/k8s/proxy-client/front-proxy-ca.pem  \  --proxy-client-cert-file=/etc/kubernetes/TLS/k8s/proxy-client/front-proxy-client.pem  \  --proxy-client-key-file=/etc/kubernetes/TLS/k8s/proxy-client/front-proxy-client-key.pem  \  --requestheader-allowed-names=front-proxy-client  \  --requestheader-group-headers=X-Remote-Group  \  --requestheader-extra-headers-prefix=X-Remote-Extra-  \  --requestheader-username-headers=X-Remote-Userchmod +x /usr/local/kubernetes/server/bin/kube-apiserver-startup.shmkdir -pv /data/logs/kubernetes/kube-apiserver"><div></div></button></div></figure></div>
<p>é…ç½®supervisorï¼š</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/supervisor/conf.d/apiserver.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[program:apiserver-157]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">command</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/kubernetes/server/bin/kube-apiserver-startup.sh</span><span style="--0:#D6DEEB;--1:#403F53">                 ; </span><span style="--0:#82AAFF;--1:#3C63B3">the</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">program</span><span style="--0:#D6DEEB;--1:#403F53"> (relative </span><span style="--0:#ECC48D;--1:#3C63B3">uses</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">PATH,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">can</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">take</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">args</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">numprocs</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">                                                      ; </span><span style="--0:#82AAFF;--1:#3C63B3">number</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">of</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">processes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">copies</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">start</span><span style="--0:#D6DEEB;--1:#403F53"> (def </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">directory</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/kubernetes/server/bin</span><span style="--0:#D6DEEB;--1:#403F53">                               ; </span><span style="--0:#82AAFF;--1:#3C63B3">directory</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">cwd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">before</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">exec</span><span style="--0:#D6DEEB;--1:#403F53"> (def </span><span style="--0:#ECC48D;--1:#3C63B3">no</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">cwd</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">autostart</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53">                                                  ; </span><span style="--0:#82AAFF;--1:#3C63B3">start</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">at</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">supervisord</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">start</span><span style="--0:#D6DEEB;--1:#403F53"> (default: </span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">autorestart</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53">                                                ; </span><span style="--0:#82AAFF;--1:#3C63B3">retstart</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">at</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">unexpected</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">quit</span><span style="--0:#D6DEEB;--1:#403F53"> (default: </span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">startsecs</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">                                                     ; </span><span style="--0:#82AAFF;--1:#3C63B3">number</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">of</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">secs</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">prog</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">must</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">stay</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">running</span><span style="--0:#D6DEEB;--1:#403F53"> (def. </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">startretries</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#D6DEEB;--1:#403F53">                                                  ; </span><span style="--0:#82AAFF;--1:#3C63B3">max</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#809191;--1:#616671"># of serial start failures (default 3)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">exitcodes</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#ECC48D;--1:#3C63B3">,2</span><span style="--0:#D6DEEB;--1:#403F53">                                                   ; </span><span style="--0:#82AAFF;--1:#3C63B3">'expected'</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">exit</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">codes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">for</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">process</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#ECC48D;--1:#3C63B3">,2</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stopsignal</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">QUIT</span><span style="--0:#D6DEEB;--1:#403F53">                                                 ; </span><span style="--0:#82AAFF;--1:#3C63B3">signal</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">used</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kill</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">process</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#ECC48D;--1:#3C63B3">TERM</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stopwaitsecs</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">10</span><span style="--0:#D6DEEB;--1:#403F53">                                                 ; </span><span style="--0:#82AAFF;--1:#3C63B3">max</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">num</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">secs</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">wait</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">b4</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">SIGKILL</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#F78C6C;--1:#AA0982">10</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">user</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53">                                                       ; </span><span style="--0:#82AAFF;--1:#3C63B3">setuid</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">this</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">UNIX</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">account</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">run</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">the</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">program</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">redirect_stderr</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53">                                            ; </span><span style="--0:#82AAFF;--1:#3C63B3">redirect</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">proc</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">stderr</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">stdout</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#82AAFF;--1:#3C63B3">false</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stdout_logfile</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/logs/kubernetes/kube-apiserver/apiserver.stdout.log</span><span style="--0:#D6DEEB;--1:#403F53">           ; </span><span style="--0:#82AAFF;--1:#3C63B3">stdout</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">log</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">path,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">NONE</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">for</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">none</span><span style="--0:#D6DEEB;--1:#403F53">; </span><span style="--0:#82AAFF;--1:#3C63B3">default</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">AUTO</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stdout_logfile_maxbytes</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">64</span><span style="--0:#ECC48D;--1:#3C63B3">MB</span><span style="--0:#D6DEEB;--1:#403F53">                                    ; </span><span style="--0:#82AAFF;--1:#3C63B3">max</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#809191;--1:#616671"># logfile bytes b4 rotation (default 50MB)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stdout_logfile_backups</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">4</span><span style="--0:#D6DEEB;--1:#403F53">                                        ; </span><span style="--0:#809191;--1:#616671"># of stdout logfile backups (default 10)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stdout_capture_maxbytes</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">MB</span><span style="--0:#D6DEEB;--1:#403F53">                                     ; </span><span style="--0:#82AAFF;--1:#3C63B3">number</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">of</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">bytes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">in</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">capturemode</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stdout_events_enabled</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">false</span><span style="--0:#D6DEEB;--1:#403F53">                                     ; </span><span style="--0:#82AAFF;--1:#3C63B3">emit</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">events</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">on</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">stdout</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">writes</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#82AAFF;--1:#3C63B3">false</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># é‡è½½supervisoré…ç½®æ–‡ä»¶</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">supervisorctl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">update</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">ss</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-tnulp</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">grep</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">6443</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># output</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">16384</span><span style="--0:#D6DEEB;--1:#403F53">                                </span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#ECC48D;--1:#3C63B3">:6443</span><span style="--0:#D6DEEB;--1:#403F53">             </span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#ECC48D;--1:#3C63B3">:</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">users:</span><span style="--0:#D6DEEB;--1:#403F53">(("kube</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">apiserver"</span><span style="--0:#C792EA;--1:#8D46B4">,</span><span style="--0:#D6DEEB;--1:#403F53">pid</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">5989</span><span style="--0:#C792EA;--1:#8D46B4">,</span><span style="--0:#D6DEEB;--1:#403F53">fd</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">7</span><span style="--0:#D6DEEB;--1:#403F53">))</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="vim /etc/supervisor/conf.d/apiserver.conf[program:apiserver-157]command=/usr/local/kubernetes/server/bin/kube-apiserver-startup.sh                 ; the program (relative uses PATH, can take args)numprocs=1                                                      ; number of processes copies to start (def 1)directory=/usr/local/kubernetes/server/bin                               ; directory to cwd to before exec (def no cwd)autostart=true                                                  ; start at supervisord start (default: true)autorestart=true                                                ; retstart at unexpected quit (default: true)startsecs=0                                                     ; number of secs prog must stay running (def. 1)startretries=3                                                  ; max # of serial start failures (default 3)exitcodes=0,2                                                   ; &#x27;expected&#x27; exit codes for process (default 0,2)stopsignal=QUIT                                                 ; signal used to kill process (default TERM)stopwaitsecs=10                                                 ; max num secs to wait b4 SIGKILL (default 10)user=root                                                       ; setuid to this UNIX account to run the programredirect_stderr=true                                            ; redirect proc stderr to stdout (default false)stdout_logfile=/data/logs/kubernetes/kube-apiserver/apiserver.stdout.log           ; stdout log path, NONE for none; default AUTOstdout_logfile_maxbytes=64MB                                    ; max # logfile bytes b4 rotation (default 50MB)stdout_logfile_backups=4                                        ; # of stdout logfile backups (default 10)stdout_capture_maxbytes=1MB                                     ; number of bytes in &#x27;capturemode&#x27; (default 0)stdout_events_enabled=false                                     ; emit events on stdout writes (default false)supervisorctl updatess -tnulp  | grep 6443tcp   LISTEN 0      16384                                *:6443             *:*    users:((&#x22;kube-apiserver&#x22;,pid=5989,fd=7))"><div></div></button></div></figure></div>
<p><img src="https://cdn.agou-ops.cn/others/20230822170053.png" alt="image.png"></p>
<h3 id="43-éƒ¨ç½²controller-manager">4.3 éƒ¨ç½²controller-manager</h3>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">cd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/TLS/k8s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-controller-manager-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"CN"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">system:kube-controller-manager</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"hosts"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [],</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"key"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"algo"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">rsa</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"size"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">2048</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">},</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"names"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"C"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">CN</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"L"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">HangZhou</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"ST"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">ZheJiang</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"O"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">system:kube-controller-manager</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"OU"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">System</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">cfssl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">gencert</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-ca=ca.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-ca-key=ca-key.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-config=ca-config.json</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-profile=kubernetes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-controller-manager-csr.json</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">cfssl-json</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-bare</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-controller-manager</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># æ·»åŠ é›†ç¾¤apiserverä¿¡æ¯</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">config</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">set-cluster</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--certificate-authority=/etc/kubernetes/TLS/k8s/ca.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--embed-certs=true</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--server=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://172.19.82.157:6443</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--kubeconfig=/etc/kubernetes/config/kube-controller-manager.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># æ·»åŠ è¯ä¹¦æ–‡ä»¶ä¿¡æ¯</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">config</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">set-credentials</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">system:kube-controller-manager</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--client-certificate=/etc/kubernetes/TLS/k8s/kube-controller-manager.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--client-key=/etc/kubernetes/TLS/k8s/kube-controller-manager-key.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--embed-certs=true</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--kubeconfig=/etc/kubernetes/config/kube-controller-manager.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># æ·»åŠ ç”¨æˆ·</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">config</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">set-context</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">default</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--cluster=kubernetes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--user=system:kube-controller-manager</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--kubeconfig=/etc/kubernetes/config/kube-controller-manager.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># æŒ‡å®šé»˜è®¤çš„é›†ç¾¤</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">config</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">use-context</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">default</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--kubeconfig=/etc/kubernetes/config/kube-controller-manager.kubeconfig</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/kubernetes/server/bin/kube-controller-manager-startup.sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#!/usr/bin/env sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">./kube-controller-manager</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--v=2</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--root-ca-file=/etc/kubernetes/TLS/k8s/ca.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--cluster-signing-cert-file=/etc/kubernetes/TLS/k8s/ca.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--cluster-signing-key-file=/etc/kubernetes/TLS/k8s/ca-key.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--service-account-private-key-file=/etc/kubernetes/TLS/k8s/sa.key</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--kubeconfig=/etc/kubernetes/config/kube-controller-manager.kubeconfig</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--leader-elect=true</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--use-service-account-credentials=true</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--node-monitor-grace-period=40s</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--node-monitor-period=5s</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--pod-eviction-timeout=2m0s</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--controllers=</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#82AAFF;--1:#3C63B3">,bootstrapsigner,tokencleaner</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--allocate-node-cidrs=true</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--cluster-cidr=10.244.0.0/12</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--requestheader-client-ca-file=/etc/kubernetes/TLS/k8s/proxy-client/front-proxy-ca.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--node-cidr-mask-size=24</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">chmod</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">+x</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/kubernetes/server/bin/kube-controller-manager-startup.sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">mkdir</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-pv</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/logs/kubernetes/kube-controller-manager/</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/supervisor/conf.d/controller-manager.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[program:kube-controller-manager-157]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">command</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/kubernetes/server/bin/kube-controller-manager-startup.sh</span><span style="--0:#D6DEEB;--1:#403F53">                     ; </span><span style="--0:#82AAFF;--1:#3C63B3">the</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">program</span><span style="--0:#D6DEEB;--1:#403F53"> (relative </span><span style="--0:#ECC48D;--1:#3C63B3">uses</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">PATH,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">can</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">take</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">args</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">numprocs</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">                                                                        ; </span><span style="--0:#82AAFF;--1:#3C63B3">number</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">of</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">processes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">copies</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">start</span><span style="--0:#D6DEEB;--1:#403F53"> (def </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">directory</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/kubernetes/server/bin</span><span style="--0:#D6DEEB;--1:#403F53">                                              ; </span><span style="--0:#82AAFF;--1:#3C63B3">directory</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">cwd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">before</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">exec</span><span style="--0:#D6DEEB;--1:#403F53"> (def </span><span style="--0:#ECC48D;--1:#3C63B3">no</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">cwd</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">autostart</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53">                                                                    ; </span><span style="--0:#82AAFF;--1:#3C63B3">start</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">at</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">supervisord</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">start</span><span style="--0:#D6DEEB;--1:#403F53"> (default: </span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">autorestart</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53">                                                                  ; </span><span style="--0:#82AAFF;--1:#3C63B3">retstart</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">at</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">unexpected</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">quit</span><span style="--0:#D6DEEB;--1:#403F53"> (default: </span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">startsecs</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">30</span><span style="--0:#D6DEEB;--1:#403F53">                                                                      ; </span><span style="--0:#82AAFF;--1:#3C63B3">number</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">of</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">secs</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">prog</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">must</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">stay</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">running</span><span style="--0:#D6DEEB;--1:#403F53"> (def. </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">startretries</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#D6DEEB;--1:#403F53">                                                                    ; </span><span style="--0:#82AAFF;--1:#3C63B3">max</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#809191;--1:#616671"># of serial start failures (default 3)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">exitcodes</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#ECC48D;--1:#3C63B3">,2</span><span style="--0:#D6DEEB;--1:#403F53">                                                                     ; </span><span style="--0:#82AAFF;--1:#3C63B3">'expected'</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">exit</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">codes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">for</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">process</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#ECC48D;--1:#3C63B3">,2</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stopsignal</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">QUIT</span><span style="--0:#D6DEEB;--1:#403F53">                                                                   ; </span><span style="--0:#82AAFF;--1:#3C63B3">signal</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">used</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kill</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">process</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#ECC48D;--1:#3C63B3">TERM</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stopwaitsecs</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">10</span><span style="--0:#D6DEEB;--1:#403F53">                                                                   ; </span><span style="--0:#82AAFF;--1:#3C63B3">max</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">num</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">secs</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">wait</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">b4</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">SIGKILL</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#F78C6C;--1:#AA0982">10</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">user</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53">                                                                         ; </span><span style="--0:#82AAFF;--1:#3C63B3">setuid</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">this</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">UNIX</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">account</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">run</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">the</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">program</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">redirect_stderr</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53">                                                              ; </span><span style="--0:#82AAFF;--1:#3C63B3">redirect</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">proc</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">stderr</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">stdout</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#82AAFF;--1:#3C63B3">false</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stdout_logfile</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/logs/kubernetes/kube-controller-manager/controller.stdout.log</span><span style="--0:#D6DEEB;--1:#403F53">  ; </span><span style="--0:#82AAFF;--1:#3C63B3">stderr</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">log</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">path,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">NONE</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">for</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">none</span><span style="--0:#D6DEEB;--1:#403F53">; </span><span style="--0:#82AAFF;--1:#3C63B3">default</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">AUTO</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stdout_logfile_maxbytes</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">64</span><span style="--0:#ECC48D;--1:#3C63B3">MB</span><span style="--0:#D6DEEB;--1:#403F53">                                                      ; </span><span style="--0:#82AAFF;--1:#3C63B3">max</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#809191;--1:#616671"># logfile bytes b4 rotation (default 50MB)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stdout_logfile_backups</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">4</span><span style="--0:#D6DEEB;--1:#403F53">                                                          ; </span><span style="--0:#809191;--1:#616671"># of stdout logfile backups (default 10)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stdout_capture_maxbytes</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">MB</span><span style="--0:#D6DEEB;--1:#403F53">                                                       ; </span><span style="--0:#82AAFF;--1:#3C63B3">number</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">of</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">bytes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">in</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">capturemode</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stdout_events_enabled</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">false</span><span style="--0:#D6DEEB;--1:#403F53">                                                       ; </span><span style="--0:#82AAFF;--1:#3C63B3">emit</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">events</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">on</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">stdout</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">writes</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#82AAFF;--1:#3C63B3">false</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="cd /etc/kubernetes/TLS/k8svim kube-controller-manager-csr.json{  &#x22;CN&#x22;: &#x22;system:kube-controller-manager&#x22;,  &#x22;hosts&#x22;: [],  &#x22;key&#x22;: {    &#x22;algo&#x22;: &#x22;rsa&#x22;,    &#x22;size&#x22;: 2048  },    &#x22;names&#x22;: [        {            &#x22;C&#x22;: &#x22;CN&#x22;,            &#x22;L&#x22;: &#x22;HangZhou&#x22;,            &#x22;ST&#x22;: &#x22;ZheJiang&#x22;,      &#x22;O&#x22;: &#x22;system:kube-controller-manager&#x22;,      &#x22;OU&#x22;: &#x22;System&#x22;        }    ]}cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=kubernetes kube-controller-manager-csr.json | cfssl-json -bare kube-controller-managerkubectl config set-cluster kubernetes \  --certificate-authority=/etc/kubernetes/TLS/k8s/ca.pem \  --embed-certs=true \  --server=&#x22;https://172.19.82.157:6443&#x22; \  --kubeconfig=/etc/kubernetes/config/kube-controller-manager.kubeconfigkubectl config set-credentials system:kube-controller-manager \  --client-certificate=/etc/kubernetes/TLS/k8s/kube-controller-manager.pem \  --client-key=/etc/kubernetes/TLS/k8s/kube-controller-manager-key.pem \  --embed-certs=true \  --kubeconfig=/etc/kubernetes/config/kube-controller-manager.kubeconfigkubectl config set-context default \  --cluster=kubernetes \  --user=system:kube-controller-manager \  --kubeconfig=/etc/kubernetes/config/kube-controller-manager.kubeconfigkubectl config use-context default --kubeconfig=/etc/kubernetes/config/kube-controller-manager.kubeconfigvim /usr/local/kubernetes/server/bin/kube-controller-manager-startup.sh./kube-controller-manager \  --v=2 \  --root-ca-file=/etc/kubernetes/TLS/k8s/ca.pem \  --cluster-signing-cert-file=/etc/kubernetes/TLS/k8s/ca.pem \  --cluster-signing-key-file=/etc/kubernetes/TLS/k8s/ca-key.pem \  --service-account-private-key-file=/etc/kubernetes/TLS/k8s/sa.key \  --kubeconfig=/etc/kubernetes/config/kube-controller-manager.kubeconfig \  --leader-elect=true \  --use-service-account-credentials=true \  --node-monitor-grace-period=40s \  --node-monitor-period=5s \  --pod-eviction-timeout=2m0s \  --controllers=*,bootstrapsigner,tokencleaner \  --allocate-node-cidrs=true \  --cluster-cidr=10.244.0.0/12 \  --requestheader-client-ca-file=/etc/kubernetes/TLS/k8s/proxy-client/front-proxy-ca.pem \  --node-cidr-mask-size=24chmod +x /usr/local/kubernetes/server/bin/kube-controller-manager-startup.shmkdir -pv /data/logs/kubernetes/kube-controller-manager/vim /etc/supervisor/conf.d/controller-manager.conf[program:kube-controller-manager-157]command=/usr/local/kubernetes/server/bin/kube-controller-manager-startup.sh                     ; the program (relative uses PATH, can take args)numprocs=1                                                                        ; number of processes copies to start (def 1)directory=/usr/local/kubernetes/server/bin                                              ; directory to cwd to before exec (def no cwd)autostart=true                                                                    ; start at supervisord start (default: true)autorestart=true                                                                  ; retstart at unexpected quit (default: true)startsecs=30                                                                      ; number of secs prog must stay running (def. 1)startretries=3                                                                    ; max # of serial start failures (default 3)exitcodes=0,2                                                                     ; &#x27;expected&#x27; exit codes for process (default 0,2)stopsignal=QUIT                                                                   ; signal used to kill process (default TERM)stopwaitsecs=10                                                                   ; max num secs to wait b4 SIGKILL (default 10)user=root                                                                         ; setuid to this UNIX account to run the programredirect_stderr=true                                                              ; redirect proc stderr to stdout (default false)stdout_logfile=/data/logs/kubernetes/kube-controller-manager/controller.stdout.log  ; stderr log path, NONE for none; default AUTOstdout_logfile_maxbytes=64MB                                                      ; max # logfile bytes b4 rotation (default 50MB)stdout_logfile_backups=4                                                          ; # of stdout logfile backups (default 10)stdout_capture_maxbytes=1MB                                                       ; number of bytes in &#x27;capturemode&#x27; (default 0)stdout_events_enabled=false                                                       ; emit events on stdout writes (default false)"><div></div></button></div></figure></div>
<p><img src="https://cdn.agou-ops.cn/others/20230823134408.png" alt="image.png"></p>
<h3 id="44-éƒ¨ç½²kube-scheduler">4.4 éƒ¨ç½²kube-scheduler</h3>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">cd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/TLS/k8s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-scheduler-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"CN"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">system:kube-scheduler</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"hosts"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [],</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"key"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"algo"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">rsa</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"size"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">2048</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">},</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"names"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"C"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">CN</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"L"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">HangZhou</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"ST"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">ZheJiang</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"O"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">system:kube-scheduler</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"OU"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">System</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">cfssl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">gencert</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-ca=ca.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-ca-key=ca-key.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-config=ca-config.json</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-profile=kubernetes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-scheduler-csr.json</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">cfssl-json</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-bare</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-scheduler</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># æ·»åŠ é›†ç¾¤apiserverä¿¡æ¯</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">config</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">set-cluster</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--certificate-authority=/etc/kubernetes/TLS/k8s/ca.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--embed-certs=true</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--server=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://172.19.82.157:6443</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--kubeconfig=/etc/kubernetes/config/kube-scheduler.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># æ·»åŠ è¯ä¹¦æ–‡ä»¶ä¿¡æ¯</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">config</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">set-credentials</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">system:kube-scheduler</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--client-certificate=/etc/kubernetes/TLS/k8s/kube-scheduler.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--client-key=/etc/kubernetes/TLS/k8s/kube-scheduler-key.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--embed-certs=true</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--kubeconfig=/etc/kubernetes/config/kube-scheduler.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># æ·»åŠ ç”¨æˆ·</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">config</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">set-context</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">default</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--cluster=kubernetes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--user=system:kube-scheduler</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--kubeconfig=/etc/kubernetes/config/kube-scheduler.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># æŒ‡å®šé»˜è®¤çš„é›†ç¾¤</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">config</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">use-context</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">default</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--kubeconfig=/etc/kubernetes/config/kube-scheduler.kubeconfig</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/kubernetes/server/bin/kube-scheduler-startup.sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#!/usr/bin/env sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">./kube-scheduler</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--v=2</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--leader-elect=true</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--kubeconfig=/etc/kubernetes/config/kube-scheduler.kubeconfig</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">chmod</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">+x</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/kubernetes/server/bin/kube-scheduler-startup.sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">mkdir</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-pv</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/logs/kubernetes/kube-scheduler/</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/supervisor/conf.d/scheduler.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[program:kube-scheduler-157]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">command</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/kubernetes/server/bin/kube-scheduler-startup.sh</span><span style="--0:#D6DEEB;--1:#403F53">                   ; </span><span style="--0:#82AAFF;--1:#3C63B3">the</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">program</span><span style="--0:#D6DEEB;--1:#403F53"> (relative </span><span style="--0:#ECC48D;--1:#3C63B3">uses</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">PATH,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">can</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">take</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">args</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">numprocs</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">                                                               ; </span><span style="--0:#82AAFF;--1:#3C63B3">number</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">of</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">processes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">copies</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">start</span><span style="--0:#D6DEEB;--1:#403F53"> (def </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">directory</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/kubernetes/server/bin</span><span style="--0:#D6DEEB;--1:#403F53">                                  ; </span><span style="--0:#82AAFF;--1:#3C63B3">directory</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">cwd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">before</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">exec</span><span style="--0:#D6DEEB;--1:#403F53"> (def </span><span style="--0:#ECC48D;--1:#3C63B3">no</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">cwd</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">autostart</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53">                                                           ; </span><span style="--0:#82AAFF;--1:#3C63B3">start</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">at</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">supervisord</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">start</span><span style="--0:#D6DEEB;--1:#403F53"> (default: </span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">autorestart</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53">                                                         ; </span><span style="--0:#82AAFF;--1:#3C63B3">retstart</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">at</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">unexpected</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">quit</span><span style="--0:#D6DEEB;--1:#403F53"> (default: </span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">startsecs</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">                                                             ; </span><span style="--0:#82AAFF;--1:#3C63B3">number</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">of</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">secs</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">prog</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">must</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">stay</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">running</span><span style="--0:#D6DEEB;--1:#403F53"> (def. </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">startretries</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#D6DEEB;--1:#403F53">                                                           ; </span><span style="--0:#82AAFF;--1:#3C63B3">max</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#809191;--1:#616671"># of serial start failures (default 3)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">exitcodes</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#ECC48D;--1:#3C63B3">,2</span><span style="--0:#D6DEEB;--1:#403F53">                                                            ; </span><span style="--0:#82AAFF;--1:#3C63B3">'expected'</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">exit</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">codes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">for</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">process</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#ECC48D;--1:#3C63B3">,2</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stopsignal</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">QUIT</span><span style="--0:#D6DEEB;--1:#403F53">                                                          ; </span><span style="--0:#82AAFF;--1:#3C63B3">signal</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">used</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kill</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">process</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#ECC48D;--1:#3C63B3">TERM</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stopwaitsecs</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">10</span><span style="--0:#D6DEEB;--1:#403F53">                                                          ; </span><span style="--0:#82AAFF;--1:#3C63B3">max</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">num</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">secs</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">wait</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">b4</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">SIGKILL</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#F78C6C;--1:#AA0982">10</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">user</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53">                                                                ; </span><span style="--0:#82AAFF;--1:#3C63B3">setuid</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">this</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">UNIX</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">account</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">run</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">the</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">program</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">redirect_stderr</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53">                                                     ; </span><span style="--0:#82AAFF;--1:#3C63B3">redirect</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">proc</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">stderr</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">stdout</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#82AAFF;--1:#3C63B3">false</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stdout_logfile</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/logs/kubernetes/kube-scheduler/scheduler.stdout.log</span><span style="--0:#D6DEEB;--1:#403F53"> ; </span><span style="--0:#82AAFF;--1:#3C63B3">stderr</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">log</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">path,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">NONE</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">for</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">none</span><span style="--0:#D6DEEB;--1:#403F53">; </span><span style="--0:#82AAFF;--1:#3C63B3">default</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">AUTO</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stdout_logfile_maxbytes</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">64</span><span style="--0:#ECC48D;--1:#3C63B3">MB</span><span style="--0:#D6DEEB;--1:#403F53">                                             ; </span><span style="--0:#82AAFF;--1:#3C63B3">max</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#809191;--1:#616671"># logfile bytes b4 rotation (default 50MB)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stdout_logfile_backups</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">4</span><span style="--0:#D6DEEB;--1:#403F53">                                                 ; </span><span style="--0:#809191;--1:#616671"># of stdout logfile backups (default 10)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stdout_capture_maxbytes</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">MB</span><span style="--0:#D6DEEB;--1:#403F53">                                              ; </span><span style="--0:#82AAFF;--1:#3C63B3">number</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">of</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">bytes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">in</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">capturemode</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stdout_events_enabled</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">false</span><span style="--0:#D6DEEB;--1:#403F53">                                              ; </span><span style="--0:#82AAFF;--1:#3C63B3">emit</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">events</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">on</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">stdout</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">writes</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#82AAFF;--1:#3C63B3">false</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">supervisorctl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">update</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="cd /etc/kubernetes/TLS/k8svim kube-scheduler-csr.json{  &#x22;CN&#x22;: &#x22;system:kube-scheduler&#x22;,  &#x22;hosts&#x22;: [],  &#x22;key&#x22;: {    &#x22;algo&#x22;: &#x22;rsa&#x22;,    &#x22;size&#x22;: 2048  },  &#x22;names&#x22;: [        {            &#x22;C&#x22;: &#x22;CN&#x22;,            &#x22;L&#x22;: &#x22;HangZhou&#x22;,            &#x22;ST&#x22;: &#x22;ZheJiang&#x22;,      &#x22;O&#x22;: &#x22;system:kube-scheduler&#x22;,      &#x22;OU&#x22;: &#x22;System&#x22;        }  ]}cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=kubernetes kube-scheduler-csr.json | cfssl-json -bare kube-schedulerkubectl config set-cluster kubernetes \  --certificate-authority=/etc/kubernetes/TLS/k8s/ca.pem \  --embed-certs=true \  --server=&#x22;https://172.19.82.157:6443&#x22; \  --kubeconfig=/etc/kubernetes/config/kube-scheduler.kubeconfigkubectl config set-credentials system:kube-scheduler \  --client-certificate=/etc/kubernetes/TLS/k8s/kube-scheduler.pem \  --client-key=/etc/kubernetes/TLS/k8s/kube-scheduler-key.pem \  --embed-certs=true \  --kubeconfig=/etc/kubernetes/config/kube-scheduler.kubeconfigkubectl config set-context default \  --cluster=kubernetes \  --user=system:kube-scheduler \  --kubeconfig=/etc/kubernetes/config/kube-scheduler.kubeconfigkubectl config use-context default --kubeconfig=/etc/kubernetes/config/kube-scheduler.kubeconfigvim /usr/local/kubernetes/server/bin/kube-scheduler-startup.sh./kube-scheduler \  --v=2 \  --leader-elect=true \  --kubeconfig=/etc/kubernetes/config/kube-scheduler.kubeconfigchmod +x /usr/local/kubernetes/server/bin/kube-scheduler-startup.shmkdir -pv /data/logs/kubernetes/kube-scheduler/vim /etc/supervisor/conf.d/scheduler.conf[program:kube-scheduler-157]command=/usr/local/kubernetes/server/bin/kube-scheduler-startup.sh                   ; the program (relative uses PATH, can take args)numprocs=1                                                               ; number of processes copies to start (def 1)directory=/usr/local/kubernetes/server/bin                                  ; directory to cwd to before exec (def no cwd)autostart=true                                                           ; start at supervisord start (default: true)autorestart=true                                                         ; retstart at unexpected quit (default: true)startsecs=0                                                             ; number of secs prog must stay running (def. 1)startretries=3                                                           ; max # of serial start failures (default 3)exitcodes=0,2                                                            ; &#x27;expected&#x27; exit codes for process (default 0,2)stopsignal=QUIT                                                          ; signal used to kill process (default TERM)stopwaitsecs=10                                                          ; max num secs to wait b4 SIGKILL (default 10)user=root                                                                ; setuid to this UNIX account to run the programredirect_stderr=true                                                     ; redirect proc stderr to stdout (default false)stdout_logfile=/data/logs/kubernetes/kube-scheduler/scheduler.stdout.log ; stderr log path, NONE for none; default AUTOstdout_logfile_maxbytes=64MB                                             ; max # logfile bytes b4 rotation (default 50MB)stdout_logfile_backups=4                                                 ; # of stdout logfile backups (default 10)stdout_capture_maxbytes=1MB                                              ; number of bytes in &#x27;capturemode&#x27; (default 0)stdout_events_enabled=false                                              ; emit events on stdout writes (default false)supervisorctl update"><div></div></button></div></figure></div>
<p>è‡³æ­¤ï¼ŒmasterèŠ‚ç‚¹çš„æ ¸å¿ƒç»„ä»¶åŸºæœ¬å®‰è£…å®Œæˆäº†ï¼Œä½¿ç”¨sså‘½ä»¤æŸ¥çœ‹æœåŠ¡ç›‘å¬çŠ¶æ€ï¼š</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">></span><span style="--0:#D6DEEB;--1:#403F53"> ss -tnulp </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">grep</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">16384</span><span style="--0:#D6DEEB;--1:#403F53">                        </span><span style="--0:#F78C6C;--1:#AA0982">127.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.1:10259</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0:</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">users:</span><span style="--0:#D6DEEB;--1:#403F53">(("kube</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">scheduler"</span><span style="--0:#C792EA;--1:#8D46B4">,</span><span style="--0:#D6DEEB;--1:#403F53">pid</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">9385</span><span style="--0:#C792EA;--1:#8D46B4">,</span><span style="--0:#D6DEEB;--1:#403F53">fd</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">7</span><span style="--0:#D6DEEB;--1:#403F53">))</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">16384</span><span style="--0:#D6DEEB;--1:#403F53">                        </span><span style="--0:#F78C6C;--1:#AA0982">127.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.1:10257</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0:</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">users:</span><span style="--0:#D6DEEB;--1:#403F53">(("kube</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">controller"</span><span style="--0:#C792EA;--1:#8D46B4">,</span><span style="--0:#D6DEEB;--1:#403F53">pid</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">9370</span><span style="--0:#C792EA;--1:#8D46B4">,</span><span style="--0:#D6DEEB;--1:#403F53">fd</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">7</span><span style="--0:#D6DEEB;--1:#403F53">))</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">16384</span><span style="--0:#D6DEEB;--1:#403F53">                                </span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#ECC48D;--1:#3C63B3">:6443</span><span style="--0:#D6DEEB;--1:#403F53">             </span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#ECC48D;--1:#3C63B3">:</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">users:</span><span style="--0:#D6DEEB;--1:#403F53">(("kube</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">apiserver"</span><span style="--0:#C792EA;--1:#8D46B4">,</span><span style="--0:#D6DEEB;--1:#403F53">pid</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">5989</span><span style="--0:#C792EA;--1:#8D46B4">,</span><span style="--0:#D6DEEB;--1:#403F53">fd</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">7</span><span style="--0:#D6DEEB;--1:#403F53">))</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="> ss -tnulp | grep kubetcp   LISTEN 0      16384                        127.0.0.1:10259      0.0.0.0:*    users:((&#x22;kube-scheduler&#x22;,pid=9385,fd=7))tcp   LISTEN 0      16384                        127.0.0.1:10257      0.0.0.0:*    users:((&#x22;kube-controller&#x22;,pid=9370,fd=7))tcp   LISTEN 0      16384                                *:6443             *:*    users:((&#x22;kube-apiserver&#x22;,pid=5989,fd=7))"><div></div></button></div></figure></div>
<h3 id="45-é…ç½®kubectlæ‰€éœ€è¦çš„kubeconfig">4.5 é…ç½®kubectlæ‰€éœ€è¦çš„kubeconfig</h3>
<p>æ­¥éª¤å¤§ä½“å’Œä¸Šé¢éƒ½æ˜¯ä¸€è‡´çš„ã€‚</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">cd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/TLS/k8s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubectl-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"CN"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">kubectl</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"hosts"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [],</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"key"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"algo"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">rsa</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"size"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">2048</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">},</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"names"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"C"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">CN</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"L"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">HangZhou</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"ST"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">ZheJiang</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"O"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">system:masters</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"OU"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">System</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">cfssl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">gencert</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-ca=ca.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-ca-key=ca-key.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-config=ca-config.json</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-profile=kubernetes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubectl-csr.json</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">cfssl-json</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-bare</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubectl</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># è¿™ä¸ªä½ æ”¾åˆ°å’Œä¸Šé¢åŒæ ·çš„ä½ç½®ï¼Œç„¶åå¤åˆ¶åˆ°~/.kubeé‡Œé¢ä¹Ÿè¡Œï¼Œè¿™é‡Œæˆ‘å›¾ä¸ªæ–¹ä¾¿</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># æ·»åŠ é›†ç¾¤apiserverä¿¡æ¯</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">config</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">set-cluster</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">--certificate-authority=/etc/kubernetes/TLS/k8s/ca.pem </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">--embed-certs=true </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">--server=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://172.19.82.157:6443</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">--kubeconfig=/root/.kube/config</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># æ·»åŠ è¯ä¹¦æ–‡ä»¶ä¿¡æ¯</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">config</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">set-credentials</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">cluster-admin</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">--client-certificate=/etc/kubernetes/TLS/k8s/kubectl.pem </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">--client-key=/etc/kubernetes/TLS/k8s/kubectl-key.pem </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">--embed-certs=true </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">--kubeconfig=/root/.kube/config</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># æ·»åŠ ç”¨æˆ·</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">config</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">set-context</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">default</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">--cluster=kubernetes </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">--user=cluster-admin </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">--kubeconfig=/root/.kube/config</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># æŒ‡å®šé»˜è®¤çš„é›†ç¾¤</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">config</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">use-context</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">default</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--kubeconfig=/root/.kube/config</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="cd /etc/kubernetes/TLS/k8svim kubectl-csr.json{  &#x22;CN&#x22;: &#x22;kubectl&#x22;,  &#x22;hosts&#x22;: [],  &#x22;key&#x22;: {    &#x22;algo&#x22;: &#x22;rsa&#x22;,    &#x22;size&#x22;: 2048  },  &#x22;names&#x22;: [        {            &#x22;C&#x22;: &#x22;CN&#x22;,            &#x22;L&#x22;: &#x22;HangZhou&#x22;,            &#x22;ST&#x22;: &#x22;ZheJiang&#x22;,      &#x22;O&#x22;: &#x22;system:masters&#x22;,      &#x22;OU&#x22;: &#x22;System&#x22;        }  ]}cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=kubernetes kubectl-csr.json | cfssl-json -bare kubectlkubectl config set-cluster kubernetes \--certificate-authority=/etc/kubernetes/TLS/k8s/ca.pem \--embed-certs=true \--server=&#x22;https://172.19.82.157:6443&#x22; \--kubeconfig=/root/.kube/configkubectl config set-credentials cluster-admin \--client-certificate=/etc/kubernetes/TLS/k8s/kubectl.pem \--client-key=/etc/kubernetes/TLS/k8s/kubectl-key.pem \--embed-certs=true \--kubeconfig=/root/.kube/configkubectl config set-context default \--cluster=kubernetes \--user=cluster-admin \--kubeconfig=/root/.kube/configkubectl config use-context default --kubeconfig=/root/.kube/config"><div></div></button></div></figure></div>
<p><img src="https://cdn.agou-ops.cn/others/20230823163202.png" alt="image.png"></p>
<h3 id="46-éƒ¨ç½²nodeç›¸å…³ç»„ä»¶kube-proxykubelet">4.6 éƒ¨ç½²nodeç›¸å…³ç»„ä»¶kube-proxyã€kubelet</h3>
<h4 id="461-bootstrapè‡ªåŠ¨è®¤è¯kubelet">4.6.1 bootstrapè‡ªåŠ¨è®¤è¯kubelet</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">cd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/config</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># ç”Ÿæˆéšæœºè®¤è¯tokenidå’Œsecretï¼Œå¹¶èµ‹äºˆæƒé™ï¼Œä¸‹é¢ç›´åˆ°EOFä¸€å—æ‰§è¡Œã€‚</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">TOKEN_ID</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--1:#3C63B3"><span style="--0:#ECC48D">`</span><span style="--0:#82AAFF">head</span><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">-c</span><span style="--0:#ECC48D"> </span></span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3"> /dev/urandom </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--1:#3C63B3"><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">od</span><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">-An</span><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">-t</span><span style="--0:#ECC48D"> x </span></span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--1:#3C63B3"><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">tr</span><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">-d</span><span style="--0:#ECC48D"> </span></span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E"> </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#3C63B3"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--1:#3C63B3"><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">head</span><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">-c6</span><span style="--0:#ECC48D">`</span></span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">TOKEN_SECRET</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--1:#3C63B3"><span style="--0:#ECC48D">`</span><span style="--0:#82AAFF">head</span><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">-c</span><span style="--0:#ECC48D"> </span></span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3"> /dev/urandom </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--1:#3C63B3"><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">od</span><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">-An</span><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">-t</span><span style="--0:#ECC48D"> x </span></span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--1:#3C63B3"><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">tr</span><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">-d</span><span style="--0:#ECC48D"> </span></span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E"> </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#3C63B3"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--1:#3C63B3"><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">head</span><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">-c16</span><span style="--0:#ECC48D">`</span></span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">cat</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">></span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">bootstrap.secret.yaml</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">&#x3C;&#x3C;</span><span style="--0:#D9F5DD;--1:#111111">EOF</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">apiVersion: v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">kind: Secret</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">name: bootstrap-token-</span><span style="--0:#C5E478;--1:#3C63B3">$a</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">namespace: kube-system</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">type: bootstrap.kubernetes.io/token</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">stringData:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">description: "The default bootstrap token generated by 'kubelet '."</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">token-id: "</span><span style="--0:#C5E478;--1:#3C63B3">$TOKEN_ID</span><span style="--0:#ECC48D;--1:#3C63B3">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">token-secret: "</span><span style="--0:#C5E478;--1:#3C63B3">$TOKEN_SECRET</span><span style="--0:#ECC48D;--1:#3C63B3">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">usage-bootstrap-authentication: "true"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">usage-bootstrap-signing: "true"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">auth-extra-groups:  system:bootstrappers:default-node-token,system:bootstrappers:worker,system:bootstrappers:ingress</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">apiVersion: rbac.authorization.k8s.io/v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">kind: ClusterRoleBinding</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">name: kubelet-bootstrap</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">roleRef:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">apiGroup: rbac.authorization.k8s.io</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">kind: ClusterRole</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">name: system:node-bootstrapper</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">subjects:</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">- apiGroup: rbac.authorization.k8s.io</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">kind: Group</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">name: system:bootstrappers:default-node-token</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">apiVersion: rbac.authorization.k8s.io/v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">kind: ClusterRoleBinding</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">name: node-autoapprove-bootstrap</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">roleRef:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">apiGroup: rbac.authorization.k8s.io</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">kind: ClusterRole</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">name: system:certificates.k8s.io:certificatesigningrequests:nodeclient</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">subjects:</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">- apiGroup: rbac.authorization.k8s.io</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">kind: Group</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">name: system:bootstrappers:default-node-token</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">apiVersion: rbac.authorization.k8s.io/v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">kind: ClusterRoleBinding</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">name: node-autoapprove-certificate-rotation</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">roleRef:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">apiGroup: rbac.authorization.k8s.io</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">kind: ClusterRole</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">name: system:certificates.k8s.io:certificatesigningrequests:selfnodeclient</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">subjects:</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">- apiGroup: rbac.authorization.k8s.io</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">kind: Group</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">name: system:nodes</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">apiVersion: rbac.authorization.k8s.io/v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">kind: ClusterRole</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">annotations:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">    </span></span><span style="--0:#ECC48D;--1:#3C63B3">rbac.authorization.kubernetes.io/autoupdate: "true"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">labels:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">    </span></span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes.io/bootstrapping: rbac-defaults</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">name: system:kube-apiserver-to-kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">rules:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">- apiGroups:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">      </span></span><span style="--0:#ECC48D;--1:#3C63B3">- ""</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">    </span></span><span style="--0:#ECC48D;--1:#3C63B3">resources:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">      </span></span><span style="--0:#ECC48D;--1:#3C63B3">- nodes/proxy</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">      </span></span><span style="--0:#ECC48D;--1:#3C63B3">- nodes/stats</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">      </span></span><span style="--0:#ECC48D;--1:#3C63B3">- nodes/log</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">      </span></span><span style="--0:#ECC48D;--1:#3C63B3">- nodes/spec</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">      </span></span><span style="--0:#ECC48D;--1:#3C63B3">- nodes/metrics</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">    </span></span><span style="--0:#ECC48D;--1:#3C63B3">verbs:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">      </span></span><span style="--0:#ECC48D;--1:#3C63B3">- "*"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">apiVersion: rbac.authorization.k8s.io/v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">kind: ClusterRoleBinding</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">name: system:kube-apiserver</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">namespace: ""</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">roleRef:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">apiGroup: rbac.authorization.k8s.io</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">kind: ClusterRole</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">name: system:kube-apiserver-to-kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">subjects:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">- apiGroup: rbac.authorization.k8s.io</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">    </span></span><span style="--0:#ECC48D;--1:#3C63B3">kind: User</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">    </span></span><span style="--0:#ECC48D;--1:#3C63B3">name: kube-apiserver</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D9F5DD;--1:#111111">EOF</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># æ·»åŠ é›†ç¾¤apiserverä¿¡æ¯</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">config</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">set-cluster</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--certificate-authority=/etc/kubernetes/TLS/k8s/ca.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--embed-certs=true</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--server=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://172.19.82.157:6443</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--kubeconfig=/etc/kubernetes/config/kubelet-bootstrap.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># æ·»åŠ è¯ä¹¦æ–‡ä»¶ä¿¡æ¯</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">config</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">set-credentials</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubelet-bootstrap-user</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--1:#3C63B3"><span style="--0:#82AAFF">--token=</span><span style="--0:#C5E478">$TOKEN_ID</span><span style="--0:#82AAFF">.</span><span style="--0:#C5E478">$TOKEN_SECRET</span></span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--kubeconfig=/etc/kubernetes/config/kubelet-bootstrap.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># æ·»åŠ ç”¨æˆ·</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">config</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">set-context</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubelet-bootstrap-user@kubernetes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--cluster=kubernetes</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--user=kubelet-bootstrap-user</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--kubeconfig=/etc/kubernetes/config/kubelet-bootstrap.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># æŒ‡å®šé»˜è®¤çš„é›†ç¾¤</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">config</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">use-context</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubelet-bootstrap-user@kubernetes</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--kubeconfig=/etc/kubernetes/config/kubelet-bootstrap.kubeconfig</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="cd /etc/kubernetes/configTOKEN_ID=&#x60;head -c 16 /dev/urandom | od -An -t x | tr -d &#x27; &#x27; | head -c6&#x60;TOKEN_SECRET=&#x60;head -c 16 /dev/urandom | od -An -t x | tr -d &#x27; &#x27; | head -c16&#x60;cat > bootstrap.secret.yaml <<EOFapiVersion: v1kind: Secretmetadata:  name: bootstrap-token-$a  namespace: kube-systemtype: bootstrap.kubernetes.io/tokenstringData:  description: &#x22;The default bootstrap token generated by &#x27;kubelet &#x27;.&#x22;  token-id: &#x22;$TOKEN_ID&#x22;  token-secret: &#x22;$TOKEN_SECRET&#x22;  usage-bootstrap-authentication: &#x22;true&#x22;  usage-bootstrap-signing: &#x22;true&#x22;  auth-extra-groups:  system:bootstrappers:default-node-token,system:bootstrappers:worker,system:bootstrappers:ingress---apiVersion: rbac.authorization.k8s.io/v1kind: ClusterRoleBindingmetadata:  name: kubelet-bootstraproleRef:  apiGroup: rbac.authorization.k8s.io  kind: ClusterRole  name: system:node-bootstrappersubjects:- apiGroup: rbac.authorization.k8s.io  kind: Group  name: system:bootstrappers:default-node-token---apiVersion: rbac.authorization.k8s.io/v1kind: ClusterRoleBindingmetadata:  name: node-autoapprove-bootstraproleRef:  apiGroup: rbac.authorization.k8s.io  kind: ClusterRole  name: system:certificates.k8s.io:certificatesigningrequests:nodeclientsubjects:- apiGroup: rbac.authorization.k8s.io  kind: Group  name: system:bootstrappers:default-node-token---apiVersion: rbac.authorization.k8s.io/v1kind: ClusterRoleBindingmetadata:  name: node-autoapprove-certificate-rotationroleRef:  apiGroup: rbac.authorization.k8s.io  kind: ClusterRole  name: system:certificates.k8s.io:certificatesigningrequests:selfnodeclientsubjects:- apiGroup: rbac.authorization.k8s.io  kind: Group  name: system:nodes---apiVersion: rbac.authorization.k8s.io/v1kind: ClusterRolemetadata:  annotations:    rbac.authorization.kubernetes.io/autoupdate: &#x22;true&#x22;  labels:    kubernetes.io/bootstrapping: rbac-defaults  name: system:kube-apiserver-to-kubeletrules:  - apiGroups:      - &#x22;&#x22;    resources:      - nodes/proxy      - nodes/stats      - nodes/log      - nodes/spec      - nodes/metrics    verbs:      - &#x22;*&#x22;---apiVersion: rbac.authorization.k8s.io/v1kind: ClusterRoleBindingmetadata:  name: system:kube-apiserver  namespace: &#x22;&#x22;roleRef:  apiGroup: rbac.authorization.k8s.io  kind: ClusterRole  name: system:kube-apiserver-to-kubeletsubjects:  - apiGroup: rbac.authorization.k8s.io    kind: User    name: kube-apiserverEOFkubectl config set-cluster kubernetes  \  --certificate-authority=/etc/kubernetes/TLS/k8s/ca.pem \  --embed-certs=true   \  --server=&#x22;https://172.19.82.157:6443&#x22; \  --kubeconfig=/etc/kubernetes/config/kubelet-bootstrap.kubeconfigkubectl config set-credentials kubelet-bootstrap-user  \  --token=$TOKEN_ID.$TOKEN_SECRET \  --kubeconfig=/etc/kubernetes/config/kubelet-bootstrap.kubeconfigkubectl config set-context kubelet-bootstrap-user@kubernetes \  --cluster=kubernetes   \  --user=kubelet-bootstrap-user \  --kubeconfig=/etc/kubernetes/config/kubelet-bootstrap.kubeconfigkubectl config use-context kubelet-bootstrap-user@kubernetes  \  --kubeconfig=/etc/kubernetes/config/kubelet-bootstrap.kubeconfig"><div></div></button></div></figure></div>
<h4 id="462-éƒ¨ç½²kubelet">4.6.2 éƒ¨ç½²kubelet</h4>
<p>âš  ç”±äºmasterèŠ‚ç‚¹åŒæ ·è¦è¿è¡Œä¸€äº›podï¼Œæ¯”å¦‚flannelã€calicoç½‘ç»œç»„ä»¶ç­‰ï¼Œæ‰€ä»¥åœ¨masterèŠ‚ç‚¹ä¹Ÿéœ€è¦å®‰è£…Kubeletå’ŒKube-proxyç»„ä»¶ã€‚</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># å‚è€ƒï¼šhttps://kubernetes.io/zh-cn/docs/reference/config-api/kubelet-config.v1beta1/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/config/kubelet-conf.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">apiVersion:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubelet.config.k8s.io/v1beta1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">KubeletConfiguration</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">address:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">172.19</span><span style="--0:#ECC48D;--1:#3C63B3">.82.157</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">port:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10250</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">readOnlyPort:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10255</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">authentication:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">anonymous:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">enabled:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">false</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">webhook:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">cacheTTL:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">m0s</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">enabled:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">x509:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">clientCAFile:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/TLS/k8s/ca.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">authorization:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">mode:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Webhook</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">webhook:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">cacheAuthorizedTTL:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">5</span><span style="--0:#ECC48D;--1:#3C63B3">m0s</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">cacheUnauthorizedTTL:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">30</span><span style="--0:#ECC48D;--1:#3C63B3">s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">cgroupDriver:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">systemd</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">cgroupsPerQOS:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">clusterDNS:</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10.100</span><span style="--0:#ECC48D;--1:#3C63B3">.0.2</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">clusterDomain:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">cluster.local</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">containerLogMaxFiles:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">5</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">containerLogMaxSize:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10</span><span style="--0:#ECC48D;--1:#3C63B3">Mi</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">contentType:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">application/vnd.kubernetes.protobuf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">cpuCFSQuota:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">cpuManagerPolicy:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">none</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">cpuManagerReconcilePeriod:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10</span><span style="--0:#ECC48D;--1:#3C63B3">s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">enableControllerAttachDetach:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">enableDebuggingHandlers:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">enforceNodeAllocatable:</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">pods</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">eventBurst:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">eventRecordQPS:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">5</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">evictionHard:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">imagefs.available:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">15</span><span style="--0:#ECC48D;--1:#3C63B3">%</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">memory.available:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">100</span><span style="--0:#ECC48D;--1:#3C63B3">Mi</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">nodefs.available:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10</span><span style="--0:#ECC48D;--1:#3C63B3">%</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">nodefs.inodesFree:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">5</span><span style="--0:#ECC48D;--1:#3C63B3">%</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">evictionPressureTransitionPeriod:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">5</span><span style="--0:#ECC48D;--1:#3C63B3">m0s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">failSwapOn:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">fileCheckFrequency:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">20</span><span style="--0:#ECC48D;--1:#3C63B3">s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">hairpinMode:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">promiscuous-bridge</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">healthzBindAddress:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">127.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">healthzPort:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10248</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">httpCheckFrequency:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">20</span><span style="--0:#ECC48D;--1:#3C63B3">s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">imageGCHighThresholdPercent:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">85</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">imageGCLowThresholdPercent:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">80</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">imageMinimumGCAge:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">m0s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">iptablesDropBit:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">15</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">iptablesMasqueradeBit:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">14</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubeAPIBurst:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubeAPIQPS:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">5</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">makeIPTablesUtilChains:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">maxOpenFiles:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1000000</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">maxPods:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">110</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">nodeStatusUpdateFrequency:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10</span><span style="--0:#ECC48D;--1:#3C63B3">s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">oomScoreAdj:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-999</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">podPidsLimit:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">registryBurst:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">registryPullQPS:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">5</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">resolvConf:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/resolv.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">rotateCertificates:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">runtimeRequestTimeout:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">m0s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">serializeImagePulls:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">staticPodPath:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/manifests</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">streamingConnectionIdleTimeout:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">4</span><span style="--0:#ECC48D;--1:#3C63B3">h0m0s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">syncFrequency:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">m0s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">volumeStatsAggPeriod:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">m0s</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/kubernetes/server/bin/kubelet-startup.sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#!/usr/bin/env sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">./kubelet</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--bootstrap-kubeconfig=/etc/kubernetes/config/kubelet-bootstrap.kubeconfig</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--kubeconfig=/etc/kubernetes/config/kubelet.kubeconfig</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--config=/etc/kubernetes/config/kubelet-conf.yml</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--hostname-override=master0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--node-labels=node.kubernetes.io/node=</span><span style="--0:#D9F5DD;--1:#111111">''</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--container-runtime-endpoint=unix:///var/run/containerd/containerd.sock</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># æ·»åŠ é›†ç¾¤apiserverä¿¡æ¯</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">config</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">set-cluster</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">--certificate-authority=/etc/kubernetes/TLS/k8s/ca.pem </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">--embed-certs=true </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">--server=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://172.19.82.157:6443</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">--kubeconfig=/etc/kubernetes/config/kubelet-bootstrap.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># æ·»åŠ è¯ä¹¦æ–‡ä»¶ä¿¡æ¯ï¼Œä¸‹é¢è¿™ä¸ªtokenæ˜¯ä¹‹å‰ç”Ÿæˆçš„ï¼Œä¹Ÿå°±æ˜¯/etc/kubernetes/config/token.csv</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">config</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">set-credentials</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubelet-bootstrap</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">--token=8d435b925863119020c4da4d16e064c8 </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">--kubeconfig=/etc/kubernetes/config/kubelet-bootstrap.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># æ·»åŠ ç”¨æˆ·</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">config</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">set-context</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">default</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">--cluster=kubernetes </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">--user=kubelet-bootstrap </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">--kubeconfig=/etc/kubernetes/config/kubelet-bootstrap.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># æŒ‡å®šé»˜è®¤çš„é›†ç¾¤</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">config</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">use-context</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">default</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--kubeconfig=/etc/kubernetes/config/kubelet-bootstrap.kubeconfig</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">chmod</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">+x</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/kubernetes/server/bin/kubelet-startup.sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">mkdir</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-pv</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/logs/kubernetes/kubelet/</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/manifests/</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/supervisor/conf.d/kubelet.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[program:kubelet-157]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">command</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/kubernetes/server/bin/kubelet-startup.sh</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                  </span></span><span style="--0:#D6DEEB;--1:#403F53">; </span><span style="--0:#82AAFF;--1:#3C63B3">the</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">program</span><span style="--0:#D6DEEB;--1:#403F53"> (relative </span><span style="--0:#ECC48D;--1:#3C63B3">uses</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">PATH,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">can</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">take</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">args</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">numprocs</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">                                                               ; </span><span style="--0:#82AAFF;--1:#3C63B3">number</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">of</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">processes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">copies</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">start</span><span style="--0:#D6DEEB;--1:#403F53"> (def </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">directory</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/kubernetes/server/bin</span><span style="--0:#D6DEEB;--1:#403F53">                                  ; </span><span style="--0:#82AAFF;--1:#3C63B3">directory</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">cwd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">before</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">exec</span><span style="--0:#D6DEEB;--1:#403F53"> (def </span><span style="--0:#ECC48D;--1:#3C63B3">no</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">cwd</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">autostart</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53">                                                           ; </span><span style="--0:#82AAFF;--1:#3C63B3">start</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">at</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">supervisord</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">start</span><span style="--0:#D6DEEB;--1:#403F53"> (default: </span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">autorestart</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53">                                                         ; </span><span style="--0:#82AAFF;--1:#3C63B3">retstart</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">at</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">unexpected</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">quit</span><span style="--0:#D6DEEB;--1:#403F53"> (default: </span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">startsecs</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">                                                             ; </span><span style="--0:#82AAFF;--1:#3C63B3">number</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">of</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">secs</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">prog</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">must</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">stay</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">running</span><span style="--0:#D6DEEB;--1:#403F53"> (def. </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">startretries</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#D6DEEB;--1:#403F53">                                                           ; </span><span style="--0:#82AAFF;--1:#3C63B3">max</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#809191;--1:#616671"># of serial start failures (default 3)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">exitcodes</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#ECC48D;--1:#3C63B3">,2</span><span style="--0:#D6DEEB;--1:#403F53">                                                            ; </span><span style="--0:#82AAFF;--1:#3C63B3">'expected'</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">exit</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">codes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">for</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">process</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#ECC48D;--1:#3C63B3">,2</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stopsignal</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">QUIT</span><span style="--0:#D6DEEB;--1:#403F53">                                                          ; </span><span style="--0:#82AAFF;--1:#3C63B3">signal</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">used</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kill</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">process</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#ECC48D;--1:#3C63B3">TERM</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stopwaitsecs</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">10</span><span style="--0:#D6DEEB;--1:#403F53">                                                          ; </span><span style="--0:#82AAFF;--1:#3C63B3">max</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">num</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">secs</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">wait</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">b4</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">SIGKILL</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#F78C6C;--1:#AA0982">10</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">user</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53">                                                                ; </span><span style="--0:#82AAFF;--1:#3C63B3">setuid</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">this</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">UNIX</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">account</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">run</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">the</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">program</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">redirect_stderr</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53">                                                     ; </span><span style="--0:#82AAFF;--1:#3C63B3">redirect</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">proc</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">stderr</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">stdout</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#82AAFF;--1:#3C63B3">false</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stdout_logfile</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/logs/kubernetes/kubelet/kubelet.stdout.log</span><span style="--0:#D6DEEB;--1:#403F53"> ; </span><span style="--0:#82AAFF;--1:#3C63B3">stderr</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">log</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">path,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">NONE</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">for</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">none</span><span style="--0:#D6DEEB;--1:#403F53">; </span><span style="--0:#82AAFF;--1:#3C63B3">default</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">AUTO</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stdout_logfile_maxbytes</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">64</span><span style="--0:#ECC48D;--1:#3C63B3">MB</span><span style="--0:#D6DEEB;--1:#403F53">                                             ; </span><span style="--0:#82AAFF;--1:#3C63B3">max</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#809191;--1:#616671"># logfile bytes b4 rotation (default 50MB)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stdout_logfile_backups</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">4</span><span style="--0:#D6DEEB;--1:#403F53">                                                 ; </span><span style="--0:#809191;--1:#616671"># of stdout logfile backups (default 10)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stdout_capture_maxbytes</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">MB</span><span style="--0:#D6DEEB;--1:#403F53">                                              ; </span><span style="--0:#82AAFF;--1:#3C63B3">number</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">of</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">bytes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">in</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">capturemode</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stdout_events_enabled</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">false</span><span style="--0:#D6DEEB;--1:#403F53">                                              ; </span><span style="--0:#82AAFF;--1:#3C63B3">emit</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">events</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">on</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">stdout</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">writes</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#82AAFF;--1:#3C63B3">false</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">supervisorctl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">update</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="vim /etc/kubernetes/config/kubelet-conf.ymlapiVersion: kubelet.config.k8s.io/v1beta1kind: KubeletConfigurationaddress: 172.19.82.157port: 10250readOnlyPort: 10255authentication:  anonymous:    enabled: false  webhook:    cacheTTL: 2m0s    enabled: true  x509:    clientCAFile: /etc/kubernetes/TLS/k8s/ca.pemauthorization:  mode: Webhook  webhook:    cacheAuthorizedTTL: 5m0s    cacheUnauthorizedTTL: 30scgroupDriver: systemdcgroupsPerQOS: trueclusterDNS:- 10.100.0.2clusterDomain: cluster.localcontainerLogMaxFiles: 5containerLogMaxSize: 10MicontentType: application/vnd.kubernetes.protobufcpuCFSQuota: truecpuManagerPolicy: nonecpuManagerReconcilePeriod: 10senableControllerAttachDetach: trueenableDebuggingHandlers: trueenforceNodeAllocatable:- podseventBurst: 10eventRecordQPS: 5evictionHard:  imagefs.available: 15%  memory.available: 100Mi  nodefs.available: 10%  nodefs.inodesFree: 5%evictionPressureTransitionPeriod: 5m0sfailSwapOn: truefileCheckFrequency: 20shairpinMode: promiscuous-bridgehealthzBindAddress: 127.0.0.1healthzPort: 10248httpCheckFrequency: 20simageGCHighThresholdPercent: 85imageGCLowThresholdPercent: 80imageMinimumGCAge: 2m0siptablesDropBit: 15iptablesMasqueradeBit: 14kubeAPIBurst: 10kubeAPIQPS: 5makeIPTablesUtilChains: truemaxOpenFiles: 1000000maxPods: 110nodeStatusUpdateFrequency: 10soomScoreAdj: -999podPidsLimit: -1registryBurst: 10registryPullQPS: 5resolvConf: /etc/resolv.confrotateCertificates: trueruntimeRequestTimeout: 2m0sserializeImagePulls: truestaticPodPath: /etc/kubernetes/manifestsstreamingConnectionIdleTimeout: 4h0m0ssyncFrequency: 1m0svolumeStatsAggPeriod: 1m0svim /usr/local/kubernetes/server/bin/kubelet-startup.sh./kubelet \  --bootstrap-kubeconfig=/etc/kubernetes/config/kubelet-bootstrap.kubeconfig \  --kubeconfig=/etc/kubernetes/config/kubelet.kubeconfig \  --config=/etc/kubernetes/config/kubelet-conf.yml \  --hostname-override=master0 \  --node-labels=node.kubernetes.io/node=&#x27;&#x27; \  --container-runtime-endpoint=unix:///var/run/containerd/containerd.sockkubectl config set-cluster kubernetes \--certificate-authority=/etc/kubernetes/TLS/k8s/ca.pem \--embed-certs=true \--server=&#x22;https://172.19.82.157:6443&#x22; \--kubeconfig=/etc/kubernetes/config/kubelet-bootstrap.kubeconfigkubectl config set-credentials kubelet-bootstrap \--token=8d435b925863119020c4da4d16e064c8 \--kubeconfig=/etc/kubernetes/config/kubelet-bootstrap.kubeconfigkubectl config set-context default \--cluster=kubernetes \--user=kubelet-bootstrap \--kubeconfig=/etc/kubernetes/config/kubelet-bootstrap.kubeconfigkubectl config use-context default --kubeconfig=/etc/kubernetes/config/kubelet-bootstrap.kubeconfigchmod +x /usr/local/kubernetes/server/bin/kubelet-startup.shmkdir -pv /data/logs/kubernetes/kubelet/ /etc/kubernetes/manifests/vim /etc/supervisor/conf.d/kubelet.conf[program:kubelet-157]command=/usr/local/kubernetes/server/bin/kubelet-startup.sh                  ; the program (relative uses PATH, can take args)numprocs=1                                                               ; number of processes copies to start (def 1)directory=/usr/local/kubernetes/server/bin                                  ; directory to cwd to before exec (def no cwd)autostart=true                                                           ; start at supervisord start (default: true)autorestart=true                                                         ; retstart at unexpected quit (default: true)startsecs=0                                                             ; number of secs prog must stay running (def. 1)startretries=3                                                           ; max # of serial start failures (default 3)exitcodes=0,2                                                            ; &#x27;expected&#x27; exit codes for process (default 0,2)stopsignal=QUIT                                                          ; signal used to kill process (default TERM)stopwaitsecs=10                                                          ; max num secs to wait b4 SIGKILL (default 10)user=root                                                                ; setuid to this UNIX account to run the programredirect_stderr=true                                                     ; redirect proc stderr to stdout (default false)stdout_logfile=/data/logs/kubernetes/kubelet/kubelet.stdout.log ; stderr log path, NONE for none; default AUTOstdout_logfile_maxbytes=64MB                                             ; max # logfile bytes b4 rotation (default 50MB)stdout_logfile_backups=4                                                 ; # of stdout logfile backups (default 10)stdout_capture_maxbytes=1MB                                              ; number of bytes in &#x27;capturemode&#x27; (default 0)stdout_events_enabled=false                                              ; emit events on stdout writes (default false)supervisorctl update"><div></div></button></div></figure></div>
<p><img src="https://cdn.agou-ops.cn/others/20230824111121.png" alt="image.png"></p>
<h4 id="463-å°†masterèŠ‚ç‚¹ä½œä¸ºnodeåŠ å…¥åˆ°é›†ç¾¤å†…éƒ¨">4.6.3 å°†masterèŠ‚ç‚¹ä½œä¸ºnodeåŠ å…¥åˆ°é›†ç¾¤å†…éƒ¨</h4>
<p><strong>âš  æ³¨æ„ï¼šè¿™ä¸ªæ­¥éª¤å¦‚æœåšäº†bootstrap kubeletï¼Œåˆ™ä¸éœ€è¦æ‰‹åŠ¨æˆæƒï¼Œå¯ç›´æ¥å¿½ç•¥æ”¹æ­¥éª¤ã€‚</strong></p>
<blockquote>
<p>ä»¥ä¸‹æ¥æºäºç½‘ç»œï¼š
å½“kubeletç»„ä»¶å¯åŠ¨æˆåŠŸåï¼Œå°±ä¼šæƒ³apiserverå‘é€ä¸€ä¸ªè¯·æ±‚åŠ å…¥é›†ç¾¤çš„ä¿¡æ¯ï¼Œåªæœ‰å½“masterèŠ‚ç‚¹æˆæƒåŒæ„åï¼Œæ‰å¯ä»¥æ­£å¸¸åŠ å…¥ï¼Œè™½ç„¶æ˜¯masterèŠ‚ç‚¹éƒ¨ç½²çš„nodeç»„ä»¶ï¼Œ> ä½†æ˜¯ä¹Ÿä¼šå‘ç”Ÿä¸€ä¸ªåŠ å…¥é›†ç¾¤çš„ä¿¡æ¯ï¼Œéœ€è¦masteråŒæ„ã€‚</p>
<p>å½“kubeletå¯åŠ¨ä¹‹åï¼Œé¦–å…ˆä¼šåœ¨è¯ä¹¦ç›®å½•ç”Ÿæˆä¸€ä¸ªkubelet-client.key.tmpè¿™ä¸ªæ–‡ä»¶ï¼Œå½“ä½¿ç”¨kubectl certificate approveå‘½ä»¤æˆæƒæˆåŠŸnodeçš„è¯·æ±‚ä¹‹åï¼Œkubele> t-client.key.tmpå°æ—¶ï¼Œéšä¹‹ä¼šç”Ÿæˆä¸€ä¸ªkubelet-client-current.pemçš„è¯ä¹¦æ–‡ä»¶ï¼Œç”¨äºä¸apiserverå»ºç«‹è¿æ¥ï¼Œæ­¤æ—¶å†ä½¿ç”¨kubectl get > nodeå°±ä¼šçœ‹åˆ°èŠ‚ç‚¹ä¿¡æ¯äº†ã€‚</p>
<p>æ‰©å±•ï¼šå¦‚æœåæœŸæƒ³è¦ä¿®æ”¹nodeçš„åç§°ï¼Œé‚£ä¹ˆå°±æŠŠç”Ÿæˆçš„kubeletè¯ä¹¦æ–‡ä»¶å…¨éƒ¨åˆ é™¤ï¼Œç„¶åä½¿ç”¨kubectl delete > nodeåˆ é™¤è¯¥èŠ‚ç‚¹ï¼Œåœ¨ä¿®æ”¹kubeleté…ç½®æ–‡ä»¶ä¸­è¯¥èŠ‚ç‚¹çš„åç§°ï¼Œç„¶åä½¿ç”¨kubectl delete > csråˆ é™¤æˆæƒä¿¡æ¯ï¼Œå†é‡å¯kubeletç”Ÿæˆæ–°çš„æˆæƒä¿¡æ¯ï¼Œç„¶åæˆæƒé€šè¿‡å³å¯çœ‹åˆ°æ–°çš„åå­—çš„nodeèŠ‚ç‚¹ã€‚</p>
<p>åªæœ‰å½“æˆæƒé€šè¿‡åï¼Œkubeletç”Ÿæˆäº†è¯ä¹¦æ–‡ä»¶ï¼Œkubeletçš„ç«¯å£æ‰ä¼šè¢«å¯åŠ¨</p>
<p>æ³¨æ„ï¼šå½“kubeletçš„æˆæƒè¢«masterè¯·æ±‚é€šåï¼Œkube-proxyå¯åŠ¨æˆåŠŸåï¼ŒèŠ‚ç‚¹æ‰ä¼šæ­£çœŸçš„åŠ å…¥é›†ç¾¤ï¼Œå³ä½¿kubectl get > nodeçœ‹åˆ°çš„èŠ‚ç‚¹æ˜¯Readyï¼Œè¯¥èŠ‚ç‚¹ä¹Ÿæ˜¯ä¸å¯ç”¨çš„ï¼Œå¿…é¡»å½“kube-proxyå¯åŠ¨å®Œæ¯•åï¼Œè¿™ä¸ªèŠ‚ç‚¹æ‰ç®—æ­£çœŸçš„å¯åŠ¨å®Œæ¯•.</p>
</blockquote>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># masterèŠ‚ç‚¹ä¸Šï¼Œè·å–è¯·æ±‚åˆ—è¡¨</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">></span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get csr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># output</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                                                   </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">SIGNERNAME</span><span style="--0:#D6DEEB;--1:#403F53">                                    </span><span style="--0:#ECC48D;--1:#3C63B3">REQUESTOR</span><span style="--0:#D6DEEB;--1:#403F53">           </span><span style="--0:#ECC48D;--1:#3C63B3">REQUESTEDDURATION</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">CONDITION</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">node-csr-VVgl1LpQ91JlbJLifEJIy_0KlbQ1mih6GPaGfaykQ-I</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">m46s</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes.io/kube-apiserver-client-kubelet</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">kubelet-bootstrap</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">              </span><span style="--0:#ECC48D;--1:#3C63B3">Pending</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># å‡†è®¸è¯¥èŠ‚ç‚¹åŠ å…¥é›†ç¾¤</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">></span><span style="--0:#D6DEEB;--1:#403F53"> kubectl certificate approve node-csr-VVgl1LpQ91JlbJLifEJIy_0KlbQ1mih6GPaGfaykQ-I</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># output</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">certificatesigningrequest.certificates.k8s.io/node-csr-VVgl1LpQ91JlbJLifEJIy_0KlbQ1mih6GPaGfaykQ-I</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">approved</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="> kubectl get csrNAME                                                   AGE     SIGNERNAME                                    REQUESTOR           REQUESTEDDURATION   CONDITIONnode-csr-VVgl1LpQ91JlbJLifEJIy_0KlbQ1mih6GPaGfaykQ-I   2m46s   kubernetes.io/kube-apiserver-client-kubelet   kubelet-bootstrap   <none>              Pending> kubectl certificate approve node-csr-VVgl1LpQ91JlbJLifEJIy_0KlbQ1mih6GPaGfaykQ-Icertificatesigningrequest.certificates.k8s.io/node-csr-VVgl1LpQ91JlbJLifEJIy_0KlbQ1mih6GPaGfaykQ-I approved"><div></div></button></div></figure></div>
<p>èŠ‚ç‚¹åŠ å…¥ç»“æœ<code dir="auto">kubectl get nodes</code>ï¼š
<img src="https://cdn.agou-ops.cn/others/20230824113851.png" alt="image.png"></p>
<h4 id="463-éƒ¨ç½²kube-proxy">4.6.3 éƒ¨ç½²kube-proxy</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">cat</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">></span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-proxy.yml</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">&#x3C;&#x3C;</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">EOF</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">apiVersion: v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">kind: ServiceAccount</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">name: kube-proxy</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">namespace: kube-system</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">apiVersion: rbac.authorization.k8s.io/v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">kind: ClusterRoleBinding</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">name: system:kube-proxy</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">roleRef:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">apiGroup: rbac.authorization.k8s.io</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">kind: ClusterRole</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">name: system:node-proxier</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">subjects:</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">- kind: ServiceAccount</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">name: kube-proxy</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">namespace: kube-system</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">apiVersion: v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">kind: Secret</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">name: kube-proxy</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">namespace: kube-system</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">  </span></span><span style="--0:#ECC48D;--1:#3C63B3">annotations:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3C63B3">    </span></span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes.io/service-account.name: "kube-proxy"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">type: kubernetes.io/service-account-token</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D9F5DD;--1:#111111">EOF</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">apply</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-f</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-proxy.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># è·å–token</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">JWT_TOKEN</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--1:#3C63B3"><span style="--0:#ECC48D">$(</span><span style="--0:#82AAFF">kubectl</span><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">-n</span><span style="--0:#ECC48D"> kube-system get secret/kube-proxy </span></span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">--output=jsonpath=</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">{.data.token}</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#3C63B3"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--1:#3C63B3"><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">base64</span><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">-d</span><span style="--0:#ECC48D">)</span></span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># æ·»åŠ é›†ç¾¤apiserverä¿¡æ¯</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">config</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">set-cluster</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--certificate-authority=/etc/kubernetes/TLS/k8s/ca.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--embed-certs=true</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--server=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://172.19.82.157:6443</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--kubeconfig=/etc/kubernetes/config/kube-proxy.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># æ·»åŠ token</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">config</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">set-credentials</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">system:kube-proxy</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--1:#3C63B3"><span style="--0:#82AAFF">--token=${</span><span style="--0:#C5E478">JWT_TOKEN</span><span style="--0:#82AAFF">}</span></span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--kubeconfig=/etc/kubernetes/config/kube-proxy.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># æ·»åŠ ç”¨æˆ·</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">config</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">set-context</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">default</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--cluster=kubernetes</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--user=system:kube-proxy</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--kubeconfig=/etc/kubernetes/config/kube-proxy.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># æŒ‡å®šé»˜è®¤çš„é›†ç¾¤</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">config</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">use-context</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">default</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--kubeconfig=/etc/kubernetes/config/kube-proxy.kubeconfig</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># å‚è€ƒï¼šhttps://kubernetes.io/zh-cn/docs/reference/config-api/kube-proxy-config.v1alpha1/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/config/kube-proxy-conf.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">apiVersion:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubeproxy.config.k8s.io/v1alpha1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">bindAddress:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">172.19</span><span style="--0:#ECC48D;--1:#3C63B3">.82.157</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">clientConnection:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">acceptContentTypes:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">""</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">burst:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">contentType:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">application/vnd.kubernetes.protobuf</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">kubeconfig:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/config/kube-proxy.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">qps:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">5</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">clusterCIDR:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10.244</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0/16</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">configSyncPeriod:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">15</span><span style="--0:#ECC48D;--1:#3C63B3">m0s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">conntrack:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">max:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">null</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">maxPerCore:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">32768</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">min:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">131072</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">tcpCloseWaitTimeout:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">h0m0s</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">tcpEstablishedTimeout:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">24</span><span style="--0:#ECC48D;--1:#3C63B3">h0m0s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">enableProfiling:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">false</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">healthzBindAddress:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0:10256</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">hostnameOverride:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#C5E478;--1:#3C63B3">$a</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">iptables:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">masqueradeAll:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">false</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">masqueradeBit:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">14</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">minSyncPeriod:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#ECC48D;--1:#3C63B3">s</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">syncPeriod:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">30</span><span style="--0:#ECC48D;--1:#3C63B3">s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">ipvs:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">masqueradeAll:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">minSyncPeriod:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">5</span><span style="--0:#ECC48D;--1:#3C63B3">s</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">scheduler:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">rr</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">syncPeriod:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">30</span><span style="--0:#ECC48D;--1:#3C63B3">s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">KubeProxyConfiguration</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">metricsBindAddress:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">127.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.1:10249</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">mode:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">ipvs</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">nodePortAddresses:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">null</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">oomScoreAdj:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-999</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">portRange:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">""</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">udpIdleTimeout:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">250</span><span style="--0:#ECC48D;--1:#3C63B3">ms</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/kubernetes/server/bin/kube-proxy-startup.sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#!/usr/bin/env sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">./kube-proxy</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--config=/etc/kubernetes/config/kube-proxy-conf.yml</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">--v=2</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">chmod</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">+x</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/kubernetes/server/bin/kube-proxy-startup.sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">mkdir</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-pv</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/logs/kubernetes/kube-proxy/</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/supervisor/conf.d/kube-proxy.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[program:kube-proxy-157]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">command</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/kubernetes/server/bin/kube-proxy-startup.sh</span><span style="--0:#D6DEEB;--1:#403F53">     ; </span><span style="--0:#82AAFF;--1:#3C63B3">the</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">program</span><span style="--0:#D6DEEB;--1:#403F53"> (relative </span><span style="--0:#ECC48D;--1:#3C63B3">uses</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">PATH,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">can</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">take</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">args</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">numprocs</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">                                                               ; </span><span style="--0:#82AAFF;--1:#3C63B3">number</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">of</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">processes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">copies</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">start</span><span style="--0:#D6DEEB;--1:#403F53"> (def </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">directory</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/kubernetes/server/bin</span><span style="--0:#D6DEEB;--1:#403F53">                                  ; </span><span style="--0:#82AAFF;--1:#3C63B3">directory</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">cwd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">before</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">exec</span><span style="--0:#D6DEEB;--1:#403F53"> (def </span><span style="--0:#ECC48D;--1:#3C63B3">no</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">cwd</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">autostart</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53">                                                           ; </span><span style="--0:#82AAFF;--1:#3C63B3">start</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">at</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">supervisord</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">start</span><span style="--0:#D6DEEB;--1:#403F53"> (default: </span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">autorestart</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53">                                                         ; </span><span style="--0:#82AAFF;--1:#3C63B3">retstart</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">at</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">unexpected</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">quit</span><span style="--0:#D6DEEB;--1:#403F53"> (default: </span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">startsecs</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">                                                             ; </span><span style="--0:#82AAFF;--1:#3C63B3">number</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">of</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">secs</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">prog</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">must</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">stay</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">running</span><span style="--0:#D6DEEB;--1:#403F53"> (def. </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">startretries</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#D6DEEB;--1:#403F53">                                                           ; </span><span style="--0:#82AAFF;--1:#3C63B3">max</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#809191;--1:#616671"># of serial start failures (default 3)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">exitcodes</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#ECC48D;--1:#3C63B3">,2</span><span style="--0:#D6DEEB;--1:#403F53">                                                            ; </span><span style="--0:#82AAFF;--1:#3C63B3">'expected'</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">exit</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">codes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">for</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">process</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#ECC48D;--1:#3C63B3">,2</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stopsignal</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">QUIT</span><span style="--0:#D6DEEB;--1:#403F53">                                                          ; </span><span style="--0:#82AAFF;--1:#3C63B3">signal</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">used</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kill</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">process</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#ECC48D;--1:#3C63B3">TERM</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stopwaitsecs</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">10</span><span style="--0:#D6DEEB;--1:#403F53">                                                          ; </span><span style="--0:#82AAFF;--1:#3C63B3">max</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">num</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">secs</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">wait</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">b4</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">SIGKILL</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#F78C6C;--1:#AA0982">10</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">user</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53">                                                                ; </span><span style="--0:#82AAFF;--1:#3C63B3">setuid</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">this</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">UNIX</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">account</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">run</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">the</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">program</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">redirect_stderr</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53">                                                     ; </span><span style="--0:#82AAFF;--1:#3C63B3">redirect</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">proc</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">stderr</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">stdout</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#82AAFF;--1:#3C63B3">false</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stdout_logfile</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/logs/kubernetes/kube-proxy/kube-proxy.stdout.log</span><span style="--0:#D6DEEB;--1:#403F53"> ; </span><span style="--0:#82AAFF;--1:#3C63B3">stderr</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">log</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">path,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">NONE</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">for</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">none</span><span style="--0:#D6DEEB;--1:#403F53">; </span><span style="--0:#82AAFF;--1:#3C63B3">default</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">AUTO</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stdout_logfile_maxbytes</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">64</span><span style="--0:#ECC48D;--1:#3C63B3">MB</span><span style="--0:#D6DEEB;--1:#403F53">                                             ; </span><span style="--0:#82AAFF;--1:#3C63B3">max</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#809191;--1:#616671"># logfile bytes b4 rotation (default 50MB)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stdout_logfile_backups</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">4</span><span style="--0:#D6DEEB;--1:#403F53">                                                 ; </span><span style="--0:#809191;--1:#616671"># of stdout logfile backups (default 10)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stdout_capture_maxbytes</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">MB</span><span style="--0:#D6DEEB;--1:#403F53">                                              ; </span><span style="--0:#82AAFF;--1:#3C63B3">number</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">of</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">bytes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">in</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">capturemode</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">stdout_events_enabled</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">false</span><span style="--0:#D6DEEB;--1:#403F53">                                              ; </span><span style="--0:#82AAFF;--1:#3C63B3">emit</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">events</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">on</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">stdout</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">writes</span><span style="--0:#D6DEEB;--1:#403F53"> (default </span><span style="--0:#82AAFF;--1:#3C63B3">false</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">supervisorctl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">update</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="cat > kube-proxy.yml << EOFapiVersion: v1kind: ServiceAccountmetadata:  name: kube-proxy  namespace: kube-system---apiVersion: rbac.authorization.k8s.io/v1kind: ClusterRoleBindingmetadata:  name: system:kube-proxyroleRef:  apiGroup: rbac.authorization.k8s.io  kind: ClusterRole  name: system:node-proxiersubjects:- kind: ServiceAccount  name: kube-proxy  namespace: kube-system---apiVersion: v1kind: Secretmetadata:  name: kube-proxy  namespace: kube-system  annotations:    kubernetes.io/service-account.name: &#x22;kube-proxy&#x22;type: kubernetes.io/service-account-tokenEOFkubectl apply -f kube-proxy.ymlJWT_TOKEN=$(kubectl -n kube-system get secret/kube-proxy \--output=jsonpath=&#x27;{.data.token}&#x27; | base64 -d)kubectl config set-cluster kubernetes   \  --certificate-authority=/etc/kubernetes/TLS/k8s/ca.pem \  --embed-certs=true    \  --server=&#x22;https://172.19.82.157:6443&#x22; \  --kubeconfig=/etc/kubernetes/config/kube-proxy.kubeconfigkubectl config set-credentials system:kube-proxy    \  --token=${JWT_TOKEN}   \  --kubeconfig=/etc/kubernetes/config/kube-proxy.kubeconfigkubectl config set-context default    \  --cluster=kubernetes   \  --user=system:kube-proxy   \  --kubeconfig=/etc/kubernetes/config/kube-proxy.kubeconfigkubectl config use-context default   \  --kubeconfig=/etc/kubernetes/config/kube-proxy.kubeconfigvim /etc/kubernetes/config/kube-proxy-conf.ymlapiVersion: kubeproxy.config.k8s.io/v1alpha1bindAddress: 172.19.82.157clientConnection:  acceptContentTypes: &#x22;&#x22;  burst: 10  contentType: application/vnd.kubernetes.protobuf  kubeconfig: /etc/kubernetes/config/kube-proxy.kubeconfig  qps: 5clusterCIDR: 10.244.0.0/16configSyncPeriod: 15m0sconntrack:  max: null  maxPerCore: 32768  min: 131072  tcpCloseWaitTimeout: 1h0m0s  tcpEstablishedTimeout: 24h0m0senableProfiling: falsehealthzBindAddress: 0.0.0.0:10256hostnameOverride: &#x22;$a&#x22;iptables:  masqueradeAll: false  masqueradeBit: 14  minSyncPeriod: 0s  syncPeriod: 30sipvs:  masqueradeAll: true  minSyncPeriod: 5s  scheduler: &#x22;rr&#x22;  syncPeriod: 30skind: KubeProxyConfigurationmetricsBindAddress: 127.0.0.1:10249mode: &#x22;ipvs&#x22;nodePortAddresses: nulloomScoreAdj: -999portRange: &#x22;&#x22;udpIdleTimeout: 250msvim /usr/local/kubernetes/server/bin/kube-proxy-startup.sh./kube-proxy \  --config=/etc/kubernetes/config/kube-proxy-conf.yml \  --v=2chmod +x /usr/local/kubernetes/server/bin/kube-proxy-startup.shmkdir -pv /data/logs/kubernetes/kube-proxy/vim /etc/supervisor/conf.d/kube-proxy.conf[program:kube-proxy-157]command=/usr/local/kubernetes/server/bin/kube-proxy-startup.sh     ; the program (relative uses PATH, can take args)numprocs=1                                                               ; number of processes copies to start (def 1)directory=/usr/local/kubernetes/server/bin                                  ; directory to cwd to before exec (def no cwd)autostart=true                                                           ; start at supervisord start (default: true)autorestart=true                                                         ; retstart at unexpected quit (default: true)startsecs=0                                                             ; number of secs prog must stay running (def. 1)startretries=3                                                           ; max # of serial start failures (default 3)exitcodes=0,2                                                            ; &#x27;expected&#x27; exit codes for process (default 0,2)stopsignal=QUIT                                                          ; signal used to kill process (default TERM)stopwaitsecs=10                                                          ; max num secs to wait b4 SIGKILL (default 10)user=root                                                                ; setuid to this UNIX account to run the programredirect_stderr=true                                                     ; redirect proc stderr to stdout (default false)stdout_logfile=/data/logs/kubernetes/kube-proxy/kube-proxy.stdout.log ; stderr log path, NONE for none; default AUTOstdout_logfile_maxbytes=64MB                                             ; max # logfile bytes b4 rotation (default 50MB)stdout_logfile_backups=4                                                 ; # of stdout logfile backups (default 10)stdout_capture_maxbytes=1MB                                              ; number of bytes in &#x27;capturemode&#x27; (default 0)stdout_events_enabled=false                                              ; emit events on stdout writes (default false)supervisorctl update"><div></div></button></div></figure></div>
<p><img src="https://cdn.agou-ops.cn/others/20230824115519.png" alt="image.png"></p>
<h4 id="464-æˆæƒapiserverè®¿é—®kubelet">4.6.4 æˆæƒapiserverè®¿é—®kubelet</h4>
<p>å¦‚æœä¸åšè¯¥æˆæƒçš„è¯ï¼Œä¼šå¯¼è‡´kubectlæ— æ³•è·å–åˆ°é›†ç¾¤çš„ä¸€äº›ä¿¡æ¯ï¼Œæ¯”å¦‚logs.
åˆ›å»ºä¸€ä¸ªRBACèµ„æºä½¿å¾—apiserverèƒ½å¤Ÿè®¿é—®kubeletï¼š</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">cd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/config</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">apiserver2kubelet-rbac.yaml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">apiVersion:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">rbac.authorization.k8s.io/v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ClusterRole</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">annotations:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">rbac.authorization.kubernetes.io/autoupdate:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">true</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">labels:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">kubernetes.io/bootstrapping:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">rbac-defaults</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">system:kube-apiserver-to-kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">rules:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">apiGroups:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">""</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">resources:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">nodes/proxy</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">nodes/stats</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">nodes/log</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">nodes/spec</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">nodes/metrics</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">pods/log</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">verbs:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">*</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">apiVersion:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">rbac.authorization.k8s.io/v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ClusterRoleBinding</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">system:kube-apiserver</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">namespace:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">""</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">roleRef:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">apiGroup:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">rbac.authorization.k8s.io</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ClusterRole</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">system:kube-apiserver-to-kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">subjects:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">apiGroup:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">rbac.authorization.k8s.io</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">User</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">apply</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-f</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">apiserver2kubelet-rbac.yaml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># output</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">clusterrole.rbac.authorization.k8s.io/system:apiserver2kubelet</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">clusterrolebinding.rbac.authorization.k8s.io/system:kube-apiserver</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="cd /etc/kubernetes/configvim apiserver2kubelet-rbac.yamlapiVersion: rbac.authorization.k8s.io/v1kind: ClusterRolemetadata:  annotations:    rbac.authorization.kubernetes.io/autoupdate: &#x22;true&#x22;  labels:    kubernetes.io/bootstrapping: rbac-defaults  name: system:kube-apiserver-to-kubeletrules:  - apiGroups:      - &#x22;&#x22;    resources:      - nodes/proxy      - nodes/stats      - nodes/log      - nodes/spec      - nodes/metrics      - pods/log    verbs:      - &#x22;*&#x22;---apiVersion: rbac.authorization.k8s.io/v1kind: ClusterRoleBindingmetadata:  name: system:kube-apiserver  namespace: &#x22;&#x22;roleRef:  apiGroup: rbac.authorization.k8s.io  kind: ClusterRole  name: system:kube-apiserver-to-kubeletsubjects:  - apiGroup: rbac.authorization.k8s.io    kind: User    name: kuberneteskubectl apply -f apiserver2kubelet-rbac.yamlclusterrole.rbac.authorization.k8s.io/system:apiserver2kubelet createdclusterrolebinding.rbac.authorization.k8s.io/system:kube-apiserver created"><div></div></button></div></figure></div>
<h4 id="465-éƒ¨ç½²flannelç½‘ç»œç»„ä»¶">4.6.5 éƒ¨ç½²flannelç½‘ç»œç»„ä»¶</h4>
<p>éƒ¨ç½²å®Œä»¥ä¸Šç»„ä»¶ä¹‹åï¼Œä½¿ç”¨<code dir="auto">kubectl get nodes</code>å‘ç°æ–°åŠ è¿›æ¥çš„masterèŠ‚ç‚¹å¤„äº<code dir="auto">NotReady</code>çŠ¶æ€ï¼ŒåŸå› æ˜¯æ²¡æœ‰ç½‘ç»œç»„ä»¶ï¼Œä¸€æ—¦å®‰è£…å¥½ç½‘ç»œç»„ä»¶ä¼šç«‹å³å˜ä¸º<code dir="auto">Ready</code>çŠ¶æ€ã€‚</p>
<p>é…ç½®containerdä½¿ç”¨ä»£ç†å’Œç§æœ‰ä»“ï¼ˆä¸ç„¶é•œåƒæ‹‰ä¸ä¸‹æ¥å–”ï¼‰ï¼š</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># é…ç½®ä»£ç†</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/lib/systemd/system/containerd.service</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># åœ¨Servicesé…ç½®æ®µæ·»åŠ </span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[Service]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">...</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">Environment</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">HTTP_PROXY=172.19.82.100:7891</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">Environment</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">HTTPS_PROXY=172.19.82.100:7891</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">...</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">systemctl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">daemon-reload</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># é…ç½®ç§æœ‰ä»“</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/containerd/config.toml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># å¤§æ¦‚ç¬¬149è¡Œå¼€å§‹</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">...</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">[plugins.</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">io.containerd.grpc.v1.cri</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">.registry.configs]</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">[plugins.</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">io.containerd.grpc.v1.cri</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">.registry.configs.</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">harbor.xxx.local</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">.auth]</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">username</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">al-admin</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">password</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">52PXZ2IDNWzk</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">[plugins.</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">io.containerd.grpc.v1.cri</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">.registry.configs.</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">harbor.xxx.local</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">.tls]</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">insecure_skip_verify</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">[plugins.</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">io.containerd.grpc.v1.cri</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">.registry.mirrors]</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">[plugins.</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">io.containerd.grpc.v1.cri</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">.registry.mirrors.</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">harbor.xxx.local</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">]</span></div></div><div class="ec-line"><div class="code"><span class="indent">         </span><span style="--0:#82AAFF;--1:#3C63B3">endpoint</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">=</span><span style="--0:#D6DEEB;--1:#403F53"> [</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://harbor.xxx.local</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">]</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">...</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">systemctl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">restart</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">containerd</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="vim /lib/systemd/system/containerd.service[Service]...Environment=&#x22;HTTP_PROXY=172.19.82.100:7891&#x22;Environment=&#x22;HTTPS_PROXY=172.19.82.100:7891&#x22;...systemctl daemon-reloadvim /etc/containerd/config.toml...      [plugins.&#x22;io.containerd.grpc.v1.cri&#x22;.registry.configs]        [plugins.&#x22;io.containerd.grpc.v1.cri&#x22;.registry.configs.&#x22;harbor.xxx.local&#x22;.auth]        username = &#x22;al-admin&#x22;        password = &#x22;52PXZ2IDNWzk&#x22;        [plugins.&#x22;io.containerd.grpc.v1.cri&#x22;.registry.configs.&#x22;harbor.xxx.local&#x22;.tls]        insecure_skip_verify = true      [plugins.&#x22;io.containerd.grpc.v1.cri&#x22;.registry.mirrors]        [plugins.&#x22;io.containerd.grpc.v1.cri&#x22;.registry.mirrors.&#x22;harbor.xxx.local&#x22;]         endpoint = [&#x22;https://harbor.xxx.local&#x22;]...systemctl restart containerd"><div></div></button></div></figure></div>
<p><img src="https://cdn.agou-ops.cn/others/20230824134826.png" alt="image.png"></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">cd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/config</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">wget</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">https://github.com/flannel-io/flannel/releases/latest/download/kube-flannel.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># å¦‚æœä½ ç”¨çš„ä¸æ˜¯10.244.0.0/16è¿™ä¸ªç½‘æ®µï¼Œåˆ™éœ€è¦æ‰‹åŠ¨ä¿®æ”¹kube-flannel.ymlèµ„æºé…ç½®æ–‡ä»¶ã€‚</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># å¦‚</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-flannel.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">...</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">net-conf.json:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"Network"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">10.96.0.0/16</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#809191;--1:#616671"># æ”¹è¿™é‡Œ</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"Backend"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"Type"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">vxlan</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">...</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">apply</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-f</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-flannel.yml</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="cd /etc/kubernetes/configwget https://github.com/flannel-io/flannel/releases/latest/download/kube-flannel.ymlvim kube-flannel.yml...  net-conf.json: |    {      &#x22;Network&#x22;: &#x22;10.96.0.0/16&#x22;,   # æ”¹è¿™é‡Œ      &#x22;Backend&#x22;: {        &#x22;Type&#x22;: &#x22;vxlan&#x22;      }    }...kubectl apply -f kube-flannel.yml"><div></div></button></div></figure></div>
<p>æ£€æŸ¥flannelè¿è¡ŒçŠ¶æ€<code dir="auto">kubectl get po -n kube-flannel</code>
<img src="https://cdn.agou-ops.cn/others/20230825141026.png" alt="image.png"></p>
<h3 id="47-æ£€æŸ¥masterèŠ‚ç‚¹éƒ¨ç½²ç»“æœ">4.7 æ£€æŸ¥masterèŠ‚ç‚¹éƒ¨ç½²ç»“æœ</h3>
<h4 id="471-æ£€æŸ¥æœåŠ¡è¿è¡ŒçŠ¶æ€">4.7.1 æ£€æŸ¥æœåŠ¡è¿è¡ŒçŠ¶æ€</h4>
<ul>
<li>æœåŠ¡è¿è¡ŒçŠ¶æ€ï¼ˆ<code dir="auto">supervisorctl status</code>ï¼‰ï¼š
<img src="https://cdn.agou-ops.cn/others/20230825141505.png" alt="image.png"></li>
<li>ç»„ä»¶çŠ¶æ€ï¼ˆ<code dir="auto">kubectl get cs</code>ï¼‰ï¼š
<img src="https://cdn.agou-ops.cn/others/20230825141536.png" alt="image.png"></li>
<li>masterèŠ‚ç‚¹çŠ¶æ€(<code dir="auto">kubectl get node -owide</code>)
<img src="https://cdn.agou-ops.cn/others/20230825141605.png" alt="image.png">
å¦‚æœä»¥ä¸Šæœ‰æŠ¥é”™ï¼Œå°±å›å¤´æ£€æŸ¥æˆ–è€…é‡æ–°éƒ¨ç½²ä¸€ä¸‹æœ‰é—®é¢˜çš„æœåŠ¡å³å¯ã€‚</li>
</ul>
<h4 id="472-é™„æ–‡ä»¶åˆ—è¡¨åŠç®€ä»‹">4.7.2 é™„ï¼šæ–‡ä»¶åˆ—è¡¨åŠç®€ä»‹</h4>
<ul>
<li>è¯ä¹¦åŠé…ç½®æ–‡ä»¶ä¸€è§ˆï¼š</li>
</ul>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#82AAFF;--1:#3C63B3">tree</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">/etc/kubernetes/</span><span style="--0:#D6DEEB;--1:#403F53">             </span><span style="--0:#809191;--1:#616671"># è¯¥ç›®å½•ä¸ºk8sé›†ç¾¤çš„æ‰€æœ‰è¯ä¹¦å’Œé…ç½®æ–‡ä»¶å­˜æ”¾ç›®å½•</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">TLS</span><span style="--0:#D6DEEB;--1:#403F53">                      </span><span style="--0:#809191;--1:#616671"># è¯ä¹¦å­˜æ”¾ç›®å½•</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">etcd</span><span style="--0:#D6DEEB;--1:#403F53">                 </span><span style="--0:#809191;--1:#616671"># etcdè¯ä¹¦å­˜æ”¾ç›®å½•ï¼Œå•ç‹¬çš„ä¸€ä¸ªCA</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca-config.json</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#809191;--1:#616671"># caé…ç½®æ–‡ä»¶</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca-csr.json</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#809191;--1:#616671"># caè¯·æ±‚é…ç½®æ–‡ä»¶</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca-key.pem</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#809191;--1:#616671"># caç§é’¥</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca.csr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">etcd-server-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">etcd-server-key.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">etcd-server.csr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â””â”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">etcd-server.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â””â”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">k8s</span><span style="--0:#D6DEEB;--1:#403F53">                  </span><span style="--0:#809191;--1:#616671"># k8sé›†ç¾¤ç»„ä»¶è¯ä¹¦ç›®å½•</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca-config.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca-key.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca.csr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-apiserver-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-apiserver-key.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-apiserver.csr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-apiserver.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-controller-manager-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-controller-manager-key.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-controller-manager.csr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-controller-manager.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-scheduler-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-scheduler-key.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-scheduler.csr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-scheduler.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubectl-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubectl-key.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubectl.csr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubectl.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">proxy-client</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">front-proxy-ca-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">front-proxy-ca-key.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">front-proxy-ca.csr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">front-proxy-ca.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">front-proxy-client-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">front-proxy-client-key.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">front-proxy-client.csr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â””â”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">front-proxy-client.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">sa.key</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â””â”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">sa.pub</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">config</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#809191;--1:#616671"># æ‰€æœ‰é…ç½®ï¼ŒåŒ…æ‹¬è®¤è¯å’Œå„ç§kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">apiserver2kubelet-rbac.yaml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">bootstrap.secret.yaml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-controller-manager.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-flannel.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-proxy-config.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-proxy-scret.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-proxy.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-scheduler.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubelet-bootstrap.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubelet-conf.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â””â”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubelet.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â””â”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">manifests</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">7</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">directories,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">51</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">files</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="tree /etc/kubernetes//etc/kubernetes/             # è¯¥ç›®å½•ä¸ºk8sé›†ç¾¤çš„æ‰€æœ‰è¯ä¹¦å’Œé…ç½®æ–‡ä»¶å­˜æ”¾ç›®å½•â”œâ”€â”€ TLS                      # è¯ä¹¦å­˜æ”¾ç›®å½•â”‚Â Â  â”œâ”€â”€ etcd                 # etcdè¯ä¹¦å­˜æ”¾ç›®å½•ï¼Œå•ç‹¬çš„ä¸€ä¸ªCAâ”‚Â Â  â”‚Â Â  â”œâ”€â”€ ca-config.json   # caé…ç½®æ–‡ä»¶â”‚Â Â  â”‚Â Â  â”œâ”€â”€ ca-csr.json      # caè¯·æ±‚é…ç½®æ–‡ä»¶â”‚Â Â  â”‚Â Â  â”œâ”€â”€ ca-key.pem       # caç§é’¥â”‚Â Â  â”‚Â Â  â”œâ”€â”€ ca.csrâ”‚Â Â  â”‚Â Â  â”œâ”€â”€ ca.pemâ”‚Â Â  â”‚Â Â  â”œâ”€â”€ etcd-server-csr.jsonâ”‚Â Â  â”‚Â Â  â”œâ”€â”€ etcd-server-key.pemâ”‚Â Â  â”‚Â Â  â”œâ”€â”€ etcd-server.csrâ”‚Â Â  â”‚Â Â  â””â”€â”€ etcd-server.pemâ”‚Â Â  â””â”€â”€ k8s                  # k8sé›†ç¾¤ç»„ä»¶è¯ä¹¦ç›®å½•â”‚Â Â      â”œâ”€â”€ ca-config.jsonâ”‚Â Â      â”œâ”€â”€ ca-csr.jsonâ”‚Â Â      â”œâ”€â”€ ca-key.pemâ”‚Â Â      â”œâ”€â”€ ca.csrâ”‚Â Â      â”œâ”€â”€ ca.pemâ”‚Â Â      â”œâ”€â”€ kube-apiserver-csr.jsonâ”‚Â Â      â”œâ”€â”€ kube-apiserver-key.pemâ”‚Â Â      â”œâ”€â”€ kube-apiserver.csrâ”‚Â Â      â”œâ”€â”€ kube-apiserver.pemâ”‚Â Â      â”œâ”€â”€ kube-controller-manager-csr.jsonâ”‚Â Â      â”œâ”€â”€ kube-controller-manager-key.pemâ”‚Â Â      â”œâ”€â”€ kube-controller-manager.csrâ”‚Â Â      â”œâ”€â”€ kube-controller-manager.pemâ”‚Â Â      â”œâ”€â”€ kube-scheduler-csr.jsonâ”‚Â Â      â”œâ”€â”€ kube-scheduler-key.pemâ”‚Â Â      â”œâ”€â”€ kube-scheduler.csrâ”‚Â Â      â”œâ”€â”€ kube-scheduler.pemâ”‚Â Â      â”œâ”€â”€ kubectl-csr.jsonâ”‚Â Â      â”œâ”€â”€ kubectl-key.pemâ”‚Â Â      â”œâ”€â”€ kubectl.csrâ”‚Â Â      â”œâ”€â”€ kubectl.pemâ”‚Â Â      â”œâ”€â”€ proxy-clientâ”‚Â Â      â”‚Â Â  â”œâ”€â”€ front-proxy-ca-csr.jsonâ”‚Â Â      â”‚Â Â  â”œâ”€â”€ front-proxy-ca-key.pemâ”‚Â Â      â”‚Â Â  â”œâ”€â”€ front-proxy-ca.csrâ”‚Â Â      â”‚Â Â  â”œâ”€â”€ front-proxy-ca.pemâ”‚Â Â      â”‚Â Â  â”œâ”€â”€ front-proxy-client-csr.jsonâ”‚Â Â      â”‚Â Â  â”œâ”€â”€ front-proxy-client-key.pemâ”‚Â Â      â”‚Â Â  â”œâ”€â”€ front-proxy-client.csrâ”‚Â Â      â”‚Â Â  â””â”€â”€ front-proxy-client.pemâ”‚Â Â      â”œâ”€â”€ sa.keyâ”‚Â Â      â””â”€â”€ sa.pubâ”œâ”€â”€ config               # æ‰€æœ‰é…ç½®ï¼ŒåŒ…æ‹¬è®¤è¯å’Œå„ç§kubeconfigâ”‚Â Â  â”œâ”€â”€ apiserver2kubelet-rbac.yamlâ”‚Â Â  â”œâ”€â”€ bootstrap.secret.yamlâ”‚Â Â  â”œâ”€â”€ kube-controller-manager.kubeconfigâ”‚Â Â  â”œâ”€â”€ kube-flannel.ymlâ”‚Â Â  â”œâ”€â”€ kube-proxy-config.ymlâ”‚Â Â  â”œâ”€â”€ kube-proxy-scret.ymlâ”‚Â Â  â”œâ”€â”€ kube-proxy.kubeconfigâ”‚Â Â  â”œâ”€â”€ kube-scheduler.kubeconfigâ”‚Â Â  â”œâ”€â”€ kubelet-bootstrap.kubeconfigâ”‚Â Â  â”œâ”€â”€ kubelet-conf.ymlâ”‚Â Â  â””â”€â”€ kubelet.kubeconfigâ””â”€â”€ manifests7 directories, 51 files"><div></div></button></div></figure></div>
<ul>
<li>k8säºŒè¿›åˆ¶ç¨‹åºä»¥åŠå¯åŠ¨è„šæœ¬ä¸€è§ˆï¼š</li>
</ul>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># ä»¥.shç»“å°¾çš„å°±æ˜¯å¯¹åº”æœåŠ¡çš„å¯åŠ¨è„šæœ¬</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#82AAFF;--1:#3C63B3">tree</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/kubernetes/server/bin/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">/usr/local/kubernetes/server/bin/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">apiextensions-apiserver</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-aggregator</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-apiserver</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-apiserver-startup.sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-controller-manager</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-controller-manager-startup.sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-log-runner</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-proxy</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-proxy-startup.sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-scheduler</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-scheduler-startup.sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubeadm</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubectl</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubectl-convert</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubelet-startup.sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â””â”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">mounter</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">directory,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">files</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="tree /usr/local/kubernetes/server/bin//usr/local/kubernetes/server/bin/â”œâ”€â”€ apiextensions-apiserverâ”œâ”€â”€ kube-aggregatorâ”œâ”€â”€ kube-apiserverâ”œâ”€â”€ kube-apiserver-startup.shâ”œâ”€â”€ kube-controller-managerâ”œâ”€â”€ kube-controller-manager-startup.shâ”œâ”€â”€ kube-log-runnerâ”œâ”€â”€ kube-proxyâ”œâ”€â”€ kube-proxy-startup.shâ”œâ”€â”€ kube-schedulerâ”œâ”€â”€ kube-scheduler-startup.shâ”œâ”€â”€ kubeadmâ”œâ”€â”€ kubectlâ”œâ”€â”€ kubectl-convertâ”œâ”€â”€ kubeletâ”œâ”€â”€ kubelet-startup.shâ””â”€â”€ mounter1 directory, 17 files"><div></div></button></div></figure></div>
<ul>
<li>supervisoré…ç½®æ–‡ä»¶ä¸€è§ˆï¼š</li>
</ul>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># k8så„ç»„ä»¶çš„supervisoré…ç½®</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#82AAFF;--1:#3C63B3">tree</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/supervisor/conf.d/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">/etc/supervisor/conf.d/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">apiserver.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">controller-manager.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">etcd-server.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-proxy.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubelet.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â””â”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">scheduler.conf</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">directory,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">6</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">files</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="tree /etc/supervisor/conf.d//etc/supervisor/conf.d/â”œâ”€â”€ apiserver.confâ”œâ”€â”€ controller-manager.confâ”œâ”€â”€ etcd-server.confâ”œâ”€â”€ kube-proxy.confâ”œâ”€â”€ kubelet.confâ””â”€â”€ scheduler.conf1 directory, 6 files"><div></div></button></div></figure></div>
<h2 id="äº”éƒ¨ç½²nodeèŠ‚ç‚¹">äº”ã€éƒ¨ç½²nodeèŠ‚ç‚¹</h2>
<p><strong>å…¶å®å®Œå…¨å¯ä»¥åˆå¹¶æˆä¸€ä¸ªï¼Œä½†æ˜¯ä¸ºäº†æ¡ç†æ¸…æ™°ï¼Œæ‰€ä»¥æ‹†å¼€å•ç‹¬å¼„ã€‚</strong>
åœ¨masterä¸Šå°†kubeletå’Œkube-proxyäºŒè¿›åˆ¶æ–‡ä»¶åˆ†å‘ä¸‹å»ï¼š</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">for</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">i</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">in</span><span style="--0:#D6DEEB;--1:#403F53"> node01 node02; </span><span style="--0:#C792EA;--1:#8D46B4">do</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#809191;--1:#616671"># åˆ›å»ºç¨‹åºç›®å½•</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">ssh</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">$i</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">mkdir -pv /usr/local/kubernetes/server/bin</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#809191;--1:#616671"># åˆ†å‘bootstrapè®¤è¯æ–‡ä»¶</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#82AAFF;--1:#3C63B3">scp</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-r</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/kubernetes/server/bin/kubelet</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/kubernetes/server/bin/kube-proxy</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">$i</span><span style="--0:#ECC48D;--1:#3C63B3">:/usr/local/kubernetes/server/bin</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#809191;--1:#616671"># å¢åŠ å¯æ‰§è¡Œæƒé™</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">ssh</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">$i</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">chmod +x /usr/local/kubernetes/server/bin/*</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">done</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="for i in node01 node02; do  ssh $i &#x22;mkdir -pv /usr/local/kubernetes/server/bin&#x22; scp -r /usr/local/kubernetes/server/bin/kubelet* /usr/local/kubernetes/server/bin/kube-proxy* $i:/usr/local/kubernetes/server/bin  ssh $i &#x22;chmod +x /usr/local/kubernetes/server/bin/*&#x22;done"><div></div></button></div></figure></div>
<h3 id="51-éƒ¨ç½²kubelet">5.1 éƒ¨ç½²kubelet</h3>
<p>åœ¨masterèŠ‚ç‚¹ä¸Šåˆ†å‘è®¤è¯æ–‡ä»¶åŠkubeleté…ç½®æ–‡ä»¶ï¼š</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">for</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">i</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">in</span><span style="--0:#D6DEEB;--1:#403F53"> node01 node02; </span><span style="--0:#C792EA;--1:#8D46B4">do</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#809191;--1:#616671"># é…ç½®è¯ä¹¦åŠé…ç½®æ–‡ä»¶ç›®å½•</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">ssh</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">$i</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">mkdir -pv /etc/kubernetes/{TLS,config,manifests}</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#809191;--1:#616671"># åˆ†å‘bootstrapè®¤è¯æ–‡ä»¶</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">scp</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/config/kubelet-bootstrap.kubeconfig</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">$i</span><span style="--0:#ECC48D;--1:#3C63B3">:/etc/kubernetes/config/kubelet-bootstrap.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#809191;--1:#616671"># å¤åˆ¶é…ç½®æ–‡ä»¶</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">scp</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/config/kubelet-conf.yml</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">$i</span><span style="--0:#ECC48D;--1:#3C63B3">:/etc/kubernetes/config/kubelet-conf.yml</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">scp</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/TLS/k8s/ca.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">$i</span><span style="--0:#ECC48D;--1:#3C63B3">:/etc/kubernetes/TLS/k8s/ca.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">done</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="for i in node01 node02; do  ssh $i &#x22;mkdir -pv /etc/kubernetes/{TLS,config,manifests}&#x22;  scp /etc/kubernetes/config/kubelet-bootstrap.kubeconfig $i:/etc/kubernetes/config/kubelet-bootstrap.kubeconfig  scp /etc/kubernetes/config/kubelet-conf.yml $i:/etc/kubernetes/config/kubelet-conf.yml  scp /etc/kubernetes/TLS/k8s/ca.pem $i:/etc/kubernetes/TLS/k8s/ca.pemdone"><div></div></button></div></figure></div>
<p>é…ç½®supervisorï¼ˆå’ŒmasterèŠ‚ç‚¹ç±»ä¼¼ï¼Œæ‰€ä»¥ç›´æ¥å¤åˆ¶è¿‡å»å¥½äº†ï¼‰ï¼š</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">for</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">i</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">in</span><span style="--0:#D6DEEB;--1:#403F53"> node01 node02; </span><span style="--0:#C792EA;--1:#8D46B4">do</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#809191;--1:#616671"># åˆ›å»ºæ—¥å¿—ç›®å½•</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">ssh</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">$i</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">mkdir -pv /data/logs/kubernetes/kubelet</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#809191;--1:#616671"># å¤åˆ¶kubeletçš„supervisoré…ç½®æ–‡ä»¶</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">scp</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/supervisor/conf.d/kubelet.conf</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">$i</span><span style="--0:#ECC48D;--1:#3C63B3">:/etc/supervisor/conf.d/kubelet.conf</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#809191;--1:#616671"># ä¿®æ”¹idï¼Œæ–¹ä¾¿åŒºåˆ†ï¼Œè¿™é‡Œä¸çŸ¥ä¸ºä½•ä¸‹é¢å‘½ä»¤ä¸èƒ½ç”¨ã€‚ã€‚ï¼ˆæ‰‹åŠ¨æ”¹ä¸€ä¸‹å§</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#809191;--1:#616671"># ssh $i "id=`ip a show dev eth0 | grep -w inet | awk '{print $2}' | sed -e 's/.*\.\([0-9]\+\)\/.*/\1/'` ; sed -i "s/157/$id/" /etc/supervisor/conf.d/kubelet.conf"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">done</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="for i in node01 node02; do  ssh $i &#x22;mkdir -pv /data/logs/kubernetes/kubelet&#x22;  scp /etc/supervisor/conf.d/kubelet.conf $i:/etc/supervisor/conf.d/kubelet.confdone"><div></div></button></div></figure></div>
<p><img src="https://cdn.agou-ops.cn/others/20230825150503.png" alt="image.png">
æ”¹å®Œä¹‹ååœ¨node01å’Œnode02åˆ†åˆ«æ‰§è¡Œï¼š</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># node01</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">IP</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--1:#3C63B3"><span style="--0:#ECC48D">`</span><span style="--0:#82AAFF">ip</span><span style="--0:#ECC48D"> a show dev eth0 </span></span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--1:#3C63B3"><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">grep</span><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">-w</span><span style="--0:#ECC48D"> inet </span></span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--1:#3C63B3"><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">awk</span><span style="--0:#ECC48D"> </span></span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">{print $2}</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#3C63B3"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--1:#3C63B3"><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">cut</span><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">-d</span><span style="--0:#ECC48D"> </span></span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">/</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--1:#3C63B3"><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">-f</span><span style="--0:#ECC48D"> </span></span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">`</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">sed</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-i</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">s/172.19.82.157/</span><span style="--0:#C5E478;--1:#3C63B3">$IP</span><span style="--0:#ECC48D;--1:#9B504E">/</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/config/kubelet-conf.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">sed</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-i</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">s/master0/node01/</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/kubernetes/server/bin/kubelet-startup.sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">supervisor</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">update</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># node02</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">IP</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--1:#3C63B3"><span style="--0:#ECC48D">`</span><span style="--0:#82AAFF">ip</span><span style="--0:#ECC48D"> a show dev eth0 </span></span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--1:#3C63B3"><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">grep</span><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">-w</span><span style="--0:#ECC48D"> inet </span></span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--1:#3C63B3"><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">awk</span><span style="--0:#ECC48D"> </span></span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">{print $2}</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#3C63B3"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--1:#3C63B3"><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">cut</span><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">-d</span><span style="--0:#ECC48D"> </span></span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">/</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--1:#3C63B3"><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">-f</span><span style="--0:#ECC48D"> </span></span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">`</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">sed</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-i</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">s/172.19.82.157/</span><span style="--0:#C5E478;--1:#3C63B3">$IP</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/config/kubelet-conf.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">sed</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-i</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">s/master0/node02/</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/kubernetes/server/bin/kubelet-startup.sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">supervisor</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">update</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="IP=&#x60;ip a show dev eth0 | grep -w inet | awk &#x27;{print $2}&#x27; | cut -d &#x27;/&#x27; -f 1&#x60;sed -i &#x22;s/172.19.82.157/$IP/&#x22; /etc/kubernetes/config/kubelet-conf.ymlsed -i &#x22;s/master0/node01/&#x22; /usr/local/kubernetes/server/bin/kubelet-startup.shsupervisor updateIP=&#x60;ip a show dev eth0 | grep -w inet | awk &#x27;{print $2}&#x27; | cut -d &#x27;/&#x27; -f 1&#x60;sed -i &#x22;s/172.19.82.157/$IP&#x22; /etc/kubernetes/config/kubelet-conf.ymlsed -i &#x22;s/master0/node02/&#x22; /usr/local/kubernetes/server/bin/kubelet-startup.shsupervisor update"><div></div></button></div></figure></div>
<p>å¯åŠ¨å®Œæˆä¹‹ååœ¨masterèŠ‚ç‚¹ä¸Šå¯ä»¥çœ‹åˆ°ï¼š</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">get</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">nodes</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># output</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#ECC48D;--1:#3C63B3">STATUS</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">ROLES</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">VERSION</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">master0</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">Ready</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">125</span><span style="--0:#ECC48D;--1:#3C63B3">m</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">v1.25.12</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">node01</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">NotReady</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">12</span><span style="--0:#ECC48D;--1:#3C63B3">s</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">v1.25.12</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">node02</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">NotReady</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#ECC48D;--1:#3C63B3">m27s</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">v1.25.12</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="kubectl get nodesNAME      STATUS     ROLES    AGE     VERSIONmaster0   Ready      <none>   125m    v1.25.12node01    NotReady   <none>   12s     v1.25.12node02    NotReady   <none>   3m27s   v1.25.12"><div></div></button></div></figure></div>
<h3 id="52-éƒ¨ç½²kube-proxy">5.2 éƒ¨ç½²kube-proxy</h3>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># åœ¨masterèŠ‚ç‚¹ä¸Šæ‰§è¡Œ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">for</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">i</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">in</span><span style="--0:#D6DEEB;--1:#403F53"> node01 node02; </span><span style="--0:#C792EA;--1:#8D46B4">do</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">ssh</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">$i</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">mkdir -pv /data/logs/kubernetes/kube-proxy/</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#809191;--1:#616671"># æ‹·è´kube-proxyé…ç½®åˆ°nodeèŠ‚ç‚¹</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">scp</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/config/kube-proxy.kubeconfig</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">$i</span><span style="--0:#ECC48D;--1:#3C63B3">:/etc/kubernetes/config/kube-proxy.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">scp</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/config/kube-proxy-conf.yml</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">$i</span><span style="--0:#ECC48D;--1:#3C63B3">:/etc/kubernetes/config/kube-proxy-conf.yml</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">scp</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/supervisor/conf.d/kube-proxy.conf</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">$i</span><span style="--0:#ECC48D;--1:#3C63B3">:/etc/supervisor/conf.d/kube-proxy.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">done</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># åœ¨node01èŠ‚ç‚¹ä¸Šæ‰§è¡Œ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">IP</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--1:#3C63B3"><span style="--0:#ECC48D">`</span><span style="--0:#82AAFF">ip</span><span style="--0:#ECC48D"> a show dev eth0 </span></span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--1:#3C63B3"><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">grep</span><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">-w</span><span style="--0:#ECC48D"> inet </span></span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--1:#3C63B3"><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">awk</span><span style="--0:#ECC48D"> </span></span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">{print $2}</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#3C63B3"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--1:#3C63B3"><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">cut</span><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">-d</span><span style="--0:#ECC48D"> </span></span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">/</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--1:#3C63B3"><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">-f</span><span style="--0:#ECC48D"> </span></span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">`</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">sed</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-i</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">s/172.19.82.157/</span><span style="--0:#C5E478;--1:#3C63B3">$IP</span><span style="--0:#ECC48D;--1:#9B504E">/</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/config/kube-proxy-conf.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">supervisor</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">update</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># åœ¨node02èŠ‚ç‚¹ä¸Šæ‰§è¡Œ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">IP</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--1:#3C63B3"><span style="--0:#ECC48D">`</span><span style="--0:#82AAFF">ip</span><span style="--0:#ECC48D"> a show dev eth0 </span></span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--1:#3C63B3"><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">grep</span><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">-w</span><span style="--0:#ECC48D"> inet </span></span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--1:#3C63B3"><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">awk</span><span style="--0:#ECC48D"> </span></span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">{print $2}</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#3C63B3"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--1:#3C63B3"><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">cut</span><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">-d</span><span style="--0:#ECC48D"> </span></span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">/</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--1:#3C63B3"><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">-f</span><span style="--0:#ECC48D"> </span></span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">`</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">sed</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-i</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">s/172.19.82.157/</span><span style="--0:#C5E478;--1:#3C63B3">$IP</span><span style="--0:#ECC48D;--1:#9B504E">/</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/config/kube-proxy-conf.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">supervisor</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">update</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="for i in node01 node02; do  ssh $i &#x22;mkdir -pv /data/logs/kubernetes/kube-proxy/&#x22;  scp /etc/kubernetes/config/kube-proxy.kubeconfig $i:/etc/kubernetes/config/kube-proxy.kubeconfig  scp /etc/kubernetes/config/kube-proxy-conf.yml $i:/etc/kubernetes/config/kube-proxy-conf.yml  scp /etc/supervisor/conf.d/kube-proxy.conf $i:/etc/supervisor/conf.d/kube-proxy.confdoneIP=&#x60;ip a show dev eth0 | grep -w inet | awk &#x27;{print $2}&#x27; | cut -d &#x27;/&#x27; -f 1&#x60;sed -i &#x22;s/172.19.82.157/$IP/&#x22; /etc/kubernetes/config/kube-proxy-conf.ymlsupervisor updateIP=&#x60;ip a show dev eth0 | grep -w inet | awk &#x27;{print $2}&#x27; | cut -d &#x27;/&#x27; -f 1&#x60;sed -i &#x22;s/172.19.82.157/$IP/&#x22; /etc/kubernetes/config/kube-proxy-conf.ymlsupervisor update"><div></div></button></div></figure></div>
<h3 id="53-æ£€æŸ¥nodeèŠ‚ç‚¹éƒ¨ç½²ç»“æœ">5.3 æ£€æŸ¥nodeèŠ‚ç‚¹éƒ¨ç½²ç»“æœ</h3>
<h4 id="531-æ£€æŸ¥æœåŠ¡è¿è¡ŒçŠ¶æ€">5.3.1 æ£€æŸ¥æœåŠ¡è¿è¡ŒçŠ¶æ€</h4>
<ul>
<li>supervisoræœåŠ¡è¿è¡ŒçŠ¶æ€ï¼ˆ<code dir="auto">sueprvisorctl status</code>ï¼‰ï¼š
<img src="https://cdn.agou-ops.cn/others/20230825154847.png" alt="image.png"></li>
<li>ç½‘ç»œç»„ä»¶ä»¥åŠèŠ‚ç‚¹çŠ¶æ€ï¼š(<code dir="auto">kubectl get node -owide/kubectl get po -A -owide</code>)ï¼š
<img src="https://cdn.agou-ops.cn/others/20230825155014.png" alt="image.png"></li>
</ul>
<h4 id="532-é™„æ–‡ä»¶åˆ—è¡¨åŠç®€ä»‹">5.3.2 é™„ï¼šæ–‡ä»¶åˆ—è¡¨åŠç®€ä»‹</h4>
<p>ä»¥node01èŠ‚ç‚¹ä¸ºä¾‹ï¼Œå…¶ä»–nodeèŠ‚ç‚¹éƒ½ä¸€æ ·ã€‚</p>
<ul>
<li>è¯ä¹¦åŠé…ç½®æ–‡ä»¶ä¸€è§ˆï¼š</li>
</ul>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#82AAFF;--1:#3C63B3">tree</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">/etc/kubernetes/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">TLS</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">etcd</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca-key.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">etcd-server-key.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â””â”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">etcd-server.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â””â”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">k8s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">â””â”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">config</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-proxy-conf.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-proxy-config.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-proxy.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubelet-bootstrap.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubelet-conf.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”‚Â Â </span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">â””â”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubelet.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â””â”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">manifests</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">6</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">directories,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">11</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">files</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="tree /etc/kubernetes//etc/kubernetes/â”œâ”€â”€ TLSâ”‚Â Â  â”œâ”€â”€ etcdâ”‚Â Â  â”‚Â Â  â”œâ”€â”€ ca-key.pemâ”‚Â Â  â”‚Â Â  â”œâ”€â”€ ca.pemâ”‚Â Â  â”‚Â Â  â”œâ”€â”€ etcd-server-key.pemâ”‚Â Â  â”‚Â Â  â””â”€â”€ etcd-server.pemâ”‚Â Â  â””â”€â”€ k8sâ”‚Â Â      â””â”€â”€ ca.pemâ”œâ”€â”€ configâ”‚Â Â  â”œâ”€â”€ kube-proxy-conf.ymlâ”‚Â Â  â”œâ”€â”€ kube-proxy-config.ymlâ”‚Â Â  â”œâ”€â”€ kube-proxy.kubeconfigâ”‚Â Â  â”œâ”€â”€ kubelet-bootstrap.kubeconfigâ”‚Â Â  â”œâ”€â”€ kubelet-conf.ymlâ”‚Â Â  â””â”€â”€ kubelet.kubeconfigâ””â”€â”€ manifests6 directories, 11 files"><div></div></button></div></figure></div>
<ul>
<li>supervisoré…ç½®æ–‡ä»¶ä¸€è§ˆï¼š</li>
</ul>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tree</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/supervisor/conf.d/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">/etc/supervisor/conf.d/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">etcd-server.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-proxy.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â””â”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubelet.conf</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">directory,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">files</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="tree /etc/supervisor/conf.d//etc/supervisor/conf.d/â”œâ”€â”€ etcd-server.confâ”œâ”€â”€ kube-proxy.confâ””â”€â”€ kubelet.conf1 directory, 3 files"><div></div></button></div></figure></div>
<ul>
<li>k8sç»„ä»¶äºŒè¿›åˆ¶ç¨‹åºåŠå¯¹åº”å¯åŠ¨è„šæœ¬ä¸€è§ˆï¼š</li>
</ul>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tree</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/local/kubernetes/server/bin/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">/usr/local/kubernetes/server/bin/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-proxy</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-proxy-startup.sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â”œâ”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">â””â”€â”€</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubelet-startup.sh</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">directory,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">4</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">files</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="tree /usr/local/kubernetes/server/bin//usr/local/kubernetes/server/bin/â”œâ”€â”€ kube-proxyâ”œâ”€â”€ kube-proxy-startup.shâ”œâ”€â”€ kubeletâ””â”€â”€ kubelet-startup.sh1 directory, 4 files"><div></div></button></div></figure></div>
<h2 id="å…­å…¶ä»–å¯é€‰ç»„ä»¶å®‰è£…">å…­ã€å…¶ä»–å¯é€‰ç»„ä»¶å®‰è£…</h2>
<h3 id="61-coredns">6.1 coredns</h3>
<h4 id="611-éƒ¨ç½²coredns">6.1.1 éƒ¨ç½²coredns</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># åœ¨masterèŠ‚ç‚¹ä¸Šæ‰§è¡Œ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">cd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/kubernetes/config</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">wget</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">https://raw.githubusercontent.com/coredns/deployment/master/kubernetes/coredns.yaml.sed</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-O</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">coredns.yaml</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># ä¿®æ”¹èµ„æºæ¸…å•é‡Œé¢çš„Corefileå’ŒclusterIP</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">coredns.yaml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># ç¬¬ä¸€å¤„</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">...</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">Corefile:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C5E478;--1:#3C63B3">.</span><span style="--0:#D6DEEB;--1:#403F53">:53 </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">errors</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">health</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#82AAFF;--1:#3C63B3">lameduck</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">5</span><span style="--0:#ECC48D;--1:#3C63B3">s</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">ready</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">kubernetes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">cluster.local</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">in-addr.arpa</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ip6.arpa</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#809191;--1:#616671"># ä¿®æ”¹åå‘è§£æ</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#82AAFF;--1:#3C63B3">fallthrough</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">in-addr.arpa</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ip6.arpa</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">prometheus</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">:9153</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">forward</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">8.8</span><span style="--0:#ECC48D;--1:#3C63B3">.8.8</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#809191;--1:#616671"># ä¿®æ”¹ä¸ºå¤–éƒ¨dnsè§£æåœ°å€ï¼Œå½“corednsè§£æä¸åˆ°æ—¶ä¼šä¼ ç»™è¯¥dns</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#82AAFF;--1:#3C63B3">max_concurrent</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1000</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">cache</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">30</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">loop</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">reload</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">loadbalance</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">}                           </span><span style="--0:#809191;--1:#616671"># è¿™åé¢æœ‰ä¸ªSTUBDOMAINSå»æ‰</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">...</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># ç¬¬äºŒå¤„ï¼Œå¤§æ¦‚191è¡Œ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">...</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">clusterIP:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10.100</span><span style="--0:#ECC48D;--1:#3C63B3">.0.2</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">...</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># ä¿®æ”¹å®Œæˆä¹‹å</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">apply</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-f</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">coredns.yaml</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="cd /etc/kubernetes/configwget https://raw.githubusercontent.com/coredns/deployment/master/kubernetes/coredns.yaml.sed -O coredns.yamlvim coredns.yaml...  Corefile: |    .:53 {        errors        health {          lameduck 5s        }        ready        kubernetes cluster.local in-addr.arpa ip6.arpa {  # ä¿®æ”¹åå‘è§£æ          fallthrough in-addr.arpa ip6.arpa        }        prometheus :9153        forward . 8.8.8.8 {          # ä¿®æ”¹ä¸ºå¤–éƒ¨dnsè§£æåœ°å€ï¼Œå½“corednsè§£æä¸åˆ°æ—¶ä¼šä¼ ç»™è¯¥dns          max_concurrent 1000        }        cache 30        loop        reload        loadbalance    }                           # è¿™åé¢æœ‰ä¸ªSTUBDOMAINSå»æ‰......  clusterIP: 10.100.0.2...kubectl apply -f coredns.yaml"><div></div></button></div></figure></div>
<p>æ£€æŸ¥corednsè¿è¡ŒçŠ¶æ€ï¼š
<img src="https://cdn.agou-ops.cn/others/20230825162329.png" alt="image.png"></p>
<h4 id="æµ‹è¯•coredns">æµ‹è¯•coredns</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">helloworld.yaml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">apiVersion:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">apps/v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Deployment</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">helloworld</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">spec:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">selector:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">matchLabels:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">app:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">helloworld</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">replicas:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">template:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">labels:</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">app:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">helloworld</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">spec:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">containers:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">helloworld</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">image:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">karthequian/helloworld:latest</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">ports:</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">containerPort:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">80</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">apiVersion:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Service</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">helloworld-service</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">spec:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">selector:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">app:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">helloworld</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">ports:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">protocol:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">TCP</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">port:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">80</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">targetPort:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">80</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3C63B3">type</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">ClusterIP</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">apply</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-f</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">helloworld.yaml</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># è¿è¡Œç½‘ç»œæµ‹è¯•å®¹å™¨</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">run</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">tmp-shell</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--rm</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-i</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--tty</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--image</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">nicolaka/netshoot</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tmp-shell</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">î‚°</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">~</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">î‚°</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">dig</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes.default.svc.cluster.local</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">+short</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">10.96.0.1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tmp-shell2</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">î‚°</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">~</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">î‚°</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">dig</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">helloworld-service.default.svc.cluster.local</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">+short</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">10.105.77.246</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="vim helloworld.yamlapiVersion: apps/v1kind: Deploymentmetadata:  name: helloworldspec:  selector:    matchLabels:      app: helloworld  replicas: 1  template:    metadata:      labels:        app: helloworld    spec:      containers:      - name: helloworld        image: karthequian/helloworld:latest        ports:        - containerPort: 80---apiVersion: v1kind: Servicemetadata:  name: helloworld-servicespec:  selector:    app: helloworld  ports:    - protocol: TCP      port: 80      targetPort: 80  type: ClusterIPkubectl apply -f helloworld.yamlkubectl run tmp-shell --rm -i --tty --image nicolaka/netshoottmp-shell î‚° ~ î‚° dig kubernetes.default.svc.cluster.local +short10.96.0.1tmp-shell2 î‚° ~ î‚° dig helloworld-service.default.svc.cluster.local +short10.105.77.246"><div></div></button></div></figure></div>
<h3 id="62-nginx-ingress">6.2 nginx ingress</h3>
<p>å‚è€ƒé“¾æ¥ï¼š<a href="https://kubernetes.github.io/ingress-nginx/">https://kubernetes.github.io/ingress-nginx/</a></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">wget</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.8.1/deploy/static/provider/baremetal/deploy.yaml</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-O</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">nginx-ingress.yaml</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">apply</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-f</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">nginx-ingress.yaml</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="wget https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.8.1/deploy/static/provider/baremetal/deploy.yaml -O nginx-ingress.yamlkubectl apply -f nginx-ingress.yaml"><div></div></button></div></figure></div>
<h3 id="63-é¢æ¿">6.3 é¢æ¿</h3>
<h4 id="631-dashboard">6.3.1 dashboard</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">wget</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">https://raw.githubusercontent.com/kubernetes/dashboard/v3.0.0-alpha0/charts/kubernetes-dashboard.yaml</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">apply</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-f</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes-dashboard.yaml</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># ä¿®æ”¹dashboardçš„Servicesç±»å‹ä¸ºnodeportï¼Œæ–¹ä¾¿è®¿é—®</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--namespace</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes-dashboard</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">patch</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">svc</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes-dashboard</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-p</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">{"spec": {"type": "NodePort"}}</span><span style="--0:#D9F5DD;--1:#111111">'</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="wget https://raw.githubusercontent.com/kubernetes/dashboard/v3.0.0-alpha0/charts/kubernetes-dashboard.yamlkubectl apply -f kubernetes-dashboard.yamlkubectl --namespace kubernetes-dashboard patch svc kubernetes-dashboard -p &#x27;{&#x22;spec&#x22;: {&#x22;type&#x22;: &#x22;NodePort&#x22;}}&#x27;"><div></div></button></div></figure></div>
<p><img src="https://cdn.agou-ops.cn/others/20230825180332.png" alt="image.png">
å®‰è£…å®Œæˆä¹‹åï¼Œä½¿ç”¨ä¸€ä¸‹å‘½ä»¤è·å–è‡ªåŠ¨åˆ†é…çš„nodeportï¼š</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">get</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">svc/kubernetes-dashboard</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-n</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes-dashboard</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-owide</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># output</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                   </span><span style="--0:#ECC48D;--1:#3C63B3">TYPE</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#ECC48D;--1:#3C63B3">CLUSTER-IP</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#ECC48D;--1:#3C63B3">EXTERNAL-IP</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">PORT</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#82AAFF;--1:#3C63B3">S</span><span style="--0:#D6DEEB;--1:#403F53">)         </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">SELECTOR</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubernetes-dashboard</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">NodePort</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">10.99</span><span style="--0:#ECC48D;--1:#3C63B3">.165.217</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">443</span><span style="--0:#ECC48D;--1:#3C63B3">:36046/TCP</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#ECC48D;--1:#3C63B3">m54s</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">k8s-app=kubernetes-dashboard</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="kubectl get svc/kubernetes-dashboard -n kubernetes-dashboard -owideNAME                   TYPE       CLUSTER-IP      EXTERNAL-IP   PORT(S)         AGE     SELECTORkubernetes-dashboard   NodePort   10.99.165.217   <none>        443:36046/TCP   3m54s   k8s-app=kubernetes-dashboard"><div></div></button></div></figure></div>
<p>è®¿é—®ä»»ä¸€èŠ‚ç‚¹çš„IPåŠ ä¸Šé¢çš„nodeportå³å¯ï¼Œæ¯”å¦‚ï¼š<a href="https://172.19.82.157:36046/#/login">https://172.19.82.157:36046/#/login</a>
<img src="https://cdn.agou-ops.cn/others/20230827094647.png" alt="image.png">
åˆ›å»ºsaä½¿ç”¨tokenç™»å½•dashboardï¼š</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">dashboard-sa.yaml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">apiVersion:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ServiceAccount</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">dashboard-admin</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">namespace:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes-dashboard</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">apiVersion:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">rbac.authorization.k8s.io/v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ClusterRoleBinding</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">dashboard-admin-rolebinding</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">roleRef:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">apiGroup:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">rbac.authorization.k8s.io</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ClusterRole</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">cluster-admin</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">subjects:</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ServiceAccount</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">dashboard-admin</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">namespace:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes-dashboard</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># æ³¨æ„è¾ƒæ–°ç‰ˆæœ¬çš„k8sä¸ä¼šè‡ªåŠ¨åˆ›å»ºsecret</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">apiVersion:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Secret</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">dashboard-admin-secret</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">namespace:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes-dashboard</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">annotations:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">kubernetes.io/service-account.name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">dashboard-admin</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">type</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes.io/service-account-token</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">apply</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-f</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">dashboard-sa.yaml</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># è·å–token</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">describe</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">secret</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">dashboard-admin-secret</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-n</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes-dashboard</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># output</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">Name:</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#ECC48D;--1:#3C63B3">dashboard-admin-secret</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">Namespace:</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes-dashboard</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">Labels:</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">Annotations:</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes.io/service-account.name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">dashboard-admin</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#82AAFF;--1:#3C63B3">kubernetes.io/service-account.uid:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">80</span><span style="--0:#ECC48D;--1:#3C63B3">bf284e-06e7-4ea4-b747-0a2e77f0ed1f</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">Type:</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes.io/service-account-token</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">Data</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">====</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">ca.crt:</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1314</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">bytes</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">namespace:</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">20</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">bytes</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">token:</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#ECC48D;--1:#3C63B3">eyJhbGciOiJSUzI1NiIsImtpZCI6IlhYRkQ2bmRNc0s2WktiWHYxT044M1ZfWTQ2UWRxZk81U3Q4TFJnRFo2QncifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlcm5ldGVzLWRhc2hib2FyZCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJkYXNoYm9hcmQtYWRtaW4tc2VjcmV0Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6ImRhc2hib2FyZC1hZG1pbiIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50LnVpZCI6IjgwYmYyODRlLTA2ZTctNGVhNC1iNzQ3LTBhMmU3N2YwZWQxZiIsInN1YiI6InN5c3RlbTpzZXJ2aWNlYWNjb3VudDprdWJlcm5ldGVzLWRhc2hib2FyZDpkYXNoYm9hcmQtYWRtaW4ifQ.RN82A652pjg5PSoIfVCrzj6b6irTQAaHP4Sr-ROf2LCA3A-GttYaH3Tq0pNQx3x2lfhEK2wqWjmKUtcP7yCfoemkXNdAHV_XOnM1qJ86crv-DHkbaqc8JikwyPOucwex8pZ-EeblDpNUyD-QKbImWRmE3XF09g3tBgRrqANFBKbJd82ABKg_BZyQV1iLEz0wN1Int3uk4f8nm19_YoPfjJPE1UcmKcI0m44aqqANSYNU4e6gej4d-YkBHvaIUZ0-9j9r7t_dKS1qVQiqcAwxdFlt0Tjxbi2KurOIAtazQriHaSbe7VhDJa_v-WYfzcZuHgoWpAELyAR9rbcyScgMbw</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="vim dashboard-sa.yamlapiVersion: v1kind: ServiceAccountmetadata:  name: dashboard-admin  namespace: kubernetes-dashboard---apiVersion: rbac.authorization.k8s.io/v1kind: ClusterRoleBindingmetadata:  name: dashboard-admin-rolebindingroleRef:  apiGroup: rbac.authorization.k8s.io  kind: ClusterRole  name: cluster-adminsubjects:- kind: ServiceAccount  name: dashboard-admin  namespace: kubernetes-dashboard---apiVersion: v1kind: Secretmetadata:  name: dashboard-admin-secret  namespace: kubernetes-dashboard  annotations:    kubernetes.io/service-account.name: dashboard-admintype: kubernetes.io/service-account-tokenkubectl apply -f dashboard-sa.yaml kubectl describe secret dashboard-admin-secret -n kubernetes-dashboardName:         dashboard-admin-secretNamespace:    kubernetes-dashboardLabels:       <none>Annotations:  kubernetes.io/service-account.name: dashboard-admin              kubernetes.io/service-account.uid: 80bf284e-06e7-4ea4-b747-0a2e77f0ed1fType:  kubernetes.io/service-account-tokenData====ca.crt:     1314 bytesnamespace:  20 bytestoken:      eyJhbGciOiJSUzI1NiIsImtpZCI6IlhYRkQ2bmRNc0s2WktiWHYxT044M1ZfWTQ2UWRxZk81U3Q4TFJnRFo2QncifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlcm5ldGVzLWRhc2hib2FyZCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJkYXNoYm9hcmQtYWRtaW4tc2VjcmV0Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6ImRhc2hib2FyZC1hZG1pbiIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50LnVpZCI6IjgwYmYyODRlLTA2ZTctNGVhNC1iNzQ3LTBhMmU3N2YwZWQxZiIsInN1YiI6InN5c3RlbTpzZXJ2aWNlYWNjb3VudDprdWJlcm5ldGVzLWRhc2hib2FyZDpkYXNoYm9hcmQtYWRtaW4ifQ.RN82A652pjg5PSoIfVCrzj6b6irTQAaHP4Sr-ROf2LCA3A-GttYaH3Tq0pNQx3x2lfhEK2wqWjmKUtcP7yCfoemkXNdAHV_XOnM1qJ86crv-DHkbaqc8JikwyPOucwex8pZ-EeblDpNUyD-QKbImWRmE3XF09g3tBgRrqANFBKbJd82ABKg_BZyQV1iLEz0wN1Int3uk4f8nm19_YoPfjJPE1UcmKcI0m44aqqANSYNU4e6gej4d-YkBHvaIUZ0-9j9r7t_dKS1qVQiqcAwxdFlt0Tjxbi2KurOIAtazQriHaSbe7VhDJa_v-WYfzcZuHgoWpAELyAR9rbcyScgMbw"><div></div></button></div></figure></div>
<p>ä½¿ç”¨ä¸Šé¢è¾“å‡ºçš„tokenå³å¯ç™»å½•dashboard.
<img src="https://cdn.agou-ops.cn/others/20230827100314.png" alt="image.png"></p>
<h4 id="632-rancher">6.3.2 rancher</h4>
<p>ç•¥ï¼Œå‚è€ƒï¼š<a href="https://ranchermanager.docs.rancher.com/pages-for-subheaders/install-upgrade-on-a-kubernetes-cluster#install-the-rancher-helm-chart">ä½¿ç”¨helmå¿«é€Ÿå®‰è£…rancher</a></p>
<h2 id="ä¸ƒæœªå®Œå¾…ç»­">ä¸ƒã€æœªå®Œå¾…ç»­</h2>
<p>To Be Continuedâ€¦</p> </div> <footer class="astro-3yyafb3n"> <div class="meta sl-flex astro-3yyafb3n">   </div> <div class="pagination-links astro-u2l5gyhi" dir="ltr"> <a href="/cloudnative/k8s/helm/helmgotemplate/" rel="prev" class="astro-u2l5gyhi"> <svg aria-hidden="true" class="astro-u2l5gyhi astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.5rem;"><path d="M17 11H9.41l3.3-3.29a1.004 1.004 0 1 0-1.42-1.42l-5 5a1 1 0 0 0-.21.33 1 1 0 0 0 0 .76 1 1 0 0 0 .21.33l5 5a1.002 1.002 0 0 0 1.639-.325 1 1 0 0 0-.219-1.095L9.41 13H17a1 1 0 0 0 0-2Z"/></svg>  <span class="astro-u2l5gyhi"> Previous <br class="astro-u2l5gyhi"> <span class="link-title astro-u2l5gyhi">Helmï¼ˆGoï¼‰template</span> </span> </a> <a href="/cloudnative/k8s/installation/kubeadm-å¿«é€Ÿéƒ¨ç½²æ‰‹å†Œ/" rel="next" class="astro-u2l5gyhi"> <svg aria-hidden="true" class="astro-u2l5gyhi astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.5rem;"><path d="M17.92 11.62a1.001 1.001 0 0 0-.21-.33l-5-5a1.003 1.003 0 1 0-1.42 1.42l3.3 3.29H7a1 1 0 0 0 0 2h7.59l-3.3 3.29a1.002 1.002 0 0 0 .325 1.639 1 1 0 0 0 1.095-.219l5-5a1 1 0 0 0 .21-.33 1 1 0 0 0 0-.76Z"/></svg>  <span class="astro-u2l5gyhi"> Next <br class="astro-u2l5gyhi"> <span class="link-title astro-u2l5gyhi">Kubeadm å¿«é€Ÿéƒ¨ç½²æ‰‹å†Œ</span> </span> </a> </div>  </footer>  </div> </div>   </main> </div> </div>  </div> </div>  </body></html>