<!DOCTYPE html><html lang="en" dir="ltr" data-has-toc data-has-sidebar data-theme="dark" class="astro-bguv2lll"> <head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Kubernetes ‰∫åËøõÂà∂ÂÆâË£Ö | AGou's Docsv5</title><link rel="canonical"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><meta name="generator" content="Astro v4.5.3"/><meta name="generator" content="Starlight v0.21.1"/><meta property="og:title" content="Kubernetes ‰∫åËøõÂà∂ÂÆâË£Ö"/><meta property="og:type" content="article"/><meta property="og:url"/><meta property="og:locale" content="en"/><meta property="og:description" content="This is a document about Kubernetes ‰∫åËøõÂà∂ÂÆâË£Ö."/><meta property="og:site_name" content="AGou's Docsv5"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Kubernetes ‰∫åËøõÂà∂ÂÆâË£Ö"/><meta name="twitter:description" content="This is a document about Kubernetes ‰∫åËøõÂà∂ÂÆâË£Ö."/><meta name="description" content="This is a document about Kubernetes ‰∫åËøõÂà∂ÂÆâË£Ö."/><script>
	window.StarlightThemeProvider = (() => {
		const storedTheme =
			typeof localStorage !== 'undefined' && localStorage.getItem('starlight-theme');
		const theme =
			storedTheme ||
			(window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark');
		document.documentElement.dataset.theme = theme === 'light' ? 'light' : 'dark';
		return {
			updatePickers(theme = storedTheme || 'auto') {
				document.querySelectorAll('starlight-theme-select').forEach((picker) => {
					const select = picker.querySelector('select');
					if (select) select.value = theme;
					/** @type {HTMLTemplateElement | null} */
					const tmpl = document.querySelector(`#theme-icons`);
					const newIcon = tmpl && tmpl.content.querySelector('.' + theme);
					if (newIcon) {
						const oldIcon = picker.querySelector('svg.label-icon');
						if (oldIcon) {
							oldIcon.replaceChildren(...newIcon.cloneNode(true).childNodes);
						}
					}
				});
			},
		};
	})();
</script><template id="theme-icons"><svg aria-hidden="true" class="light astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M5 12a1 1 0 0 0-1-1H3a1 1 0 0 0 0 2h1a1 1 0 0 0 1-1Zm.64 5-.71.71a1 1 0 0 0 0 1.41 1 1 0 0 0 1.41 0l.71-.71A1 1 0 0 0 5.64 17ZM12 5a1 1 0 0 0 1-1V3a1 1 0 0 0-2 0v1a1 1 0 0 0 1 1Zm5.66 2.34a1 1 0 0 0 .7-.29l.71-.71a1 1 0 1 0-1.41-1.41l-.66.71a1 1 0 0 0 0 1.41 1 1 0 0 0 .66.29Zm-12-.29a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.71-.71a1.004 1.004 0 1 0-1.43 1.41l.73.71ZM21 11h-1a1 1 0 0 0 0 2h1a1 1 0 0 0 0-2Zm-2.64 6A1 1 0 0 0 17 18.36l.71.71a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.76-.66ZM12 6.5a5.5 5.5 0 1 0 5.5 5.5A5.51 5.51 0 0 0 12 6.5Zm0 9a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7Zm0 3.5a1 1 0 0 0-1 1v1a1 1 0 0 0 2 0v-1a1 1 0 0 0-1-1Z"/></svg> <svg aria-hidden="true" class="dark astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.64 13a1 1 0 0 0-1.05-.14 8.049 8.049 0 0 1-3.37.73 8.15 8.15 0 0 1-8.14-8.1 8.59 8.59 0 0 1 .25-2A1 1 0 0 0 8 2.36a10.14 10.14 0 1 0 14 11.69 1 1 0 0 0-.36-1.05Zm-9.5 6.69A8.14 8.14 0 0 1 7.08 5.22v.27a10.15 10.15 0 0 0 10.14 10.14 9.784 9.784 0 0 0 2.1-.22 8.11 8.11 0 0 1-7.18 4.32v-.04Z"/></svg> <svg aria-hidden="true" class="auto astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg> </template><link rel="stylesheet" href="/_astro/index.BsC2KTtW.css" /><script type="module" src="/_astro/hoisted.bf4k8FkQ.js"></script>
<script type="module" src="/_astro/page.CZ0TFQCk.js"></script></head> <body class="astro-bguv2lll"> <a href="#_top" class="astro-7q3lir66">Skip to content</a>  <div class="page sl-flex astro-vrdttmbt"> <header class="header astro-vrdttmbt"><div class="header sl-flex astro-kmkmnagf"> <div class="title-wrapper sl-flex astro-kmkmnagf"> <a href="/" class="site-title sl-flex astro-m46x6ez3">  <img class="astro-m46x6ez3" alt="" src="/_astro/logo.BdruG-BK.png" width="200" height="200">  <span class="astro-m46x6ez3"> AGou&#39;s Docsv5 </span> </a>  </div> <div class="sl-flex astro-kmkmnagf"> <site-search data-translations="{&#34;placeholder&#34;:&#34;Search&#34;}" class="astro-v37mnknz"> <button data-open-modal disabled class="astro-v37mnknz">  <svg aria-label="Search" class="astro-v37mnknz astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.71 20.29 18 16.61A9 9 0 1 0 16.61 18l3.68 3.68a.999.999 0 0 0 1.42 0 1 1 0 0 0 0-1.39ZM11 18a7 7 0 1 1 0-14 7 7 0 0 1 0 14Z"/></svg>  <span class="sl-hidden md:sl-block astro-v37mnknz" aria-hidden="true">Search</span> <svg aria-label="(Press / to Search)" class="sl-hidden md:sl-block astro-v37mnknz astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 2H7a5 5 0 0 0-5 5v10a5 5 0 0 0 5 5h10a5 5 0 0 0 5-5V7a5 5 0 0 0-5-5Zm3 15a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V7a3 3 0 0 1 3-3h10a3 3 0 0 1 3 3v10Z"/><path d="M15.293 6.707a1 1 0 1 1 1.414 1.414l-8.485 8.486a1 1 0 0 1-1.414-1.415l8.485-8.485Z"/></svg>  </button> <dialog style="padding:0" aria-label="Search" class="astro-v37mnknz"> <div class="dialog-frame sl-flex astro-v37mnknz">  <button data-close-modal class="sl-flex md:sl-hidden astro-v37mnknz"> Cancel </button> <div class="search-container astro-v37mnknz"> <div id="starlight__search" class="astro-v37mnknz"></div> </div> </div> </dialog> </site-search>    </div> <div class="sl-hidden md:sl-flex right-group astro-kmkmnagf"> <div class="sl-flex social-icons astro-kmkmnagf"> <a href="https://github.com/AGou-ops" rel="me" class="sl-flex astro-wy4te6ga"><span class="sr-only astro-wy4te6ga">GitHub</span><svg aria-hidden="true" class="astro-wy4te6ga astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"/></svg> </a> </div> <starlight-theme-select>  <label style="--sl-select-width: 6.25em" class="astro-4yphtoen"> <span class="sr-only astro-4yphtoen">Select theme</span> <svg aria-hidden="true" class="icon label-icon astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg>  <select value="auto" class="astro-4yphtoen"> <option value="dark" class="astro-4yphtoen">Dark</option><option value="light" class="astro-4yphtoen">Light</option><option value="auto" selected="true" class="astro-4yphtoen">Auto</option> </select> <svg aria-hidden="true" class="icon caret astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </label>  </starlight-theme-select>  <script>
	StarlightThemeProvider.updatePickers();
</script>   </div> </div> </header> <nav class="sidebar astro-vrdttmbt" aria-label="Main"> <starlight-menu-button class="astro-jif73yzw"> <button aria-expanded="false" aria-label="Menu" aria-controls="starlight__sidebar" class="sl-flex md:sl-hidden astro-jif73yzw"> <svg aria-hidden="true" class="astro-jif73yzw astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M3 8h18a1 1 0 1 0 0-2H3a1 1 0 0 0 0 2Zm18 8H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Zm0-5H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Z"/></svg>  </button> </starlight-menu-button>    <div id="starlight__sidebar" class="sidebar-pane astro-vrdttmbt"> <div class="sidebar-content sl-flex astro-vrdttmbt"> <ul class="top-level astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">üîó Links</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="https://agou-ops.cn" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">‚≠êÔ∏è Go to myBlog</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">guide</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/guide/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">index</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">CloudNative</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">index</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">CICD</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/argocd-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ArgoCD Basic</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">GitLab</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/gitlab/gitlab-backup-move/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">GitLab Backup-Move</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/gitlab/gitlab-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">GitLab Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/gitlab/gitlab-reset-passwd/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">GitLab reset passwd</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/gogs-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Gogs Basic</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Jenkins</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/docker-jenkins-ÊâßË°åÂÆø‰∏ªÊú∫ÂëΩ‰ª§/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker Jenkins ÊâßË°åÂÆø‰∏ªÊú∫ÂëΩ‰ª§</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/generic-webhook-trigger/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Generic Webhook Trigger</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/jenkins-backup-restore/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jenkins Backup Restore</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/jenkins-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jenkins Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/jenkins-issues/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jenkins issues</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/jenkins-plugins/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jenkins Plugins</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/jenkins-ÂÖ±‰∫´Â∫ì/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jenkins ÂÖ±‰∫´Â∫ì</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/jenkins-Âà†Èô§ÊûÑÂª∫ÂéÜÂè≤/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jenkins Âà†Èô§ÊûÑÂª∫ÂéÜÂè≤</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/jenkins-ÊµÅÊ∞¥Á∫øÂÆû‰æã/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jenkins ÊµÅÊ∞¥Á∫øÂÆû‰æã</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/jenkins-ÈïúÂÉèÂä†ÈÄü/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jenkins ÈïúÂÉèÂä†ÈÄü</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/jenkinsfile-sample/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jenkinsfile Sample</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/jenkinsfile-Ëá™ÂÆö‰πâÂáΩÊï∞/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jenkinsfile Ëá™ÂÆö‰πâÂáΩÊï∞</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/pipeline-build-parameters/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Pipeline build parameters</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jenkins/ÈÇÆ‰ª∂ÈÄöÁü•Ê®°Êùø/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ÈÇÆ‰ª∂ÈÄöÁü•Ê®°Êùø</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/jira-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jira Basic</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Sonarqube</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/sonarqube/sonarqube-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Sonarqube Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/sonarqube/sonarqube-with-jenkins/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Sonarqube with Jenkins</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cicd/ÂèëÂ∏ÉÊñπÂºè/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ÂèëÂ∏ÉÊñπÂºè</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">CloudComptering</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Aliyun</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/cloudcomptering/aliyun/untitled/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Untitled</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cloudcomptering/amazon-eks-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Amazon EKS Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cloudcomptering/amazon-web-services/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Amazon Web Services</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/cloudcomptering/microsoft-azure/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Microsoft Azure</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/consul-ÂÖ•Èó®/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Consul ÂÖ•Èó®</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Docker</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-compose/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker Compose</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-network/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker Network</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-openvswitch/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker openvswitch</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-portainer/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker Portainer</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-private-registry/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker Private Registry</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-remote-access/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker Remote Access</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-volume/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker Volume</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-Âõ∫ÂÆöipÂèäË∑®‰∏ªÊú∫‰∫íÈÄö/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker Âõ∫ÂÆöIPÂèäË∑®‰∏ªÊú∫‰∫íÈÄö</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-ÂÆπÂô®Èó¥ÈÄöËøá‰∏ªÊú∫Âêç‰∫íÁõ∏ËÆøÈóÆ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker ÂÆπÂô®Èó¥ÈÄöËøá‰∏ªÊú∫Âêç‰∫íÁõ∏ËÆøÈóÆ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-Ê∏ÖÁêÜ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker Ê∏ÖÁêÜ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/docker-Á§∫‰æãÂèäÂ§öÊû∂ÊûÑÊûÑÂª∫/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Docker Á§∫‰æãÂèäÂ§öÊû∂ÊûÑÊûÑÂª∫</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/dockerfile/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">DockerFile</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/docker/ssh-docker-container/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">SSH Docker container</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/dubbo-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Dubbo Basic</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">ELFK</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/elastic-stack-beats/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Elastic Stack Beats</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/elk-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ELK basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/elk-kafka-filebeat/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ELK-Kafka-Filebeat</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/elk-redisÁºìÂ≠ò‰ª•ÂèäÊó•ÂøóÂàÜÊµÅ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ELK-RedisÁºìÂ≠ò‰ª•ÂèäÊó•ÂøóÂàÜÊµÅ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/es-3rd-part-plugins/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ES 3rd part Plugins</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/es-docker‰∏âËäÇÁÇπÈÉ®ÁΩ≤/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ES Docker‰∏âËäÇÁÇπÈÉ®ÁΩ≤</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/es-ÈÖçÁΩÆÊñá‰ª∂ËØ¶Ëß£/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ES ÈÖçÁΩÆÊñá‰ª∂ËØ¶Ëß£</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/filebeat-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Filebeat basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/kafka-elfkÂàÜÂ∏ÉÂºèÊó•ÂøóÊî∂ÈõÜ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Kafka-ELFKÂàÜÂ∏ÉÂºèÊó•ÂøóÊî∂ÈõÜ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/kafka-redis-elfkÂàÜÂ∏ÉÂºèÊó•ÂøóÊî∂ÈõÜ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Kafka-Redis-ELFKÂàÜÂ∏ÉÂºèÊó•ÂøóÊî∂ÈõÜ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/logstash-basic-plugins/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Logstash Basic - Plugins</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/logstash-Êó•ÂøóÂàÜÊµÅ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Logstash Êó•ÂøóÂàÜÊµÅ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/syslog-elkÊó•ÂøóÊî∂ÈõÜ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">syslog-ELKÊó•ÂøóÊî∂ÈõÜ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/tcp-elkÊó•ÂøóÊî∂ÈõÜ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">TCP-ELKÊó•ÂøóÊî∂ÈõÜ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/‰ΩøÁî®-docker-compose-ÈÉ®ÁΩ≤-elk/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">‰ΩøÁî® docker-compose ÈÉ®ÁΩ≤ ELK</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/Êî∂ÈõÜjavatomcatÊó•Âøó/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Êî∂ÈõÜJava„ÄÅTomcatÊó•Âøó</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/elfk/ÈÉ®ÁΩ≤elk-kafka-filebeatÊó•ÂøóÊî∂ÈõÜÂàÜÊûêÁ≥ªÁªü/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ÈÉ®ÁΩ≤ELK-Kafka-FilebeatÊó•ÂøóÊî∂ÈõÜÂàÜÊûêÁ≥ªÁªü</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/grafana-loki-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Grafana Loki Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/istio-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Istio Basic</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">k8s</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/cilium-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">cilium Basic</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Helm</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/helm/charts/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">charts</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/helm/helm-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Helm Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/helm/helmgotemplate/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">HelmÔºàGoÔºâtemplate</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Installation</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/installation/k8s-debian12‰∫åËøõÂà∂ÂÆâË£Ö/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">k8s Debian12‰∫åËøõÂà∂ÂÆâË£Ö</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/installation/kubeadm-Âø´ÈÄüÈÉ®ÁΩ≤ÊâãÂÜå/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Kubeadm Âø´ÈÄüÈÉ®ÁΩ≤ÊâãÂÜå</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/installation/kubernetes-‰∫åËøõÂà∂ÂÆâË£Ö/" aria-current="page" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Kubernetes ‰∫åËøõÂà∂ÂÆâË£Ö</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/installation/‰ΩøÁî®-kubeadm-ÈÉ®ÁΩ≤Âçïmaster/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">‰ΩøÁî® Kubeadm ÈÉ®ÁΩ≤ÔºàÂçïmasterÔºâ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/installation/‰ΩøÁî®-kubespray-ÈÉ®ÁΩ≤/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">‰ΩøÁî® Kubespray ÈÉ®ÁΩ≤</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/installation/‰ΩøÁî®ÂõΩÂÜÖÊ∫êÂèäÁõ∏ÂÖ≥Â∞èÂ∑•ÂÖ∑/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">‰ΩøÁî®ÂõΩÂÜÖÊ∫êÂèäÁõ∏ÂÖ≥Â∞èÂ∑•ÂÖ∑</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/installation/Â∏∏Áî®ÁªÑ‰ª∂ÂÆâË£Ö/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Â∏∏Áî®ÁªÑ‰ª∂ÂÆâË£Ö</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/k3d/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">k3d</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/k8s-command/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">k8s command</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/k8s-ÂõæËß£Â§ßÂÖ®/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">k8s ÂõæËß£Â§ßÂÖ®</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/k8s-ÁΩëÁªúÁõ∏ÂÖ≥/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">k8s ÁΩëÁªúÁõ∏ÂÖ≥</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/k8sÊ¶ÇÂøµÂèäÂéüÁêÜÁõ∏ÂÖ≥/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">k8sÊ¶ÇÂøµÂèäÂéüÁêÜÁõ∏ÂÖ≥</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/kompose-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">kompose Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/kubeadm-Âø´ÈÄüÈÉ®ÁΩ≤k8sÈõÜÁæ§/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Kubeadm Âø´ÈÄüÈÉ®ÁΩ≤k8sÈõÜÁæ§</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/kubenetesËøúÁ®ãË∞ÉËØïÂ∑•ÂÖ∑/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">kubenetesËøúÁ®ãË∞ÉËØïÂ∑•ÂÖ∑</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/kubernetes-rest-api/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Kubernetes REST API</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/kubernetes-with-jenkins-cicd/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Kubernetes with Jenkins CICD</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/kubernetes-yaml-quicklystart/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Kubernetes Yaml quicklystart</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/kustmoize-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">kustmoize Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/metalb-ÈÉ®ÁΩ≤‰∏éÁÆÄÂçïÊµãËØï/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MetaLB ÈÉ®ÁΩ≤‰∏éÁÆÄÂçïÊµãËØï</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/minikube-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Minikube Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/prometheus-grafanaÂÖ®Êñπ‰ΩçÁõëÊéßkubernetesÈõÜÁæ§/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Prometheus-GrafanaÂÖ®Êñπ‰ΩçÁõëÊéßKubernetesÈõÜÁæ§</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Quicklystart</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/‰∏Ä-kubernetesÊ¶ÇËø∞/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">‰∏Ä KubernetesÊ¶ÇËø∞</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/‰∏É-ÊéßÂà∂Âô®ÈÖçÁΩÆÊ∏ÖÂçï/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">‰∏É ÊéßÂà∂Âô®ÈÖçÁΩÆÊ∏ÖÂçï</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/‰∏â-ÈõÜÁæ§ÈÉ®ÁΩ≤/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">‰∏â ÈõÜÁæ§ÈÉ®ÁΩ≤</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/‰πù-ingress-ÊéßÂà∂Âô®/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">‰πù ingress ÊéßÂà∂Âô®</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/‰∫å-Ê†∏ÂøÉÁªÑ‰ª∂ÂèäÈôÑ‰ª∂/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">‰∫å Ê†∏ÂøÉÁªÑ‰ª∂ÂèäÈôÑ‰ª∂</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/‰∫î-ÈÖçÁΩÆÊ∏ÖÂçï‰ΩøÁî®/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">‰∫î ÈÖçÁΩÆÊ∏ÖÂçï‰ΩøÁî®</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/ÂÖ´-service-ÈÖçÁΩÆÊ∏ÖÂçï/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ÂÖ´ Service ÈÖçÁΩÆÊ∏ÖÂçï</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/ÂÖ≠-pod-ÈÖçÁΩÆÊ∏ÖÂçï/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ÂÖ≠ POD ÈÖçÁΩÆÊ∏ÖÂçï</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/ÂçÅ-pod-Â≠òÂÇ®Âç∑/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ÂçÅ POD Â≠òÂÇ®Âç∑</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/ÂçÅ‰∏Ä-ÈÖçÁΩÆ‰ø°ÊÅØÂÆπÂô®Âåñ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ÂçÅ‰∏Ä ÈÖçÁΩÆ‰ø°ÊÅØÂÆπÂô®Âåñ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/ÂçÅ‰∏É-Ë∞ÉÂ∫¶Á≠ñÁï•/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ÂçÅ‰∏É Ë∞ÉÂ∫¶Á≠ñÁï•</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/ÂçÅ‰∏â-Áî®Êà∑ËÆ§ËØÅÁ≥ªÁªü/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ÂçÅ‰∏â Áî®Êà∑ËÆ§ËØÅÁ≥ªÁªü</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/ÂçÅ‰πù-ÂÆπÂô®ËµÑÊ∫êÈôêÂà∂/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ÂçÅ‰πù ÂÆπÂô®ËµÑÊ∫êÈôêÂà∂</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/ÂçÅ‰∫å-statefulset-ÊéßÂà∂Âô®/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ÂçÅ‰∫å StatefulSet ÊéßÂà∂Âô®</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/ÂçÅ‰∫î-dashboard/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ÂçÅ‰∫î dashboard</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/ÂçÅÂÖ´-È´òÁ∫ßË∞ÉÂ∫¶ËÆæÁΩÆ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ÂçÅÂÖ´ È´òÁ∫ßË∞ÉÂ∫¶ËÆæÁΩÆ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/ÂçÅÂÖ≠-ÁΩëÁªúÈÄö‰ø°/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ÂçÅÂÖ≠ ÁΩëÁªúÈÄö‰ø°</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/ÂçÅÂõõ-Áî®Êà∑ÊùÉÈôêÁ≥ªÁªü/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ÂçÅÂõõ Áî®Êà∑ÊùÉÈôêÁ≥ªÁªü</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/quicklystart/Âõõ-ÂÖ•Èó®ÂëΩ‰ª§/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Âõõ ÂÖ•Èó®ÂëΩ‰ª§</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/remote-access-k8s/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Remote access k8s</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/xfs-recovery/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">xfs recovery</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">ÂÆûÊàòÊ°à‰æã</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/ÂÆûÊàòÊ°à‰æã/cert-managerËá™Âä®È¢ÅÂèëËØÅ‰π¶/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">cert-managerËá™Âä®È¢ÅÂèëËØÅ‰π¶</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/ÂÆûÊàòÊ°à‰æã/helmÂÆâË£ÖzookeeperÈõÜÁæ§/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">helmÂÆâË£ÖzookeeperÈõÜÁæ§</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/ÂÆûÊàòÊ°à‰æã/jenkinsÁªìÂêà/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">jenkinsÁªìÂêà</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/ÂÆûÊàòÊ°à‰æã/k8s‰∏≠‰ΩøÁî®traefikÂü∫Á°Ä/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">k8s‰∏≠‰ΩøÁî®traefikÔºàÂü∫Á°ÄÔºâ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/ÂÆûÊàòÊ°à‰æã/k8sÂÆâË£ÖapolloÈÖçÁΩÆ‰∏≠ÂøÉ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">k8sÂÆâË£ÖApolloÈÖçÁΩÆ‰∏≠ÂøÉ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/ÂÆûÊàòÊ°à‰æã/k8sÂÆâË£ÖminioÂØπË±°Â≠òÂÇ®/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">k8sÂÆâË£ÖMinIOÂØπË±°Â≠òÂÇ®</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/ÂÆûÊàòÊ°à‰æã/rbac-ÂÆûÊàòÊ°à‰æã/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">RBAC ÂÆûÊàòÊ°à‰æã</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/ÂÆûÊàòÊ°à‰æã/springcloudÂæÆÊúçÂä°ÁîµÂïÜÁ≥ªÁªüÂú®kubernetesÈõÜÁæ§‰∏≠‰∏äÁ∫øËØ¶ÁªÜÊïôÁ®ã/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">SpringCloudÂæÆÊúçÂä°ÁîµÂïÜÁ≥ªÁªüÂú®KubernetesÈõÜÁæ§‰∏≠‰∏äÁ∫øËØ¶ÁªÜÊïôÁ®ã</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/ÂÆûÊàòÊ°à‰æã/‰ΩøÁî®csr-apiÂàõÂª∫Áî®Êà∑/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">‰ΩøÁî®CSR APIÂàõÂª∫Áî®Êà∑</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/ÂÆûÊàòÊ°à‰æã/ÂÖ∂‰ªñÂÆûÊàòÊ°à‰æã/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ÂÖ∂‰ªñÂÆûÊàòÊ°à‰æã</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Â∞èÊäÄÂ∑ß</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/Â∞èÊäÄÂ∑ß/‰ΩøÁî®curlËÆøÈóÆk8sÁöÑrest-api/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">‰ΩøÁî®curlËÆøÈóÆk8sÁöÑREST API</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/k8s/Â∞èÊäÄÂ∑ß/Âº∫Âà∂Âà†Èô§namespace/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Âº∫Âà∂Âà†Èô§namespace</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Prometheus</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/cloudnative/prometheus/influxdbtelegraf-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">influxDB„ÄÅTelegraf Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/prometheus/prometheus-alertmanager/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Prometheus-AlertManager</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/prometheus/prometheus-consulÊúçÂä°ÂèëÁé∞/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Prometheus-ConsulÔºàÊúçÂä°ÂèëÁé∞Ôºâ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/prometheus/prometheus-in-docker/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Prometheus in Docker</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/prometheus/prometheus-ÂÆâË£Ö‰∏éÈÉ®ÁΩ≤grafana/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Prometheus ÂÆâË£Ö‰∏éÈÉ®ÁΩ≤„ÄÅGrafana</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/cloudnative/prometheus/prometheus-ËøõÈò∂/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Prometheus ËøõÈò∂</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">LinuxBasics</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">index</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Ansible</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/ansible/ansible-ad-hoc-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ansible Ad-hoc Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/ansible/ansible-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ansible Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/ansible/ansible-best-practices/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ansible Best Practices</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/ansible/ansible-inventory/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ansible inventory</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/ansible/ansible-modules/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ansible modules</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/ansible/ansible-playbook-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ansible Playbook Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/ansible/ansible-tower/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ansible Tower</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Cache</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Nuster</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/cache/nuster/nuster-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nuster Basic</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Varnish</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/cache/varnish/varnish-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">varnish Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/cache/varnish/varnish-ÂèÇËÄÉÁ§∫‰æã/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">varnish ÂèÇËÄÉÁ§∫‰æã</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/cache/varnish/varnish-Êû∂ÊûÑÂ∑•‰ΩúÂéüÁêÜÂèäÁÆÄÂçïÈÖçÁΩÆ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">varnish Êû∂ÊûÑ„ÄÅÂ∑•‰ΩúÂéüÁêÜÂèäÁÆÄÂçïÈÖçÁΩÆ</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/certbot-nginx-ssl/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">CertBot Nginx SSL</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">DataBases</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Etcd</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/etcd/etcd-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">etcd Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/etcd/etcd-Â§á‰ªΩ‰∏éÊÅ¢Â§ç/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">etcd Â§á‰ªΩ‰∏éÊÅ¢Â§ç</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/etcd/etcd-Ê∑ªÂä†leanerËäÇÁÇπ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">etcd Ê∑ªÂä†leanerËäÇÁÇπ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/etcd/etcdctl-Âø´ÈÄüÊâãÂÜå/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">etcdctl Âø´ÈÄüÊâãÂÜå</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">MongoDB</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mongodb/mongodb-backup/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MongoDB Backup</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mongodb/mongodb-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MongoDB Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mongodb/mongodb-cluster/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MongoDB Cluster</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mongodb/mongodb-installation/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MongoDB Installation</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mongodb/mongodb-sharded-cluster/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MongoDB Sharded-Cluster</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mongodb/mongodb-ÂºÇÊûÑÊï∞ÊçÆÂπ≥Âè∞ËøÅÁßª/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MongoDB ÂºÇÊûÑÊï∞ÊçÆÂπ≥Âè∞ËøÅÁßª</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mongodb/mongodumprestoreoplogÈ´òÁ∫ßÂ§á‰ªΩ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">mongodumpÔºàrestoreÔºâoplogÈ´òÁ∫ßÂ§á‰ªΩ</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">MySQL</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mariadb-log/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MariaDB Log</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-auth-cli/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL Auth CLI</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-backup-client-tools/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL BackUP - Client Tools</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-cluster/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL Cluster</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-configuration/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL Configuration</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-cursor/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL Cursor</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-data_type/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL Data_Type</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-explain/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL EXPLAIN</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-function/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL Function</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-internal_function/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL Internal_function</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-stored-procedure/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL Stored Procedure</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-transaction/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL Transaction</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-Â∞èÊäÄÂ∑ß/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL Â∞èÊäÄÂ∑ß</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-Âø´ÈÄüÊâãÂÜå/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL Âø´ÈÄüÊâãÂÜå</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/mysql/mysql-Á∫¶Êùü/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MySQL Á∫¶Êùü</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Redis</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/redis/redis-backup/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redis Backup</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/redis/redis-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redis Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/redis/redis-cluster/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redis Cluster</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/redis/redis-codis/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redis Codis</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/redis/redis-ha/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redis  HA</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/redis/redis-installation/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redis Installation</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/redis/redis-sentinel/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redis Sentinel</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/redis/redis-ËøõÈò∂/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redis ËøõÈò∂</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/databases/redis/ÁºìÂ≠òÁ©øÈÄèÁºìÂ≠òÂáªÁ©øÁºìÂ≠òÈõ™Â¥©/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ÁºìÂ≠òÁ©øÈÄè„ÄÅÁºìÂ≠òÂáªÁ©ø„ÄÅÁºìÂ≠òÈõ™Â¥©</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">DHCP-PXE-Cobbler</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/dhcp-pxe-cobbler/cobbler-centos/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Cobbler CentOS</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/dhcp-pxe-cobbler/dhcp-ÁÆÄÂçï‰ΩøÁî®/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">DHCP ÁÆÄÂçï‰ΩøÁî®</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/dhcp-pxe-cobbler/pxe-centos/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">PXE CentOS</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/dnsmasq/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">dnsmasq</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/fail2ban-ÁÆÄÂçï‰ΩøÁî®/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Fail2ban ÁÆÄÂçï‰ΩøÁî®</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">FileSystem</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Ceph</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/ceph/ceph-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ceph Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/ceph/ceph-cluster-ÁßªÈô§/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ceph Cluster ÁßªÈô§</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/ceph/ceph-deploy-ÈõÜÁæ§Âø´ÈÄüÈÉ®ÁΩ≤/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ceph-deploy ÈõÜÁæ§Âø´ÈÄüÈÉ®ÁΩ≤</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/ceph/ceph-manager-dashboard/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ceph Manager Dashboard</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/ceph/ceph-rgw/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ceph RGW</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/ceph/ceph-ÈÉ®ÁΩ≤ÈóÆÈ¢òÊ±áÊÄª/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ceph ÈÉ®ÁΩ≤ÈóÆÈ¢òÊ±áÊÄª</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/ceph/cephadm-ÈÉ®ÁΩ≤octopus/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Cephadm ÈÉ®ÁΩ≤octopus</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/ceph/cephfs/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">CephFS</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">FastDFS</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/fastdfs/fastdfs-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">FastDFS Basic</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">GlusterFS</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/glusterfs/‰∏¥Êó∂/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">‰∏¥Êó∂</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">MinIO</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/minio/minio-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MinIO Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/minio/minio-in-docker/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MinIO in Docker</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/nfs-Âü∫Á°ÄÂèäÂÆûÊàò/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">NFS Âü∫Á°ÄÂèäÂÆûÊàò</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/samba-Âü∫Á°ÄÂèäÂÆûÊàò/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">SAMBA Âü∫Á°ÄÂèäÂÆûÊàò</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/smbconfËØ¶Ëß£/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">smb.confËØ¶Ëß£</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/tftp/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">TFTP</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/filesystem/vsftp-Âü∫Á°ÄÂèäÂÆûÊàò/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">vsFTP Âü∫Á°ÄÂèäÂÆûÊàò</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/firewalld-iptablesÂø´ÈÄüÊâãÂÜå/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Firewalld IPtablesÂø´ÈÄüÊâãÂÜå</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/inotifywait-Êñá‰ª∂ÁõëÊéß/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">inotifywait Êñá‰ª∂ÁõëÊéß</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/jumpserver/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">JumpServer</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/k3s-k3d-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">k3s - k3d Basic</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Kafka</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/kafka/cmak/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">CMAK</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/kafka/kafka-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Kafka Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/kafka/‰ΩøÁî®-docker-compose-ÈÉ®ÁΩ≤-kafka/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">‰ΩøÁî® docker-compose ÈÉ®ÁΩ≤ Kafka</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/keepalived/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">keepalived</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">KVM</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/kvm/kvm_installsh/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">kvm_install.sh</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/kvm/kvm-2-vmware-station/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">KVM 2 VMware Station</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/kvm/kvm-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">KVM Basic</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/linux-ÂéãÊµãÂ§ßÂÖ®/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Linux ÂéãÊµãÂ§ßÂÖ®</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/linuxËØäÊñ≠/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">LinuxËØäÊñ≠</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">LoadBalancer</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">HAProxy</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/haproxy/haproxy-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">HAProxy Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/haproxy/haproxy-in-docker/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">HAProxy in Docker</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/haproxy/haproxy-ÂèÇËÄÉÁ§∫‰æã/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">HAProxy ÂèÇËÄÉÁ§∫‰æã</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/haproxy/haproxy-ÈÖçÁΩÆËØ¶Ëß£/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">HAProxy ÈÖçÁΩÆËØ¶Ëß£</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/haproxy/keepalived-haproxy/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Keepalived - HAProxy</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Keepalived-Nginx</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/keepalived-nginx/nginx-keepalivedÂÆûÁé∞È´òÂèØÁî®ÈõÜÁæ§/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx - keepalivedÂÆûÁé∞È´òÂèØÁî®ÈõÜÁæ§</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/keepalived-nginx/nginx-keepalivedÂø´ÈÄüÈÖçÁΩÆÂèäËÑöÊú¨/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx - keepalivedÂø´ÈÄüÈÖçÁΩÆÂèäËÑöÊú¨</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">LVS</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/lvs/ipvsadm-ÂèÇÊï∞/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ipvsadm ÂèÇÊï∞</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/lvs/lvs-keepalived/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">LVS - keepalived</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/lvs/lvs-ÂõõÁßçÊ®°ÂûãËØ¶Ëß£/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">LVS ÂõõÁßçÊ®°ÂûãËØ¶Ëß£</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/lvs/lvs-ÁÆÄÂçïÂ∫îÁî®/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">LVS ÁÆÄÂçïÂ∫îÁî®</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/lvs/lvs-Ë∞ÉÂ∫¶ÁÆóÊ≥ï/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">LVS Ë∞ÉÂ∫¶ÁÆóÊ≥ï</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/loadbalancer/lvs/lvs-ËøõÈò∂ÈÖçÁΩÆ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">LVS ËøõÈò∂ÈÖçÁΩÆ</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/lsyncd/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">lsyncd</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/lvm-ËÆ≤Ëß£/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">lvm ËÆ≤Ëß£</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Makefile</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/makefile/makefile-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Makefile Basic</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Nexus</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/nexus/nexus-basic-maven-ÁßÅÊúç/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nexus Basic - Maven ÁßÅÊúç</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/nexus/nexus-yum-ÁßÅÊúç/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nexus - yum ÁßÅÊúç</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/nexus/nexus-ÊâπÈáè‰∏ä‰º†ËÑöÊú¨/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">nexus ÊâπÈáè‰∏ä‰º†ËÑöÊú¨</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/openvpn-for-centos/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">OpenVPN for CentOS</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/powerdns/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">PowerDNS</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">PVE</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/pve/pve-issues/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">PVE issues</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/pve/pve-ÂàùÂßãÂåñÁõ∏ÂÖ≥/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">PVE ÂàùÂßãÂåñÁõ∏ÂÖ≥</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/pve/pve-Âà∂‰ΩúÈïúÂÉèÊ®°Êùø/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">PVE Âà∂‰ΩúÈïúÂÉèÊ®°Êùø</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">RabbitMQ</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/rabbitmq/rabbitmq-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">RabbitMQ Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/rabbitmq/rabbitmq-mirror-queue/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">RabbitMQ Mirror Queue</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/rabbitmq/rabbitmq-on-docker/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">RabbitMQ on Docker</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/rsync-inotifysersync/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">rsync - inotifyÔºàsersyncÔºâ</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Shell</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/shell/command/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">command</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/shell/linux-shell-ÂÆûÁî®ÂëΩ‰ª§Âèä‰ΩøÁî®Âú∫ÊôØ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Linux Shell ÂÆûÁî®ÂëΩ‰ª§Âèä‰ΩøÁî®Âú∫ÊôØ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/shell/shell-getopts-Ê†∑‰æã/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Shell getopts Ê†∑‰æã</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/shell/userful-shell/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">userful-shell</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/snmpÈÖçÁΩÆ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">snmpÈÖçÁΩÆ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/split-logrotate/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Split - Logrotate</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">SpringBoot</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/springboot/springboot-in-docker/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">SpringBoot in Docker</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/springboot/springboot-quicklystart/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">SpringBoot Quicklystart</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/sql-review/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">SQL review</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/ssh-tunnel/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">SSH Tunnel</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/tcpdump-wireshark/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Tcpdump - Wireshark</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Terraform</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/terraform/terraform-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Terraform Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/terraform/terraform-examples/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Terraform Examples</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/terraform/terraform-variable/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Terraform Variable</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/useful-command/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Useful Command</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/vagrant/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Vagrant</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/vim-tricks/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">vim tricks</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/vps-ËäÇÁÇπÊê≠Âª∫/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">VPS ËäÇÁÇπÊê≠Âª∫</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Web-Servers</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Apache</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/apache/lamp-Âø´ÈÄüÈÉ®ÁΩ≤/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">LAMP Âø´ÈÄüÈÉ®ÁΩ≤</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Jvm-Tomcat</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/jvm-tomcat/jvm-monitor-tools/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Jvm Monitor Tools</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/jvm-tomcat/tomcat-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Tomcat Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/jvm-tomcat/tomcat-clusternginx/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Tomcat ClusterÔºànginxÔºâ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/jvm-tomcat/tomcat-sessionmemcached/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Tomcat SessionÔºàmemcachedÔºâ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/jvm-tomcat/tomcat-sessionredis-with-nginx/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Tomcat SessionÔºàRedis with NginxÔºâ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/jvm-tomcat/tomcat-Ë∞É‰ºò/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Tomcat Ë∞É‰ºò</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/jvm-tomcat/tomcat‰∏≠Èó¥‰ª∂ÊñπÊñπÈù¢Èù¢ÂÇ®Â§áÁü•ËØÜ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Tomcat‰∏≠Èó¥‰ª∂ÊñπÊñπÈù¢Èù¢ÂÇ®Â§áÁü•ËØÜ</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Nginx</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/https-ÈÖçÁΩÆÂèä‰ºòÂåñ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">HTTPS  ÈÖçÁΩÆÂèä‰ºòÂåñ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-cache/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx Cache</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-php-fpm/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx php-fpm</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-rewrite/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx Rewrite</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-try_files/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx try_files</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-uwsgi-ÈÉ®ÁΩ≤django/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx - uWSGI ÈÉ®ÁΩ≤Django</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-ÂÜÖÁΩÆÂèòÈáè/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx ÂÜÖÁΩÆÂèòÈáè</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-ÂèçÂêë‰ª£ÁêÜ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx ÂèçÂêë‰ª£ÁêÜ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-Âπ≥ÊªëÂçáÁ∫ß‰∏éÂõûÊªö/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx Âπ≥ÊªëÂçáÁ∫ß‰∏éÂõûÊªö</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-Âø´ÈÄüÈÖçÁΩÆÊâãÂÜå/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx Âø´ÈÄüÈÖçÁΩÆÊâãÂÜå</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-ÊÄßËÉΩ‰ºòÂåñ‰∏éÂÆâÂÖ®/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx ÊÄßËÉΩ‰ºòÂåñ‰∏éÂÆâÂÖ®</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-Áà¨Ëô´ÈôêÂà∂/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx Áà¨Ëô´ÈôêÂà∂</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-ÁºñËØëÂèäÂà∂‰ΩúÂåÖ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx ÁºñËØëÂèäÂà∂‰ΩúÂåÖ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-Ë¥üËΩΩÂùáË°°/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx Ë¥üËΩΩÂùáË°°</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/nginx-È´òÁ∫ßÊ®°Âùó/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx È´òÁ∫ßÊ®°Âùó</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Others</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/others/nodejs-with-ssl-nginx/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Node.js with ssl - nginx</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/others/‰ΩøÁî®logrotateÂàáÂâ≤nginxÊó•Âøó/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">‰ΩøÁî®logrotateÂàáÂâ≤nginxÊó•Âøó</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/others/Ê£ÄÊü•ÊúçÂä°Âô®ÊòØÂê¶ÊîØÊåÅgzip/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ê£ÄÊü•ÊúçÂä°Âô®ÊòØÂê¶ÊîØÊåÅgzip</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Problems</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/nginx/problems/rewriteÂèÇÊï∞Â§ÑÁêÜÈóÆÈ¢ò/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">rewriteÂèÇÊï∞Â§ÑÁêÜÈóÆÈ¢ò</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">PHP</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/php/php-‰ºòÂåñÂèäÂÆâÂÖ®ÈÖçÁΩÆ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">PHP ‰ºòÂåñÂèäÂÆâÂÖ®ÈÖçÁΩÆ</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Python-Django</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/python-django/access-to-database/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Access to Database</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/web-servers/python-django/django-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Django Basic</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/windows-useful-cmd/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Windows useful cmd</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/wireguard-vpn-for-ubuntu/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">WireGuard VPN for Ubuntu</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Zabbix</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/zabbix/zabbix-agentÊâßË°åËøúÁ®ãÂëΩ‰ª§/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Zabbix agentÊâßË°åËøúÁ®ãÂëΩ‰ª§</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/zabbix/zabbix-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Zabbix Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/zabbix/zabbix-ÂÆâË£Ö‰∏≠ÊñáÂåÖ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Zabbix ÂÆâË£Ö‰∏≠ÊñáÂåÖ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/zabbix/zabbix-ËØ¶ÁªÜ‰ªãÁªç/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Zabbix ËØ¶ÁªÜ‰ªãÁªç</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/zabbix/zabbix-ÈíâÈíâÊä•Ë≠¶/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Zabbix ÈíâÈíâÊä•Ë≠¶</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Zookeeper</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/linuxbasics/zookeeper/zookeeper-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Zookeeper Basic</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/Ëá™Âª∫dns/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ëá™Âª∫dns</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/Ëá™Âª∫ÈÇÆÁÆ±ÊúçÂä°Âô®/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ëá™Âª∫ÈÇÆÁÆ±ÊúçÂä°Âô®</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/linuxbasics/ËìùÈ≤∏ËøêÁª¥Âπ≥Âè∞/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ËìùÈ≤∏ËøêÁª¥Âπ≥Âè∞</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">ProgramLang</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/programlang/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">index</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Golang</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-basic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang Basic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-errors-handler/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang Errors - handler</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-file-operate/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang File Operate</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-fmtÂç†‰ΩçÁ¨¶/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang fmtÂç†‰ΩçÁ¨¶</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-function/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang Function</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-interface/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang Interface</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-json/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang Json</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-package-manage/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang Package manage</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-pkgs/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang Pkgs</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-pointer/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang Pointer</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-project-layout/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang Project Layout</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-testing/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang Testing</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/golang-Âπ∂Âèë/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Golang Âπ∂Âèë</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/gormÂåÖ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">gormÂåÖ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/golang/string-operate/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">String Operate</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Lua</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/programlang/lua/lua-baisc/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Lua Baisc</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/programlang/lua/lua-continue-ex/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Lua continue Ex</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Scripts</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/scripts/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">index</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">shell</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/scripts/shell/centos-sys-information/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">CentOS sys information</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/scripts/shell/dokcer-ÈïúÂÉèÂ§á‰ªΩ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Dokcer ÈïúÂÉèÂ§á‰ªΩ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/scripts/shell/nginx-log-check/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nginx Log Check</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/scripts/shell/redis-tools/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Redis tools</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">resort-file-from-csv</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/scripts/shell/resort-file-from-csv/resort-file/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">resort-file</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/scripts/shell/rsync/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Rsync</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/scripts/shell/shell-Âπ∂Âèë/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Shell Âπ∂Âèë</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/scripts/shell/Êó•Â∏∏Â∑°Ê£Äshell/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Êó•Â∏∏Â∑°Ê£ÄShell</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">windows</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/scripts/windows/ÈÄöÁî®‰øÆÊîπdns/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ÈÄöÁî®‰øÆÊîπdns</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Interview</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/interview/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">index</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/pdfÈù¢ËØïÈ¢òÈõÜÂêà/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">PDFÈù¢ËØïÈ¢òÈõÜÂêà</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Â∑•‰ΩúÈù¢ËØïÈ¢ò</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/interview/Â∑•‰ΩúÈù¢ËØïÈ¢ò/dbaÊï∞ÊçÆÂ∫ìËøêÁª¥Â∑•Á®ãÂ∏à/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">DBAÊï∞ÊçÆÂ∫ìËøêÁª¥Â∑•Á®ãÂ∏à</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/Â∑•‰ΩúÈù¢ËØïÈ¢ò/devopsÈù¢ËØïÈ¢ò/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">DevopsÈù¢ËØïÈ¢ò</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/Â∑•‰ΩúÈù¢ËØïÈ¢ò/dockerÈù¢ËØïÈ¢ò/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">dockerÈù¢ËØïÈ¢ò</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/Â∑•‰ΩúÈù¢ËØïÈ¢ò/esÈù¢ËØïÈ¢ò/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">esÈù¢ËØïÈ¢ò</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/Â∑•‰ΩúÈù¢ËØïÈ¢ò/etcdÈù¢ËØïÈ¢ò/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">etcdÈù¢ËØïÈ¢ò</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/Â∑•‰ΩúÈù¢ËØïÈ¢ò/goËØ≠Ë®ÄÁõ∏ÂÖ≥/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">GoËØ≠Ë®ÄÁõ∏ÂÖ≥</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/Â∑•‰ΩúÈù¢ËØïÈ¢ò/goËØ≠Ë®ÄÁõ∏ÂÖ≥Áª≠-ÊñáÁ´†Ê±áÊÄª/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">GoËØ≠Ë®ÄÁõ∏ÂÖ≥ÔºàÁª≠-ÊñáÁ´†Ê±áÊÄªÔºâ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/Â∑•‰ΩúÈù¢ËØïÈ¢ò/k8sÈù¢ËØïÈ¢òÊï¥ÁêÜ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">K8sÈù¢ËØïÈ¢òÊï¥ÁêÜ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/Â∑•‰ΩúÈù¢ËØïÈ¢ò/linuxÁõ∏ÂÖ≥ÁöÑÊÄßËÉΩ‰ºòÂåñÈù¢ËØïÈ¢ò/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">linuxÁõ∏ÂÖ≥ÁöÑÊÄßËÉΩ‰ºòÂåñÈù¢ËØïÈ¢ò</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/Â∑•‰ΩúÈù¢ËØïÈ¢ò/mysqlÈù¢ËØïÈ¢ò/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">mysqlÈù¢ËØïÈ¢ò</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/Â∑•‰ΩúÈù¢ËØïÈ¢ò/nginxÈù¢ËØïÈ¢ò/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">nginxÈù¢ËØïÈ¢ò</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/Â∑•‰ΩúÈù¢ËØïÈ¢ò/nginxÈù¢ËØïÈ¢òÂê´Á≠îÊ°àÁª≠/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">nginxÈù¢ËØïÈ¢òÂê´Á≠îÊ°àÔºàÁª≠Ôºâ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/Â∑•‰ΩúÈù¢ËØïÈ¢ò/redisÈù¢ËØïÈ¢ò1/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">RedisÈù¢ËØïÈ¢ò1</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/Â∑•‰ΩúÈù¢ËØïÈ¢ò/redisÈù¢ËØïÈ¢ò1Âê´Á≠îÊ°àÁª≠/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">RedisÈù¢ËØïÈ¢ò1Âê´Á≠îÊ°àÔºàÁª≠Ôºâ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/Â∑•‰ΩúÈù¢ËØïÈ¢ò/redisÈù¢ËØïÈ¢ò2/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">RedisÈù¢ËØïÈ¢ò2</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/Â∑•‰ΩúÈù¢ËØïÈ¢ò/shellËÑöÊú¨Áõ∏ÂÖ≥/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">shellËÑöÊú¨Áõ∏ÂÖ≥</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/Â∑•‰ΩúÈù¢ËØïÈ¢ò/sreÂü∫Á°ÄÂøÖ‰ºöÊ†∏ÂøÉÂÆûÊàòÈù¢ËØïÈ¢ò/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">SREÂü∫Á°ÄÂøÖ‰ºöÊ†∏ÂøÉÂÆûÊàòÈù¢ËØïÈ¢ò</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/Â∑•‰ΩúÈù¢ËØïÈ¢ò/sreÈ´òÁ∫ßËøêÁª¥Èù¢ËØïÈ¢ò/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">SREÈ´òÁ∫ßËøêÁª¥Èù¢ËØïÈ¢ò</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/Â∑•‰ΩúÈù¢ËØïÈ¢ò/ÂÖ¨Âè∏‰∫ßÂìÅ‰∏ä‰∫ëÊµÅÁ®ãËßÑËåÉ/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ÂÖ¨Âè∏‰∫ßÂìÅ‰∏ä‰∫ëÊµÅÁ®ãËßÑËåÉ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/Â∑•‰ΩúÈù¢ËØïÈ¢ò/Êó•ÂøóÊî∂ÈõÜefk/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Êó•ÂøóÊî∂ÈõÜEFK</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/Â∑•‰ΩúÈù¢ËØïÈ¢ò/Êù•Ëá™ÁΩëÁªú-1/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Êù•Ëá™ÁΩëÁªú-1</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/Â∑•‰ΩúÈù¢ËØïÈ¢ò/Êù•Ëá™Áæ§Âèã-1/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Êù•Ëá™Áæ§Âèã-1</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/Â∑•‰ΩúÈù¢ËØïÈ¢ò/Á≥ªÁªüËøêÁª¥ÊïÖÈöúÁõ∏ÂÖ≥/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Á≥ªÁªüËøêÁª¥ÊïÖÈöúÁõ∏ÂÖ≥</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/Â∑•‰ΩúÈù¢ËØïÈ¢ò/ËµÑÊ∑±ËøêÁª¥Êû∂ÊûÑËÆæËÆ°ËßÑÂàí/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ËµÑÊ∑±ËøêÁª¥Êû∂ÊûÑËÆæËÆ°ËßÑÂàí</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/Â∑•‰ΩúÈù¢ËØïÈ¢ò/ËøêÁª¥ÂÆâÂÖ®Áõ∏ÂÖ≥/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ËøêÁª¥ÂÆâÂÖ®Áõ∏ÂÖ≥</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/Â∑•‰ΩúÈù¢ËØïÈ¢ò/ËøêÁª¥ÂøÖ‰ºöÈù¢ËØïÈ¢ò-Âø´ÈÄüÁ™ÅÂáª/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ËøêÁª¥ÂøÖ‰ºöÈù¢ËØïÈ¢ò-Âø´ÈÄüÁ™ÅÂáª</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/Â∑•‰ΩúÈù¢ËØïÈ¢ò/ËøêÁª¥ÁõëÊéß‰ΩìÁ≥ª/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ËøêÁª¥ÁõëÊéß‰ΩìÁ≥ª</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/Â∑•‰ΩúÈù¢ËØïÈ¢ò/ËøêÁª¥ÁΩëÁªúÂü∫Á°Ä/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ËøêÁª¥ÁΩëÁªúÂü∫Á°Ä</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/Â∑•‰ΩúÈù¢ËØïÈ¢ò/ËøêÁª¥Èù¢ËØïËØùÊúØËá™Êàë‰ªãÁªç/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ËøêÁª¥Èù¢ËØïËØùÊúØËá™Êàë‰ªãÁªç</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">ÊùÇÈ°π-Ëá™Áî®</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/interview/ÊùÇÈ°π-Ëá™Áî®/‰∏¥Êó∂2/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">‰∏¥Êó∂2</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/ÊùÇÈ°π-Ëá™Áî®/‰∏¥Êó∂Â§ç‰π†Áî®Âæà‰π±/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">‰∏¥Êó∂Â§ç‰π†Áî®ÔºàÂæà‰π±Ôºâ</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/interview/ÈÄâÊã©ÂÖ¨Âè∏/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ÈÄâÊã©ÂÖ¨Âè∏</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/interview/Èù¢ËØïÂçöÊñáÈìæÊé•ÈõÜÂêà/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Èù¢ËØïÂçöÊñáÈìæÊé•ÈõÜÂêà</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">WORK</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">AnHeng</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/work/anheng/telegraf/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">telegraf</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/work/anheng/ÊµÅÊ∞¥Á∫ø-Â∑•‰ΩúÊµÅÂºïÊìé/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ÊµÅÊ∞¥Á∫ø Â∑•‰ΩúÊµÅÂºïÊìé</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li> </ul>  <div class="md:sl-hidden"> <div class="mobile-preferences sl-flex astro-wu23bvmt"> <div class="sl-flex social-icons astro-wu23bvmt"> <a href="https://github.com/AGou-ops" rel="me" class="sl-flex astro-wy4te6ga"><span class="sr-only astro-wy4te6ga">GitHub</span><svg aria-hidden="true" class="astro-wy4te6ga astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"/></svg> </a> </div> <starlight-theme-select>  <label style="--sl-select-width: 6.25em" class="astro-4yphtoen"> <span class="sr-only astro-4yphtoen">Select theme</span> <svg aria-hidden="true" class="icon label-icon astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg>  <select value="auto" class="astro-4yphtoen"> <option value="dark" class="astro-4yphtoen">Dark</option><option value="light" class="astro-4yphtoen">Light</option><option value="auto" selected="true" class="astro-4yphtoen">Auto</option> </select> <svg aria-hidden="true" class="icon caret astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </label>  </starlight-theme-select>  <script>
	StarlightThemeProvider.updatePickers();
</script>   </div>  </div> </div> </div> </nav> <div class="main-frame astro-vrdttmbt">  <div class="lg:sl-flex astro-67yu43on"> <aside class="right-sidebar-container astro-67yu43on"> <div class="right-sidebar astro-67yu43on"> <div class="lg:sl-hidden astro-pb3aqygn"><mobile-starlight-toc data-min-h="2" data-max-h="3" class="astro-doynk5tl"><nav aria-labelledby="starlight__on-this-page--mobile" class="astro-doynk5tl"><details id="starlight__mobile-toc" class="astro-doynk5tl"><summary id="starlight__on-this-page--mobile" class="sl-flex astro-doynk5tl"><div class="toggle sl-flex astro-doynk5tl">On this page<svg aria-hidden="true" class="caret astro-doynk5tl astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </div><span class="display-current astro-doynk5tl"></span></summary><div class="dropdown astro-doynk5tl"><ul class="isMobile astro-g2bywc46" style="--depth: 0;"> <li class="astro-g2bywc46" style="--depth: 0;"> <a href="#_top" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Overview</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#1ÁéØÂ¢ÉÂáÜÂ§á" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">1.ÁéØÂ¢ÉÂáÜÂ§á</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#11kubernetesÈ´òÂèØÁî®ÈõÜÁæ§ÈÉ®ÁΩ≤ÊñπÂºè" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">1.1.KubernetesÈ´òÂèØÁî®ÈõÜÁæ§ÈÉ®ÁΩ≤ÊñπÂºè</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#12kubernetesÈõÜÁæ§ÂºÉÁî®dockerÂÆπÂô®" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">1.2.KubernetesÈõÜÁæ§ÂºÉÁî®dockerÂÆπÂô®</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#13kubernetesÈõÜÁæ§ÊâÄÈúÄÁöÑËØÅ‰π¶" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">1.3.KubernetesÈõÜÁæ§ÊâÄÈúÄÁöÑËØÅ‰π¶</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#14ÁéØÂ¢ÉÂáÜÂ§á" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">1.4.ÁéØÂ¢ÉÂáÜÂ§á</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#15ÂÆâË£ÖcfsslËØÅ‰π¶ÁîüÊàêÂ∑•ÂÖ∑" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">1.5.ÂÆâË£ÖcfsslËØÅ‰π¶ÁîüÊàêÂ∑•ÂÖ∑</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#2Êìç‰ΩúÁ≥ªÁªüÂàùÂßãÂåñÈÖçÁΩÆ" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">2.Êìç‰ΩúÁ≥ªÁªüÂàùÂßãÂåñÈÖçÁΩÆ</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#3ÈÉ®ÁΩ≤etcdÈõÜÁæ§" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">3.ÈÉ®ÁΩ≤EtcdÈõÜÁæ§</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#31‰ΩøÁî®cfsslËØÅ‰π¶Â∑•ÂÖ∑ÁîüÊàêetcdËØÅ‰π¶" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">3.1.‰ΩøÁî®cfsslËØÅ‰π¶Â∑•ÂÖ∑ÁîüÊàêetcdËØÅ‰π¶</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#32ÈÉ®ÁΩ≤etcdÈõÜÁæ§" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">3.2.ÈÉ®ÁΩ≤etcdÈõÜÁæ§</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#4ÈÉ®ÁΩ≤dockerÊúçÂä°" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">4.ÈÉ®ÁΩ≤DockerÊúçÂä°</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#41ÂÆâË£Ödocker" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.1.ÂÆâË£Ödocker</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#42‰∏∫dockerÂàõÂª∫systemctlÂêØÂä®ËÑöÊú¨" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.2.‰∏∫dockerÂàõÂª∫systemctlÂêØÂä®ËÑöÊú¨</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#5ÈÉ®ÁΩ≤kubernetes-masterËäÇÁÇπ" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">5.ÈÉ®ÁΩ≤kubernetes masterËäÇÁÇπ</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#51‰ΩøÁî®cfsslÁîüÊàêapiserverÁöÑËØÅ‰π¶Êñá‰ª∂" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">5.1.‰ΩøÁî®cfsslÁîüÊàêapiserverÁöÑËØÅ‰π¶Êñá‰ª∂</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#52Ëß£Âéã‰∫åËøõÂà∂Êñá‰ª∂Â§çÂà∂Áõ∏ÂÖ≥ÁªÑ‰ª∂Á®ãÂ∫è" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">5.2.Ëß£Âéã‰∫åËøõÂà∂Êñá‰ª∂Â§çÂà∂Áõ∏ÂÖ≥ÁªÑ‰ª∂Á®ãÂ∫è</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#53ÈÉ®ÁΩ≤kube-apiserverÁªÑ‰ª∂" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">5.3.ÈÉ®ÁΩ≤kube-apiserverÁªÑ‰ª∂</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#54ÈÉ®ÁΩ≤kube-controller-manageÁªÑ‰ª∂" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">5.4.ÈÉ®ÁΩ≤kube-controller-manageÁªÑ‰ª∂</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#55ÈÉ®ÁΩ≤kube-schedulerÁªÑ‰ª∂" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">5.5.ÈÉ®ÁΩ≤kube-schedulerÁªÑ‰ª∂</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#56ÂáÜÂ§ákubectlÊâÄÈúÄÁöÑkubeconfigÊñá‰ª∂ËøûÊé•ÈõÜÁæ§" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">5.6.ÂáÜÂ§ákubectlÊâÄÈúÄÁöÑkubeconfigÊñá‰ª∂ËøûÊé•ÈõÜÁæ§</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#6Âú®masterËäÇÁÇπÈÉ®ÁΩ≤nodeËäÇÁÇπÁõ∏ÂÖ≥ÁªÑ‰ª∂" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">6.Âú®masterËäÇÁÇπÈÉ®ÁΩ≤nodeËäÇÁÇπÁõ∏ÂÖ≥ÁªÑ‰ª∂</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#61Âú®ÈõÜÁæ§ÊéàÊùÉkubelet-bootstrapÁî®Êà∑ÂÖÅËÆ∏ËØ∑Ê±ÇËØÅ‰π¶" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">6.1.Âú®ÈõÜÁæ§ÊéàÊùÉkubelet-bootstrapÁî®Êà∑ÂÖÅËÆ∏ËØ∑Ê±ÇËØÅ‰π¶</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#62Âú®masterËäÇÁÇπÈÉ®ÁΩ≤kubeletÁªÑ‰ª∂" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">6.2.Âú®masterËäÇÁÇπÈÉ®ÁΩ≤kubeletÁªÑ‰ª∂</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#63Âú®masterËäÇÁÇπÈÉ®ÁΩ≤kube-proxy" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">6.3.Âú®masterËäÇÁÇπÈÉ®ÁΩ≤kube-proxy</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#64ÊéàÊùÉapiserverËÆøÈóÆkubelet" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">6.4.ÊéàÊùÉapiserverËÆøÈóÆkubelet</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#7ÈÉ®ÁΩ≤kubernetes-calicoÁΩëÁªúÁªÑ‰ª∂" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">7.ÈÉ®ÁΩ≤kubernetes calicoÁΩëÁªúÁªÑ‰ª∂</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#8ÈÉ®ÁΩ≤kubernetes-nodeËäÇÁÇπ" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">8.ÈÉ®ÁΩ≤kubernetes nodeËäÇÁÇπ</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#81Ëß£Âéã‰∫åËøõÂà∂Êñá‰ª∂Â§çÂà∂Áõ∏ÂÖ≥ÁªÑ‰ª∂Á®ãÂ∫è" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">8.1.Ëß£Âéã‰∫åËøõÂà∂Êñá‰ª∂Â§çÂà∂Áõ∏ÂÖ≥ÁªÑ‰ª∂Á®ãÂ∫è</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#82ÈÉ®ÁΩ≤kubeletÁªÑ‰ª∂" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">8.2.ÈÉ®ÁΩ≤kubeletÁªÑ‰ª∂</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#83ÈÉ®ÁΩ≤kube-proxyÁªÑ‰ª∂" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">8.3.ÈÉ®ÁΩ≤kube-proxyÁªÑ‰ª∂</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#84Âø´ÈÄüÂ¢ûÂä†Êñ∞ÁöÑnodeËäÇÁÇπ" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">8.4.Âø´ÈÄüÂ¢ûÂä†Êñ∞ÁöÑnodeËäÇÁÇπ</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#9‰∏∫ÈõÜÁæ§ÈÉ®ÁΩ≤corednsÁªÑ‰ª∂" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">9.‰∏∫ÈõÜÁæ§ÈÉ®ÁΩ≤corednsÁªÑ‰ª∂</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#91ÈÉ®ÁΩ≤corednsÁªÑ‰ª∂" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">9.1.ÈÉ®ÁΩ≤corednsÁªÑ‰ª∂</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#92ËøêË°å‰∏Ä‰∏™busyboxÂÆπÂô®ÊµãËØïdns" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">9.2.ËøêË°å‰∏Ä‰∏™busyboxÂÆπÂô®ÊµãËØïdns</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#10Êâ©ÂÆπmasterËäÇÁÇπÁªÑÂª∫kubernetesÈ´òÂèØÁî®ÈõÜÁæ§" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">10.Êâ©ÂÆπmasterËäÇÁÇπÁªÑÂª∫kubernetesÈ´òÂèØÁî®ÈõÜÁæ§</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#101kubernetesÈ´òÂèØÁî®Êû∂ÊûÑÊ¶ÇÂøµ" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">10.1.kubernetesÈ´òÂèØÁî®Êû∂ÊûÑÊ¶ÇÂøµ</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#102Âú®ÈõÜÁæ§‰∏≠Êñ∞Â¢û‰∏Ä‰∏™etcdËäÇÁÇπ" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">10.2.Âú®ÈõÜÁæ§‰∏≠Êñ∞Â¢û‰∏Ä‰∏™etcdËäÇÁÇπ</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#103ÈÉ®ÁΩ≤master-2ËäÇÁÇπ" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">10.3.ÈÉ®ÁΩ≤master-2ËäÇÁÇπ</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#104ÈÉ®ÁΩ≤nginxkeepalivedÂÆûÁé∞kubernetesÈ´òÂèØÁî®ÈõÜÁæ§" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">10.4.ÈÉ®ÁΩ≤Nginx+KeepalivedÂÆûÁé∞kubernetesÈ´òÂèØÁî®ÈõÜÁæ§</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#105ÂàáÊç¢kubernetesÈõÜÁæ§‰∏∫È´òÂèØÁî®Ê®°Âºè" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">10.5.ÂàáÊç¢kubernetesÈõÜÁæ§‰∏∫È´òÂèØÁî®Ê®°Âºè</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#11ÊµãËØïkubernetesÈ´òÂèØÁî®ÈõÜÁæ§" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">11.ÊµãËØïkubernetesÈ´òÂèØÁî®ÈõÜÁæ§</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#12Âú®kubernetesÈõÜÁæ§ËøêË°å‰∏ÄÂ•óÊúçÂä°È™åËØÅÈõÜÁæ§ÁöÑÂèØÁî®ÊÄß" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">12.Âú®kubernetesÈõÜÁæ§ËøêË°å‰∏ÄÂ•óÊúçÂä°È™åËØÅÈõÜÁæ§ÁöÑÂèØÁî®ÊÄß</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#121ÂàõÂª∫ËµÑÊ∫êyamlÊñá‰ª∂" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">12.1.ÂàõÂª∫ËµÑÊ∫êyamlÊñá‰ª∂</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#122ÂàõÂª∫ËµÑÊ∫êÂπ∂ËøõË°åÊµãËØï" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">12.2.ÂàõÂª∫ËµÑÊ∫êÂπ∂ËøõË°åÊµãËØï</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#13ÈÉ®ÁΩ≤kubernetes-dashboard" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">13.ÈÉ®ÁΩ≤kubernetes dashboard</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#131ÈÉ®ÁΩ≤dashboard" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">13.1.ÈÉ®ÁΩ≤dashboard</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#132ËÆøÈóÆdashboard" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">13.2.ËÆøÈóÆdashboard</span> </a>  </li> </ul>  </li> </ul> </div></details></nav></mobile-starlight-toc></div><div class="right-sidebar-panel sl-hidden lg:sl-block astro-pb3aqygn"><div class="sl-container astro-pb3aqygn"><starlight-toc data-min-h="2" data-max-h="3"><nav aria-labelledby="starlight__on-this-page"><h2 id="starlight__on-this-page">On this page</h2><ul class="astro-g2bywc46" style="--depth: 0;"> <li class="astro-g2bywc46" style="--depth: 0;"> <a href="#_top" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Overview</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#1ÁéØÂ¢ÉÂáÜÂ§á" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">1.ÁéØÂ¢ÉÂáÜÂ§á</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#11kubernetesÈ´òÂèØÁî®ÈõÜÁæ§ÈÉ®ÁΩ≤ÊñπÂºè" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">1.1.KubernetesÈ´òÂèØÁî®ÈõÜÁæ§ÈÉ®ÁΩ≤ÊñπÂºè</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#12kubernetesÈõÜÁæ§ÂºÉÁî®dockerÂÆπÂô®" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">1.2.KubernetesÈõÜÁæ§ÂºÉÁî®dockerÂÆπÂô®</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#13kubernetesÈõÜÁæ§ÊâÄÈúÄÁöÑËØÅ‰π¶" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">1.3.KubernetesÈõÜÁæ§ÊâÄÈúÄÁöÑËØÅ‰π¶</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#14ÁéØÂ¢ÉÂáÜÂ§á" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">1.4.ÁéØÂ¢ÉÂáÜÂ§á</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#15ÂÆâË£ÖcfsslËØÅ‰π¶ÁîüÊàêÂ∑•ÂÖ∑" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">1.5.ÂÆâË£ÖcfsslËØÅ‰π¶ÁîüÊàêÂ∑•ÂÖ∑</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#2Êìç‰ΩúÁ≥ªÁªüÂàùÂßãÂåñÈÖçÁΩÆ" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">2.Êìç‰ΩúÁ≥ªÁªüÂàùÂßãÂåñÈÖçÁΩÆ</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#3ÈÉ®ÁΩ≤etcdÈõÜÁæ§" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">3.ÈÉ®ÁΩ≤EtcdÈõÜÁæ§</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#31‰ΩøÁî®cfsslËØÅ‰π¶Â∑•ÂÖ∑ÁîüÊàêetcdËØÅ‰π¶" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">3.1.‰ΩøÁî®cfsslËØÅ‰π¶Â∑•ÂÖ∑ÁîüÊàêetcdËØÅ‰π¶</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#32ÈÉ®ÁΩ≤etcdÈõÜÁæ§" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">3.2.ÈÉ®ÁΩ≤etcdÈõÜÁæ§</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#4ÈÉ®ÁΩ≤dockerÊúçÂä°" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">4.ÈÉ®ÁΩ≤DockerÊúçÂä°</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#41ÂÆâË£Ödocker" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.1.ÂÆâË£Ödocker</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#42‰∏∫dockerÂàõÂª∫systemctlÂêØÂä®ËÑöÊú¨" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4.2.‰∏∫dockerÂàõÂª∫systemctlÂêØÂä®ËÑöÊú¨</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#5ÈÉ®ÁΩ≤kubernetes-masterËäÇÁÇπ" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">5.ÈÉ®ÁΩ≤kubernetes masterËäÇÁÇπ</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#51‰ΩøÁî®cfsslÁîüÊàêapiserverÁöÑËØÅ‰π¶Êñá‰ª∂" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">5.1.‰ΩøÁî®cfsslÁîüÊàêapiserverÁöÑËØÅ‰π¶Êñá‰ª∂</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#52Ëß£Âéã‰∫åËøõÂà∂Êñá‰ª∂Â§çÂà∂Áõ∏ÂÖ≥ÁªÑ‰ª∂Á®ãÂ∫è" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">5.2.Ëß£Âéã‰∫åËøõÂà∂Êñá‰ª∂Â§çÂà∂Áõ∏ÂÖ≥ÁªÑ‰ª∂Á®ãÂ∫è</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#53ÈÉ®ÁΩ≤kube-apiserverÁªÑ‰ª∂" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">5.3.ÈÉ®ÁΩ≤kube-apiserverÁªÑ‰ª∂</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#54ÈÉ®ÁΩ≤kube-controller-manageÁªÑ‰ª∂" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">5.4.ÈÉ®ÁΩ≤kube-controller-manageÁªÑ‰ª∂</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#55ÈÉ®ÁΩ≤kube-schedulerÁªÑ‰ª∂" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">5.5.ÈÉ®ÁΩ≤kube-schedulerÁªÑ‰ª∂</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#56ÂáÜÂ§ákubectlÊâÄÈúÄÁöÑkubeconfigÊñá‰ª∂ËøûÊé•ÈõÜÁæ§" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">5.6.ÂáÜÂ§ákubectlÊâÄÈúÄÁöÑkubeconfigÊñá‰ª∂ËøûÊé•ÈõÜÁæ§</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#6Âú®masterËäÇÁÇπÈÉ®ÁΩ≤nodeËäÇÁÇπÁõ∏ÂÖ≥ÁªÑ‰ª∂" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">6.Âú®masterËäÇÁÇπÈÉ®ÁΩ≤nodeËäÇÁÇπÁõ∏ÂÖ≥ÁªÑ‰ª∂</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#61Âú®ÈõÜÁæ§ÊéàÊùÉkubelet-bootstrapÁî®Êà∑ÂÖÅËÆ∏ËØ∑Ê±ÇËØÅ‰π¶" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">6.1.Âú®ÈõÜÁæ§ÊéàÊùÉkubelet-bootstrapÁî®Êà∑ÂÖÅËÆ∏ËØ∑Ê±ÇËØÅ‰π¶</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#62Âú®masterËäÇÁÇπÈÉ®ÁΩ≤kubeletÁªÑ‰ª∂" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">6.2.Âú®masterËäÇÁÇπÈÉ®ÁΩ≤kubeletÁªÑ‰ª∂</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#63Âú®masterËäÇÁÇπÈÉ®ÁΩ≤kube-proxy" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">6.3.Âú®masterËäÇÁÇπÈÉ®ÁΩ≤kube-proxy</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#64ÊéàÊùÉapiserverËÆøÈóÆkubelet" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">6.4.ÊéàÊùÉapiserverËÆøÈóÆkubelet</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#7ÈÉ®ÁΩ≤kubernetes-calicoÁΩëÁªúÁªÑ‰ª∂" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">7.ÈÉ®ÁΩ≤kubernetes calicoÁΩëÁªúÁªÑ‰ª∂</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#8ÈÉ®ÁΩ≤kubernetes-nodeËäÇÁÇπ" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">8.ÈÉ®ÁΩ≤kubernetes nodeËäÇÁÇπ</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#81Ëß£Âéã‰∫åËøõÂà∂Êñá‰ª∂Â§çÂà∂Áõ∏ÂÖ≥ÁªÑ‰ª∂Á®ãÂ∫è" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">8.1.Ëß£Âéã‰∫åËøõÂà∂Êñá‰ª∂Â§çÂà∂Áõ∏ÂÖ≥ÁªÑ‰ª∂Á®ãÂ∫è</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#82ÈÉ®ÁΩ≤kubeletÁªÑ‰ª∂" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">8.2.ÈÉ®ÁΩ≤kubeletÁªÑ‰ª∂</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#83ÈÉ®ÁΩ≤kube-proxyÁªÑ‰ª∂" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">8.3.ÈÉ®ÁΩ≤kube-proxyÁªÑ‰ª∂</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#84Âø´ÈÄüÂ¢ûÂä†Êñ∞ÁöÑnodeËäÇÁÇπ" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">8.4.Âø´ÈÄüÂ¢ûÂä†Êñ∞ÁöÑnodeËäÇÁÇπ</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#9‰∏∫ÈõÜÁæ§ÈÉ®ÁΩ≤corednsÁªÑ‰ª∂" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">9.‰∏∫ÈõÜÁæ§ÈÉ®ÁΩ≤corednsÁªÑ‰ª∂</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#91ÈÉ®ÁΩ≤corednsÁªÑ‰ª∂" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">9.1.ÈÉ®ÁΩ≤corednsÁªÑ‰ª∂</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#92ËøêË°å‰∏Ä‰∏™busyboxÂÆπÂô®ÊµãËØïdns" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">9.2.ËøêË°å‰∏Ä‰∏™busyboxÂÆπÂô®ÊµãËØïdns</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#10Êâ©ÂÆπmasterËäÇÁÇπÁªÑÂª∫kubernetesÈ´òÂèØÁî®ÈõÜÁæ§" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">10.Êâ©ÂÆπmasterËäÇÁÇπÁªÑÂª∫kubernetesÈ´òÂèØÁî®ÈõÜÁæ§</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#101kubernetesÈ´òÂèØÁî®Êû∂ÊûÑÊ¶ÇÂøµ" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">10.1.kubernetesÈ´òÂèØÁî®Êû∂ÊûÑÊ¶ÇÂøµ</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#102Âú®ÈõÜÁæ§‰∏≠Êñ∞Â¢û‰∏Ä‰∏™etcdËäÇÁÇπ" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">10.2.Âú®ÈõÜÁæ§‰∏≠Êñ∞Â¢û‰∏Ä‰∏™etcdËäÇÁÇπ</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#103ÈÉ®ÁΩ≤master-2ËäÇÁÇπ" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">10.3.ÈÉ®ÁΩ≤master-2ËäÇÁÇπ</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#104ÈÉ®ÁΩ≤nginxkeepalivedÂÆûÁé∞kubernetesÈ´òÂèØÁî®ÈõÜÁæ§" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">10.4.ÈÉ®ÁΩ≤Nginx+KeepalivedÂÆûÁé∞kubernetesÈ´òÂèØÁî®ÈõÜÁæ§</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#105ÂàáÊç¢kubernetesÈõÜÁæ§‰∏∫È´òÂèØÁî®Ê®°Âºè" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">10.5.ÂàáÊç¢kubernetesÈõÜÁæ§‰∏∫È´òÂèØÁî®Ê®°Âºè</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#11ÊµãËØïkubernetesÈ´òÂèØÁî®ÈõÜÁæ§" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">11.ÊµãËØïkubernetesÈ´òÂèØÁî®ÈõÜÁæ§</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#12Âú®kubernetesÈõÜÁæ§ËøêË°å‰∏ÄÂ•óÊúçÂä°È™åËØÅÈõÜÁæ§ÁöÑÂèØÁî®ÊÄß" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">12.Âú®kubernetesÈõÜÁæ§ËøêË°å‰∏ÄÂ•óÊúçÂä°È™åËØÅÈõÜÁæ§ÁöÑÂèØÁî®ÊÄß</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#121ÂàõÂª∫ËµÑÊ∫êyamlÊñá‰ª∂" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">12.1.ÂàõÂª∫ËµÑÊ∫êyamlÊñá‰ª∂</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#122ÂàõÂª∫ËµÑÊ∫êÂπ∂ËøõË°åÊµãËØï" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">12.2.ÂàõÂª∫ËµÑÊ∫êÂπ∂ËøõË°åÊµãËØï</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#13ÈÉ®ÁΩ≤kubernetes-dashboard" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">13.ÈÉ®ÁΩ≤kubernetes dashboard</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#131ÈÉ®ÁΩ≤dashboard" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">13.1.ÈÉ®ÁΩ≤dashboard</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#132ËÆøÈóÆdashboard" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">13.2.ËÆøÈóÆdashboard</span> </a>  </li> </ul>  </li> </ul> </nav></starlight-toc></div></div> </div> </aside> <div class="main-pane astro-67yu43on">  <main data-pagefind-body lang="en" dir="ltr" class="astro-bguv2lll">    <div class="content-panel astro-7nkwcw3z"> <div class="sl-container astro-7nkwcw3z"> <h1 id="_top" class="astro-j6tvhyss">Kubernetes ‰∫åËøõÂà∂ÂÆâË£Ö</h1>  </div> </div>  <div class="content-panel astro-7nkwcw3z"> <div class="sl-container astro-7nkwcw3z"> <div class="sl-markdown-content"> <p>[[toc]]</p>
<h2 id="1ÁéØÂ¢ÉÂáÜÂ§á">1.ÁéØÂ¢ÉÂáÜÂ§á</h2>
<h3 id="11kubernetesÈ´òÂèØÁî®ÈõÜÁæ§ÈÉ®ÁΩ≤ÊñπÂºè">1.1.KubernetesÈ´òÂèØÁî®ÈõÜÁæ§ÈÉ®ÁΩ≤ÊñπÂºè</h3>
<blockquote>
<p>ÁõÆÂâçÁîü‰∫ßÁéØÂ¢ÉÈÉ®ÁΩ≤KubernetesÂª∫‰∏ªË¶ÅÊúâ‰∏§ÁßçÊñπÂºèÔºö</p>
<p>kubeadmÔºöÊèê‰æõkubeadm initÂíåkubeadm joinÔºåÁî®‰∫éÂø´ÈÄüÈÉ®ÁΩ≤KubernetesÈõÜÁæ§ÔºåkubeadmÂÆâË£ÖÁöÑk8sÈõÜÁæ§ÔºåÊâÄÊúâÁöÑk8sÁªÑ‰ª∂ÈÉΩÊòØ‰ª•podÂΩ¢ÂºèËøêË°å„ÄÇ</p>
<p>‰∫åËøõÂà∂ÂåÖÔºö‰ªégithub‰∏ä‰∏ãËΩΩÂèëË°åÁâàÁöÑ‰∫åËøõÂà∂ÂåÖÔºåÊâãÂä®ÈÉ®ÁΩ≤ÊØè‰∏™ÁªÑ‰ª∂ÔºåÁªÑÊàêkubernetesÈõÜÁæ§„ÄÇ</p>
<p>KubeadmÈôç‰ΩéÈÉ®ÁΩ≤ÊàêÊú¨Ôºå‰ªéËÄåÂ±èËîΩ‰∫ÜÂæàÂ§öÁªÜËäÇÔºåÈÅáÂà∞ÈóÆÈ¢òÂæàÈöæÊéíÊü•ÔºåÂ¶ÇÊûúÊÉ≥Êõ¥ÂÆπÊòìÂèØÊéßÔºåÊé®Ëçê‰ΩøÁî®‰∫åËøõÂà∂ÂåÖÈÉ®ÁΩ≤KubernetesÈõÜÁæ§ÔºåËôΩÁÑ∂ÊâãÂä®ÈÉ®ÁΩ≤È∫ªÁÉ¶ÁÇπÔºåÊúüÈó¥ÂèØ‰ª•Â≠¶‰π†ÂæàÂ§öÂ∑•‰ΩúÂéüÁêÜÔºå‰πüÂà©‰∫éÂêéÊúüÁª¥Êä§„ÄÇ</p>
</blockquote>
<h3 id="12kubernetesÈõÜÁæ§ÂºÉÁî®dockerÂÆπÂô®">1.2.KubernetesÈõÜÁæ§ÂºÉÁî®dockerÂÆπÂô®</h3>
<blockquote>
<p>Âú®k8sÂπ≥Âè∞‰∏≠Ôºå‰∏∫‰∫ÜËß£ÂÜ≥‰∏éÂÆπÂô®ËøêË°åÊó∂ÔºåÊØîÂ¶ÇdockerÁöÑÈõÜÊàêÈóÆÈ¢òÔºåÂú®Êó©ÊúüÁ§æÂå∫Êé®Âá∫CRIÊé•Âè£Ôºå‰ª•ÊîØÊåÅÊõ¥Â§öÁöÑÂÆπÂô®ÔºåÂΩìÊàë‰ª¨‰ΩøÁî®Docker‰Ωú‰∏∫ÂÆπÂô®ËøêË°åÊó∂ÔºåÈ¶ñÂÖàkubeletË∞ÉÁî®dockershimÁöÑCRIÂÆπÂô®Êé•Âè£ËøûÊé•dockerËøõÁ®ãÔºåÊúÄÂêéÁî±dockerÂêØÂä®ÂÆπÂô®„ÄÇ</p>
<p>Âú®k8s1.23ÁâàÊú¨‰∏≠Ôºåk8sËÆ°ÂàíÂºÉÁî®kubelet‰∏≠ÁöÑdockershimÊé•Âè£ÔºådockershimÊé•Âè£‰∏ÄÊó¶ÂºÉÁî®ÔºåkubeletÂéªË∞ÉÁî®CRLÊó∂Â∞±Ê≤°ÊúâÂèØ‰ª•‰∏édockerÂª∫Á´ãËøûÊé•ÁöÑ‰∏Ä‰∏™Êé•Âè£Ôºå‰ªéËÄåÂØºËá¥k8sÂºÉÁî®dockerÂÆπÂô®„ÄÇ</p>
</blockquote>
<h3 id="13kubernetesÈõÜÁæ§ÊâÄÈúÄÁöÑËØÅ‰π¶">1.3.KubernetesÈõÜÁæ§ÊâÄÈúÄÁöÑËØÅ‰π¶</h3>
<blockquote>
<p>k8sÊâÄÊúâÁªÑ‰ª∂ÂùáÈááÁî®httpsÂä†ÂØÜÈÄö‰ø°ÔºåËøô‰∫õÁªÑ‰ª∂‰∏ÄËà¨Áî±‰∏§Â•óÊ†πËØÅ‰π¶ÁîüÊàêÔºö‰∏Ä‰∏™Áî®‰∫ék8s apiserver‰∏Ä‰∏™Áî®‰∫éetcdÊï∞ÊçÆÂ∫ì„ÄÇ</p>
<p>ÊåâÁÖßËßíËâ≤Êù•ÂàÜÔºåËØÅ‰π¶ÂàÜ‰∏∫ÁÆ°ÁêÜËäÇÁÇπÂíåÂ∑•‰ΩúËäÇÁÇπ„ÄÇ</p>
<ul>
<li>ÁÆ°ÁêÜËäÇÁÇπÔºöÊåácontroller-managerÂíåschedulerËøûÊé•apiserverÊâÄÈúÄÁöÑÂÆ¢Êà∑Á´ØËØÅ‰π¶„ÄÇ</li>
<li>Â∑•‰ΩúËäÇÁÇπÔºöÊåákubeletÂíåkube-proxyËøûÊé•apiserverÊâÄÈúÄË¶ÅÁöÑÂÆ¢Êà∑Á´ØËØÅ‰π¶ÔºåËÄå‰∏ÄËà¨ÈÉΩ‰ºöÂêØÁî®Bootstrap TLSÊú∫Âà∂ÔºåÊâÄ‰ª•kubeletÁöÑËØÅ‰π¶ÂàùÊ¨°ÂêØÂä®‰ºöÂêëapiserverÁî≥ËØ∑È¢ÅÂèëËØÅ‰π¶ÔºåÁî±controller-managerÁªÑ‰ª∂Ëá™Âä®È¢ÅÂèë„ÄÇ</li>
<li>Âõæ‰∏≠Á∫¢Á∫øÊòØk8sÂêÑ‰∏™ÁªÑ‰ª∂ÈÄöËøáÊê∫Â∏¶k8sËá™Âª∫ËØÅ‰π¶È¢ÅÂèëÊú∫ÊûÑÁîüÊàêÁöÑÂÆ¢Êà∑Á´ØËØÅ‰π¶ËÆøÈóÆapiserverÔºåÂõæ‰∏≠ËìùÁ∫øÊòØk8sapiserverÁªÑ‰ª∂ÈÄöËøáetcdÈ¢ÅÂèëÁöÑÂÆ¢Êà∑Á´ØËØÅ‰π¶‰∏éetcdÂª∫Á´ãËøûÊé•„ÄÇ</li>
</ul>
<p><img src="https://cdn.agou-ops.cn/others/3b600f8680a443168cb556a183c19b3f.png" alt="ËØ∑Ê∑ªÂä†ÂõæÁâáÊèèËø∞"></p>
</blockquote>
<h3 id="14ÁéØÂ¢ÉÂáÜÂ§á">1.4.ÁéØÂ¢ÉÂáÜÂ§á</h3>



































<table><thead><tr><th>ËßíËâ≤</th><th>IP</th><th>ÁªÑ‰ª∂</th></tr></thead><tbody><tr><td>binary-k8s-master1</td><td>192.168.20.10</td><td>kube-apiserver„ÄÅkube-controller-manage„ÄÅkube-scheduler„ÄÅkubelet„ÄÅkube-proxy„ÄÅdocker„ÄÅetcd„ÄÅnginx„ÄÅkeepalived</td></tr><tr><td>binary-k8s-master2</td><td>192.168.20.11</td><td>kube-apiserver„ÄÅkube-controller-manage„ÄÅkube-scheduler„ÄÅkubelet„ÄÅkube-proxy„ÄÅdocker„ÄÅnginx„ÄÅkeepalived„ÄÅetcdÔºàÊâ©ÂÆπËäÇÁÇπÔºâ</td></tr><tr><td>binary-k8s-node1</td><td>192.168.20.12</td><td>kubelet„ÄÅkube-proxy„ÄÅdocker„ÄÅetcd</td></tr><tr><td>binary-k8s-node2</td><td>192.168.20.13</td><td>kubelet„ÄÅkube-proxy„ÄÅdocker„ÄÅetcd</td></tr><tr><td>Ë¥üËΩΩÂùáË°°Âô®IP</td><td>192.168.20.9</td><td>Ôºà‰ΩúÁî®‰∫ékube-apiserverÁöÑÂú∞ÂùÄÔºâ</td></tr></tbody></table>
<p>È¶ñÂÖàÈÉ®ÁΩ≤‰∏ÄÂ•óÂçïmasterËäÇÁÇπÁöÑkubernetesÈõÜÁæ§ÔºåÁÑ∂ÂêéÂú®Â¢ûÂä†‰∏ÄÂè∞masterËäÇÁÇπÔºåÂΩ¢ÊàêÈ´òÂèØÁî®ÈõÜÁæ§„ÄÇ</p>
<p>ÂçïmasterËäÇÁÇπÁöÑkubernetesÈõÜÁæ§ÊúçÂä°Âô®ËßÑÂàí„ÄÇ</p>

























<table><thead><tr><th>ËßíËâ≤</th><th>IP</th><th>ÁªÑ‰ª∂</th></tr></thead><tbody><tr><td>binary-k8s-master1</td><td>192.168.20.10</td><td>kube-apiserver„ÄÅkube-controller-manage„ÄÅkube-schedule„ÄÅetcd</td></tr><tr><td>binary-k8s-node1</td><td>192.168.20.12</td><td>kubelet„ÄÅkube-proxy„ÄÅdocker„ÄÅetcd</td></tr><tr><td>binary-k8s-node2</td><td>192.168.20.13</td><td>kubelet„ÄÅkube-proxy„ÄÅdocker„ÄÅetcd</td></tr></tbody></table>
<p><img src="https://cdn.agou-ops.cn/others/ea0354a4d3cc4b6397ee9397f42e35dc.png" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞"></p>
<h3 id="15ÂÆâË£ÖcfsslËØÅ‰π¶ÁîüÊàêÂ∑•ÂÖ∑">1.5.ÂÆâË£ÖcfsslËØÅ‰π¶ÁîüÊàêÂ∑•ÂÖ∑</h3>
<p>cfsslÊòØ‰∏Ä‰∏™ÂºÄÊ∫êÁöÑËØÅ‰π¶ÁÆ°ÁêÜÂ∑•ÂÖ∑Ôºå‰ΩøÁî®jsonÊñá‰ª∂ÁîüÊàêËØÅ‰π¶ÔºåÁõ∏ÊØîopensslÊõ¥Êñπ‰æø‰ΩøÁî®„ÄÇ</p>
<div class="expressive-code"><link rel="stylesheet" href="/_astro/ec.pjkke.css"><script type="module" src="/_astro/ec.sgewm.js"></script><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> wget https://pkg.cfssl.org/R1.2/cfssl_linux-amd64</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> wget https://pkg.cfssl.org/R1.2/cfssljson_linux-amd64</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> wget https://pkg.cfssl.org/R1.2/cfssl-certinfo_linux-amd64</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> chmod +x cfssl_linux-amd64 cfssljson_linux-amd64 cfssl-certinfo_linux-amd64</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> mv cfssl_linux-amd64 /usr/local/bin/cfssl</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> mv cfssljson_linux-amd64 /usr/local/bin/cfssljson</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> mv cfssl-certinfo_linux-amd64 /usr/bin/cfssl-certinfo</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 ~]\# wget https://pkg.cfssl.org/R1.2/cfssl_linux-amd64[root@binary-k8s-master1 ~]\# wget https://pkg.cfssl.org/R1.2/cfssljson_linux-amd64[root@binary-k8s-master1 ~]\# wget https://pkg.cfssl.org/R1.2/cfssl-certinfo_linux-amd64[root@binary-k8s-master1 ~]\# chmod +x cfssl_linux-amd64 cfssljson_linux-amd64 cfssl-certinfo_linux-amd64[root@binary-k8s-master1 ~]\# mv cfssl_linux-amd64 /usr/local/bin/cfssl[root@binary-k8s-master1 ~]\# mv cfssljson_linux-amd64 /usr/local/bin/cfssljson[root@binary-k8s-master1 ~]\# mv cfssl-certinfo_linux-amd64 /usr/bin/cfssl-certinfo"><div></div></button></div></figure></div>
<h2 id="2Êìç‰ΩúÁ≥ªÁªüÂàùÂßãÂåñÈÖçÁΩÆ">2.Êìç‰ΩúÁ≥ªÁªüÂàùÂßãÂåñÈÖçÁΩÆ</h2>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.ÂÖ≥Èó≠Èò≤ÁÅ´Â¢ô</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">systemctl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">stop</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">firewalld</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">systemctl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">disable</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">firewalld</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.ÂÖ≥Èó≠selinux</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">sed</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-i</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">s/enforcing/disabled/</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/selinux/config</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">setenforce</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">0</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.ÂÖ≥Èó≠‰∫§Êç¢ÂàÜÂå∫</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">swapoff</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-a</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">sed</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-ri</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">s/.*swap.*/#&#x26;/</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/fstab</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">4.ÈÖçÁΩÆhosts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">cat</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">>></span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/hosts</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">&#x3C;&#x3C;</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">EOF</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">192.168.20.10 binary-k8s-master1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">192.168.20.12 binary-k8s-node1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">192.168.20.13 binary-k8s-node2</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D9F5DD;--1:#111111">EOF</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">5.‰ºòÂåñÂÜÖÊ†∏ÂèÇÊï∞</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">cat</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">></span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/sysctl.d/k8s.conf</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">&#x3C;&#x3C;</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">EOF</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">net.bridge.bridge-nf-call-ip6tables = 1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#3C63B3">net.bridge.bridge-nf-call-iptables = 1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D9F5DD;--1:#111111">EOF</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">sysctl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--system</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.ÂÖ≥Èó≠Èò≤ÁÅ´Â¢ôsystemctl stop firewalldsystemctl disable firewalld2.ÂÖ≥Èó≠selinuxsed -i &#x27;s/enforcing/disabled/&#x27; /etc/selinux/configsetenforce 03.ÂÖ≥Èó≠‰∫§Êç¢ÂàÜÂå∫swapoff -ased -ri &#x27;s/.*swap.*/#&#x26;/&#x27; /etc/fstab4.ÈÖçÁΩÆhostscat >> /etc/hosts << EOF192.168.20.10 binary-k8s-master1192.168.20.12 binary-k8s-node1192.168.20.13 binary-k8s-node2EOF5.‰ºòÂåñÂÜÖÊ†∏ÂèÇÊï∞cat > /etc/sysctl.d/k8s.conf << EOFnet.bridge.bridge-nf-call-ip6tables = 1net.bridge.bridge-nf-call-iptables = 1EOFsysctl --system"><div></div></button></div></figure></div>
<h2 id="3ÈÉ®ÁΩ≤etcdÈõÜÁæ§">3.ÈÉ®ÁΩ≤EtcdÈõÜÁæ§</h2>
<p>etcdÊòØ‰∏Ä‰∏™ÂàÜÂ∏ÉÂºèÈîÆÂÄºÂ≠òÂÇ®Á≥ªÁªüÔºåkubernetes‰ΩøÁî®etcdËøõË°åÊï∞ÊçÆÂ≠òÂÇ®Ôºå‰∏∫Ëß£ÂÜ≥etcdÂçïÁÇπÊïÖÈöúÔºåÈááÁî®ÈõÜÁæ§ÊñπÂºèÈÉ®ÁΩ≤Ôºå3Âè∞ÁªÑÁªÑÂª∫ÈõÜÁæ§ÔºåÂèØ‰ª•Âùè1Âè∞ÔºåÂ¶ÇÊûúÊúâ5Âè∞ÂèØ‰ª•Âùè2Âè∞„ÄÇ</p>





















<table><thead><tr><th>ËäÇÁÇπÂêçÁß∞</th><th>IP</th></tr></thead><tbody><tr><td>etcd-1</td><td>192.168.20.10</td></tr><tr><td>etcd-2</td><td>192.168.20.12</td></tr><tr><td>etcd-3</td><td>192.168.20.13</td></tr></tbody></table>
<h3 id="31‰ΩøÁî®cfsslËØÅ‰π¶Â∑•ÂÖ∑ÁîüÊàêetcdËØÅ‰π¶">3.1.‰ΩøÁî®cfsslËØÅ‰π¶Â∑•ÂÖ∑ÁîüÊàêetcdËØÅ‰π¶</h3>
<p><strong>1.ÁîüÊàêCAËá™Á≠æÈ¢ÅÂèëÊú∫ÊûÑËØÅ‰π¶</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/TLS/etcd]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim ca-config.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"signing"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"default"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"expiry"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">87600h</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">},</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"profiles"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"www"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">         </span><span style="--0:#82AAFF;--1:#3C63B3">"expiry"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">87600h</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">         </span><span style="--0:#82AAFF;--1:#3C63B3">"usages"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"signing"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"key encipherment"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"server auth"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"client auth"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">]</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/TLS/etcd]</span><span style="--0:#82AAFF;--1:#3C63B3">\#</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"CN"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">etcd CA</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"key"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"algo"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">rsa</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"size"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">2048</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">},</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"names"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"C"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">CN</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"L"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Beijing</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"ST"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Beijing</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/TLS/etcd]</span><span style="--0:#82AAFF;--1:#3C63B3">\#</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">cfssl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">gencert</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-initca</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca-csr.json</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">cfssljson</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-bare</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">-</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/08/27</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">:16:49</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] generating a new CA key and certificate from CSR</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/08/27</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">:16:49</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] generate received request</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/08/27</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">:16:49</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] received CSR</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/08/27</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">:16:49</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] generating key: rsa-2048</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/08/27</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">:16:49</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] encoded CSR</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/08/27</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">:16:49</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] signed certificate with serial number 595276170535764345591605360849177409156623041535</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 ~/TLS/etcd]\# vim ca-config.json{  &#x22;signing&#x22;: {    &#x22;default&#x22;: {      &#x22;expiry&#x22;: &#x22;87600h&#x22;    },    &#x22;profiles&#x22;: {      &#x22;www&#x22;: {         &#x22;expiry&#x22;: &#x22;87600h&#x22;,         &#x22;usages&#x22;: [            &#x22;signing&#x22;,            &#x22;key encipherment&#x22;,            &#x22;server auth&#x22;,            &#x22;client auth&#x22;        ]      }    }  }}[root@binary-k8s-master1 ~/TLS/etcd]\# vim ca-csr.json{    &#x22;CN&#x22;: &#x22;etcd CA&#x22;,    &#x22;key&#x22;: {        &#x22;algo&#x22;: &#x22;rsa&#x22;,        &#x22;size&#x22;: 2048    },    &#x22;names&#x22;: [        {            &#x22;C&#x22;: &#x22;CN&#x22;,            &#x22;L&#x22;: &#x22;Beijing&#x22;,            &#x22;ST&#x22;: &#x22;Beijing&#x22;        }    ]}[root@binary-k8s-master1 ~/TLS/etcd]\# cfssl gencert -initca ca-csr.json | cfssljson -bare ca -2021/08/27 17:16:49 [INFO] generating a new CA key and certificate from CSR2021/08/27 17:16:49 [INFO] generate received request2021/08/27 17:16:49 [INFO] received CSR2021/08/27 17:16:49 [INFO] generating key: rsa-20482021/08/27 17:16:49 [INFO] encoded CSR2021/08/27 17:16:49 [INFO] signed certificate with serial number 595276170535764345591605360849177409156623041535"><div></div></button></div></figure></div>
<p><strong>2.‰ΩøÁî®Ëá™Á≠æCAÁ≠æÂèëEtcd HTTPSËØÅ‰π¶</strong></p>
<p>Áî≥ËØ∑ËØÅ‰π¶ÁöÑjsonÊñá‰ª∂‰∏≠Êúâ‰∏Ä‰∏™hostsÂ≠óÊÆµÔºåËøô‰∏™Â≠óÊÆµÁöÑÂÄºÂ∞±ÊòØetcdÈõÜÁæ§ÁöÑIPÂú∞ÂùÄÔºåÂèØ‰ª•Â§öÂÜôÂá†‰∏™IPÔºå‰Ωú‰∏∫È¢ÑÁïôIPÔºåÊñπ‰æøÊâ©ÂÆπetcdÈõÜÁæ§„ÄÇ</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.ÂàõÂª∫ËØÅ‰π¶Áî≥ËØ∑Êñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/TLS/etcd]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim server-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"CN"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">etcd</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"hosts"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"192.168.20.10"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"192.168.20.11"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#809191;--1:#616671">#È¢ÑÁïôip</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"192.168.20.12"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"192.168.20.13"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">],</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"key"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"algo"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">rsa</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"size"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">2048</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">},</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"names"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"C"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">CN</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"L"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">BeiJing</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"ST"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">BeiJing</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.ÁîüÊàêËØÅ‰π¶</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/TLS/etcd]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=www server-csr.json </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">cfssljson</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-bare</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">server</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/08/27</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">:17:08</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] generate received request</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/08/27</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">:17:08</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] received CSR</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/08/27</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">:17:08</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] generating key: rsa-2048</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/08/27</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">:17:08</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] encoded CSR</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/08/27</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">:17:08</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] signed certificate with serial number 390637014214409356442509482537912246480465374076</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/08/27</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">:17:08</span><span style="--0:#D6DEEB;--1:#403F53"> [WARNING] This certificate lacks a </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">hosts</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> field. This makes it unsuitable </span><span style="--0:#C792EA;--1:#8D46B4">for</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">websites.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">For</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">more</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">information</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">see</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">the</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Baseline</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Requirements</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">for</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">the</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Issuance</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">and</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Management</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">of</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Publicly-Trusted</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Certificates,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">v.1.1.6,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">the</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">CA/Browser</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Forum</span><span style="--0:#D6DEEB;--1:#403F53"> (https://cabforum.org);</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">specifically,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">section</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10.2</span><span style="--0:#ECC48D;--1:#3C63B3">.3</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Information Requirements</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">).</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.ÂàõÂª∫ËØÅ‰π¶Áî≥ËØ∑Êñá‰ª∂[root@binary-k8s-master1 ~/TLS/etcd]\# vim server-csr.json{    &#x22;CN&#x22;: &#x22;etcd&#x22;,    &#x22;hosts&#x22;: [    &#x22;192.168.20.10&#x22;,    &#x22;192.168.20.11&#x22;,      #È¢ÑÁïôip    &#x22;192.168.20.12&#x22;,    &#x22;192.168.20.13&#x22;    ],    &#x22;key&#x22;: {        &#x22;algo&#x22;: &#x22;rsa&#x22;,        &#x22;size&#x22;: 2048    },    &#x22;names&#x22;: [        {            &#x22;C&#x22;: &#x22;CN&#x22;,            &#x22;L&#x22;: &#x22;BeiJing&#x22;,            &#x22;ST&#x22;: &#x22;BeiJing&#x22;        }    ]}2.ÁîüÊàêËØÅ‰π¶[root@binary-k8s-master1 ~/TLS/etcd]\# cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=www server-csr.json | cfssljson -bare server2021/08/27 17:17:08 [INFO] generate received request2021/08/27 17:17:08 [INFO] received CSR2021/08/27 17:17:08 [INFO] generating key: rsa-20482021/08/27 17:17:08 [INFO] encoded CSR2021/08/27 17:17:08 [INFO] signed certificate with serial number 3906370142144093564425094825379122464804653740762021/08/27 17:17:08 [WARNING] This certificate lacks a &#x22;hosts&#x22; field. This makes it unsuitable forwebsites. For more information see the Baseline Requirements for the Issuance and Managementof Publicly-Trusted Certificates, v.1.1.6, from the CA/Browser Forum (https://cabforum.org);specifically, section 10.2.3 (&#x22;Information Requirements&#x22;)."><div></div></button></div></figure></div>
<p><strong>3.Êü•ÁúãÁîü‰∫ßÁöÑËØÅ‰π¶Êñá‰ª∂</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/TLS/etcd]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> ll</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">ÊÄªÁî®Èáè</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">36</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">288</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">8</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">27</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">:16</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca-config.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">956</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">8</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">27</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">:16</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca.csr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">210</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">8</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">27</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">:16</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-------.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1675</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">8</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">27</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">:16</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca-key.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1265</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">8</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">27</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">:16</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1021</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">8</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">27</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">:17</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">server.csr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">311</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">8</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">27</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">:17</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">server-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-------.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1679</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">8</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">27</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">:17</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">server-key.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1346</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">8</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">27</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">:17</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">server.pem</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 ~/TLS/etcd]\# llÊÄªÁî®Èáè 36-rw-r--r--. 1 root root  288 8Êúà  27 17:16 ca-config.json-rw-r--r--. 1 root root  956 8Êúà  27 17:16 ca.csr-rw-r--r--. 1 root root  210 8Êúà  27 17:16 ca-csr.json-rw-------. 1 root root 1675 8Êúà  27 17:16 ca-key.pem-rw-r--r--. 1 root root 1265 8Êúà  27 17:16 ca.pem-rw-r--r--. 1 root root 1021 8Êúà  27 17:17 server.csr-rw-r--r--. 1 root root  311 8Êúà  27 17:17 server-csr.json-rw-------. 1 root root 1679 8Êúà  27 17:17 server-key.pem-rw-r--r--. 1 root root 1346 8Êúà  27 17:17 server.pem"><div></div></button></div></figure></div>
<h3 id="32ÈÉ®ÁΩ≤etcdÈõÜÁæ§">3.2.ÈÉ®ÁΩ≤etcdÈõÜÁæ§</h3>
<p><strong>1.‰∏ãËΩΩetcd‰∫åËøõÂà∂Êñá‰ª∂</strong></p>
<p>‰∏ãËΩΩÂú∞ÂùÄÔºö<a href="https://github.com/etcd-io/etcd/releases/download/v3.4.9/etcd-v3.4.9-linux-amd64.tar.gz">https://github.com/etcd-io/etcd/releases/download/v3.4.9/etcd-v3.4.9-linux-amd64.tar.gz</a></p>
<p>ÈÉ®ÁΩ≤‰∫åËøõÂà∂ÁöÑÁ®ãÂ∫èÈõÜÁæ§ÊúÄÁÆÄÂçïÁöÑÊñπÂºèÂ∞±ÊòØÂú®ÂÖ∂‰∏≠‰∏ÄÂè∞‰∏äÈù¢ÈÉ®ÁΩ≤ÔºåÁÑ∂ÂêéÂ∞ÜÊâÄÊúâÁöÑÊñá‰ª∂scpÂà∞ÂÖ∂‰ªñÊú∫Âô®‰∏ä‰øÆÊîπÈÖçÁΩÆÔºå‰∏ÄÂ•óÈõÜÁæ§‰πüÂ∞±ÂÆåÊàê‰∫Ü„ÄÇ</p>
<p>Â∞Ü‰∏ãËΩΩÂ•ΩÁöÑÊñá‰ª∂‰∏ä‰º†Ëá≥ÊâÄÊúâetcdËäÇÁÇπ„ÄÇ</p>
<p>etcdÈÖçÁΩÆÊñá‰ª∂Ëß£Èáä</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#[Member]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_NAME</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">etcd-1</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">              </span><span style="--0:#809191;--1:#616671">#ËäÇÁÇπÂêçÁß∞</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_DATA_DIR</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">/data/etcd/data</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#809191;--1:#616671">#Êï∞ÊçÆÁõÆÂΩï</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_LISTEN_PEER_URLS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.10:2380</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#809191;--1:#616671">#ÈõÜÁæ§ÈÄö‰ø°Âú∞ÂùÄ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_LISTEN_CLIENT_URLS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.10:2379,http://127.0.0.1:2379</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#809191;--1:#616671">#ÂÆ¢Êà∑Á´ØËÆøÈóÆÁöÑÁõëÂê¨Âú∞ÂùÄÔºåÂú®ËøôÈáåÂä†‰∏Ä‰∏™http://127.0.0.1:2379ÔºåÂú®ÂΩìÂâçËäÇÁÇπÊü•ÈõÜÁæ§‰ø°ÊÅØÊó∂Â∞±‰∏çÈúÄË¶ÅÊåáÂÆöËØÅ‰π¶ÂéªÊü•ËØ¢‰∫Ü</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#[Clustering]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_INITIAL_ADVERTISE_PEER_URLS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.10:2380</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#809191;--1:#616671">#ÈõÜÁæ§ÈÄöÂëäÂú∞ÂùÄ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_ADVERTISE_CLIENT_URLS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.10:2379,http://127.0.0.1:2379</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#809191;--1:#616671">#ÂÆ¢Êà∑Á´ØÈÄöÂëäÂú∞ÂùÄÔºåÔºåÂú®ËøôÈáåÂä†‰∏Ä‰∏™http://127.0.0.1:2379ÔºåÂú®ÂΩìÂâçËäÇÁÇπÊü•ÈõÜÁæ§‰ø°ÊÅØÊó∂Â∞±‰∏çÈúÄË¶ÅÊåáÂÆöËØÅ‰π¶ÂéªÊü•ËØ¢‰∫Ü</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_INITIAL_CLUSTER</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">etcd-1=https://192.168.20.10:2380,etcd-2=https://192.168.20.12:2380,etcd-3=https://192.168.20.13:2380</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">            </span><span style="--0:#809191;--1:#616671">#ÈõÜÁæ§ËäÇÁÇπÂú∞ÂùÄ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_INITIAL_CLUSTER_TOKEN</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">etcd-cluster</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#809191;--1:#616671">#ÈõÜÁæ§ÁöÑÂîØ‰∏ÄÊ†áËØÜ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_INITIAL_CLUSTER_STATE</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">new</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">            </span><span style="--0:#809191;--1:#616671">#Âä†ÂÖ•ÈõÜÁæ§ÁöÑÁä∂ÊÄÅÔºånew‰∏∫Êñ∞ÈõÜÁæ§ÔºåexistingË°®Á§∫Âä†ÂÖ•Áé∞ÊúâÈõÜÁæ§</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="ETCD_NAME=&#x22;etcd-1&#x22;              #ËäÇÁÇπÂêçÁß∞ETCD_DATA_DIR=&#x22;/data/etcd/data&#x22;          #Êï∞ÊçÆÁõÆÂΩïETCD_LISTEN_PEER_URLS=&#x22;https://192.168.20.10:2380&#x22;      #ÈõÜÁæ§ÈÄö‰ø°Âú∞ÂùÄETCD_LISTEN_CLIENT_URLS=&#x22;https://192.168.20.10:2379,http://127.0.0.1:2379&#x22;    #ÂÆ¢Êà∑Á´ØËÆøÈóÆÁöÑÁõëÂê¨Âú∞ÂùÄÔºåÂú®ËøôÈáåÂä†‰∏Ä‰∏™http://127.0.0.1:2379ÔºåÂú®ÂΩìÂâçËäÇÁÇπÊü•ÈõÜÁæ§‰ø°ÊÅØÊó∂Â∞±‰∏çÈúÄË¶ÅÊåáÂÆöËØÅ‰π¶ÂéªÊü•ËØ¢‰∫ÜETCD_INITIAL_ADVERTISE_PEER_URLS=&#x22;https://192.168.20.10:2380&#x22;      #ÈõÜÁæ§ÈÄöÂëäÂú∞ÂùÄETCD_ADVERTISE_CLIENT_URLS=&#x22;https://192.168.20.10:2379,http://127.0.0.1:2379&#x22;          #ÂÆ¢Êà∑Á´ØÈÄöÂëäÂú∞ÂùÄÔºåÔºåÂú®ËøôÈáåÂä†‰∏Ä‰∏™http://127.0.0.1:2379ÔºåÂú®ÂΩìÂâçËäÇÁÇπÊü•ÈõÜÁæ§‰ø°ÊÅØÊó∂Â∞±‰∏çÈúÄË¶ÅÊåáÂÆöËØÅ‰π¶ÂéªÊü•ËØ¢‰∫ÜETCD_INITIAL_CLUSTER=&#x22;etcd-1=https://192.168.20.10:2380,etcd-2=https://192.168.20.12:2380,etcd-3=https://192.168.20.13:2380&#x22;            #ÈõÜÁæ§ËäÇÁÇπÂú∞ÂùÄETCD_INITIAL_CLUSTER_TOKEN=&#x22;etcd-cluster&#x22;        #ÈõÜÁæ§ÁöÑÂîØ‰∏ÄÊ†áËØÜETCD_INITIAL_CLUSTER_STATE=&#x22;new&#x22;            #Âä†ÂÖ•ÈõÜÁæ§ÁöÑÁä∂ÊÄÅÔºånew‰∏∫Êñ∞ÈõÜÁæ§ÔºåexistingË°®Á§∫Âä†ÂÖ•Áé∞ÊúâÈõÜÁæ§"><div></div></button></div></figure></div>
<p><strong>2.ÈÉ®ÁΩ≤etcd-1ËäÇÁÇπ</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.ÂàõÂª∫Á®ãÂ∫èÁõÆÂΩï</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> mkdir /data/etcd/{</span><span style="--0:#82AAFF;--1:#3C63B3">bin,conf,ssl,data}</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-p</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.Ëß£Âéã‰∫åËøõÂà∂Êñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> tar xf etcd-v3.4.9-linux-amd64.tar.gz</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.Â∞Ü‰∫åËøõÂà∂ÂëΩ‰ª§ÁßªÂä®Âà∞Âà∂ÂÆöÂá∫Á®ãÂ∫èÁõÆÂΩï</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> mv etcd-v3.4.9-linux-amd64/etcd</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53"> /data/etcd/bin/</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">4.ÁºñËæëÈÖçÁΩÆÊñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /data/etcd/conf/etcd.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#[Member]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_NAME</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">etcd-1</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_DATA_DIR</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">/data/etcd/data</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_LISTEN_PEER_URLS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.10:2380</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_LISTEN_CLIENT_URLS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.10:2379,http://127.0.0.1:2379</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#[Clustering]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_INITIAL_ADVERTISE_PEER_URLS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.10:2380</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_ADVERTISE_CLIENT_URLS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.10:2379,http://127.0.0.1:2379</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_INITIAL_CLUSTER</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">etcd-1=https://192.168.20.10:2380,etcd-2=https://192.168.20.12:2380,etcd-3=https://192.168.20.13:2380</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_INITIAL_CLUSTER_TOKEN</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">etcd-cluster</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_INITIAL_CLUSTER_STATE</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">new</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">5.ÁºñÂÜôsystemctlÊéßÂà∂ËÑöÊú¨</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /usr/lib/systemd/system/etcd.service</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[Unit]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">Description</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">Etcd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">Server</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">After</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">network.target</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">After</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">network-online.target</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">Wants</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">network-online.target</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[Service]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">Type</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">notify</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">EnvironmentFile</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/etcd/conf/etcd.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ExecStart</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/etcd/bin/etcd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--cert-file</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/etcd/ssl/server.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--key-file</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/etcd/ssl/server-key.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--peer-cert-file</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/etcd/ssl/server.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--peer-key-file</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/etcd/ssl/server-key.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--trusted-ca-file</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/etcd/ssl/ca.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--peer-trusted-ca-file</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/etcd/ssl/ca.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--logger</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">zap</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">Restart</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">on-failure</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">LimitNOFILE</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">65536</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[Install]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">WantedBy</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">multi-user.target</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">6.Â§çÂà∂ËØÅ‰π¶Êñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cp TLS/etcd/</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">.pem /data/etcd/ssl/</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">7.ÂêØÂä®etcd-1ËäÇÁÇπ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl daemon-reload</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl start etcd</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl enable etcd</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#Á¨¨‰∏Ä‰∏™ËäÇÁÇπÂêØÂä®‰ºö‰∏ÄÁõ¥Â§Ñ‰∫éÂÖ∂‰∏≠‰∏≠ÁöÑÁä∂ÊÄÅÔºåÂè™ÊúâÂΩìÁ¨¨‰∫å‰∏™ËäÇÁÇπ‰πüÂêØÂä®‰∫ÜÔºåÁ¨¨‰∏Ä‰∏™ËäÇÁÇπÊâçËÉΩÂêØÂä®ÊàêÂäüÔºåÂõ†‰∏∫ÈõÜÁæ§ÁâàÁöÑetcdËá≥Â∞ëÈúÄË¶Å2‰∏™ËäÇÁÇπÊâçËÉΩÊàêÂäüËøêË°å</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.ÂàõÂª∫Á®ãÂ∫èÁõÆÂΩï[root@binary-k8s-master1 ~]\# mkdir /data/etcd/{bin,conf,ssl,data} -p2.Ëß£Âéã‰∫åËøõÂà∂Êñá‰ª∂[root@binary-k8s-master1 ~]\# tar xf etcd-v3.4.9-linux-amd64.tar.gz3.Â∞Ü‰∫åËøõÂà∂ÂëΩ‰ª§ÁßªÂä®Âà∞Âà∂ÂÆöÂá∫Á®ãÂ∫èÁõÆÂΩï[root@binary-k8s-master1 ~]\# mv etcd-v3.4.9-linux-amd64/etcd* /data/etcd/bin/4.ÁºñËæëÈÖçÁΩÆÊñá‰ª∂[root@binary-k8s-master1 ~]\# vim /data/etcd/conf/etcd.confETCD_NAME=&#x22;etcd-1&#x22;ETCD_DATA_DIR=&#x22;/data/etcd/data&#x22;ETCD_LISTEN_PEER_URLS=&#x22;https://192.168.20.10:2380&#x22;ETCD_LISTEN_CLIENT_URLS=&#x22;https://192.168.20.10:2379,http://127.0.0.1:2379&#x22;ETCD_INITIAL_ADVERTISE_PEER_URLS=&#x22;https://192.168.20.10:2380&#x22;ETCD_ADVERTISE_CLIENT_URLS=&#x22;https://192.168.20.10:2379,http://127.0.0.1:2379&#x22;ETCD_INITIAL_CLUSTER=&#x22;etcd-1=https://192.168.20.10:2380,etcd-2=https://192.168.20.12:2380,etcd-3=https://192.168.20.13:2380&#x22;ETCD_INITIAL_CLUSTER_TOKEN=&#x22;etcd-cluster&#x22;ETCD_INITIAL_CLUSTER_STATE=&#x22;new&#x22;5.ÁºñÂÜôsystemctlÊéßÂà∂ËÑöÊú¨[root@binary-k8s-master1 ~]\# vim /usr/lib/systemd/system/etcd.service[Unit]Description=Etcd ServerAfter=network.targetAfter=network-online.targetWants=network-online.target[Service]Type=notifyEnvironmentFile=/data/etcd/conf/etcd.confExecStart=/data/etcd/bin/etcd \--cert-file=/data/etcd/ssl/server.pem \--key-file=/data/etcd/ssl/server-key.pem \--peer-cert-file=/data/etcd/ssl/server.pem \--peer-key-file=/data/etcd/ssl/server-key.pem \--trusted-ca-file=/data/etcd/ssl/ca.pem \--peer-trusted-ca-file=/data/etcd/ssl/ca.pem \--logger=zapRestart=on-failureLimitNOFILE=65536[Install]WantedBy=multi-user.target6.Â§çÂà∂ËØÅ‰π¶Êñá‰ª∂[root@binary-k8s-master1 ~]\# cp TLS/etcd/*.pem /data/etcd/ssl/7.ÂêØÂä®etcd-1ËäÇÁÇπ[root@binary-k8s-master1 ~]\# systemctl daemon-reload[root@binary-k8s-master1 ~]\# systemctl start etcd[root@binary-k8s-master1 ~]\# systemctl enable etcd"><div></div></button></div></figure></div>
<p><strong>3.ÈÖçÁΩÆetcd-2ËäÇÁÇπÂíåetcd-3ËäÇÁÇπ</strong></p>
<p>ÈÉ®ÁΩ≤ÂÆå‰∏Ä‰∏™ËäÇÁÇπÔºåÂèØ‰ª•Áõ¥Êé•Â∞ÜÁõÆÂΩïÊã∑Ë¥ùËá≥ÂÖ∂‰ªñËäÇÁÇπÔºåÁúÅÂéªÂÆâË£ÖÁöÑ‰∏Ä‰∫õÊ≠•È™§„ÄÇ</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.Êé®ÈÄÅetcdÁõÆÂΩï</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> scp -rp /data/etcd root@192.168.20.12:/data</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> scp -rp /data/etcd root@192.168.20.13:/data</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.Êé®ÈÄÅsystemctlÂêØÂä®Êñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> scp -rp /usr/lib/systemd/system/etcd.service root@192.168.20.12:/usr/lib/systemd/system/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> scp -rp /usr/lib/systemd/system/etcd.service root@192.168.20.13:/usr/lib/systemd/system/</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.‰øÆÊîπetcd-2ÈÖçÁΩÆÊñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /data/etcd/conf/etcd.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#[Member]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_NAME</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">etcd-2</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_DATA_DIR</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">/data/etcd/data</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_LISTEN_PEER_URLS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.12:2380</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_LISTEN_CLIENT_URLS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.12:2379,http://127.0.0.1:2379</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#[Clustering]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_INITIAL_ADVERTISE_PEER_URLS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.12:2380</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_ADVERTISE_CLIENT_URLS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.12:2379,http://127.0.0.1:2379</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_INITIAL_CLUSTER</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">etcd-1=https://192.168.20.10:2380,etcd-2=https://192.168.20.12:2380,etcd-3=https://192.168.20.13:2380</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_INITIAL_CLUSTER_TOKEN</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">etcd-cluster</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_INITIAL_CLUSTER_STATE</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">new</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">4.‰øÆÊîπetcd-3ÈÖçÁΩÆÊñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /data/etcd/conf/etcd.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#[Member]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_NAME</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">etcd-3</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_DATA_DIR</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">/data/etcd/data</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_LISTEN_PEER_URLS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.13:2380</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_LISTEN_CLIENT_URLS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.13:2379,http://127.0.0.1:2379</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#[Clustering]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_INITIAL_ADVERTISE_PEER_URLS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.13:2380</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_ADVERTISE_CLIENT_URLS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.13:2379,http://127.0.0.1:2379</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_INITIAL_CLUSTER</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">etcd-1=https://192.168.20.10:2380,etcd-2=https://192.168.20.12:2380,etcd-3=https://192.168.20.13:2380</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_INITIAL_CLUSTER_TOKEN</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">etcd-cluster</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_INITIAL_CLUSTER_STATE</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">new</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">5.ÂêØÂä®etcd-1Âíåetcd-2</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl daemon-reload</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl start etcd</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl enable etcd</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">------------</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl daemon-reload</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl start etcd</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl enable etcd</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.Êé®ÈÄÅetcdÁõÆÂΩï[root@binary-k8s-master1 ~]\# scp -rp /data/etcd root@192.168.20.12:/data[root@binary-k8s-master1 ~]\# scp -rp /data/etcd root@192.168.20.13:/data2.Êé®ÈÄÅsystemctlÂêØÂä®Êñá‰ª∂[root@binary-k8s-master1 ~]\# scp -rp /usr/lib/systemd/system/etcd.service root@192.168.20.12:/usr/lib/systemd/system/[root@binary-k8s-master1 ~]\# scp -rp /usr/lib/systemd/system/etcd.service root@192.168.20.13:/usr/lib/systemd/system/3.‰øÆÊîπetcd-2ÈÖçÁΩÆÊñá‰ª∂[root@binary-k8s-node1 ~]\# vim /data/etcd/conf/etcd.confETCD_NAME=&#x22;etcd-2&#x22;ETCD_DATA_DIR=&#x22;/data/etcd/data&#x22;ETCD_LISTEN_PEER_URLS=&#x22;https://192.168.20.12:2380&#x22;ETCD_LISTEN_CLIENT_URLS=&#x22;https://192.168.20.12:2379,http://127.0.0.1:2379&#x22;ETCD_INITIAL_ADVERTISE_PEER_URLS=&#x22;https://192.168.20.12:2380&#x22;ETCD_ADVERTISE_CLIENT_URLS=&#x22;https://192.168.20.12:2379,http://127.0.0.1:2379&#x22;ETCD_INITIAL_CLUSTER=&#x22;etcd-1=https://192.168.20.10:2380,etcd-2=https://192.168.20.12:2380,etcd-3=https://192.168.20.13:2380&#x22;ETCD_INITIAL_CLUSTER_TOKEN=&#x22;etcd-cluster&#x22;ETCD_INITIAL_CLUSTER_STATE=&#x22;new&#x22;4.‰øÆÊîπetcd-3ÈÖçÁΩÆÊñá‰ª∂[root@binary-k8s-node2 ~]\# vim /data/etcd/conf/etcd.confETCD_NAME=&#x22;etcd-3&#x22;ETCD_DATA_DIR=&#x22;/data/etcd/data&#x22;ETCD_LISTEN_PEER_URLS=&#x22;https://192.168.20.13:2380&#x22;ETCD_LISTEN_CLIENT_URLS=&#x22;https://192.168.20.13:2379,http://127.0.0.1:2379&#x22;ETCD_INITIAL_ADVERTISE_PEER_URLS=&#x22;https://192.168.20.13:2380&#x22;ETCD_ADVERTISE_CLIENT_URLS=&#x22;https://192.168.20.13:2379,http://127.0.0.1:2379&#x22;ETCD_INITIAL_CLUSTER=&#x22;etcd-1=https://192.168.20.10:2380,etcd-2=https://192.168.20.12:2380,etcd-3=https://192.168.20.13:2380&#x22;ETCD_INITIAL_CLUSTER_TOKEN=&#x22;etcd-cluster&#x22;ETCD_INITIAL_CLUSTER_STATE=&#x22;new&#x22;5.ÂêØÂä®etcd-1Âíåetcd-2[root@binary-k8s-node1 ~]\# systemctl daemon-reload[root@binary-k8s-node1 ~]\# systemctl start etcd[root@binary-k8s-node1 ~]\# systemctl enable etcd------------[root@binary-k8s-node2 ~]\# systemctl daemon-reload[root@binary-k8s-node2 ~]\# systemctl start etcd[root@binary-k8s-node2 ~]\# systemctl enable etcd"><div></div></button></div></figure></div>
<p><strong>4.Êü•ÁúãÈõÜÁæ§Áä∂ÊÄÅ</strong><br>
etcd-1ÂêØÂä®Êó∂‰ºö‰∏ÄÁõ¥Â§Ñ‰∫éÁ≠âÂæÖÁä∂ÊÄÅÔºåÂΩìetcd-2ÊâßË°åÂêØÂä®ÂëΩ‰ª§Êó∂‰ºöÁ´ãÂç≥ÂêØÂä®ÊàêÂäüÔºåÂπ∂‰∏îetcd-1‰πü‰ºöÁ´ãÂàªÂêØÂä®ÊàêÂäü„ÄÇ</p>
<p>Êü•ÁúãetcdÁöÑÊó•ÂøóÂèØ‰ª•‰ΩøÁî®Ëøô‰∏™ÂëΩ‰ª§Ôºö<code dir="auto">[root@binary-k8s-master1 ~]\# journalctl -u etcd -f</code></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.Êü•ÁúãÊúçÂä°Á´ØÂè£</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> netstat -lnpt </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">grep</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">etcd</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#ECC48D;--1:#3C63B3">.20.10:2379</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0:</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">9625</span><span style="--0:#ECC48D;--1:#3C63B3">/etcd</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#ECC48D;--1:#3C63B3">.20.10:2380</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0:</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">9625</span><span style="--0:#ECC48D;--1:#3C63B3">/etcd</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.Êü•ÁúãÈõÜÁæ§Áä∂ÊÄÅ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#Â¶ÇÊûúÈÖçÁΩÆÊñá‰ª∂‰∏≠2379Á´ØÂè£Ê≤°ÊúâÂä†‰∏Ä‰∏™127.0.0.1ÂàôËøôÊ†∑Êü•ÁúãÈõÜÁæ§Áä∂ÊÄÅ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> ETCDCTL_API=3 /data/etcd/bin/etcdctl --cacert=/data/etcd/ssl/ca.pem --cert=/data/etcd/ssl/server.pem --key=/data/etcd/ssl/server-key.pem --endpoints=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.10:2379,https://192.168.20.12:2379,https://192.168.20.13:2379</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> endpoint health --write-out=table</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">+----------------------------+--------+-------------+-------+</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#82AAFF;--1:#3C63B3">ENDPOINT</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">HEALTH</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#82AAFF;--1:#3C63B3">TOOK</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">ERROR</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">+----------------------------+--------+-------------+-------+</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">https://192.168.20.10:2379</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#C5E478;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">32.322714ms</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#7FDBCA;--1:#097174">|</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">https://192.168.20.12:2379</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#C5E478;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">31.524079ms</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#7FDBCA;--1:#097174">|</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">https://192.168.20.13:2379</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#C5E478;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">38.985949ms</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#7FDBCA;--1:#097174">|</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">+----------------------------+--------+-------------+-------+</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#Â¶ÇÊûúÈÖçÁΩÆÊñá‰ª∂Ê±áÊÄª2379Á´ØÂè£Âä†‰∫Ü‰∏Ä‰∏™127.0.0.1ÂàôÂèØ‰ª•‰ΩøÁî®Â¶Ç‰∏ãÊñπÂºèÊü•ÁúãÈõÜÁæ§‰ø°ÊÅØÊó†ÈúÄÊåáÂÆöËØÅ‰π¶</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 /data/etcd/conf]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53">  /data/etcd/bin/etcdctl member list --write-out=table</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">+------------------+---------+--------+----------------------------+---------------------------------------------------+------------+</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#82AAFF;--1:#3C63B3">ID</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">STATUS</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#82AAFF;--1:#3C63B3">PEER</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ADDRS</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">                   </span><span style="--0:#82AAFF;--1:#3C63B3">CLIENT</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ADDRS</span><span style="--0:#D6DEEB;--1:#403F53">                    </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">IS</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">LEARNER</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">+------------------+---------+--------+----------------------------+---------------------------------------------------+------------+</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">12446003b2a53d43</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">started</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">etcd-2</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">https://192.168.20.12:2380</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">https://127.0.0.1:2379,https://192.168.20.12:2379</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#C5E478;--1:#3C63B3">false</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">51ae3f86f3783687</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">started</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">etcd-1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">https://192.168.20.10:2380</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#82AAFF;--1:#3C63B3">http://127.0.0.1:2379,https://192.168.20.10:2379</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#C5E478;--1:#3C63B3">false</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">667c9c7ba890c3f7</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">started</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">etcd-3</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">https://192.168.20.13:2380</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#82AAFF;--1:#3C63B3">http://127.0.0.1:2379,https://192.168.20.13:2379</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#C5E478;--1:#3C63B3">false</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">+------------------+---------+--------+----------------------------+---------------------------------------------------+------------+</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.Êü•ÁúãÊúçÂä°Á´ØÂè£[root@binary-k8s-master1 ~]\# netstat -lnpt | grep etcdtcp        0      0 192.168.20.10:2379      0.0.0.0:*               LISTEN      9625/etcdtcp        0      0 192.168.20.10:2380      0.0.0.0:*               LISTEN      9625/etcd2.Êü•ÁúãÈõÜÁæ§Áä∂ÊÄÅ[root@binary-k8s-master1 ~]\# ETCDCTL_API=3 /data/etcd/bin/etcdctl --cacert=/data/etcd/ssl/ca.pem --cert=/data/etcd/ssl/server.pem --key=/data/etcd/ssl/server-key.pem --endpoints=&#x22;https://192.168.20.10:2379,https://192.168.20.12:2379,https://192.168.20.13:2379&#x22; endpoint health --write-out=table+----------------------------+--------+-------------+-------+|          ENDPOINT          | HEALTH |    TOOK     | ERROR |+----------------------------+--------+-------------+-------+| https://192.168.20.10:2379 |   true | 32.322714ms |       || https://192.168.20.12:2379 |   true | 31.524079ms |       || https://192.168.20.13:2379 |   true | 38.985949ms |       |+----------------------------+--------+-------------+-------+[root@binary-k8s-master1 /data/etcd/conf]\#  /data/etcd/bin/etcdctl member list --write-out=table+------------------+---------+--------+----------------------------+---------------------------------------------------+------------+|        ID        | STATUS  |  NAME  |         PEER ADDRS         |                   CLIENT ADDRS                    | IS LEARNER |+------------------+---------+--------+----------------------------+---------------------------------------------------+------------+| 12446003b2a53d43 | started | etcd-2 | https://192.168.20.12:2380 | https://127.0.0.1:2379,https://192.168.20.12:2379 |      false || 51ae3f86f3783687 | started | etcd-1 | https://192.168.20.10:2380 |  http://127.0.0.1:2379,https://192.168.20.10:2379 |      false || 667c9c7ba890c3f7 | started | etcd-3 | https://192.168.20.13:2380 |  http://127.0.0.1:2379,https://192.168.20.13:2379 |      false |+------------------+---------+--------+----------------------------+---------------------------------------------------+------------+"><div></div></button></div></figure></div>
<p>ÈÖçÁΩÆÊñá‰ª∂Áä∂ÊÄÅ<br>
<img src="https://cdn.agou-ops.cn/others/da2f8ef902c04e77a4e555d67cc32273.png" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞"></p>
<p>etcdÂêØÂä®ÊàêÂäüÁöÑÊó•Âøó</p>
<p><img src="https://cdn.agou-ops.cn/others/25e40829361b4c78b782ae1b180a90b7.png" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞"></p>
<h2 id="4ÈÉ®ÁΩ≤dockerÊúçÂä°">4.ÈÉ®ÁΩ≤DockerÊúçÂä°</h2>
<p>ÊâÄÊúâkubernetesËäÇÁÇπÈÉΩÈúÄË¶ÅÂÆâË£ÖdockerÊúçÂä°ÔºåÂåÖÊã¨masterÂíånodeËäÇÁÇπ„ÄÇ</p>
<p>docker‰∫åËøõÂà∂Êñá‰ª∂‰∏ãËΩΩÂú∞ÂùÄÔºö<a href="https://download.docker.com/linux/static/stable/x86%5C_64/docker-19.03.9.tgz">https://download.docker.com/linux/static/stable/x86\_64/docker-19.03.9.tgz</a></p>
<h3 id="41ÂÆâË£Ödocker">4.1.ÂÆâË£Ödocker</h3>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.Ëß£Âéã‰∫åËøõÂà∂ÂåÖ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tar</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">zxf</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">docker-19.03.9.tgz</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.Â∞ÜÂèØÊâßË°åÂëΩ‰ª§ÁßªÂä®Âà∞Á≥ªÁªüË∑ØÂæÑ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">mv</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">docker/</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/bin</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.ÂàõÂª∫ÈÖçÁΩÆÊñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">mkdir</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/docker</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/docker/daemon.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"registry-mirrors"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://9wn5tbfh.mirror.aliyuncs.com</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.Ëß£Âéã‰∫åËøõÂà∂ÂåÖtar zxf docker-19.03.9.tgz2.Â∞ÜÂèØÊâßË°åÂëΩ‰ª§ÁßªÂä®Âà∞Á≥ªÁªüË∑ØÂæÑmv docker/* /usr/bin3.ÂàõÂª∫ÈÖçÁΩÆÊñá‰ª∂mkdir /etc/dockervim /etc/docker/daemon.json{  &#x22;registry-mirrors&#x22;: [&#x22;https://9wn5tbfh.mirror.aliyuncs.com&#x22;]}"><div></div></button></div></figure></div>
<h3 id="42‰∏∫dockerÂàõÂª∫systemctlÂêØÂä®ËÑöÊú¨">4.2.‰∏∫dockerÂàõÂª∫systemctlÂêØÂä®ËÑöÊú¨</h3>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.ÁºñÂÜôÂêØÂä®ËÑöÊú¨</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/usr/lib/systemd/system/docker.service</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[Unit]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">Description</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">Docker</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">Application</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Container</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Engine</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">Documentation</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">https://docs.docker.com</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">After</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">network-online.target</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">firewalld.service</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">Wants</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">network-online.target</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[Service]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">Type</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">notify</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ExecStart</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/usr/bin/dockerd</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ExecReload</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/bin/kill</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-s</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">HUP</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">LimitNOFILE</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">infinity</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">LimitNPROC</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">infinity</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">LimitCORE</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">infinity</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">TimeoutStartSec</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">0</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">Delegate</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">yes</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">KillMode</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">process</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">Restart</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">on-failure</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">StartLimitBurst</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">3</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">StartLimitInterval</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">60</span><span style="--0:#ECC48D;--1:#3C63B3">s</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[Install]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">WantedBy</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">multi-user.target</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.ÂêØÂä®docker</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">systemctl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">daemon-reload</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">systemctl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">start</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">docker</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">systemctl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">enable</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">docker</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.ÁºñÂÜôÂêØÂä®ËÑöÊú¨vim /usr/lib/systemd/system/docker.service[Unit]Description=Docker Application Container EngineDocumentation=https://docs.docker.comAfter=network-online.target firewalld.serviceWants=network-online.target[Service]Type=notifyExecStart=/usr/bin/dockerdExecReload=/bin/kill -s HUPLimitNOFILE=infinityLimitNPROC=infinityLimitCORE=infinityTimeoutStartSec=0Delegate=yesKillMode=processRestart=on-failureStartLimitBurst=3StartLimitInterval=60s[Install]WantedBy=multi-user.target2.ÂêØÂä®dockersystemctl daemon-reloadsystemctl start dockersystemctl enable docker"><div></div></button></div></figure></div>
<h2 id="5ÈÉ®ÁΩ≤kubernetes-masterËäÇÁÇπ">5.ÈÉ®ÁΩ≤kubernetes masterËäÇÁÇπ</h2>
<p>ÈÉ®ÁΩ≤‰∫åËøõÂà∂ÁöÑkubernetesÁªÑ‰ª∂Â§ßËá¥ÂèØÂàÜ‰∏∫Â¶Ç‰∏ãÂá†‰∏™Ê≠•È™§Ôºö</p>
<ul>
<li>1.Ëß£Âéã‰∫åËøõÂà∂Êñá‰ª∂</li>
<li>2.Â§çÂà∂‰∫åËøõÂà∂Á®ãÂ∫èÂà∞ÊåáÂÆöÁõÆÂΩï</li>
<li>3.ÂàõÂª∫ÁªÑ‰ª∂ÈÖçÁΩÆÊñá‰ª∂</li>
<li>4.ÁîüÊàêÁªÑ‰ª∂ÁöÑkubeconfigÊñá‰ª∂</li>
<li>5.ÂàõÂª∫systemctlËÑöÊú¨ÁÆ°ÁêÜÊúçÂä°</li>
<li>6.ÂêØÂä®ÁªÑ‰ª∂</li>
</ul>
<p>kubernetesÈõÜÁæ§ÁöÑmasterËäÇÁÇπÂíånodeËäÇÁÇπÁöÑ‰∫åËøõÂà∂Êñá‰ª∂ÈÉΩ‰ªégithub‰∏ä‰∏ãËΩΩÔºåmasterÂíånodeÁõ∏ÂÖ≥ÁöÑÊâÄÊúâÁªÑ‰ª∂ÈÉΩÂú®‰∏Ä‰∏™Á®ãÂ∫èÂåÖ‰∏≠„ÄÇ</p>
<p>‰∏ãËΩΩÂú∞ÂùÄÔºö <a href="https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG/CHANGELOG-1.20.md">https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG/CHANGELOG-1.20.md</a></p>
<p><img src="https://cdn.agou-ops.cn/others/36b71f10da9442808c7a950d2dedd254.png" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞"></p>
<h3 id="51‰ΩøÁî®cfsslÁîüÊàêapiserverÁöÑËØÅ‰π¶Êñá‰ª∂">5.1.‰ΩøÁî®cfsslÁîüÊàêapiserverÁöÑËØÅ‰π¶Êñá‰ª∂</h3>
<p><strong>1.ÁîüÊàêCAËá™Á≠æÈ¢ÅÂèëÊú∫ÊûÑËØÅ‰π¶</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.ÂáÜÂ§áCAÈÖçÁΩÆÊñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/TLS/k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim ca-config.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"signing"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"default"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"expiry"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">87600h</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">},</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"profiles"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"kubernetes"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">         </span><span style="--0:#82AAFF;--1:#3C63B3">"expiry"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">87600h</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">         </span><span style="--0:#82AAFF;--1:#3C63B3">"usages"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"signing"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"key encipherment"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"server auth"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"client auth"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">]</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/TLS/k8s]</span><span style="--0:#82AAFF;--1:#3C63B3">\#</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"CN"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">kubernetes</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"key"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"algo"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">rsa</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"size"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">2048</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">},</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"names"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"C"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">CN</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"L"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Beijing</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"ST"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Beijing</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"O"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">k8s</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"OU"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">System</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.ÁîüÊàêËØÅ‰π¶Êñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/TLS/k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cfssl gencert -initca ca-csr.json </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">cfssljson</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-bare</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">-</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/01</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:20:42</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] generating a new CA key and certificate from CSR</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/01</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:20:42</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] generate received request</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/01</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:20:42</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] received CSR</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/01</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:20:42</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] generating key: rsa-2048</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/01</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:20:43</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] encoded CSR</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/01</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:20:43</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] signed certificate with serial number 90951268335404710707183639990677546638148434604</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.ÂáÜÂ§áCAÈÖçÁΩÆÊñá‰ª∂[root@binary-k8s-master1 ~/TLS/k8s]\# vim ca-config.json{  &#x22;signing&#x22;: {    &#x22;default&#x22;: {      &#x22;expiry&#x22;: &#x22;87600h&#x22;    },    &#x22;profiles&#x22;: {      &#x22;kubernetes&#x22;: {         &#x22;expiry&#x22;: &#x22;87600h&#x22;,         &#x22;usages&#x22;: [            &#x22;signing&#x22;,            &#x22;key encipherment&#x22;,            &#x22;server auth&#x22;,            &#x22;client auth&#x22;        ]      }    }  }}[root@binary-k8s-master1 ~/TLS/k8s]\# vim ca-csr.json{    &#x22;CN&#x22;: &#x22;kubernetes&#x22;,    &#x22;key&#x22;: {        &#x22;algo&#x22;: &#x22;rsa&#x22;,        &#x22;size&#x22;: 2048    },    &#x22;names&#x22;: [        {            &#x22;C&#x22;: &#x22;CN&#x22;,            &#x22;L&#x22;: &#x22;Beijing&#x22;,            &#x22;ST&#x22;: &#x22;Beijing&#x22;,            &#x22;O&#x22;: &#x22;k8s&#x22;,            &#x22;OU&#x22;: &#x22;System&#x22;        }    ]}2.ÁîüÊàêËØÅ‰π¶Êñá‰ª∂[root@binary-k8s-master1 ~/TLS/k8s]\# cfssl gencert -initca ca-csr.json | cfssljson -bare ca -2021/09/01 16:20:42 [INFO] generating a new CA key and certificate from CSR2021/09/01 16:20:42 [INFO] generate received request2021/09/01 16:20:42 [INFO] received CSR2021/09/01 16:20:42 [INFO] generating key: rsa-20482021/09/01 16:20:43 [INFO] encoded CSR2021/09/01 16:20:43 [INFO] signed certificate with serial number 90951268335404710707183639990677546638148434604"><div></div></button></div></figure></div>
<p><strong>2.‰ΩøÁî®Ëá™Á≠æCAÁ≠æÂèëapiserver HTTPSËØÅ‰π¶</strong></p>
<p>Á≠æÂèëÁöÑÂÆ¢Êà∑Á´ØËØÅ‰π¶ÈÖçÁΩÆÊñá‰ª∂‰∏≠ÁöÑhostsÂ≠óÊÆµË¶ÅÂåÖÂê´ÊâÄÊúâMaster/LB/VIPÁöÑIPÂú∞ÂùÄÔºåNodeËäÇÁÇπÁöÑÂú∞ÂùÄÂèØÂÜôÂèØ‰∏çÂÜô„ÄÇ</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.ÂáÜÂ§áÂÆ¢Êà∑Á´ØÈÖçÁΩÆÊñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/TLS/k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim kube-apiserver-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"CN"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">kubernetes</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"hosts"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"10.0.0.1"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"127.0.0.1"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"192.168.20.10"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"192.168.20.11"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"192.168.20.12"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"192.168.20.13"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"192.168.20.9"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"kubernetes"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"kubernetes.default"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"kubernetes.default.svc"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"kubernetes.default.svc.cluster"</span><span style="--0:#82AAFF;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"kubernetes.default.svc.cluster.local"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">],</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"key"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"algo"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">rsa</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">"size"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">2048</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">},</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"names"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"C"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">CN</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"L"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">BeiJing</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"ST"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">BeiJing</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"O"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">k8s</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">"OU"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">System</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.ÁîüÊàêËØÅ‰π¶Êñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/TLS/k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=kubernetes kube-apiserver-csr.json </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">cfssljson</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-bare</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-apiserver</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/01</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:30:24</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] generate received request</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/01</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:30:24</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] received CSR</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/01</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:30:24</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] generating key: rsa-2048</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/01</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:30:25</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] encoded CSR</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/01</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:30:25</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] signed certificate with serial number 714472722509814799589567099679496298525490716083</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/01</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:30:25</span><span style="--0:#D6DEEB;--1:#403F53"> [WARNING] This certificate lacks a </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">hosts</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> field. This makes it unsuitable </span><span style="--0:#C792EA;--1:#8D46B4">for</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">websites.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">For</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">more</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">information</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">see</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">the</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Baseline</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Requirements</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">for</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">the</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Issuance</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">and</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Management</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">of</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Publicly-Trusted</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Certificates,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">v.1.1.6,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">the</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">CA/Browser</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Forum</span><span style="--0:#D6DEEB;--1:#403F53"> (https://cabforum.org);</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">specifically,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">section</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10.2</span><span style="--0:#ECC48D;--1:#3C63B3">.3</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Information Requirements</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">).</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.ÂáÜÂ§áÂÆ¢Êà∑Á´ØÈÖçÁΩÆÊñá‰ª∂[root@binary-k8s-master1 ~/TLS/k8s]\# vim kube-apiserver-csr.json{    &#x22;CN&#x22;: &#x22;kubernetes&#x22;,    &#x22;hosts&#x22;: [      &#x22;10.0.0.1&#x22;,      &#x22;127.0.0.1&#x22;,      &#x22;192.168.20.10&#x22;,      &#x22;192.168.20.11&#x22;,      &#x22;192.168.20.12&#x22;,      &#x22;192.168.20.13&#x22;,      &#x22;192.168.20.9&#x22;,      &#x22;kubernetes&#x22;,      &#x22;kubernetes.default&#x22;,      &#x22;kubernetes.default.svc&#x22;,      &#x22;kubernetes.default.svc.cluster&#x22;,      &#x22;kubernetes.default.svc.cluster.local&#x22;    ],    &#x22;key&#x22;: {        &#x22;algo&#x22;: &#x22;rsa&#x22;,        &#x22;size&#x22;: 2048    },    &#x22;names&#x22;: [        {            &#x22;C&#x22;: &#x22;CN&#x22;,            &#x22;L&#x22;: &#x22;BeiJing&#x22;,            &#x22;ST&#x22;: &#x22;BeiJing&#x22;,            &#x22;O&#x22;: &#x22;k8s&#x22;,            &#x22;OU&#x22;: &#x22;System&#x22;        }    ]}2.ÁîüÊàêËØÅ‰π¶Êñá‰ª∂[root@binary-k8s-master1 ~/TLS/k8s]\# cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=kubernetes kube-apiserver-csr.json | cfssljson -bare kube-apiserver2021/09/01 16:30:24 [INFO] generate received request2021/09/01 16:30:24 [INFO] received CSR2021/09/01 16:30:24 [INFO] generating key: rsa-20482021/09/01 16:30:25 [INFO] encoded CSR2021/09/01 16:30:25 [INFO] signed certificate with serial number 7144727225098147995895670996794962985254907160832021/09/01 16:30:25 [WARNING] This certificate lacks a &#x22;hosts&#x22; field. This makes it unsuitable forwebsites. For more information see the Baseline Requirements for the Issuance and Managementof Publicly-Trusted Certificates, v.1.1.6, from the CA/Browser Forum (https://cabforum.org);specifically, section 10.2.3 (&#x22;Information Requirements&#x22;)."><div></div></button></div></figure></div>
<p><strong>3.Êü•ÁúãÁîü‰∫ßÁöÑËØÅ‰π¶Êñá‰ª∂</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/TLS/k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> ll</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">ÊÄªÁî®Èáè</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">36</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">294</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:20</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca-config.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1001</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:20</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca.csr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">264</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:20</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-------.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1679</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:20</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca-key.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1359</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:20</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1277</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:30</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-apiserver.csr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">602</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:30</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-apiserver-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-------.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1679</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:30</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-apiserver-key.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1643</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:30</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-apiserver.pem</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 ~/TLS/k8s]\# llÊÄªÁî®Èáè 36-rw-r--r--. 1 root root  294 9Êúà   1 16:20 ca-config.json-rw-r--r--. 1 root root 1001 9Êúà   1 16:20 ca.csr-rw-r--r--. 1 root root  264 9Êúà   1 16:20 ca-csr.json-rw-------. 1 root root 1679 9Êúà   1 16:20 ca-key.pem-rw-r--r--. 1 root root 1359 9Êúà   1 16:20 ca.pem-rw-r--r--. 1 root root 1277 9Êúà   1 16:30 kube-apiserver.csr-rw-r--r--. 1 root root  602 9Êúà   1 16:30 kube-apiserver-csr.json-rw-------. 1 root root 1679 9Êúà   1 16:30 kube-apiserver-key.pem-rw-r--r--. 1 root root 1643 9Êúà   1 16:30 kube-apiserver.pem"><div></div></button></div></figure></div>
<h3 id="52Ëß£Âéã‰∫åËøõÂà∂Êñá‰ª∂Â§çÂà∂Áõ∏ÂÖ≥ÁªÑ‰ª∂Á®ãÂ∫è">5.2.Ëß£Âéã‰∫åËøõÂà∂Êñá‰ª∂Â§çÂà∂Áõ∏ÂÖ≥ÁªÑ‰ª∂Á®ãÂ∫è</h3>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> mkdir /data/kubernetes/{</span><span style="--0:#82AAFF;--1:#3C63B3">bin,config,ssl,logs}</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-p</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> tar xf kubernetes-server-linux-amd64.tar.gz</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cd kubernetes/server/bin/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/kubernetes/server/bin]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cp kube-apiserver kube-scheduler kube-controller-manager /data/kubernetes/bin/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/kubernetes/server/bin]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cp kubectl /usr/bin/</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 ~]\# mkdir /data/kubernetes/{bin,config,ssl,logs} -p[root@binary-k8s-master1 ~]\# tar xf kubernetes-server-linux-amd64.tar.gz[root@binary-k8s-master1 ~]\# cd kubernetes/server/bin/[root@binary-k8s-master1 ~/kubernetes/server/bin]\# cp kube-apiserver kube-scheduler kube-controller-manager /data/kubernetes/bin/[root@binary-k8s-master1 ~/kubernetes/server/bin]\# cp kubectl /usr/bin/"><div></div></button></div></figure></div>
<p><img src="https://cdn.agou-ops.cn/others/e7c7eb9ad3ae4b0a8800c575d4e86023.png" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞"></p>
<h3 id="53ÈÉ®ÁΩ≤kube-apiserverÁªÑ‰ª∂">5.3.ÈÉ®ÁΩ≤kube-apiserverÁªÑ‰ª∂</h3>
<h4 id="531ÂàõÂª∫kube-apiserverÈÖçÁΩÆÊñá‰ª∂">5.3.1.ÂàõÂª∫kube-apiserverÈÖçÁΩÆÊñá‰ª∂</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /data/kubernetes/config/kube-apiserver.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">KUBE_APISERVER_OPTS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">--logtostderr=false </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--v=2 </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--log-dir=/data/kubernetes/logs </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--etcd-servers=https://192.168.20.10:2379,https://192.168.20.12:2379,https://192.168.20.13:2379 </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--bind-address=192.168.20.10 </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--secure-port=6443 </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--advertise-address=192.168.20.10 </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--allow-privileged=true </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--service-cluster-ip-range=10.0.0.0/24 </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--enable-admission-plugins=NamespaceLifecycle,LimitRanger,ServiceAccount,ResourceQuota,NodeRestriction </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--authorization-mode=RBAC,Node </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--enable-bootstrap-token-auth=true </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--token-auth-file=/data/kubernetes/config/token.csv </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--service-node-port-range=30000-32767 </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--kubelet-client-certificate=/data/kubernetes/ssl/kube-apiserver.pem </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--kubelet-client-key=/data/kubernetes/ssl/kube-apiserver-key.pem </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--tls-cert-file=/data/kubernetes/ssl/kube-apiserver.pem  </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--tls-private-key-file=/data/kubernetes/ssl/kube-apiserver-key.pem </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--client-ca-file=/data/kubernetes/ssl/ca.pem </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--service-account-key-file=/data/kubernetes/ssl/ca-key.pem </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--service-account-issuer=api </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--service-account-signing-key-file=/data/kubernetes/ssl/kube-apiserver-key.pem </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--etcd-cafile=/data/etcd/ssl/ca.pem </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--etcd-certfile=/data/etcd/ssl/server.pem </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--etcd-keyfile=/data/etcd/ssl/server-key.pem </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--requestheader-client-ca-file=/data/kubernetes/ssl/ca.pem </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--proxy-client-cert-file=/data/kubernetes/ssl/kube-apiserver.pem </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--proxy-client-key-file=/data/kubernetes/ssl/kube-apiserver-key.pem </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--requestheader-allowed-names=kubernetes </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--requestheader-extra-headers-prefix=X-Remote-Extra- </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--requestheader-group-headers=X-Remote-Group </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--requestheader-username-headers=X-Remote-User </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--enable-aggregator-routing=true </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--audit-log-maxage=30 </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--audit-log-maxbackup=3 </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--audit-log-maxsize=100 </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--audit-log-path=/data/kubernetes/logs/k8s-audit.log</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 ~]\# vim /data/kubernetes/config/kube-apiserver.confKUBE_APISERVER_OPTS=&#x22;--logtostderr=false \--v=2 \--log-dir=/data/kubernetes/logs \--etcd-servers=https://192.168.20.10:2379,https://192.168.20.12:2379,https://192.168.20.13:2379 \--bind-address=192.168.20.10 \--secure-port=6443 \--advertise-address=192.168.20.10 \--allow-privileged=true \--service-cluster-ip-range=10.0.0.0/24 \--enable-admission-plugins=NamespaceLifecycle,LimitRanger,ServiceAccount,ResourceQuota,NodeRestriction \--authorization-mode=RBAC,Node \--enable-bootstrap-token-auth=true \--token-auth-file=/data/kubernetes/config/token.csv \--service-node-port-range=30000-32767 \--kubelet-client-certificate=/data/kubernetes/ssl/kube-apiserver.pem \--kubelet-client-key=/data/kubernetes/ssl/kube-apiserver-key.pem \--tls-cert-file=/data/kubernetes/ssl/kube-apiserver.pem  \--tls-private-key-file=/data/kubernetes/ssl/kube-apiserver-key.pem \--client-ca-file=/data/kubernetes/ssl/ca.pem \--service-account-key-file=/data/kubernetes/ssl/ca-key.pem \--service-account-issuer=api \--service-account-signing-key-file=/data/kubernetes/ssl/kube-apiserver-key.pem \--etcd-cafile=/data/etcd/ssl/ca.pem \--etcd-certfile=/data/etcd/ssl/server.pem \--etcd-keyfile=/data/etcd/ssl/server-key.pem \--requestheader-client-ca-file=/data/kubernetes/ssl/ca.pem \--proxy-client-cert-file=/data/kubernetes/ssl/kube-apiserver.pem \--proxy-client-key-file=/data/kubernetes/ssl/kube-apiserver-key.pem \--requestheader-allowed-names=kubernetes \--requestheader-extra-headers-prefix=X-Remote-Extra- \--requestheader-group-headers=X-Remote-Group \--requestheader-username-headers=X-Remote-User \--enable-aggregator-routing=true \--audit-log-maxage=30 \--audit-log-maxbackup=3 \--audit-log-maxsize=100 \--audit-log-path=/data/kubernetes/logs/k8s-audit.log&#x22;"><div></div></button></div></figure></div>
<p><strong>ÈÖçÁΩÆÊñá‰ª∂ÂêÑÂèÇÊï∞Âê´‰πâ</strong></p>





































































































































<table><thead><tr><th>ÈÖçÁΩÆÂèÇÊï∞</th><th>Âê´‰πâ</th></tr></thead><tbody><tr><td>‚Äìlogtostderr</td><td>ÊòØÂê¶ÂºÄÂêØÊó•Âøó</td></tr><tr><td>‚Äìv</td><td>Êó•ÂøóÁöÑÁ≠âÁ∫ßÔºåÁ≠âÁ∫ßË∂äÈ´òÂÜÖÂÆπË∂äËØ¶ÁªÜ</td></tr><tr><td>‚Äìlog-dir</td><td>Êó•ÂøóÂ≠òÊîæË∑ØÂæÑ</td></tr><tr><td>‚Äìetcd-servers</td><td>etcdÈõÜÁæ§Âú∞ÂùÄ</td></tr><tr><td>‚Äìbind-address</td><td>ÁõëÂê¨Âú∞ÂùÄÔºå‰πüÂ∞±ÊòØÊú¨Êú∫</td></tr><tr><td>‚Äìsecure-port</td><td>httpsÂÆâÂÖ®Á´ØÂè£</td></tr><tr><td>‚Äìadvertise-address</td><td>ÈõÜÁæ§ÈÄöÂëäÂú∞ÂùÄ</td></tr><tr><td>‚Äìallow-privileged</td><td>‰ºÅ‰∏öÊéàÊùÉ</td></tr><tr><td>‚Äìservice-cluster-ip-range</td><td>serviceËµÑÊ∫êIPÂú∞ÂùÄÊÆµ</td></tr><tr><td>‚Äìenable-admission-plugins</td><td>ÂáÜÂÖ•ÊéßÂà∂Ê®°Âùó</td></tr><tr><td>‚Äìauthorization-mode</td><td>ËÆ§ËØÅÊéàÊùÉÔºåÂêØÁî®RBACÊéàÊùÉÂíåËäÇÁÇπËá™ÁÆ°ÁêÜ</td></tr><tr><td>‚Äìenable-bootstrap-token-auth</td><td>ÂêØÁî®TLS bootstrapÊú∫Âà∂ÔºåÂêØÁî®‰πãÂêékubeletÂèØ‰ª•Ëá™Âä®ÁªônodeËäÇÈ¢ÅÂèëËØÅ‰π¶</td></tr><tr><td>‚Äìtoken-auth-file</td><td>bootstrap tokenÊñá‰ª∂Ë∑ØÂæÑ</td></tr><tr><td>‚Äìservice-node-port-range</td><td>Service nodeportÁ±ªÂûãÈªòËÆ§ÂàÜÈÖçÁ´ØÂè£ËåÉÂõ¥</td></tr><tr><td>‚Äìkubelet-client-certificate</td><td>apiserverËÆøÈóÆkubeletÁöÑÂÆ¢Êà∑Á´ØËØÅ‰π¶Êñá‰ª∂</td></tr><tr><td>‚Äìkubelet-client-key</td><td>apiserverËÆøÈóÆkubeletÁöÑÂÆ¢Êà∑Á´ØÁßÅÈí•Êñá‰ª∂</td></tr><tr><td>‚Äìtls-cert-file</td><td>apiserver httpsËØÅ‰π¶</td></tr><tr><td>‚Äìtls-private-key-file</td><td>apiserver httpsËØÅ‰π¶</td></tr><tr><td>‚Äìclient-ca-file</td><td>caËØÅ‰π¶Ë∑ØÂæÑ</td></tr><tr><td>‚Äìservice-account-key-file</td><td>caÁßÅÈí•Ë∑ØÂæÑ</td></tr><tr><td>‚Äìservice-account-issuer</td><td>saË¥¶Âè∑ÊéàÊùÉËøáÊúüÊó∂Èó¥ÁöÑ‰∏Ä‰∏™ÈÖçÁΩÆÔºå1.20‰ª•ÂêéÊâçÊúâÁöÑÁâπÊÄß</td></tr><tr><td>‚Äìservice-account-signing-key-file</td><td>ËØÅ‰π¶Êñá‰ª∂Ë∑ØÂæÑ</td></tr><tr><td>‚Äìetcd-cafile</td><td>etcd caËØÅ‰π¶Êñá‰ª∂Ë∑ØÂæÑ</td></tr><tr><td>‚Äìetcd-certfile</td><td>etcd ÂÆ¢Êà∑Á´ØËØÅ‰π¶Êñá‰ª∂Ë∑ØÂæÑ</td></tr><tr><td>‚Äìetcd-keyfile</td><td>etcd ÂÆ¢Êà∑Á´ØÁßÅÈí•Êñá‰ª∂Ë∑ØÂæÑ</td></tr><tr><td>‚Äìrequestheader-client-ca-file</td><td>ËÅöÂêàÂ±ÇÁõ∏ÂÖ≥ÈÖçÁΩÆ</td></tr><tr><td>‚Äìproxy-client-cert-file</td><td>ËÅöÂêàÂ±ÇÁõ∏ÂÖ≥ÈÖçÁΩÆ</td></tr><tr><td>‚Äìproxy-client-key-file</td><td>ËÅöÂêàÂ±ÇÁõ∏ÂÖ≥ÈÖçÁΩÆ</td></tr><tr><td>‚Äìrequestheader-allowed-names</td><td>ËÅöÂêàÂ±ÇÁõ∏ÂÖ≥ÈÖçÁΩÆ</td></tr><tr><td>‚Äìrequestheader-extra-headers-prefix</td><td>ËÅöÂêàÂ±ÇÁõ∏ÂÖ≥ÈÖçÁΩÆ</td></tr><tr><td>‚Äìenable-aggregator-routing</td><td>ËÅöÂêàÂ±ÇÁõ∏ÂÖ≥ÈÖçÁΩÆ</td></tr></tbody></table>
<h4 id="532ÂàõÂª∫tls-bootstrappingÊñá‰ª∂">5.3.2.ÂàõÂª∫TLS BootstrappingÊñá‰ª∂</h4>
<p>TLS BootstrapingÔºöMaster apiserverÂêØÁî®TLSËÆ§ËØÅÂêéÔºåNodeËäÇÁÇπkubeletÂíåkube-proxyË¶Å‰∏ékube-apiserverËøõË°åÈÄö‰ø°ÔºåÂøÖÈ°ª‰ΩøÁî®CAÁ≠æÂèëÁöÑÊúâÊïàËØÅ‰π¶ÊâçÂèØ‰ª•ÔºåÂΩìNodeËäÇÁÇπÂæàÂ§öÊó∂ÔºåËøôÁßçÂÆ¢Êà∑Á´ØËØÅ‰π¶È¢ÅÂèëÈúÄË¶ÅÂ§ßÈáèÂ∑•‰ΩúÔºåÂêåÊ†∑‰πü‰ºöÂ¢ûÂä†ÈõÜÁæ§Êâ©Â±ïÂ§çÊùÇÂ∫¶„ÄÇ‰∏∫‰∫ÜÁÆÄÂåñÊµÅÁ®ãÔºåKubernetesÂºïÂÖ•‰∫ÜTLS bootstrapingÊú∫Âà∂Êù•Ëá™Âä®È¢ÅÂèëÂÆ¢Êà∑Á´ØËØÅ‰π¶Ôºåkubelet‰ºö‰ª•‰∏Ä‰∏™‰ΩéÊùÉÈôêÁî®Êà∑Ëá™Âä®ÂêëapiserverÁî≥ËØ∑ËØÅ‰π¶ÔºåkubeletÁöÑËØÅ‰π¶Áî±apiserverÂä®ÊÄÅÁ≠æÁΩ≤„ÄÇÊâÄ‰ª•Âº∫ÁÉàÂª∫ËÆÆÂú®Node‰∏ä‰ΩøÁî®ËøôÁßçÊñπÂºèÔºåÁõÆÂâç‰∏ªË¶ÅÁî®‰∫ékubeletÔºåkube-proxyËøòÊòØÁî±Êàë‰ª¨Áªü‰∏ÄÈ¢ÅÂèë‰∏Ä‰∏™ËØÅ‰π¶„ÄÇ</p>
<p>TLS bootstraping Â∑•‰ΩúÊµÅÁ®ãÔºö</p>
<p>kubeletÈ¶ñÂÖàÂèñÊü•ÊâæbootstrapingÈÖçÁΩÆÊñá‰ª∂ÔºåÁÑ∂ÂêéÂéªËøûÊé•apiserverÔºåÂºÄÂßãÈ™åËØÅbootstrap tokenÊñá‰ª∂ÔºåÂÜçÈ™åËØÅËØÅ‰π¶Êñá‰ª∂ÔºåÊúÄÂêéÈ¢ÅÂèëËØÅ‰π¶ÂêØÂä®ÊàêÂäüÔºåÂê¶ÂàôÂ∞±‰ºöÂêØÂä®Â§±Ë¥•„ÄÇ<br>
<img src="https://cdn.agou-ops.cn/others/17a18dfd43ae4604863e590283b63ebd.png" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞"></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.ÁîüÊàê‰∏Ä‰∏™tokenÂÄº</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> head -c 16 /dev/urandom </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">od</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-An</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-t</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">x</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">tr</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-d</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E"> </span><span style="--0:#D9F5DD;--1:#111111">'</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">d7f96b0d86c574d0f64a713608db092</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.ÂàõÂª∫tokenÊñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /data/kubernetes/config/token.csv</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">d7f96b0d86c574d0f64a713608db0922,kubelet-bootstrap,10001,</span><span style="--0:#82AAFF;--1:#3C63B3">"system:node-bootstrapper"</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#Ê†ºÂºèÔºötokenÔºåÁî®Êà∑ÂêçÔºåUIDÔºåÁî®Êà∑ÁªÑ</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.ÁîüÊàê‰∏Ä‰∏™tokenÂÄº[root@binary-k8s-master1 ~]\# head -c 16 /dev/urandom | od -An -t x | tr -d &#x27; &#x27;d7f96b0d86c574d0f64a713608db0922.ÂàõÂª∫tokenÊñá‰ª∂[root@binary-k8s-master1 ~]\# vim /data/kubernetes/config/token.csvd7f96b0d86c574d0f64a713608db0922,kubelet-bootstrap,10001,&#x22;system:node-bootstrapper&#x22;"><div></div></button></div></figure></div>
<h4 id="534ÂàõÂª∫systemctlËÑöÊú¨ÁÆ°ÁêÜapiserver">5.3.4.ÂàõÂª∫systemctlËÑöÊú¨ÁÆ°ÁêÜapiserver</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /usr/lib/systemd/system/kube-apiserver.service</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[Unit]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">Description</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">Kubernetes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">API</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Server</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">Documentation</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">https://github.com/kubernetes/kubernetes</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[Service]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">EnvironmentFile</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/config/kube-apiserver.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ExecStart</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/bin/kube-apiserver</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">$KUBE_APISERVER_OPTS</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">Restart</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">on-failure</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[Install]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">WantedBy</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">multi-user.target</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 ~]\# vim /usr/lib/systemd/system/kube-apiserver.service[Unit]Description=Kubernetes API ServerDocumentation=https://github.com/kubernetes/kubernetes[Service]EnvironmentFile=/data/kubernetes/config/kube-apiserver.confExecStart=/data/kubernetes/bin/kube-apiserver $KUBE_APISERVER_OPTSRestart=on-failure[Install]WantedBy=multi-user.target"><div></div></button></div></figure></div>
<h4 id="535ÂêØÂä®kube-apiserverÁªÑ‰ª∂">5.3.5.ÂêØÂä®kube-apiserverÁªÑ‰ª∂</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.Êã∑Ë¥ùÊàë‰ª¨ÈúÄË¶ÅÁöÑËØÅ‰π¶Êñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cp TLS/k8s/</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">.pem /data/kubernetes/ssl/</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.ÂêØÂä®kube-apiserver</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl daemon-reload</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl start kube-apiserver</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl enable kube-apiserver</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.Êü•ÁúãÁ´ØÂè£</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> netstat -lnpt </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">grep</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#ECC48D;--1:#3C63B3">.20.10:6443</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0:</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">28546</span><span style="--0:#ECC48D;--1:#3C63B3">/kube-apiserve</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.Êã∑Ë¥ùÊàë‰ª¨ÈúÄË¶ÅÁöÑËØÅ‰π¶Êñá‰ª∂[root@binary-k8s-master1 ~]\# cp TLS/k8s/*.pem /data/kubernetes/ssl/2.ÂêØÂä®kube-apiserver[root@binary-k8s-master1 ~]\# systemctl daemon-reload[root@binary-k8s-master1 ~]\# systemctl start kube-apiserver[root@binary-k8s-master1 ~]\# systemctl enable kube-apiserver3.Êü•ÁúãÁ´ØÂè£[root@binary-k8s-master1 ~]\# netstat -lnpt | grep kubetcp        0      0 192.168.20.10:6443      0.0.0.0:*               LISTEN      28546/kube-apiserve"><div></div></button></div></figure></div>
<h3 id="54ÈÉ®ÁΩ≤kube-controller-manageÁªÑ‰ª∂">5.4.ÈÉ®ÁΩ≤kube-controller-manageÁªÑ‰ª∂</h3>
<h4 id="541ÂàõÂª∫kube-controller-manageÈÖçÁΩÆÊñá‰ª∂">5.4.1.ÂàõÂª∫kube-controller-manageÈÖçÁΩÆÊñá‰ª∂</h4>
<blockquote>
<p><strong>ÈÖçÁΩÆÊñá‰ª∂Âê´‰πâ</strong></p>
<p>‚ÄìkubeconfigÔºöÊåáÂÆöÁî®‰∫éËøûÊé•apiserverÁöÑkubeconfigÈÖçÁΩÆÊñá‰ª∂</p>
<p>‚Äìleader-electÔºöÁî®‰∫éÈ´òÂèØÁî®ÈõÜÁæ§ÔºåËá™Âä®ÈÄâ‰∏æ</p>
<p>‚Äìcluster-signing-cert-fileÔºöÊåáÂÆöCAËØÅ‰π¶Êñá‰ª∂Ôºå‰∏∫kubeletËá™Âä®È¢ÅÂèëËØÅ‰π¶</p>
<p>‚Äìcluster-signing-key-fileÔºöÊåáÂÆöCAÁßÅÈí•Êñá‰ª∂Ôºå‰∏∫kubeletËá™Âä®È¢ÅÂèëËØÅ‰π¶</p>
<p>‚Äìcluster-signing-durationÔºöËØÅ‰π¶ËøáÊúüÊó∂Èó¥</p>
</blockquote>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /data/kubernetes/config/kube-controller-manager.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">KUBE_CONTROLLER_MANAGER_OPTS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">--logtostderr=false </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--v=2 </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--log-dir=/data/kubernetes/logs </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--leader-elect=true </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--kubeconfig=/data/kubernetes/config/kube-controller-manager.kubeconfig </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--bind-address=192.168.20.10 </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--allocate-node-cidrs=true </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--cluster-cidr=10.244.0.0/16 </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--service-cluster-ip-range=10.0.0.0/24 </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--cluster-signing-cert-file=/data/kubernetes/ssl/ca.pem </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--cluster-signing-key-file=/data/kubernetes/ssl/ca-key.pem  </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--root-ca-file=/data/kubernetes/ssl/ca.pem </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--service-account-private-key-file=/data/kubernetes/ssl/ca-key.pem </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--cluster-signing-duration=87600h0m0s</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 ~]\# vim /data/kubernetes/config/kube-controller-manager.confKUBE_CONTROLLER_MANAGER_OPTS=&#x22;--logtostderr=false \--v=2 \--log-dir=/data/kubernetes/logs \--leader-elect=true \--kubeconfig=/data/kubernetes/config/kube-controller-manager.kubeconfig \--bind-address=192.168.20.10 \--allocate-node-cidrs=true \--cluster-cidr=10.244.0.0/16 \--service-cluster-ip-range=10.0.0.0/24 \--cluster-signing-cert-file=/data/kubernetes/ssl/ca.pem \--cluster-signing-key-file=/data/kubernetes/ssl/ca-key.pem  \--root-ca-file=/data/kubernetes/ssl/ca.pem \--service-account-private-key-file=/data/kubernetes/ssl/ca-key.pem \--cluster-signing-duration=87600h0m0s&#x22;"><div></div></button></div></figure></div>
<h4 id="542ÁîüÊàêkubeconfigÊñá‰ª∂">5.4.2.ÁîüÊàêkubeconfigÊñá‰ª∂</h4>
<p>kube-controller-manageÂà©Áî®kubeconfigÈÖçÁΩÆÊñá‰ª∂ËøûÊé•apiserver„ÄÇ</p>
<p>kubeconfigÊñá‰ª∂‰∏≠ÂåÖÊã¨ÈõÜÁæ§apiserverÂú∞ÂùÄ„ÄÅËØÅ‰π¶Êñá‰ª∂„ÄÅÁî®Êà∑„ÄÇ</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.Áî±‰∫ékubeconfigÈúÄË¶ÅËØÅ‰π¶Êñá‰ª∂ÁöÑÊîØÊåÅÔºåÂõ†Ê≠§Ë¶ÅÁîüÊàê‰∏Ä‰∏™ËØÅ‰π¶</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/TLS/k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim kube-controller-manager-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"CN"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">system:kube-controller-manager</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"hosts"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [],</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"key"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"algo"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">rsa</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"size"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">2048</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">},</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"names"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"C"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">CN</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"L"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">BeiJing</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"ST"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">BeiJing</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"O"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">system:masters</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"OU"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">System</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/TLS/k8s]</span><span style="--0:#82AAFF;--1:#3C63B3">\#</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">cfssl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">gencert</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-ca=ca.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-ca-key=ca-key.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-config=ca-config.json</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-profile=kubernetes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-controller-manager-csr.json</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">cfssljson</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-bare</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-controller-manager</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/01</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:36:18</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] generate received request</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/01</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:36:18</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] received CSR</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/01</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:36:18</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] generating key: rsa-2048</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">l2021/09/01</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:36:19</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] encoded CSR</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/01</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:36:19</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] signed certificate with serial number 719101376219834763931271155238486242405063666906</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/01</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:36:19</span><span style="--0:#D6DEEB;--1:#403F53"> [WARNING] This certificate lacks a </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">hosts</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> field. This makes it unsuitable </span><span style="--0:#C792EA;--1:#8D46B4">for</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">websites.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">For</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">more</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">information</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">see</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">the</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Baseline</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Requirements</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">for</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">the</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Issuance</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">and</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Management</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">of</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Publicly-Trusted</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Certificates,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">v.1.1.6,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">the</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">CA/Browser</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Forum</span><span style="--0:#D6DEEB;--1:#403F53"> (https://cabforum.org);</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">specifically,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">section</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10.2</span><span style="--0:#ECC48D;--1:#3C63B3">.3</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Information Requirements</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">).</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/TLS/k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cp kube-controller-manager</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">pem /data/kubernetes/ssl/</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.ÁîüÊàêkubeconfigÊñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#Âú®kubeconfigÊñá‰ª∂‰∏≠Â¢ûÂä†ÈõÜÁæ§apiserver‰ø°ÊÅØ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl config set-cluster kubernetes \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--certificate-authority</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/ssl/ca.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--embed-certs</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--server</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.10:6443</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--kubeconfig</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/config/kube-controller-manager.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#Âú®kubeconfigÊñá‰ª∂‰∏≠Â¢ûÂä†ËØÅ‰π¶Êñá‰ª∂‰ø°ÊÅØ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl config set-credentials kube-controller-manager \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--client-certificate</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/ssl/kube-controller-manager.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--client-key</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/ssl/kube-controller-manager-key.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--embed-certs</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--kubeconfig</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/config/kube-controller-manager.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#Âú®kubeconfigÊñá‰ª∂‰∏≠Â¢ûÂä†Áî®Êà∑‰ø°ÊÅØ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl config set-context default \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--cluster</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--user</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">kube-controller-manager</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--kubeconfig</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/config/kube-controller-manager.kubeconfig</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.ÊåáÂÆöÁîüÊàêÁöÑkubeconfigÊñá‰ª∂‰∏∫ÈõÜÁæ§‰ΩøÁî®</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl config use-context default --kubeconfig=/data/kubernetes/config/kube-controller-manager.kubeconfig</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.Áî±‰∫ékubeconfigÈúÄË¶ÅËØÅ‰π¶Êñá‰ª∂ÁöÑÊîØÊåÅÔºåÂõ†Ê≠§Ë¶ÅÁîüÊàê‰∏Ä‰∏™ËØÅ‰π¶[root@binary-k8s-master1 ~/TLS/k8s]\# vim kube-controller-manager-csr.json{  &#x22;CN&#x22;: &#x22;system:kube-controller-manager&#x22;,  &#x22;hosts&#x22;: [],  &#x22;key&#x22;: {    &#x22;algo&#x22;: &#x22;rsa&#x22;,    &#x22;size&#x22;: 2048  },  &#x22;names&#x22;: [    {      &#x22;C&#x22;: &#x22;CN&#x22;,      &#x22;L&#x22;: &#x22;BeiJing&#x22;,      &#x22;ST&#x22;: &#x22;BeiJing&#x22;,      &#x22;O&#x22;: &#x22;system:masters&#x22;,      &#x22;OU&#x22;: &#x22;System&#x22;    }  ]}[root@binary-k8s-master1 ~/TLS/k8s]\# cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=kubernetes kube-controller-manager-csr.json | cfssljson -bare kube-controller-manager2021/09/01 16:36:18 [INFO] generate received request2021/09/01 16:36:18 [INFO] received CSR2021/09/01 16:36:18 [INFO] generating key: rsa-2048l2021/09/01 16:36:19 [INFO] encoded CSR2021/09/01 16:36:19 [INFO] signed certificate with serial number 7191013762198347639312711552384862424050636669062021/09/01 16:36:19 [WARNING] This certificate lacks a &#x22;hosts&#x22; field. This makes it unsuitable forwebsites. For more information see the Baseline Requirements for the Issuance and Managementof Publicly-Trusted Certificates, v.1.1.6, from the CA/Browser Forum (https://cabforum.org);specifically, section 10.2.3 (&#x22;Information Requirements&#x22;).[root@binary-k8s-master1 ~/TLS/k8s]\# cp kube-controller-manager*pem /data/kubernetes/ssl/2.ÁîüÊàêkubeconfigÊñá‰ª∂[root@binary-k8s-master1 ~]\# kubectl config set-cluster kubernetes \--certificate-authority=/data/kubernetes/ssl/ca.pem \--embed-certs=true \--server=&#x22;https://192.168.20.10:6443&#x22; \--kubeconfig=/data/kubernetes/config/kube-controller-manager.kubeconfig[root@binary-k8s-master1 ~]\# kubectl config set-credentials kube-controller-manager \--client-certificate=/data/kubernetes/ssl/kube-controller-manager.pem \--client-key=/data/kubernetes/ssl/kube-controller-manager-key.pem \--embed-certs=true \--kubeconfig=/data/kubernetes/config/kube-controller-manager.kubeconfig[root@binary-k8s-master1 ~]\# kubectl config set-context default \--cluster=kubernetes \--user=kube-controller-manager \--kubeconfig=/data/kubernetes/config/kube-controller-manager.kubeconfig3.ÊåáÂÆöÁîüÊàêÁöÑkubeconfigÊñá‰ª∂‰∏∫ÈõÜÁæ§‰ΩøÁî®[root@binary-k8s-master1 ~]\# kubectl config use-context default --kubeconfig=/data/kubernetes/config/kube-controller-manager.kubeconfig"><div></div></button></div></figure></div>
<p><img src="https://cdn.agou-ops.cn/others/877a98a70b2f47919bcaae2d9d02a4d1.png" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞"></p>
<h4 id="543ÂàõÂª∫systemctlËÑöÊú¨ÁÆ°ÁêÜÊúçÂä°">5.4.3.ÂàõÂª∫systemctlËÑöÊú¨ÁÆ°ÁêÜÊúçÂä°</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /usr/lib/systemd/system/kube-controller-manager.service</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[Unit]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">Description</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">Kubernetes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">Controller</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Manager</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">Documentation</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">https://github.com/kubernetes/kubernetes</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[Service]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">EnvironmentFile</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/config/kube-controller-manager.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ExecStart</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/bin/kube-controller-manager</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">$KUBE_CONTROLLER_MANAGER_OPTS</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">Restart</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">on-failure</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[Install]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">WantedBy</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">multi-user.target</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 ~]\# vim /usr/lib/systemd/system/kube-controller-manager.service[Unit]Description=Kubernetes Controller ManagerDocumentation=https://github.com/kubernetes/kubernetes[Service]EnvironmentFile=/data/kubernetes/config/kube-controller-manager.confExecStart=/data/kubernetes/bin/kube-controller-manager $KUBE_CONTROLLER_MANAGER_OPTSRestart=on-failure[Install]WantedBy=multi-user.target"><div></div></button></div></figure></div>
<h4 id="544ÂêØÂä®kube-controller-manageÁªÑ‰ª∂">5.4.4.ÂêØÂä®kube-controller-manageÁªÑ‰ª∂</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.ÂêØÂä®ÊúçÂä°</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl daemon-reload</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl start kube-controller-manager</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl enable kube-controller-manager</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.Êü•ÁúãÁ´ØÂè£</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> netstat -lnpt </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">grep</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#ECC48D;--1:#3C63B3">.20.10:6443</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0:</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">28546</span><span style="--0:#ECC48D;--1:#3C63B3">/kube-apiserve</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#ECC48D;--1:#3C63B3">.20.10:10257</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0:</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">28941</span><span style="--0:#ECC48D;--1:#3C63B3">/kube-controll</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp6</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">:::10252</span><span style="--0:#D6DEEB;--1:#403F53">                </span><span style="--0:#ECC48D;--1:#3C63B3">:::</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">                    </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">28941</span><span style="--0:#ECC48D;--1:#3C63B3">/kube-controll</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.ÂêØÂä®ÊúçÂä°[root@binary-k8s-master1 ~]\# systemctl daemon-reload[root@binary-k8s-master1 ~]\# systemctl start kube-controller-manager[root@binary-k8s-master1 ~]\# systemctl enable kube-controller-manager2.Êü•ÁúãÁ´ØÂè£[root@binary-k8s-master1 ~]\# netstat -lnpt | grep kubetcp        0      0 192.168.20.10:6443      0.0.0.0:*               LISTEN      28546/kube-apiservetcp        0      0 192.168.20.10:10257     0.0.0.0:*               LISTEN      28941/kube-controlltcp6       0      0 :::10252                :::*                    LISTEN      28941/kube-controll"><div></div></button></div></figure></div>
<h3 id="55ÈÉ®ÁΩ≤kube-schedulerÁªÑ‰ª∂">5.5.ÈÉ®ÁΩ≤kube-schedulerÁªÑ‰ª∂</h3>
<h4 id="551ÂàõÂª∫kube-schedulerÈÖçÁΩÆÊñá‰ª∂">5.5.1.ÂàõÂª∫kube-schedulerÈÖçÁΩÆÊñá‰ª∂</h4>
<blockquote>
<p>ÈÖçÁΩÆÊñá‰ª∂Ëß£Èáä</p>
<p>‚ÄìkubeconfigÔºöÊåáÂÆökubeconfigÊñá‰ª∂</p>
<p>‚Äìleader-electÔºöÈÄâ‰∏æ</p>
</blockquote>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /data/kubernetes/config/kube-scheduler.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">KUBE_SCHEDULER_OPTS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">--logtostderr=false </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--v=2 </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--log-dir=/data/kubernetes/logs </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--leader-elect </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--kubeconfig=/data/kubernetes/config/kube-scheduler.kubeconfig </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--bind-address=192.168.20.10</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 ~]\# vim /data/kubernetes/config/kube-scheduler.confKUBE_SCHEDULER_OPTS=&#x22;--logtostderr=false \--v=2 \--log-dir=/data/kubernetes/logs \--leader-elect \--kubeconfig=/data/kubernetes/config/kube-scheduler.kubeconfig \--bind-address=192.168.20.10&#x22;"><div></div></button></div></figure></div>
<h4 id="552ÁîüÊàêkubeconfigÊñá‰ª∂">5.5.2.ÁîüÊàêkubeconfigÊñá‰ª∂</h4>
<p>ÁîüÊàêkubeconfigËøûÊé•ÈõÜÁæ§apiserver„ÄÇ</p>
<p>kube-scheduleÂà©Áî®kubeconfigÈÖçÁΩÆÊñá‰ª∂ËøûÊé•apiserver„ÄÇ</p>
<p>kubeconfigÊñá‰ª∂‰∏≠ÂåÖÊã¨ÈõÜÁæ§apiserverÂú∞ÂùÄ„ÄÅËØÅ‰π¶Êñá‰ª∂„ÄÅÁî®Êà∑„ÄÇ</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.ÂàõÂª∫ËØÅ‰π¶ÈÖçÁΩÆÊñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/TLS/k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim kube-scheduler-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"CN"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">system:kube-scheduler</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"hosts"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [],</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"key"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"algo"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">rsa</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"size"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">2048</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">},</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"names"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"C"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">CN</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"L"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">BeiJing</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"ST"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">BeiJing</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"O"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">system:masters</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"OU"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">System</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.ÁîüÊàêËØÅ‰π¶</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/TLS/k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=kubernetes kube-scheduler-csr.json </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">cfssljson</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-bare</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-scheduler</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/02</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">14</span><span style="--0:#ECC48D;--1:#3C63B3">:50:40</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] generate received request</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/02</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">14</span><span style="--0:#ECC48D;--1:#3C63B3">:50:40</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] received CSR</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/02</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">14</span><span style="--0:#ECC48D;--1:#3C63B3">:50:40</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] generating key: rsa-2048</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/02</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">14</span><span style="--0:#ECC48D;--1:#3C63B3">:50:42</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] encoded CSR</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/02</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">14</span><span style="--0:#ECC48D;--1:#3C63B3">:50:42</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] signed certificate with serial number 91388852050290848663498441480862532526947759393</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/02</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">14</span><span style="--0:#ECC48D;--1:#3C63B3">:50:42</span><span style="--0:#D6DEEB;--1:#403F53"> [WARNING] This certificate lacks a </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">hosts</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> field. This makes it unsuitable </span><span style="--0:#C792EA;--1:#8D46B4">for</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">websites.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">For</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">more</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">information</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">see</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">the</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Baseline</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Requirements</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">for</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">the</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Issuance</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">and</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Management</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">of</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Publicly-Trusted</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Certificates,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">v.1.1.6,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">the</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">CA/Browser</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Forum</span><span style="--0:#D6DEEB;--1:#403F53"> (https://cabforum.org);</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">specifically,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">section</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10.2</span><span style="--0:#ECC48D;--1:#3C63B3">.3</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Information Requirements</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">).</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.Êü•ÁúãËØÅ‰π¶Êñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/TLS/k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> ll</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">ÊÄªÁî®Èáè</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">68</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">294</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:20</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca-config.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1001</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:20</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca.csr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">264</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:20</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-------.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1679</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:20</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca-key.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1359</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:20</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1277</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:30</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-apiserver.csr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">602</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:30</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-apiserver-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-------.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1679</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:30</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-apiserver-key.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1643</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:30</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-apiserver.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1045</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:36</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-controller-manager.csr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">255</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:46</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-controller-manager-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-------.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1675</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:36</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-controller-manager-key.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1436</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:36</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-controller-manager.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1029</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">14</span><span style="--0:#ECC48D;--1:#3C63B3">:50</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-scheduler.csr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">245</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">14</span><span style="--0:#ECC48D;--1:#3C63B3">:50</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-scheduler-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-------.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1675</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">14</span><span style="--0:#ECC48D;--1:#3C63B3">:50</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-scheduler-key.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1424</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">14</span><span style="--0:#ECC48D;--1:#3C63B3">:50</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-scheduler.pem</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">4.Êã∑Ë¥ùËØÅ‰π¶Êñá‰ª∂Ëá≥ÊåáÂÆöË∑ØÂæÑ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/TLS/k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cp kube-scheduler</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">.pem /data/kubernetes/ssl/</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">5.ÁîüÊàêkubeconfigÊñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#Âú®kubeconfigÊñá‰ª∂‰∏≠Â¢ûÂä†ÈõÜÁæ§apiserver‰ø°ÊÅØ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl config set-cluster kubernetes \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--certificate-authority</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/ssl/ca.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--embed-certs</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--server</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.10:6443</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--kubeconfig</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/config/kube-scheduler.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#Âú®kubeconfigÊñá‰ª∂‰∏≠Â¢ûÂä†ËØÅ‰π¶Êñá‰ª∂‰ø°ÊÅØ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl config set-credentials kube-scheduler \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--client-certificate</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/ssl/kube-scheduler.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--client-key</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/ssl/kube-scheduler-key.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--embed-certs</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--kubeconfig</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/config/kube-scheduler.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#Âú®kubeconfigÊñá‰ª∂‰∏≠Â¢ûÂä†Áî®Êà∑‰ø°ÊÅØ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl config set-context default \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--cluster</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--user</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">kube-scheduler</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--kubeconfig</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/config/kube-scheduler.kubeconfig</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">6.ÊåáÂÆöÁîüÊàêÁöÑkubeconfigÊñá‰ª∂‰∏∫ÈõÜÁæ§‰ΩøÁî®</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl config use-context default --kubeconfig=/data/kubernetes/config/kube-scheduler.kubeconfig</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.ÂàõÂª∫ËØÅ‰π¶ÈÖçÁΩÆÊñá‰ª∂[root@binary-k8s-master1 ~/TLS/k8s]\# vim kube-scheduler-csr.json{  &#x22;CN&#x22;: &#x22;system:kube-scheduler&#x22;,  &#x22;hosts&#x22;: [],  &#x22;key&#x22;: {    &#x22;algo&#x22;: &#x22;rsa&#x22;,    &#x22;size&#x22;: 2048  },  &#x22;names&#x22;: [    {      &#x22;C&#x22;: &#x22;CN&#x22;,      &#x22;L&#x22;: &#x22;BeiJing&#x22;,      &#x22;ST&#x22;: &#x22;BeiJing&#x22;,      &#x22;O&#x22;: &#x22;system:masters&#x22;,      &#x22;OU&#x22;: &#x22;System&#x22;    }  ]}2.ÁîüÊàêËØÅ‰π¶[root@binary-k8s-master1 ~/TLS/k8s]\# cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=kubernetes kube-scheduler-csr.json | cfssljson -bare kube-scheduler2021/09/02 14:50:40 [INFO] generate received request2021/09/02 14:50:40 [INFO] received CSR2021/09/02 14:50:40 [INFO] generating key: rsa-20482021/09/02 14:50:42 [INFO] encoded CSR2021/09/02 14:50:42 [INFO] signed certificate with serial number 913888520502908486634984414808625325269477593932021/09/02 14:50:42 [WARNING] This certificate lacks a &#x22;hosts&#x22; field. This makes it unsuitable forwebsites. For more information see the Baseline Requirements for the Issuance and Managementof Publicly-Trusted Certificates, v.1.1.6, from the CA/Browser Forum (https://cabforum.org);specifically, section 10.2.3 (&#x22;Information Requirements&#x22;).3.Êü•ÁúãËØÅ‰π¶Êñá‰ª∂[root@binary-k8s-master1 ~/TLS/k8s]\# llÊÄªÁî®Èáè 68-rw-r--r--. 1 root root  294 9Êúà   1 16:20 ca-config.json-rw-r--r--. 1 root root 1001 9Êúà   1 16:20 ca.csr-rw-r--r--. 1 root root  264 9Êúà   1 16:20 ca-csr.json-rw-------. 1 root root 1679 9Êúà   1 16:20 ca-key.pem-rw-r--r--. 1 root root 1359 9Êúà   1 16:20 ca.pem-rw-r--r--. 1 root root 1277 9Êúà   1 16:30 kube-apiserver.csr-rw-r--r--. 1 root root  602 9Êúà   1 16:30 kube-apiserver-csr.json-rw-------. 1 root root 1679 9Êúà   1 16:30 kube-apiserver-key.pem-rw-r--r--. 1 root root 1643 9Êúà   1 16:30 kube-apiserver.pem-rw-r--r--. 1 root root 1045 9Êúà   1 16:36 kube-controller-manager.csr-rw-r--r--. 1 root root  255 9Êúà   1 16:46 kube-controller-manager-csr.json-rw-------. 1 root root 1675 9Êúà   1 16:36 kube-controller-manager-key.pem-rw-r--r--. 1 root root 1436 9Êúà   1 16:36 kube-controller-manager.pem-rw-r--r--. 1 root root 1029 9Êúà   2 14:50 kube-scheduler.csr-rw-r--r--. 1 root root  245 9Êúà   2 14:50 kube-scheduler-csr.json-rw-------. 1 root root 1675 9Êúà   2 14:50 kube-scheduler-key.pem-rw-r--r--. 1 root root 1424 9Êúà   2 14:50 kube-scheduler.pem4.Êã∑Ë¥ùËØÅ‰π¶Êñá‰ª∂Ëá≥ÊåáÂÆöË∑ØÂæÑ[root@binary-k8s-master1 ~/TLS/k8s]\# cp kube-scheduler*.pem /data/kubernetes/ssl/5.ÁîüÊàêkubeconfigÊñá‰ª∂[root@binary-k8s-master1 ~]\# kubectl config set-cluster kubernetes \--certificate-authority=/data/kubernetes/ssl/ca.pem \--embed-certs=true \--server=&#x22;https://192.168.20.10:6443&#x22; \--kubeconfig=/data/kubernetes/config/kube-scheduler.kubeconfig[root@binary-k8s-master1 ~]\# kubectl config set-credentials kube-scheduler \--client-certificate=/data/kubernetes/ssl/kube-scheduler.pem \--client-key=/data/kubernetes/ssl/kube-scheduler-key.pem \--embed-certs=true \--kubeconfig=/data/kubernetes/config/kube-scheduler.kubeconfig[root@binary-k8s-master1 ~]\# kubectl config set-context default \--cluster=kubernetes \--user=kube-scheduler \--kubeconfig=/data/kubernetes/config/kube-scheduler.kubeconfig6.ÊåáÂÆöÁîüÊàêÁöÑkubeconfigÊñá‰ª∂‰∏∫ÈõÜÁæ§‰ΩøÁî®[root@binary-k8s-master1 ~]\# kubectl config use-context default --kubeconfig=/data/kubernetes/config/kube-scheduler.kubeconfig"><div></div></button></div></figure></div>
<h4 id="553ÂàõÂª∫systemctlËÑöÊú¨ÁÆ°ÁêÜÊúçÂä°">5.5.3.ÂàõÂª∫systemctlËÑöÊú¨ÁÆ°ÁêÜÊúçÂä°</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /usr/lib/systemd/system/kube-scheduler.service</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[Unit]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">Description</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">Kubernetes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">Scheduler</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">Documentation</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">https://github.com/kubernetes/kubernetes</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[Service]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">EnvironmentFile</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/config/kube-scheduler.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ExecStart</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/bin/kube-scheduler</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">$KUBE_SCHEDULER_OPTS</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">Restart</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">on-failure</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[Install]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">WantedBy</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">multi-user.target</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 ~]\# vim /usr/lib/systemd/system/kube-scheduler.service[Unit]Description=Kubernetes SchedulerDocumentation=https://github.com/kubernetes/kubernetes[Service]EnvironmentFile=/data/kubernetes/config/kube-scheduler.confExecStart=/data/kubernetes/bin/kube-scheduler $KUBE_SCHEDULER_OPTSRestart=on-failure[Install]WantedBy=multi-user.target"><div></div></button></div></figure></div>
<h4 id="554ÂêØÂä®kube-schedulerÁªÑ‰ª∂">5.5.4.ÂêØÂä®kube-schedulerÁªÑ‰ª∂</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.ÂêØÂä®ÊúçÂä°</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl daemon-reload</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl start kube-scheduler</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl enable kube-scheduler</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.Êü•ÁúãÁ´ØÂè£</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> netstat -lnpt </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">grep</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#ECC48D;--1:#3C63B3">.20.10:6443</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0:</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">28546</span><span style="--0:#ECC48D;--1:#3C63B3">/kube-apiserve</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#ECC48D;--1:#3C63B3">.20.10:10257</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0:</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">28941</span><span style="--0:#ECC48D;--1:#3C63B3">/kube-controll</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#ECC48D;--1:#3C63B3">.20.10:10259</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0:</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">6127</span><span style="--0:#ECC48D;--1:#3C63B3">/kube-scheduler</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp6</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">:::10251</span><span style="--0:#D6DEEB;--1:#403F53">                </span><span style="--0:#ECC48D;--1:#3C63B3">:::</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">                    </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">6127</span><span style="--0:#ECC48D;--1:#3C63B3">/kube-scheduler</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp6</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">:::10252</span><span style="--0:#D6DEEB;--1:#403F53">                </span><span style="--0:#ECC48D;--1:#3C63B3">:::</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">                    </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">28941</span><span style="--0:#ECC48D;--1:#3C63B3">/kube-controll</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.ÂêØÂä®ÊúçÂä°[root@binary-k8s-master1 ~]\# systemctl daemon-reload[root@binary-k8s-master1 ~]\# systemctl start kube-scheduler[root@binary-k8s-master1 ~]\# systemctl enable kube-scheduler2.Êü•ÁúãÁ´ØÂè£[root@binary-k8s-master1 ~]\# netstat -lnpt | grep kubetcp        0      0 192.168.20.10:6443      0.0.0.0:*               LISTEN      28546/kube-apiservetcp        0      0 192.168.20.10:10257     0.0.0.0:*               LISTEN      28941/kube-controlltcp        0      0 192.168.20.10:10259     0.0.0.0:*               LISTEN      6127/kube-schedulertcp6       0      0 :::10251                :::*                    LISTEN      6127/kube-schedulertcp6       0      0 :::10252                :::*                    LISTEN      28941/kube-controll"><div></div></button></div></figure></div>
<h3 id="56ÂáÜÂ§ákubectlÊâÄÈúÄÁöÑkubeconfigÊñá‰ª∂ËøûÊé•ÈõÜÁæ§">5.6.ÂáÜÂ§ákubectlÊâÄÈúÄÁöÑkubeconfigÊñá‰ª∂ËøûÊé•ÈõÜÁæ§</h3>
<p>kubectlÊÉ≥Ë¶ÅËøûÊé•ÈõÜÁæ§ÂØπÂêÑÁßçËµÑÊ∫êËøõË°åÊìç‰ΩúÔºåÈúÄË¶ÅÊúâ‰∏Ä‰∏™kubeconfigÊñá‰ª∂ËøûÊé•apiserverÊâçÂèØ‰ª•ÂØπÈõÜÁæ§ËøõË°åÊìç‰ΩúÔºå‰πüÂ∞±ÊòØkubeadmÂÆâË£Ök8sÈõÜÁæ§ÂêéÂú®masterËäÇÁÇπÁîüÊàêÁöÑ/root/.kubeÁõÆÂΩïÔºåËøô‰∏™ÁõÆÂΩï‰∏≠ÁöÑconfigÊñá‰ª∂Â∞±ÊòØkubectlÁî®‰∫éËøûÊé•apiserverÁöÑkubeconfigÊñá‰ª∂„ÄÇ</p>
<h4 id="561ÁîüÊàêËØÅ‰π¶Êñá‰ª∂">5.6.1.ÁîüÊàêËØÅ‰π¶Êñá‰ª∂</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.ÂàõÂª∫ËØÅ‰π¶ÈÖçÁΩÆÊñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/TLS/k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim kubectl-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"CN"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">kubectl</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"hosts"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [],</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"key"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"algo"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">rsa</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"size"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">2048</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">},</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"names"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"C"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">CN</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"L"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">BeiJing</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"ST"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">BeiJing</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"O"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">system:masters</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"OU"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">System</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.ÁîüÊàêËØÅ‰π¶</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/TLS/k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=kubernetes kubectl-csr.json </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">cfssljson</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-bare</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubectl</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/02</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">:20:44</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] generate received request</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/02</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">:20:44</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] received CSR</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/02</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">:20:44</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] generating key: rsa-2048</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/02</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">:20:45</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] encoded CSR</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/02</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">:20:45</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] signed certificate with serial number 398472525484598388169457456772550114435870340604</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/02</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">:20:45</span><span style="--0:#D6DEEB;--1:#403F53"> [WARNING] This certificate lacks a </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">hosts</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> field. This makes it unsuitable </span><span style="--0:#C792EA;--1:#8D46B4">for</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">websites.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">For</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">more</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">information</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">see</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">the</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Baseline</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Requirements</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">for</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">the</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Issuance</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">and</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Management</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">of</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Publicly-Trusted</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Certificates,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">v.1.1.6,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">the</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">CA/Browser</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Forum</span><span style="--0:#D6DEEB;--1:#403F53"> (https://cabforum.org);</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">specifically,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">section</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10.2</span><span style="--0:#ECC48D;--1:#3C63B3">.3</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Information Requirements</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">).</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.Êü•ÁúãÁîüÊàêÁöÑËØÅ‰π¶Êñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/TLS/k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> ll</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">ÊÄªÁî®Èáè</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">84</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">294</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:20</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca-config.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1001</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:20</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca.csr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">264</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:20</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-------.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1679</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:20</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca-key.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1359</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:20</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ca.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1277</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:30</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-apiserver.csr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">602</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:30</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-apiserver-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-------.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1679</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:30</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-apiserver-key.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1643</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:30</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-apiserver.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1045</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:36</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-controller-manager.csr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">255</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:46</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-controller-manager-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-------.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1675</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:36</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-controller-manager-key.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1436</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:36</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-controller-manager.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1013</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">:20</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubectl.csr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">231</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">:20</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubectl-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-------.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1679</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">:20</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubectl-key.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1403</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">17</span><span style="--0:#ECC48D;--1:#3C63B3">:20</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubectl.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1029</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">14</span><span style="--0:#ECC48D;--1:#3C63B3">:50</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-scheduler.csr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">245</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">14</span><span style="--0:#ECC48D;--1:#3C63B3">:50</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-scheduler-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-------.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1675</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">14</span><span style="--0:#ECC48D;--1:#3C63B3">:50</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-scheduler-key.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1424</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">14</span><span style="--0:#ECC48D;--1:#3C63B3">:50</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-scheduler.pem</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">4.Êã∑Ë¥ùËØÅ‰π¶Êñá‰ª∂Âà∞ÊåáÂÆöÁõÆÂΩï</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/TLS/k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\c</span><span style="--0:#D6DEEB;--1:#403F53">p kubectl</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">.pem /data/kubernetes/ssl/</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.ÂàõÂª∫ËØÅ‰π¶ÈÖçÁΩÆÊñá‰ª∂[root@binary-k8s-master1 ~/TLS/k8s]\# vim kubectl-csr.json{  &#x22;CN&#x22;: &#x22;kubectl&#x22;,  &#x22;hosts&#x22;: [],  &#x22;key&#x22;: {    &#x22;algo&#x22;: &#x22;rsa&#x22;,    &#x22;size&#x22;: 2048  },  &#x22;names&#x22;: [    {      &#x22;C&#x22;: &#x22;CN&#x22;,      &#x22;L&#x22;: &#x22;BeiJing&#x22;,      &#x22;ST&#x22;: &#x22;BeiJing&#x22;,      &#x22;O&#x22;: &#x22;system:masters&#x22;,      &#x22;OU&#x22;: &#x22;System&#x22;    }  ]}2.ÁîüÊàêËØÅ‰π¶[root@binary-k8s-master1 ~/TLS/k8s]\# cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=kubernetes kubectl-csr.json | cfssljson -bare kubectl2021/09/02 17:20:44 [INFO] generate received request2021/09/02 17:20:44 [INFO] received CSR2021/09/02 17:20:44 [INFO] generating key: rsa-20482021/09/02 17:20:45 [INFO] encoded CSR2021/09/02 17:20:45 [INFO] signed certificate with serial number 3984725254845983881694574567725501144358703406042021/09/02 17:20:45 [WARNING] This certificate lacks a &#x22;hosts&#x22; field. This makes it unsuitable forwebsites. For more information see the Baseline Requirements for the Issuance and Managementof Publicly-Trusted Certificates, v.1.1.6, from the CA/Browser Forum (https://cabforum.org);specifically, section 10.2.3 (&#x22;Information Requirements&#x22;).3.Êü•ÁúãÁîüÊàêÁöÑËØÅ‰π¶Êñá‰ª∂[root@binary-k8s-master1 ~/TLS/k8s]\# llÊÄªÁî®Èáè 84-rw-r--r--. 1 root root  294 9Êúà   1 16:20 ca-config.json-rw-r--r--. 1 root root 1001 9Êúà   1 16:20 ca.csr-rw-r--r--. 1 root root  264 9Êúà   1 16:20 ca-csr.json-rw-------. 1 root root 1679 9Êúà   1 16:20 ca-key.pem-rw-r--r--. 1 root root 1359 9Êúà   1 16:20 ca.pem-rw-r--r--. 1 root root 1277 9Êúà   1 16:30 kube-apiserver.csr-rw-r--r--. 1 root root  602 9Êúà   1 16:30 kube-apiserver-csr.json-rw-------. 1 root root 1679 9Êúà   1 16:30 kube-apiserver-key.pem-rw-r--r--. 1 root root 1643 9Êúà   1 16:30 kube-apiserver.pem-rw-r--r--. 1 root root 1045 9Êúà   1 16:36 kube-controller-manager.csr-rw-r--r--. 1 root root  255 9Êúà   1 16:46 kube-controller-manager-csr.json-rw-------. 1 root root 1675 9Êúà   1 16:36 kube-controller-manager-key.pem-rw-r--r--. 1 root root 1436 9Êúà   1 16:36 kube-controller-manager.pem-rw-r--r--. 1 root root 1013 9Êúà   2 17:20 kubectl.csr-rw-r--r--. 1 root root  231 9Êúà   2 17:20 kubectl-csr.json-rw-------. 1 root root 1679 9Êúà   2 17:20 kubectl-key.pem-rw-r--r--. 1 root root 1403 9Êúà   2 17:20 kubectl.pem-rw-r--r--. 1 root root 1029 9Êúà   2 14:50 kube-scheduler.csr-rw-r--r--. 1 root root  245 9Êúà   2 14:50 kube-scheduler-csr.json-rw-------. 1 root root 1675 9Êúà   2 14:50 kube-scheduler-key.pem-rw-r--r--. 1 root root 1424 9Êúà   2 14:50 kube-scheduler.pem4.Êã∑Ë¥ùËØÅ‰π¶Êñá‰ª∂Âà∞ÊåáÂÆöÁõÆÂΩï[root@binary-k8s-master1 ~/TLS/k8s]\# \cp kubectl*.pem /data/kubernetes/ssl/"><div></div></button></div></figure></div>
<h4 id="562ÁîüÊàêkubeconfigÊñá‰ª∂">5.6.2.ÁîüÊàêkubeconfigÊñá‰ª∂</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.Âú®kubeconfigÊñá‰ª∂‰∏≠Â¢ûÂä†ÈõÜÁæ§apiserver‰ø°ÊÅØ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl config set-cluster kubernetes \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--certificate-authority</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/ssl/ca.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--embed-certs</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--server</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.10:6443</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--kubeconfig</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/root/.kube/config</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.Âú®kubeconfigÊñá‰ª∂‰∏≠Â¢ûÂä†ËØÅ‰π¶Êñá‰ª∂‰ø°ÊÅØ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl config set-credentials cluster-admin \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--client-certificate</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/ssl/kubectl.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--client-key</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/ssl/kubectl-key.pem</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--embed-certs</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--kubeconfig</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/root/.kube/config</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.Âú®kubeconfigÊñá‰ª∂‰∏≠Â¢ûÂä†Áî®Êà∑‰ø°ÊÅØ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl config set-context default \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--cluster</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--user</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">cluster-admin</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--kubeconfig</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/root/.kube/config</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">4.ÊåáÂÆöÁîüÊàêÁöÑkubeconfigÊñá‰ª∂‰∏∫ÈõÜÁæ§‰ΩøÁî®</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl config use-context default --kubeconfig=/root/.kube/config</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.Âú®kubeconfigÊñá‰ª∂‰∏≠Â¢ûÂä†ÈõÜÁæ§apiserver‰ø°ÊÅØ[root@binary-k8s-master1 ~]\# kubectl config set-cluster kubernetes \--certificate-authority=/data/kubernetes/ssl/ca.pem \--embed-certs=true \--server=&#x22;https://192.168.20.10:6443&#x22; \--kubeconfig=/root/.kube/config2.Âú®kubeconfigÊñá‰ª∂‰∏≠Â¢ûÂä†ËØÅ‰π¶Êñá‰ª∂‰ø°ÊÅØ[root@binary-k8s-master1 ~]\# kubectl config set-credentials cluster-admin \--client-certificate=/data/kubernetes/ssl/kubectl.pem \--client-key=/data/kubernetes/ssl/kubectl-key.pem  \--embed-certs=true \--kubeconfig=/root/.kube/config3.Âú®kubeconfigÊñá‰ª∂‰∏≠Â¢ûÂä†Áî®Êà∑‰ø°ÊÅØ[root@binary-k8s-master1 ~]\# kubectl config set-context default \--cluster=kubernetes \--user=cluster-admin \--kubeconfig=/root/.kube/config4.ÊåáÂÆöÁîüÊàêÁöÑkubeconfigÊñá‰ª∂‰∏∫ÈõÜÁæ§‰ΩøÁî®[root@binary-k8s-master1 ~]\# kubectl config use-context default --kubeconfig=/root/.kube/config"><div></div></button></div></figure></div>
<h4 id="563‰ΩøÁî®kubectlÊü•ÁúãÈõÜÁæ§ËøûÊé•‰ø°ÊÅØ">5.6.3.‰ΩøÁî®kubectlÊü•ÁúãÈõÜÁæ§ËøûÊé•‰ø°ÊÅØ</h4>
<p>Ëá≥Ê≠§masterËäÇÁÇπÁõ∏ÂÖ≥ÁªÑ‰ª∂ÈÉ®ÁΩ≤ÂÆåÊàê„ÄÇ</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get node</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">No</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">resources</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">found</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get cs</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">Warning:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">v1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ComponentStatus</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">is</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">deprecated</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">in</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">v1.19+</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                 </span><span style="--0:#ECC48D;--1:#3C63B3">STATUS</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">MESSAGE</span><span style="--0:#D6DEEB;--1:#403F53">             </span><span style="--0:#ECC48D;--1:#3C63B3">ERROR</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">scheduler</span><span style="--0:#D6DEEB;--1:#403F53">            </span><span style="--0:#ECC48D;--1:#3C63B3">Healthy</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">ok</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">controller-manager</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">Healthy</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">ok</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">etcd-1</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">Healthy</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">{</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">health</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">:</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">true</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">etcd-0</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">Healthy</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">{</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">health</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">:</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">true</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">etcd-2</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">Healthy</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">{</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">health</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">:</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">true</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 ~]\# kubectl get nodeNo resources found[root@binary-k8s-master1 ~]\# kubectl get csWarning: v1 ComponentStatus is deprecated in v1.19+NAME                 STATUS    MESSAGE             ERRORscheduler            Healthy   okcontroller-manager   Healthy   oketcd-1               Healthy   {&#x22;health&#x22;:&#x22;true&#x22;}etcd-0               Healthy   {&#x22;health&#x22;:&#x22;true&#x22;}etcd-2               Healthy   {&#x22;health&#x22;:&#x22;true&#x22;}"><div></div></button></div></figure></div>
<p><img src="https://cdn.agou-ops.cn/others/8ea5953c67f6460facc684905acb502c.png" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞"></p>
<h2 id="6Âú®masterËäÇÁÇπÈÉ®ÁΩ≤nodeËäÇÁÇπÁõ∏ÂÖ≥ÁªÑ‰ª∂">6.Âú®masterËäÇÁÇπÈÉ®ÁΩ≤nodeËäÇÁÇπÁõ∏ÂÖ≥ÁªÑ‰ª∂</h2>
<h3 id="61Âú®ÈõÜÁæ§ÊéàÊùÉkubelet-bootstrapÁî®Êà∑ÂÖÅËÆ∏ËØ∑Ê±ÇËØÅ‰π¶">6.1.Âú®ÈõÜÁæ§ÊéàÊùÉkubelet-bootstrapÁî®Êà∑ÂÖÅËÆ∏ËØ∑Ê±ÇËØÅ‰π¶</h3>
<p>Âú®Ê≠§Â§ÑÂÅö‰∫ÜËøô‰∏ÄÊ≠•‰πãÂêéÔºånodeËäÇÁÇπÂä†ÂÖ•ÈõÜÁæ§Êó∂Â∞±‰∏çÈúÄË¶ÅÂÅö‰∫Ü„ÄÇ</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl create clusterrolebinding kubelet-bootstrap \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--clusterrole</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">system:node-bootstrapper</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--user</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">kubelet-bootstrap</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 ~]\# kubectl create clusterrolebinding kubelet-bootstrap \--clusterrole=system:node-bootstrapper \--user=kubelet-bootstrap"><div></div></button></div></figure></div>
<h3 id="62Âú®masterËäÇÁÇπÈÉ®ÁΩ≤kubeletÁªÑ‰ª∂">6.2.Âú®masterËäÇÁÇπÈÉ®ÁΩ≤kubeletÁªÑ‰ª∂</h3>
<p>Áî±‰∫émaster‰πüÈúÄË¶ÅÂêØÂä®Êüê‰∫õpodÔºåÊØîÂ¶ÇcalicoÁªÑ‰ª∂ÈÉΩÊòØ‰ª•podÊñπÂºèËøêË°åÁöÑÔºåÂõ†Ê≠§Âú®masterËäÇÁÇπ‰πüÈúÄË¶ÅkubeletÂíåkube-proxyÁªÑ‰ª∂„ÄÇ</p>
<h4 id="621Â∞ÜkubeletÂíåkube-proxyÁöÑ‰∫åËøõÂà∂Êñá‰ª∂Êã∑Ë¥ùËá≥ÂØπÂ∫îÁõÆÂΩï">6.2.1.Â∞ÜkubeletÂíåkube-proxyÁöÑ‰∫åËøõÂà∂Êñá‰ª∂Êã∑Ë¥ùËá≥ÂØπÂ∫îÁõÆÂΩï</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cp kubernetes/server/bin/{</span><span style="--0:#82AAFF;--1:#3C63B3">kubelet,kube-proxy}</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/bin/</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 ~]\# cp kubernetes/server/bin/{kubelet,kube-proxy} /data/kubernetes/bin/"><div></div></button></div></figure></div>
<h4 id="622ÂàõÂª∫kubeletÈÖçÁΩÆÊñá‰ª∂">6.2.2.ÂàõÂª∫kubeletÈÖçÁΩÆÊñá‰ª∂</h4>
<blockquote>
<p>ÈÖçÁΩÆÊñá‰ª∂Âê´‰πâÔºö</p>
<p>‚Äìhostname-overrideÔºöËäÇÁÇπÂêçÁß∞ÔºåÈõÜÁæ§‰∏≠ÂîØ‰∏Ä</p>
<p>‚Äìnetwork-pluginÔºöÂêØÁî®CNIÁΩëÁªú</p>
<p>‚ÄìkubeconfigÔºöÊåáÂÆöËá™Âä®ÁîüÊàêÁöÑkubeconfigÊñá‰ª∂Ë∑ØÂæÑÔºåÁî®‰∫éËøûÊé•apiserver</p>
<p>‚Äìbootstrap-kubeconfigÔºöÊåáÂÆöÈ¶ñÊ¨°ÂêØÂä®ÂêëapiserverÁî≥ËØ∑ËØÅ‰π¶ÁöÑkubeconfigÊñá‰ª∂Ë∑ØÂæÑ</p>
<p>‚ÄìconfigÔºöÈÖçÁΩÆÂèÇÊï∞Êñá‰ª∂Ë∑ØÂæÑ</p>
<p>‚Äìcert-dirÔºökubeletËØÅ‰π¶ÁîüÊàêÁõÆÂΩïË∑ØÂæÑ</p>
<p>‚Äìpod-infra-container-imageÔºöpodÂÆπÂô®ÁöÑÊ†πÂÆπÂô®</p>
</blockquote>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /data/kubernetes/config/kubelet.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">KUBELET_OPTS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">--logtostderr=false </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--v=2 </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--log-dir=/data/kubernetes/logs </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--hostname-override=binary-k8s-master1 </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--network-plugin=cni </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--kubeconfig=/data/kubernetes/config/kubelet.kubeconfig </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--bootstrap-kubeconfig=/data/kubernetes/config/bootstrap.kubeconfig </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--config=/data/kubernetes/config/kubelet-config.yml </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--cert-dir=/data/kubernetes/ssl </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--pod-infra-container-image=pause-amd64:3.0</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 ~]\# vim /data/kubernetes/config/kubelet.confKUBELET_OPTS=&#x22;--logtostderr=false \--v=2 \--log-dir=/data/kubernetes/logs \--hostname-override=binary-k8s-master1 \--network-plugin=cni \--kubeconfig=/data/kubernetes/config/kubelet.kubeconfig \--bootstrap-kubeconfig=/data/kubernetes/config/bootstrap.kubeconfig \--config=/data/kubernetes/config/kubelet-config.yml \--cert-dir=/data/kubernetes/ssl \--pod-infra-container-image=pause-amd64:3.0&#x22;"><div></div></button></div></figure></div>
<h4 id="623ÂàõÂª∫kubelet-configyamlÂèÇÊï∞ÈÖçÁΩÆÊñá‰ª∂">6.2.3.ÂàõÂª∫kubelet-config.yamlÂèÇÊï∞ÈÖçÁΩÆÊñá‰ª∂</h4>
<p>kubeletÂíåkube-proxyÊúçÂä°ÁöÑÂèÇÊï∞ÈÖçÁΩÆÊòØ‰ª•yamlÂΩ¢ÂºèÊù•ÈÖçÁΩÆÁöÑ</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /data/kubernetes/config/kubelet-config.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">KubeletConfiguration</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">apiVersion:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubelet.config.k8s.io/v1beta1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">address:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#809191;--1:#616671">#ÁõëÂê¨Âú∞ÂùÄ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">port:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10250</span><span style="--0:#D6DEEB;--1:#403F53">            </span><span style="--0:#809191;--1:#616671">#ÁõëÂê¨Á´ØÂè£</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">readOnlyPort:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10255</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">cgroupDriver:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">cgroupfs</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#809191;--1:#616671">#È©±Âä®ÂºïÊìé</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">clusterDNS:</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.2</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">clusterDomain:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">cluster.local</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">failSwapOn:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">false</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">authentication:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">anonymous:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">enabled:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">false</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">webhook:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">cacheTTL:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">m0s</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">enabled:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">x509:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">clientCAFile:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/ssl/ca.pem</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#809191;--1:#616671">#caËØÅ‰π¶Êñá‰ª∂Ë∑ØÂæÑ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">authorization:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">mode:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Webhook</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">webhook:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">cacheAuthorizedTTL:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">5</span><span style="--0:#ECC48D;--1:#3C63B3">m0s</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">cacheUnauthorizedTTL:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">30</span><span style="--0:#ECC48D;--1:#3C63B3">s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">evictionHard:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">imagefs.available:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">15</span><span style="--0:#ECC48D;--1:#3C63B3">%</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">memory.available:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">100</span><span style="--0:#ECC48D;--1:#3C63B3">Mi</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">nodefs.available:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10</span><span style="--0:#ECC48D;--1:#3C63B3">%</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">nodefs.inodesFree:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">5</span><span style="--0:#ECC48D;--1:#3C63B3">%</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">maxOpenFiles:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1000000</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">maxPods:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">110</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#809191;--1:#616671">#ÂèØËøêË°åÁöÑpodÁöÑÊï∞Èáè</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 ~]\# vim /data/kubernetes/config/kubelet-config.ymlkind: KubeletConfigurationapiVersion: kubelet.config.k8s.io/v1beta1address: 0.0.0.0        #ÁõëÂê¨Âú∞ÂùÄport: 10250            #ÁõëÂê¨Á´ØÂè£readOnlyPort: 10255cgroupDriver: cgroupfs      #È©±Âä®ÂºïÊìéclusterDNS:- 10.0.0.2clusterDomain: cluster.localfailSwapOn: falseauthentication:  anonymous:    enabled: false  webhook:    cacheTTL: 2m0s    enabled: true  x509:    clientCAFile: /data/kubernetes/ssl/ca.pem    #caËØÅ‰π¶Êñá‰ª∂Ë∑ØÂæÑauthorization:  mode: Webhook  webhook:    cacheAuthorizedTTL: 5m0s    cacheUnauthorizedTTL: 30sevictionHard:  imagefs.available: 15%  memory.available: 100Mi  nodefs.available: 10%  nodefs.inodesFree: 5%maxOpenFiles: 1000000maxPods: 110        #ÂèØËøêË°åÁöÑpodÁöÑÊï∞Èáè"><div></div></button></div></figure></div>
<h4 id="624ÂàõÂª∫bootstrap-kubeconfigÊñá‰ª∂">6.2.4.ÂàõÂª∫bootstrap-kubeconfigÊñá‰ª∂</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.Âú®kubeconfigÊñá‰ª∂‰∏≠Â¢ûÂä†ÈõÜÁæ§apiserver‰ø°ÊÅØ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl config set-cluster kubernetes \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--certificate-authority</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/ssl/ca.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--embed-certs</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--server</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.10:6443</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--kubeconfig</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/config/bootstrap.kubeconfig</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.Âú®kubeconfigÊñá‰ª∂‰∏≠Â¢ûÂä†token‰ø°ÊÅØ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl config set-credentials </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">kubelet-bootstrap</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--token</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">d7f96b0d86c574d0f64a713608db0922</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--kubeconfig</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/config/bootstrap.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#Ëøô‰∏™tokenÂ∞±ÊòØ‰πãÂâçÁîüÊàêÁöÑ/data/kubernetes/config/token.csv‰∏≠ÁöÑtoken</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.Âú®kubeconfigÊñá‰ª∂‰∏≠Â¢ûÂä†Áî®Êà∑‰ø°ÊÅØ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl config set-context default \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--cluster</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--user</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">kubelet-bootstrap</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--kubeconfig</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/config/bootstrap.kubeconfig</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">4.ÊåáÂÆöÁîüÊàêÁöÑkubeconfigÊñá‰ª∂‰∏∫ÈõÜÁæ§‰ΩøÁî®</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl config use-context default --kubeconfig=/data/kubernetes/config/bootstrap.kubeconfig</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.Âú®kubeconfigÊñá‰ª∂‰∏≠Â¢ûÂä†ÈõÜÁæ§apiserver‰ø°ÊÅØ[root@binary-k8s-master1 ~]\# kubectl config set-cluster kubernetes \--certificate-authority=/data/kubernetes/ssl/ca.pem \--embed-certs=true \--server=&#x22;https://192.168.20.10:6443&#x22; \--kubeconfig=/data/kubernetes/config/bootstrap.kubeconfig2.Âú®kubeconfigÊñá‰ª∂‰∏≠Â¢ûÂä†token‰ø°ÊÅØ[root@binary-k8s-master1 ~]\# kubectl config set-credentials &#x22;kubelet-bootstrap&#x22; \--token=d7f96b0d86c574d0f64a713608db0922 \--kubeconfig=/data/kubernetes/config/bootstrap.kubeconfig3.Âú®kubeconfigÊñá‰ª∂‰∏≠Â¢ûÂä†Áî®Êà∑‰ø°ÊÅØ[root@binary-k8s-master1 ~]\# kubectl config set-context default \--cluster=kubernetes \--user=&#x22;kubelet-bootstrap&#x22; \--kubeconfig=/data/kubernetes/config/bootstrap.kubeconfig4.ÊåáÂÆöÁîüÊàêÁöÑkubeconfigÊñá‰ª∂‰∏∫ÈõÜÁæ§‰ΩøÁî®[root@binary-k8s-master1 ~]\# kubectl config use-context default --kubeconfig=/data/kubernetes/config/bootstrap.kubeconfig"><div></div></button></div></figure></div>
<h4 id="625ÂàõÂª∫systemctlËÑöÊú¨Âπ∂ÂêØÂä®ÊúçÂä°">6.2.5.ÂàõÂª∫systemctlËÑöÊú¨Âπ∂ÂêØÂä®ÊúçÂä°</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.ÂàõÂª∫systemctlËÑöÊú¨</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /usr/lib/systemd/system/kubelet.service</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[Unit]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">Description</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">Kubernetes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">Kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">After</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">docker.service</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[Service]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">EnvironmentFile</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/config/kubelet.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ExecStart</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/bin/kubelet</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">$KUBELET_OPTS</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">Restart</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">on-failure</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">LimitNOFILE</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">65536</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[Install]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">WantedBy</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">multi-user.target</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.ÂêØÂä®kubeletÊúçÂä°</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl daemon-reload</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl start kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl enable kubelet</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.ÂàõÂª∫systemctlËÑöÊú¨[root@binary-k8s-master1 ~]\# vim /usr/lib/systemd/system/kubelet.service[Unit]Description=Kubernetes KubeletAfter=docker.service[Service]EnvironmentFile=/data/kubernetes/config/kubelet.confExecStart=/data/kubernetes/bin/kubelet $KUBELET_OPTSRestart=on-failureLimitNOFILE=65536[Install]WantedBy=multi-user.target2.ÂêØÂä®kubeletÊúçÂä°[root@binary-k8s-master1 ~]\# systemctl daemon-reload[root@binary-k8s-master1 ~]\# systemctl start kubelet[root@binary-k8s-master1 ~]\# systemctl enable kubelet"><div></div></button></div></figure></div>
<h4 id="626Â∞ÜmasterËäÇÁÇπ‰Ωú‰∏∫nodeÂä†ÂÖ•ÈõÜÁæ§ÂÜÖÈÉ®">6.2.6.Â∞ÜmasterËäÇÁÇπ‰Ωú‰∏∫nodeÂä†ÂÖ•ÈõÜÁæ§ÂÜÖÈÉ®</h4>
<p>ÂΩìkubeletÁªÑ‰ª∂ÂêØÂä®ÊàêÂäüÂêéÔºåÂ∞±‰ºöÊÉ≥apiserverÂèëÈÄÅ‰∏Ä‰∏™ËØ∑Ê±ÇÂä†ÂÖ•ÈõÜÁæ§ÁöÑ‰ø°ÊÅØÔºåÂè™ÊúâÂΩìmasterËäÇÁÇπÊéàÊùÉÂêåÊÑèÂêéÔºåÊâçÂèØ‰ª•Ê≠£Â∏∏Âä†ÂÖ•ÔºåËôΩÁÑ∂ÊòØmasterËäÇÁÇπÈÉ®ÁΩ≤ÁöÑnodeÁªÑ‰ª∂Ôºå‰ΩÜÊòØ‰πü‰ºöÂèëÁîü‰∏Ä‰∏™Âä†ÂÖ•ÈõÜÁæ§ÁöÑ‰ø°ÊÅØÔºåÈúÄË¶ÅmasterÂêåÊÑè„ÄÇ</p>
<p>ÂΩìkubeletÂêØÂä®‰πãÂêéÔºåÈ¶ñÂÖà‰ºöÂú®ËØÅ‰π¶ÁõÆÂΩïÁîüÊàê‰∏Ä‰∏™kubelet-client.key.tmpËøô‰∏™Êñá‰ª∂ÔºåÂΩì‰ΩøÁî®kubectl certificate approveÂëΩ‰ª§ÊéàÊùÉÊàêÂäünodeÁöÑËØ∑Ê±Ç‰πãÂêéÔºåkubelet-client.key.tmpÂ∞èÊó∂ÔºåÈöè‰πã‰ºöÁîüÊàê‰∏Ä‰∏™kubelet-client-current.pemÁöÑËØÅ‰π¶Êñá‰ª∂ÔºåÁî®‰∫é‰∏éapiserverÂª∫Á´ãËøûÊé•ÔºåÊ≠§Êó∂ÂÜç‰ΩøÁî®kubectl get nodeÂ∞±‰ºöÁúãÂà∞ËäÇÁÇπ‰ø°ÊÅØ‰∫Ü„ÄÇ</p>
<p>Êâ©Â±ïÔºöÂ¶ÇÊûúÂêéÊúüÊÉ≥Ë¶Å‰øÆÊîπnodeÁöÑÂêçÁß∞ÔºåÈÇ£‰πàÂ∞±ÊääÁîüÊàêÁöÑkubeletËØÅ‰π¶Êñá‰ª∂ÂÖ®ÈÉ®Âà†Èô§ÔºåÁÑ∂Âêé‰ΩøÁî®kubectl delete nodeÂà†Èô§ËØ•ËäÇÁÇπÔºåÂú®‰øÆÊîπkubeletÈÖçÁΩÆÊñá‰ª∂‰∏≠ËØ•ËäÇÁÇπÁöÑÂêçÁß∞ÔºåÁÑ∂Âêé‰ΩøÁî®kubectl delete csrÂà†Èô§ÊéàÊùÉ‰ø°ÊÅØÔºåÂÜçÈáçÂêØkubeletÁîüÊàêÊñ∞ÁöÑÊéàÊùÉ‰ø°ÊÅØÔºåÁÑ∂ÂêéÊéàÊùÉÈÄöËøáÂç≥ÂèØÁúãÂà∞Êñ∞ÁöÑÂêçÂ≠óÁöÑnodeËäÇÁÇπ„ÄÇ</p>
<p>Âè™ÊúâÂΩìÊéàÊùÉÈÄöËøáÂêéÔºåkubeletÁîüÊàê‰∫ÜËØÅ‰π¶Êñá‰ª∂ÔºåkubeletÁöÑÁ´ØÂè£Êâç‰ºöË¢´ÂêØÂä®</p>
<p>Ê≥®ÊÑèÔºöÂΩìkubeletÁöÑÊéàÊùÉË¢´masterËØ∑Ê±ÇÈÄöÂêéÔºåkube-proxyÂêØÂä®ÊàêÂäüÂêéÔºåËäÇÁÇπÊâç‰ºöÊ≠£ÁúüÁöÑÂä†ÂÖ•ÈõÜÁæ§ÔºåÂç≥‰Ωøkubectl get nodeÁúãÂà∞ÁöÑËäÇÁÇπÊòØReadyÔºåËØ•ËäÇÁÇπ‰πüÊòØ‰∏çÂèØÁî®ÁöÑÔºåÂøÖÈ°ªÂΩìkube-proxyÂêØÂä®ÂÆåÊØïÂêéÔºåËøô‰∏™ËäÇÁÇπÊâçÁÆóÊ≠£ÁúüÁöÑÂêØÂä®ÂÆåÊØï&#x3C;</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.Áõ¥Êé•Âú®masterËäÇÁÇπ‰∏äÊâßË°åÂ¶Ç‰∏ãÂëΩ‰ª§Ëé∑ÂèñËØ∑Ê±ÇÂàóË°®</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get csr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                                                   </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">SIGNERNAME</span><span style="--0:#D6DEEB;--1:#403F53">                                    </span><span style="--0:#ECC48D;--1:#3C63B3">REQUESTOR</span><span style="--0:#D6DEEB;--1:#403F53">           </span><span style="--0:#ECC48D;--1:#3C63B3">CONDITION</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">node-csr-JN8q9WljA6oupdWZ2mVO-TOIq2sLodFdkyL5fu6Ius4</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">4</span><span style="--0:#ECC48D;--1:#3C63B3">s</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes.io/kube-apiserver-client-kubelet</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">kubelet-bootstrap</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">Pending</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.ÊéàÊùÉÂêåÊÑèÊ≠§ËäÇÁÇπÂä†ÂÖ•ÈõÜÁæ§</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl certificate approve node-csr-JN8q9WljA6oupdWZ2mVO-TOIq2sLodFdkyL5fu6Ius4</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">certificatesigningrequest.certificates.k8s.io/node-csr-JN8q9WljA6oupdWZ2mVO-TOIq2sLodFdkyL5fu6Ius4</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">approved</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.Êü•ÁúãnodeËäÇÁÇπ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get node</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                 </span><span style="--0:#ECC48D;--1:#3C63B3">STATUS</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">ROLES</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">VERSION</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">binary-k8s-master1</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">NotReady</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">6</span><span style="--0:#ECC48D;--1:#3C63B3">s</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">v1.20.4</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#Ê≠§Êó∂masterËäÇÁÇπÂ∑≤ÁªèÂá∫Áé∞Âú®ÈõÜÁæ§ËäÇÁÇπÂàóË°®‰∏≠‰∫Ü</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">4.Êü•ÁúãkubeletÁ´ØÂè£</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> netstat -lnpt </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">grep</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">127.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.1:10248</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0:</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">29092</span><span style="--0:#ECC48D;--1:#3C63B3">/kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">127.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.1:41132</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0:</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">29092</span><span style="--0:#ECC48D;--1:#3C63B3">/kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp6</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">:::10250</span><span style="--0:#D6DEEB;--1:#403F53">                </span><span style="--0:#ECC48D;--1:#3C63B3">:::</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">                    </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">29092</span><span style="--0:#ECC48D;--1:#3C63B3">/kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp6</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">:::10255</span><span style="--0:#D6DEEB;--1:#403F53">                </span><span style="--0:#ECC48D;--1:#3C63B3">:::</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">                    </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">29092</span><span style="--0:#ECC48D;--1:#3C63B3">/kubelet</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.Áõ¥Êé•Âú®masterËäÇÁÇπ‰∏äÊâßË°åÂ¶Ç‰∏ãÂëΩ‰ª§Ëé∑ÂèñËØ∑Ê±ÇÂàóË°®[root@binary-k8s-master1 ~]\# kubectl get csrNAME                                                   AGE   SIGNERNAME                                    REQUESTOR           CONDITIONnode-csr-JN8q9WljA6oupdWZ2mVO-TOIq2sLodFdkyL5fu6Ius4   4s    kubernetes.io/kube-apiserver-client-kubelet   kubelet-bootstrap   Pending2.ÊéàÊùÉÂêåÊÑèÊ≠§ËäÇÁÇπÂä†ÂÖ•ÈõÜÁæ§[root@binary-k8s-master1 ~]\# kubectl certificate approve node-csr-JN8q9WljA6oupdWZ2mVO-TOIq2sLodFdkyL5fu6Ius4certificatesigningrequest.certificates.k8s.io/node-csr-JN8q9WljA6oupdWZ2mVO-TOIq2sLodFdkyL5fu6Ius4 approved3.Êü•ÁúãnodeËäÇÁÇπ[root@binary-k8s-master1 ~]\# kubectl get nodeNAME                 STATUS     ROLES    AGE   VERSIONbinary-k8s-master1   NotReady   <none>   6s    v1.20.44.Êü•ÁúãkubeletÁ´ØÂè£[root@binary-k8s-master1 ~]\# netstat -lnpt | grep kubelettcp        0      0 127.0.0.1:10248         0.0.0.0:*               LISTEN      29092/kubelettcp        0      0 127.0.0.1:41132         0.0.0.0:*               LISTEN      29092/kubelettcp6       0      0 :::10250                :::*                    LISTEN      29092/kubelettcp6       0      0 :::10255                :::*                    LISTEN      29092/kubelet"><div></div></button></div></figure></div>
<p><img src="https://cdn.agou-ops.cn/others/857b38edfb4c46e99ccd40e7fa296628.png" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞"></p>
<h3 id="63Âú®masterËäÇÁÇπÈÉ®ÁΩ≤kube-proxy">6.3.Âú®masterËäÇÁÇπÈÉ®ÁΩ≤kube-proxy</h3>
<h4 id="631ÂàõÂª∫kube-proxyÈÖçÁΩÆÊñá‰ª∂">6.3.1.ÂàõÂª∫kube-proxyÈÖçÁΩÆÊñá‰ª∂</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /data/kubernetes/config/kube-proxy.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">KUBE_PROXY_OPTS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">--logtostderr=false </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--v=2 </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--log-dir=/data/kubernetes/logs </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--config=/data/kubernetes/config/kube-proxy-config.yml</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 ~]\# vim /data/kubernetes/config/kube-proxy.confKUBE_PROXY_OPTS=&#x22;--logtostderr=false \--v=2 \--log-dir=/data/kubernetes/logs \--config=/data/kubernetes/config/kube-proxy-config.yml&#x22;"><div></div></button></div></figure></div>
<h4 id="632ÂàõÂª∫kube-proxyÂèÇÊï∞ÈÖçÁΩÆÊñá‰ª∂">6.3.2.ÂàõÂª∫kube-proxyÂèÇÊï∞ÈÖçÁΩÆÊñá‰ª∂</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /data/kubernetes/config/kube-proxy-config.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">KubeProxyConfiguration</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">apiVersion:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubeproxy.config.k8s.io/v1alpha1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">bindAddress:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0</span><span style="--0:#D6DEEB;--1:#403F53">                  </span><span style="--0:#809191;--1:#616671">#ÁõëÂê¨Âú∞ÂùÄ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">metricsBindAddress:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0:10249</span><span style="--0:#D6DEEB;--1:#403F53">              </span><span style="--0:#809191;--1:#616671">#ÁõëÂê¨Á´ØÂè£</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">clientConnection:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">kubeconfig:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/config/kube-proxy.kubeconfig</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#809191;--1:#616671">#kubeconfigÊñá‰ª∂Áî®‰∫éÂíåapiserverÈÄö‰ø°</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">hostnameOverride:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">binary-k8s-master1</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#809191;--1:#616671">#ÂΩìÂâçËäÇÁÇπÂêçÁß∞</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">clusterCIDR:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10.244</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0/16</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 ~]\# vim /data/kubernetes/config/kube-proxy-config.ymlkind: KubeProxyConfigurationapiVersion: kubeproxy.config.k8s.io/v1alpha1bindAddress: 0.0.0.0                  #ÁõëÂê¨Âú∞ÂùÄmetricsBindAddress: 0.0.0.0:10249              #ÁõëÂê¨Á´ØÂè£clientConnection:  kubeconfig: /data/kubernetes/config/kube-proxy.kubeconfig      #kubeconfigÊñá‰ª∂Áî®‰∫éÂíåapiserverÈÄö‰ø°hostnameOverride: binary-k8s-master1        #ÂΩìÂâçËäÇÁÇπÂêçÁß∞clusterCIDR: 10.244.0.0/16"><div></div></button></div></figure></div>
<h4 id="633ÁîüÊàêkubeconfigÊñá‰ª∂">6.3.3.ÁîüÊàêkubeconfigÊñá‰ª∂</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.ÂàõÂª∫ËØÅ‰π¶ÈÖçÁΩÆÊñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/TLS/k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim kube-proxy-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"CN"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">system:kube-proxy</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"hosts"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [],</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"key"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"algo"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">rsa</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">"size"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">2048</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">},</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"names"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> [</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"C"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">CN</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"L"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">BeiJing</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"ST"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">BeiJing</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"O"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">k8s</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">"OU"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">System</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.ÁîüÊàêËØÅ‰π¶</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/TLS/k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=kubernetes kube-proxy-csr.json </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">cfssljson</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-bare</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-proxy</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/03</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:04:23</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] generate received request</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/03</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:04:23</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] received CSR</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/03</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:04:23</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] generating key: rsa-2048</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/03</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:04:24</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] encoded CSR</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/03</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:04:24</span><span style="--0:#D6DEEB;--1:#403F53"> [INFO] signed certificate with serial number 677418055440191127932354470575565723194258386145</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2021/09/03</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:04:24</span><span style="--0:#D6DEEB;--1:#403F53"> [WARNING] This certificate lacks a </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">hosts</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> field. This makes it unsuitable </span><span style="--0:#C792EA;--1:#8D46B4">for</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">websites.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">For</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">more</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">information</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">see</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">the</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Baseline</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Requirements</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">for</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">the</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Issuance</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">and</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Management</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">of</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Publicly-Trusted</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Certificates,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">v.1.1.6,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">the</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">CA/Browser</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Forum</span><span style="--0:#D6DEEB;--1:#403F53"> (https://cabforum.org);</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">specifically,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">section</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10.2</span><span style="--0:#ECC48D;--1:#3C63B3">.3</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Information Requirements</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">).</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.Êü•ÁúãËØÅ‰π¶Êñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/TLS/k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> ll </span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">proxy</span><span style="--0:#7FDBCA;--1:#097174">*</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1009</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:04</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-proxy.csr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">230</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:04</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-proxy-csr.json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-------.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1679</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:04</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-proxy-key.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-r--r--.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1403</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16</span><span style="--0:#ECC48D;--1:#3C63B3">:04</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-proxy.pem</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">4.Êã∑Ë¥ùËØÅ‰π¶Êñá‰ª∂Ëá≥ÊåáÂÆöË∑ØÂæÑ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">/TLS/k8s]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cp kube-proxy</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">.pem /data/kubernetes/ssl/</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">5.ÁîüÊàêkubeconfigÊñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#Âú®kubeconfigÊñá‰ª∂‰∏≠Â¢ûÂä†ÈõÜÁæ§apiserver‰ø°ÊÅØ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl config set-cluster kubernetes \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--certificate-authority</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/ssl/ca.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--embed-certs</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--server</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.10:6443</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--kubeconfig</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/config/kube-proxy.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#Âú®kubeconfigÊñá‰ª∂‰∏≠Â¢ûÂä†ËØÅ‰π¶Êñá‰ª∂‰ø°ÊÅØ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl config set-credentials kube-proxy \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--client-certificate</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/ssl/kube-proxy.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--client-key</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/ssl/kube-proxy-key.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--embed-certs</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--kubeconfig</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/config/kube-proxy.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#Âú®kubeconfigÊñá‰ª∂‰∏≠Â¢ûÂä†Áî®Êà∑‰ø°ÊÅØ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl config set-context default \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--cluster</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--user</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">kube-proxy</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--kubeconfig</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/config/kube-proxy.kubeconfig</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">6.ÊåáÂÆöÁîüÊàêÁöÑkubeconfigÊñá‰ª∂‰∏∫ÈõÜÁæ§‰ΩøÁî®</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl config use-context default --kubeconfig=/data/kubernetes/config/kube-proxy.kubeconfig</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.ÂàõÂª∫ËØÅ‰π¶ÈÖçÁΩÆÊñá‰ª∂[root@binary-k8s-master1 ~/TLS/k8s]\# vim kube-proxy-csr.json{  &#x22;CN&#x22;: &#x22;system:kube-proxy&#x22;,  &#x22;hosts&#x22;: [],  &#x22;key&#x22;: {    &#x22;algo&#x22;: &#x22;rsa&#x22;,    &#x22;size&#x22;: 2048  },  &#x22;names&#x22;: [    {      &#x22;C&#x22;: &#x22;CN&#x22;,      &#x22;L&#x22;: &#x22;BeiJing&#x22;,      &#x22;ST&#x22;: &#x22;BeiJing&#x22;,      &#x22;O&#x22;: &#x22;k8s&#x22;,      &#x22;OU&#x22;: &#x22;System&#x22;    }  ]}2.ÁîüÊàêËØÅ‰π¶[root@binary-k8s-master1 ~/TLS/k8s]\# cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=kubernetes kube-proxy-csr.json | cfssljson -bare kube-proxy2021/09/03 16:04:23 [INFO] generate received request2021/09/03 16:04:23 [INFO] received CSR2021/09/03 16:04:23 [INFO] generating key: rsa-20482021/09/03 16:04:24 [INFO] encoded CSR2021/09/03 16:04:24 [INFO] signed certificate with serial number 6774180554401911279323544705755657231942583861452021/09/03 16:04:24 [WARNING] This certificate lacks a &#x22;hosts&#x22; field. This makes it unsuitable forwebsites. For more information see the Baseline Requirements for the Issuance and Managementof Publicly-Trusted Certificates, v.1.1.6, from the CA/Browser Forum (https://cabforum.org);specifically, section 10.2.3 (&#x22;Information Requirements&#x22;).3.Êü•ÁúãËØÅ‰π¶Êñá‰ª∂[root@binary-k8s-master1 ~/TLS/k8s]\# ll *proxy*-rw-r--r--. 1 root root 1009 9Êúà   3 16:04 kube-proxy.csr-rw-r--r--. 1 root root  230 9Êúà   3 16:04 kube-proxy-csr.json-rw-------. 1 root root 1679 9Êúà   3 16:04 kube-proxy-key.pem-rw-r--r--. 1 root root 1403 9Êúà   3 16:04 kube-proxy.pem4.Êã∑Ë¥ùËØÅ‰π¶Êñá‰ª∂Ëá≥ÊåáÂÆöË∑ØÂæÑ[root@binary-k8s-master1 ~/TLS/k8s]\# cp kube-proxy*.pem /data/kubernetes/ssl/5.ÁîüÊàêkubeconfigÊñá‰ª∂[root@binary-k8s-master1 ~]\# kubectl config set-cluster kubernetes \--certificate-authority=/data/kubernetes/ssl/ca.pem \--embed-certs=true \--server=&#x22;https://192.168.20.10:6443&#x22; \--kubeconfig=/data/kubernetes/config/kube-proxy.kubeconfig[root@binary-k8s-master1 ~]\# kubectl config set-credentials kube-proxy \--client-certificate=/data/kubernetes/ssl/kube-proxy.pem \--client-key=/data/kubernetes/ssl/kube-proxy-key.pem \--embed-certs=true \--kubeconfig=/data/kubernetes/config/kube-proxy.kubeconfig[root@binary-k8s-master1 ~]\# kubectl config set-context default \--cluster=kubernetes \--user=kube-proxy \--kubeconfig=/data/kubernetes/config/kube-proxy.kubeconfig6.ÊåáÂÆöÁîüÊàêÁöÑkubeconfigÊñá‰ª∂‰∏∫ÈõÜÁæ§‰ΩøÁî®[root@binary-k8s-master1 ~]\# kubectl config use-context default --kubeconfig=/data/kubernetes/config/kube-proxy.kubeconfig"><div></div></button></div></figure></div>
<h4 id="634ÂàõÂª∫systemctlËÑöÊú¨ÁÆ°ÁêÜÊúçÂä°">6.3.4.ÂàõÂª∫systemctlËÑöÊú¨ÁÆ°ÁêÜÊúçÂä°</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /usr/lib/systemd/system/kube-proxy.service</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[Unit]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">Description</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">Kubernetes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">Proxy</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">After</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">network.target</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[Service]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">EnvironmentFile</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/config/kube-proxy.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ExecStart</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/bin/kube-proxy</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">$KUBE_PROXY_OPTS</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">Restart</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">on-failure</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">LimitNOFILE</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">65536</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[Install]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">WantedBy</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">multi-user.target</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 ~]\# vim /usr/lib/systemd/system/kube-proxy.service[Unit]Description=Kubernetes ProxyAfter=network.target[Service]EnvironmentFile=/data/kubernetes/config/kube-proxy.confExecStart=/data/kubernetes/bin/kube-proxy $KUBE_PROXY_OPTSRestart=on-failureLimitNOFILE=65536[Install]WantedBy=multi-user.target"><div></div></button></div></figure></div>
<h4 id="634ÂêØÂä®kube-proxyÁªÑ‰ª∂">6.3.4.ÂêØÂä®kube-proxyÁªÑ‰ª∂</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.ÂêØÂä®ÊúçÂä°</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl daemon-reload</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl start kube-proxy</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl enable kube-proxy</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.Êü•ÁúãÁ´ØÂè£</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> netstat -lnpt </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">grep</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-proxy</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp6</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">:::10249</span><span style="--0:#D6DEEB;--1:#403F53">                </span><span style="--0:#ECC48D;--1:#3C63B3">:::</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">                    </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">29354</span><span style="--0:#ECC48D;--1:#3C63B3">/kube-proxy</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp6</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">:::10256</span><span style="--0:#D6DEEB;--1:#403F53">                </span><span style="--0:#ECC48D;--1:#3C63B3">:::</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">                    </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">29354</span><span style="--0:#ECC48D;--1:#3C63B3">/kube-proxy</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.ÂêØÂä®ÊúçÂä°[root@binary-k8s-master1 ~]\# systemctl daemon-reload[root@binary-k8s-master1 ~]\# systemctl start kube-proxy[root@binary-k8s-master1 ~]\# systemctl enable kube-proxy2.Êü•ÁúãÁ´ØÂè£[root@binary-k8s-master1 ~]\# netstat -lnpt | grep kube-proxytcp6       0      0 :::10249                :::*                    LISTEN      29354/kube-proxytcp6       0      0 :::10256                :::*                    LISTEN      29354/kube-proxy"><div></div></button></div></figure></div>
<h3 id="64ÊéàÊùÉapiserverËÆøÈóÆkubelet">6.4.ÊéàÊùÉapiserverËÆøÈóÆkubelet</h3>
<p>Â¶ÇÊûú‰∏çÊî∂ÂèñapiserverËÆøÈóÆkubeletÔºåÈÇ£‰πàÂ∞ÜÊó†Ê≥ï‰ΩøÁî®kubectlÊü•ÁúãÈõÜÁæ§ÁöÑ‰∏Ä‰∫õ‰ø°ÊÅØÔºåÊØîÂ¶Çkubectl logsÂ∞±Êó†Ê≥ï‰ΩøÁî®„ÄÇ</p>
<p>ÂÆûÈôÖ‰∏äÂ∞±ÊòØÂàõÂª∫‰∏Ä‰∏™rbacËµÑÊ∫êËÆ©apiserverËÉΩÂê¶ËÆøÈóÆkubeletÁöÑËµÑÊ∫ê„ÄÇ</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.ÁºñÂÜôËµÑÊ∫êyamlÊñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim apiserver-to-kubelet-rbac.yaml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">apiVersion:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">rbac.authorization.k8s.io/v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ClusterRole</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">annotations:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">rbac.authorization.kubernetes.io/autoupdate:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">true</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">labels:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">kubernetes.io/bootstrapping:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">rbac-defaults</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">system:kube-apiserver-to-kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">rules:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">apiGroups:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">""</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">resources:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">nodes/proxy</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">nodes/stats</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">nodes/log</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">nodes/spec</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">nodes/metrics</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">pods/log</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">verbs:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">*</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">apiVersion:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">rbac.authorization.k8s.io/v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ClusterRoleBinding</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">system:kube-apiserver</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">namespace:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">""</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">roleRef:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">apiGroup:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">rbac.authorization.k8s.io</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ClusterRole</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">system:kube-apiserver-to-kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">subjects:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">apiGroup:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">rbac.authorization.k8s.io</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">User</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.ÂàõÂª∫ËµÑÊ∫ê</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl apply -f apiserver-to-kubelet-rbac.yaml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">clusterrole.rbac.authorization.k8s.io/system:kube-apiserver-to-kubelet</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">clusterrolebinding.rbac.authorization.k8s.io/system:kube-apiserver</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.ÁºñÂÜôËµÑÊ∫êyamlÊñá‰ª∂[root@binary-k8s-master1 ~]\# vim apiserver-to-kubelet-rbac.yamlapiVersion: rbac.authorization.k8s.io/v1kind: ClusterRolemetadata:  annotations:    rbac.authorization.kubernetes.io/autoupdate: &#x22;true&#x22;  labels:    kubernetes.io/bootstrapping: rbac-defaults  name: system:kube-apiserver-to-kubeletrules:  - apiGroups:      - &#x22;&#x22;    resources:      - nodes/proxy      - nodes/stats      - nodes/log      - nodes/spec      - nodes/metrics      - pods/log    verbs:      - &#x22;*&#x22;---apiVersion: rbac.authorization.k8s.io/v1kind: ClusterRoleBindingmetadata:  name: system:kube-apiserver  namespace: &#x22;&#x22;roleRef:  apiGroup: rbac.authorization.k8s.io  kind: ClusterRole  name: system:kube-apiserver-to-kubeletsubjects:  - apiGroup: rbac.authorization.k8s.io    kind: User    name: kubernetes2.ÂàõÂª∫ËµÑÊ∫ê[root@binary-k8s-master1 ~]\# kubectl apply -f apiserver-to-kubelet-rbac.yamlclusterrole.rbac.authorization.k8s.io/system:kube-apiserver-to-kubelet createdclusterrolebinding.rbac.authorization.k8s.io/system:kube-apiserver created"><div></div></button></div></figure></div>
<h2 id="7ÈÉ®ÁΩ≤kubernetes-calicoÁΩëÁªúÁªÑ‰ª∂">7.ÈÉ®ÁΩ≤kubernetes calicoÁΩëÁªúÁªÑ‰ª∂</h2>
<p>Âú®6‰∏≠masterËäÇÁÇπÂ∑≤ÁªèÂä†ÂÖ•ÈõÜÁæ§Ôºå‰ΩÜÊòØÁä∂ÊÄÅ‰∏ÄÁõ¥Â§Ñ‰∫éNotReadyÁä∂ÊÄÅÔºåÂ∞±ÊòØÁî±‰∫éÈõÜÁæ§Ê≤°ÊúâÁΩëÁªúÁªÑ‰ª∂ÂØºËá¥ÁöÑÔºåÈÉ®ÁΩ≤Â•ΩÁΩëÁªúÁªÑ‰ª∂ÔºåmasterËäÇÁÇπÁ´ãÈ©¨‰ºöÊàê‰∏∫ReadyÁä∂ÊÄÅ„ÄÇ</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.ÈÉ®ÁΩ≤calico</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl apply -f calico.yaml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">configmap/calico-config</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">customresourcedefinition.apiextensions.k8s.io/bgpconfigurations.crd.projectcalico.org</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">customresourcedefinition.apiextensions.k8s.io/bgppeers.crd.projectcalico.org</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">customresourcedefinition.apiextensions.k8s.io/blockaffinities.crd.projectcalico.org</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">customresourcedefinition.apiextensions.k8s.io/clusterinformations.crd.projectcalico.org</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">customresourcedefinition.apiextensions.k8s.io/felixconfigurations.crd.projectcalico.org</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">customresourcedefinition.apiextensions.k8s.io/globalnetworkpolicies.crd.projectcalico.org</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">customresourcedefinition.apiextensions.k8s.io/globalnetworksets.crd.projectcalico.org</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">customresourcedefinition.apiextensions.k8s.io/hostendpoints.crd.projectcalico.org</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">customresourcedefinition.apiextensions.k8s.io/ipamblocks.crd.projectcalico.org</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">customresourcedefinition.apiextensions.k8s.io/ipamconfigs.crd.projectcalico.org</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">customresourcedefinition.apiextensions.k8s.io/ipamhandles.crd.projectcalico.org</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">customresourcedefinition.apiextensions.k8s.io/ippools.crd.projectcalico.org</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">customresourcedefinition.apiextensions.k8s.io/kubecontrollersconfigurations.crd.projectcalico.org</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">customresourcedefinition.apiextensions.k8s.io/networkpolicies.crd.projectcalico.org</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">customresourcedefinition.apiextensions.k8s.io/networksets.crd.projectcalico.org</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">clusterrole.rbac.authorization.k8s.io/calico-kube-controllers</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">clusterrolebinding.rbac.authorization.k8s.io/calico-kube-controllers</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">clusterrole.rbac.authorization.k8s.io/calico-node</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">clusterrolebinding.rbac.authorization.k8s.io/calico-node</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">daemonset.apps/calico-node</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">serviceaccount/calico-node</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">deployment.apps/calico-kube-controllers</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">serviceaccount/calico-kube-controllers</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.Êü•ÁúãËµÑÊ∫êÁä∂ÊÄÅ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get pod -n kube-system</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                                      </span><span style="--0:#ECC48D;--1:#3C63B3">READY</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">STATUS</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">RESTARTS</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">calico-kube-controllers-97769f7c7-bnwcl</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">11</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">calico-node-mghdj</span><span style="--0:#D6DEEB;--1:#403F53">                         </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">11</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.Êü•ÁúãmasterËäÇÁÇπÁöÑÁä∂ÊÄÅ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get node</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#ECC48D;--1:#3C63B3">STATUS</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">ROLES</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">VERSION</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">k8s-master1</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">Ready</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">99</span><span style="--0:#ECC48D;--1:#3C63B3">m</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">v1.20.4</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.ÈÉ®ÁΩ≤calico[root@binary-k8s-master1 ~]\# kubectl apply -f calico.yamlconfigmap/calico-config createdcustomresourcedefinition.apiextensions.k8s.io/bgpconfigurations.crd.projectcalico.org createdcustomresourcedefinition.apiextensions.k8s.io/bgppeers.crd.projectcalico.org createdcustomresourcedefinition.apiextensions.k8s.io/blockaffinities.crd.projectcalico.org createdcustomresourcedefinition.apiextensions.k8s.io/clusterinformations.crd.projectcalico.org createdcustomresourcedefinition.apiextensions.k8s.io/felixconfigurations.crd.projectcalico.org createdcustomresourcedefinition.apiextensions.k8s.io/globalnetworkpolicies.crd.projectcalico.org createdcustomresourcedefinition.apiextensions.k8s.io/globalnetworksets.crd.projectcalico.org createdcustomresourcedefinition.apiextensions.k8s.io/hostendpoints.crd.projectcalico.org createdcustomresourcedefinition.apiextensions.k8s.io/ipamblocks.crd.projectcalico.org createdcustomresourcedefinition.apiextensions.k8s.io/ipamconfigs.crd.projectcalico.org createdcustomresourcedefinition.apiextensions.k8s.io/ipamhandles.crd.projectcalico.org createdcustomresourcedefinition.apiextensions.k8s.io/ippools.crd.projectcalico.org createdcustomresourcedefinition.apiextensions.k8s.io/kubecontrollersconfigurations.crd.projectcalico.org createdcustomresourcedefinition.apiextensions.k8s.io/networkpolicies.crd.projectcalico.org createdcustomresourcedefinition.apiextensions.k8s.io/networksets.crd.projectcalico.org createdclusterrole.rbac.authorization.k8s.io/calico-kube-controllers createdclusterrolebinding.rbac.authorization.k8s.io/calico-kube-controllers createdclusterrole.rbac.authorization.k8s.io/calico-node createdclusterrolebinding.rbac.authorization.k8s.io/calico-node createddaemonset.apps/calico-node createdserviceaccount/calico-node createddeployment.apps/calico-kube-controllers createdserviceaccount/calico-kube-controllers created2.Êü•ÁúãËµÑÊ∫êÁä∂ÊÄÅ[root@binary-k8s-master1 ~]\# kubectl get pod -n kube-systemNAME                                      READY   STATUS    RESTARTS   AGEcalico-kube-controllers-97769f7c7-bnwcl   1/1     Running   0          11mcalico-node-mghdj                         1/1     Running   0          11m3.Êü•ÁúãmasterËäÇÁÇπÁöÑÁä∂ÊÄÅ[root@binary-k8s-master1 ~]\# kubectl get nodeNAME          STATUS   ROLES    AGE   VERSIONk8s-master1   Ready    <none>   99m   v1.20.4"><div></div></button></div></figure></div>
<h2 id="8ÈÉ®ÁΩ≤kubernetes-nodeËäÇÁÇπ">8.ÈÉ®ÁΩ≤kubernetes nodeËäÇÁÇπ</h2>
<h3 id="81Ëß£Âéã‰∫åËøõÂà∂Êñá‰ª∂Â§çÂà∂Áõ∏ÂÖ≥ÁªÑ‰ª∂Á®ãÂ∫è">8.1.Ëß£Âéã‰∫åËøõÂà∂Êñá‰ª∂Â§çÂà∂Áõ∏ÂÖ≥ÁªÑ‰ª∂Á®ãÂ∫è</h3>
<p>‰ª•‰∏ãÊìç‰Ωú‰ªÖÂú®node1ËäÇÁÇπÊìç‰ΩúÂç≥ÂèØ„ÄÇ</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.ÂáÜÂ§á‰∫åËøõÂà∂Á®ãÂ∫è</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> tar xf kubernetes-server-linux-amd64.tar.gz</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> mkdir -p /data/kubernetes/{</span><span style="--0:#82AAFF;--1:#3C63B3">bin,config,ssl,logs}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cp kubernetes/server/bin/{</span><span style="--0:#82AAFF;--1:#3C63B3">kubelet,kube-proxy}</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/bin/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cp kubernetes/server/bin/kubectl /usr/bin/</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.Â∞ÜmasterËäÇÁÇπ‰∏äÁöÑËØÅ‰π¶Êñá‰ª∂Êã∑Ë¥ùËá≥nodeËäÇÁÇπ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> scp -rp /data/kubernetes/ssl/</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53"> binary-k8s-node1:/data/kubernetes/ssl/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> scp -rp /data/kubernetes/config/token.csv root@binary-k8s-node1:/data/kubernetes/config</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.Âà†Èô§‰ªémasterËäÇÁÇπ‰∏äÊã∑Ë¥ùËøáÊù•ÁöÑkubeletËØÅ‰π¶</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> rm -rf /data/kubernetes/ssl/kubelet-client-</span><span style="--0:#7FDBCA;--1:#097174">*</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#kubeletËØÅ‰π¶ÈúÄË¶ÅÂà†Èô§ÔºåÂΩìnodeËäÇÁÇπÁöÑkubeletÂêØÂä®Âêé‰ºöÁîüÊàê‰∏¥Êó∂ËØÅ‰π¶Êñá‰ª∂ÔºåÂΩìmasterÊéàÊùÉÈÄöËøáÂêéÔºåËØÅ‰π¶Êñá‰ª∂‰∫ßÁîü</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.ÂáÜÂ§á‰∫åËøõÂà∂Á®ãÂ∫è[root@binary-k8s-node1 ~]\# tar xf kubernetes-server-linux-amd64.tar.gz[root@binary-k8s-node1 ~]\# mkdir -p /data/kubernetes/{bin,config,ssl,logs}[root@binary-k8s-node1 ~]\# cp kubernetes/server/bin/{kubelet,kube-proxy} /data/kubernetes/bin/[root@binary-k8s-node1 ~]\# cp kubernetes/server/bin/kubectl /usr/bin/2.Â∞ÜmasterËäÇÁÇπ‰∏äÁöÑËØÅ‰π¶Êñá‰ª∂Êã∑Ë¥ùËá≥nodeËäÇÁÇπ[root@binary-k8s-master1 ~]\# scp -rp /data/kubernetes/ssl/* binary-k8s-node1:/data/kubernetes/ssl/[root@binary-k8s-master1 ~]\# scp -rp /data/kubernetes/config/token.csv root@binary-k8s-node1:/data/kubernetes/config3.Âà†Èô§‰ªémasterËäÇÁÇπ‰∏äÊã∑Ë¥ùËøáÊù•ÁöÑkubeletËØÅ‰π¶[root@binary-k8s-node1 ~]\# rm -rf /data/kubernetes/ssl/kubelet-client-*"><div></div></button></div></figure></div>
<h3 id="82ÈÉ®ÁΩ≤kubeletÁªÑ‰ª∂">8.2.ÈÉ®ÁΩ≤kubeletÁªÑ‰ª∂</h3>
<h4 id="821ÂàõÂª∫kubeletÈÖçÁΩÆÊñá‰ª∂">8.2.1.ÂàõÂª∫kubeletÈÖçÁΩÆÊñá‰ª∂</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /data/kubernetes/config/kubelet.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">KUBELET_OPTS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">--logtostderr=false </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--v=2 </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--log-dir=/data/kubernetes/logs </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--hostname-override=binary-k8s-node1    #Ê≥®ÊÑè‰øÆÊîπËäÇÁÇπÂêçÁß∞ </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--network-plugin=cni </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--kubeconfig=/data/kubernetes/config/kubelet.kubeconfig </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--bootstrap-kubeconfig=/data/kubernetes/config/bootstrap.kubeconfig </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--config=/data/kubernetes/config/kubelet-config.yml </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--cert-dir=/data/kubernetes/ssl </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--pod-infra-container-image=pause-amd64:3.0</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-node1 ~]\# vim /data/kubernetes/config/kubelet.confKUBELET_OPTS=&#x22;--logtostderr=false \--v=2 \--log-dir=/data/kubernetes/logs \--hostname-override=binary-k8s-node1    #Ê≥®ÊÑè‰øÆÊîπËäÇÁÇπÂêçÁß∞ \--network-plugin=cni \--kubeconfig=/data/kubernetes/config/kubelet.kubeconfig \--bootstrap-kubeconfig=/data/kubernetes/config/bootstrap.kubeconfig \--config=/data/kubernetes/config/kubelet-config.yml \--cert-dir=/data/kubernetes/ssl \--pod-infra-container-image=pause-amd64:3.0&#x22;"><div></div></button></div></figure></div>
<h4 id="822ÂàõÂª∫kubeletÂèÇÊï∞ÈÖçÁΩÆÊñá‰ª∂">8.2.2.ÂàõÂª∫kubeletÂèÇÊï∞ÈÖçÁΩÆÊñá‰ª∂</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /data/kubernetes/config/kubelet-config.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">KubeletConfiguration</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">apiVersion:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubelet.config.k8s.io/v1beta1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">address:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">port:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10250</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">readOnlyPort:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10255</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">cgroupDriver:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">cgroupfs</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">clusterDNS:</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.2</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">clusterDomain:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">cluster.local</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">failSwapOn:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">false</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">authentication:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">anonymous:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">enabled:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">false</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">webhook:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">cacheTTL:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">m0s</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">enabled:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">x509:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">clientCAFile:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/ssl/ca.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">authorization:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">mode:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Webhook</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">webhook:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">cacheAuthorizedTTL:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">5</span><span style="--0:#ECC48D;--1:#3C63B3">m0s</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">cacheUnauthorizedTTL:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">30</span><span style="--0:#ECC48D;--1:#3C63B3">s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">evictionHard:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">imagefs.available:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">15</span><span style="--0:#ECC48D;--1:#3C63B3">%</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">memory.available:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">100</span><span style="--0:#ECC48D;--1:#3C63B3">Mi</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">nodefs.available:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10</span><span style="--0:#ECC48D;--1:#3C63B3">%</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">nodefs.inodesFree:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">5</span><span style="--0:#ECC48D;--1:#3C63B3">%</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">maxOpenFiles:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1000000</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">maxPods:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">110</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-node1 ~]\# vim /data/kubernetes/config/kubelet-config.ymlkind: KubeletConfigurationapiVersion: kubelet.config.k8s.io/v1beta1address: 0.0.0.0port: 10250readOnlyPort: 10255cgroupDriver: cgroupfsclusterDNS:- 10.0.0.2clusterDomain: cluster.localfailSwapOn: falseauthentication:  anonymous:    enabled: false  webhook:    cacheTTL: 2m0s    enabled: true  x509:    clientCAFile: /data/kubernetes/ssl/ca.pemauthorization:  mode: Webhook  webhook:    cacheAuthorizedTTL: 5m0s    cacheUnauthorizedTTL: 30sevictionHard:  imagefs.available: 15%  memory.available: 100Mi  nodefs.available: 10%  nodefs.inodesFree: 5%maxOpenFiles: 1000000maxPods: 110"><div></div></button></div></figure></div>
<h4 id="823ÂàõÂª∫bootstrap-kubeconfigÊñá‰ª∂">8.2.3.ÂàõÂª∫bootstrap-kubeconfigÊñá‰ª∂</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.Âú®kubeconfigÊñá‰ª∂‰∏≠Â¢ûÂä†ÈõÜÁæ§apiserver‰ø°ÊÅØ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl config set-cluster kubernetes \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--certificate-authority</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/ssl/ca.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--embed-certs</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--server</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.10:6443</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--kubeconfig</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/config/bootstrap.kubeconfig</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.Âú®kubeconfigÊñá‰ª∂‰∏≠Â¢ûÂä†token‰ø°ÊÅØ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl config set-credentials </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">kubelet-bootstrap</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--token</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">d7f96b0d86c574d0f64a713608db0922</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--kubeconfig</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/config/bootstrap.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#Ëøô‰∏™tokenÂ∞±ÊòØ‰πãÂâçÁîüÊàêÁöÑ/data/kubernetes/config/token.csv‰∏≠ÁöÑtoken</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.Âú®kubeconfigÊñá‰ª∂‰∏≠Â¢ûÂä†Áî®Êà∑‰ø°ÊÅØ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl config set-context default \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--cluster</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--user</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">kubelet-bootstrap</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--kubeconfig</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/config/bootstrap.kubeconfig</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">4.ÊåáÂÆöÁîüÊàêÁöÑkubeconfigÊñá‰ª∂‰∏∫ÈõÜÁæ§‰ΩøÁî®</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl config use-context default --kubeconfig=/data/kubernetes/config/bootstrap.kubeconfig</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.Âú®kubeconfigÊñá‰ª∂‰∏≠Â¢ûÂä†ÈõÜÁæ§apiserver‰ø°ÊÅØ[root@binary-k8s-node1 ~]\# kubectl config set-cluster kubernetes \--certificate-authority=/data/kubernetes/ssl/ca.pem \--embed-certs=true \--server=&#x22;https://192.168.20.10:6443&#x22; \--kubeconfig=/data/kubernetes/config/bootstrap.kubeconfig2.Âú®kubeconfigÊñá‰ª∂‰∏≠Â¢ûÂä†token‰ø°ÊÅØ[root@binary-k8s-master1 ~]\# kubectl config set-credentials &#x22;kubelet-bootstrap&#x22; \--token=d7f96b0d86c574d0f64a713608db0922 \--kubeconfig=/data/kubernetes/config/bootstrap.kubeconfig3.Âú®kubeconfigÊñá‰ª∂‰∏≠Â¢ûÂä†Áî®Êà∑‰ø°ÊÅØ[root@binary-k8s-master1 ~]\# kubectl config set-context default \--cluster=kubernetes \--user=&#x22;kubelet-bootstrap&#x22; \--kubeconfig=/data/kubernetes/config/bootstrap.kubeconfig4.ÊåáÂÆöÁîüÊàêÁöÑkubeconfigÊñá‰ª∂‰∏∫ÈõÜÁæ§‰ΩøÁî®[root@binary-k8s-master1 ~]\# kubectl config use-context default --kubeconfig=/data/kubernetes/config/bootstrap.kubeconfig"><div></div></button></div></figure></div>
<h4 id="824ÂàõÂª∫systemctlËÑöÊú¨Âπ∂ÂêØÂä®ÊúçÂä°">8.2.4.ÂàõÂª∫systemctlËÑöÊú¨Âπ∂ÂêØÂä®ÊúçÂä°</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.ÁºñÂÜôsystemctlÊúçÂä°ËÑöÊú¨</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /usr/lib/systemd/system/kubelet.service</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[Unit]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">Description</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">Kubernetes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">Kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">After</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">docker.service</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[Service]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">EnvironmentFile</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/config/kubelet.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ExecStart</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/bin/kubelet</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">$KUBELET_OPTS</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">Restart</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">on-failure</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">LimitNOFILE</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">65536</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[Install]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">WantedBy</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">multi-user.target</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.ÂêØÂä®kubeletÊúçÂä°</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl daemon-reload</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl start kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl enable kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl status kubelet</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.ÁºñÂÜôsystemctlÊúçÂä°ËÑöÊú¨[root@binary-k8s-node1 ~]\# vim /usr/lib/systemd/system/kubelet.service[Unit]Description=Kubernetes KubeletAfter=docker.service[Service]EnvironmentFile=/data/kubernetes/config/kubelet.confExecStart=/data/kubernetes/bin/kubelet $KUBELET_OPTSRestart=on-failureLimitNOFILE=65536[Install]WantedBy=multi-user.target2.ÂêØÂä®kubeletÊúçÂä°[root@binary-k8s-node1 ~]\# systemctl daemon-reload[root@binary-k8s-node1 ~]\# systemctl start kubelet[root@binary-k8s-node1 ~]\# systemctl enable kubelet[root@binary-k8s-node1 ~]\# systemctl status kubelet"><div></div></button></div></figure></div>
<h4 id="825masterËäÇÁÇπÊéàÊùÉÂêåÊÑènodeËäÇÁÇπÂä†ÂÖ•ÈõÜÁæ§">8.2.5.masterËäÇÁÇπÊéàÊùÉÂêåÊÑènodeËäÇÁÇπÂä†ÂÖ•ÈõÜÁæ§</h4>
<p>kubeletÊúçÂä°ÂêØÂä®ÂêéÔºå‰ºöÁîüÊàê‰∏Ä‰∏™‰∏¥Êó∂ËØÅ‰π¶Êñá‰ª∂ÔºåÁÑ∂ÂêéÂêëmasterËäÇÁÇπÂèëÈÄÅ‰∏Ä‰∏™csrÊéàÊùÉËØ∑Ê±ÇÔºåÂΩìmasterËäÇÁÇπÊéàÊùÉÂêåÊÑèÂêéÔºåkubelet-clinetËØÅ‰π¶Êñá‰ª∂ÁîüÊàêÔºåÁ´ØÂè£‰πüÈöè‰πãÂêØÂä®ÔºåËäÇÁÇπÊ≠£Â∏∏Âä†ÂÖ•ÈõÜÁæ§„ÄÇ</p>
<p>csrÂàóË°®ÁöÑÊéàÊùÉ‰ø°ÊÅØ‰πü‰ºöËá™Âä®Ê∏ÖÁ©∫ÔºåÂ¶ÇÊûúmasterËäÇÁÇπÁöÑÊéàÊùÉ‰∏çÂèäÊó∂Ôºå‰πüÂèØ‰ª•ÈáçÂêØ‰∏Ä‰∏ãkubeletÈáçÊñ∞ÂèëÈÄÅ‰∏Ä‰∏™csrËØ∑Ê±Ç„ÄÇ</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.Âú®nodeËäÇÁÇπÊü•Áúã‰∏¥Êó∂ËØÅ‰π¶Êñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> ll /data/kubernetes/ssl/</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">.tmp</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-------.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">227</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">6</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">11</span><span style="--0:#ECC48D;--1:#3C63B3">:28</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubelet-client.key.tmp</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#Âè™Ë¶ÅkubeletÂêØÂä®Â∞±‰ºö‰∫ßÁîü‰∏Ä‰∏™‰∏¥Êó∂ËØÅ‰π¶Êñá‰ª∂</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.Âú®masterËäÇÁÇπÊü•ÁúãcsrÊéàÊùÉËØ∑Ê±ÇÂàóË°®</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get csr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                                                   </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">SIGNERNAME</span><span style="--0:#D6DEEB;--1:#403F53">                                    </span><span style="--0:#ECC48D;--1:#3C63B3">REQUESTOR</span><span style="--0:#D6DEEB;--1:#403F53">           </span><span style="--0:#ECC48D;--1:#3C63B3">CONDITION</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">node-csr-JmO7N8iDvyD0D-2Pu7_yHJ3ngZ5xXfA_TwRevqmHAXI</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">11</span><span style="--0:#ECC48D;--1:#3C63B3">s</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes.io/kube-apiserver-client-kubelet</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">kubelet-bootstrap</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">Pending</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.ÊéàÊùÉÈÄöËøá</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl certificate approve node-csr-JmO7N8iDvyD0D-2Pu7_yHJ3ngZ5xXfA_TwRevqmHAXI</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">certificatesigningrequest.certificates.k8s.io/node-csr-JmO7N8iDvyD0D-2Pu7_yHJ3ngZ5xXfA_TwRevqmHAXI</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">approved</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">4.Ê≠§Êó∂‰∏¥Êó∂Êñá‰ª∂Â∑≤Âà†Èô§ÔºåÂ∑≤ÁªèÁîüÊàêkubeletËØÅ‰π¶Êñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> ll /data/kubernetes/ssl/kubelet-client</span><span style="--0:#7FDBCA;--1:#097174">*</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-rw-------.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1236</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">6</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">11</span><span style="--0:#ECC48D;--1:#3C63B3">:28</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubelet-client-2021-09-06-11-28-54.pem</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">lrwxrwxrwx.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">root</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">59</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#ECC48D;--1:#3C63B3">Êúà</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">6</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">11</span><span style="--0:#ECC48D;--1:#3C63B3">:28</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubelet-client-current.pem</span><span style="--0:#D6DEEB;--1:#403F53"> -</span><span style="--0:#7FDBCA;--1:#097174">></span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/ssl/kubelet-client-2021-09-06-11-28-54.pem</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">5.node1ËäÇÁÇπÊàêÂäüÂä†ÂÖ•ÈõÜÁæ§</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get node</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                 </span><span style="--0:#ECC48D;--1:#3C63B3">STATUS</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">ROLES</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">VERSION</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">binary-k8s-master1</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">Ready</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">d22h</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">v1.20.4</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">binary-k8s-node1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Ready</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">4</span><span style="--0:#ECC48D;--1:#3C63B3">h59m</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">v1.20.4</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">6.Âú®nodeËäÇÁÇπÊü•ÁúãkubeletÊúçÂä°ÁöÑÁ´ØÂè£</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> netstat -lnpt </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">grep</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">127.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.1:10248</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0:</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">29220</span><span style="--0:#ECC48D;--1:#3C63B3">/kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">127.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.1:44151</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0:</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">29220</span><span style="--0:#ECC48D;--1:#3C63B3">/kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp6</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">:::10250</span><span style="--0:#D6DEEB;--1:#403F53">                </span><span style="--0:#ECC48D;--1:#3C63B3">:::</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">                    </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">29220</span><span style="--0:#ECC48D;--1:#3C63B3">/kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp6</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">:::10255</span><span style="--0:#D6DEEB;--1:#403F53">                </span><span style="--0:#ECC48D;--1:#3C63B3">:::</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">                    </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">29220</span><span style="--0:#ECC48D;--1:#3C63B3">/kubelet</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.Âú®nodeËäÇÁÇπÊü•Áúã‰∏¥Êó∂ËØÅ‰π¶Êñá‰ª∂[root@binary-k8s-node1 ~]\# ll /data/kubernetes/ssl/*.tmp-rw-------. 1 root root  227 9Êúà   6 11:28 kubelet-client.key.tmp2.Âú®masterËäÇÁÇπÊü•ÁúãcsrÊéàÊùÉËØ∑Ê±ÇÂàóË°®[root@binary-k8s-master1 ~]\# kubectl get csrNAME                                                   AGE    SIGNERNAME                                    REQUESTOR           CONDITIONnode-csr-JmO7N8iDvyD0D-2Pu7_yHJ3ngZ5xXfA_TwRevqmHAXI   11s    kubernetes.io/kube-apiserver-client-kubelet   kubelet-bootstrap   Pending3.ÊéàÊùÉÈÄöËøá[root@binary-k8s-master1 ~]\# kubectl certificate approve node-csr-JmO7N8iDvyD0D-2Pu7_yHJ3ngZ5xXfA_TwRevqmHAXIcertificatesigningrequest.certificates.k8s.io/node-csr-JmO7N8iDvyD0D-2Pu7_yHJ3ngZ5xXfA_TwRevqmHAXI approved4.Ê≠§Êó∂‰∏¥Êó∂Êñá‰ª∂Â∑≤Âà†Èô§ÔºåÂ∑≤ÁªèÁîüÊàêkubeletËØÅ‰π¶Êñá‰ª∂[root@binary-k8s-node1 ~]\# ll /data/kubernetes/ssl/kubelet-client*-rw-------. 1 root root 1236 9Êúà   6 11:28 kubelet-client-2021-09-06-11-28-54.pemlrwxrwxrwx. 1 root root   59 9Êúà   6 11:28 kubelet-client-current.pem -> /data/kubernetes/ssl/kubelet-client-2021-09-06-11-28-54.pem5.node1ËäÇÁÇπÊàêÂäüÂä†ÂÖ•ÈõÜÁæ§[root@binary-k8s-master1 ~]\# kubectl get nodeNAME                 STATUS   ROLES    AGE     VERSIONbinary-k8s-master1   Ready    <none>   2d22h   v1.20.4binary-k8s-node1     Ready    <none>   4h59m   v1.20.46.Âú®nodeËäÇÁÇπÊü•ÁúãkubeletÊúçÂä°ÁöÑÁ´ØÂè£[root@binary-k8s-node1 ~]\# netstat -lnpt | grep kubelettcp        0      0 127.0.0.1:10248         0.0.0.0:*               LISTEN      29220/kubelettcp        0      0 127.0.0.1:44151         0.0.0.0:*               LISTEN      29220/kubelettcp6       0      0 :::10250                :::*                    LISTEN      29220/kubelettcp6       0      0 :::10255                :::*                    LISTEN      29220/kubelet"><div></div></button></div></figure></div>
<h3 id="83ÈÉ®ÁΩ≤kube-proxyÁªÑ‰ª∂">8.3.ÈÉ®ÁΩ≤kube-proxyÁªÑ‰ª∂</h3>
<h4 id="831ÂàõÂª∫kube-proxyÈÖçÁΩÆÊñá‰ª∂">8.3.1.ÂàõÂª∫kube-proxyÈÖçÁΩÆÊñá‰ª∂</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /data/kubernetes/config/kube-proxy.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">KUBE_PROXY_OPTS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">--logtostderr=false </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--v=2 </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--log-dir=/data/kubernetes/logs </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--config=/data/kubernetes/config/kube-proxy-config.yml</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-node1 ~]\# vim /data/kubernetes/config/kube-proxy.confKUBE_PROXY_OPTS=&#x22;--logtostderr=false \--v=2 \--log-dir=/data/kubernetes/logs \--config=/data/kubernetes/config/kube-proxy-config.yml&#x22;"><div></div></button></div></figure></div>
<h4 id="832ÂàõÂª∫kube-proxyÂèÇÊï∞ÈÖçÁΩÆÊñá‰ª∂">8.3.2.ÂàõÂª∫kube-proxyÂèÇÊï∞ÈÖçÁΩÆÊñá‰ª∂</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /data/kubernetes/config/kube-proxy-config.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">KubeProxyConfiguration</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">apiVersion:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubeproxy.config.k8s.io/v1alpha1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">bindAddress:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0</span><span style="--0:#D6DEEB;--1:#403F53">                  </span><span style="--0:#809191;--1:#616671">#ÁõëÂê¨Âú∞ÂùÄ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">metricsBindAddress:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0:10249</span><span style="--0:#D6DEEB;--1:#403F53">              </span><span style="--0:#809191;--1:#616671">#ÁõëÂê¨Á´ØÂè£</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">clientConnection:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">kubeconfig:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/config/kube-proxy.kubeconfig</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#809191;--1:#616671">#kubeconfigÊñá‰ª∂Áî®‰∫éÂíåapiserverÈÄö‰ø°</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">hostnameOverride:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">binary-k8s-node1</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#809191;--1:#616671">#ÂΩìÂâçËäÇÁÇπÂêçÁß∞</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">clusterCIDR:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10.244</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0/16</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-node1 ~]\# vim /data/kubernetes/config/kube-proxy-config.ymlkind: KubeProxyConfigurationapiVersion: kubeproxy.config.k8s.io/v1alpha1bindAddress: 0.0.0.0                  #ÁõëÂê¨Âú∞ÂùÄmetricsBindAddress: 0.0.0.0:10249              #ÁõëÂê¨Á´ØÂè£clientConnection:  kubeconfig: /data/kubernetes/config/kube-proxy.kubeconfig      #kubeconfigÊñá‰ª∂Áî®‰∫éÂíåapiserverÈÄö‰ø°hostnameOverride: binary-k8s-node1        #ÂΩìÂâçËäÇÁÇπÂêçÁß∞clusterCIDR: 10.244.0.0/16"><div></div></button></div></figure></div>
<h4 id="833ÁîüÊàêkube-configÊñá‰ª∂">8.3.3.ÁîüÊàêkube-configÊñá‰ª∂</h4>
<p>Áî±‰∫ékube-proxyÁöÑËØÅ‰π¶Êñá‰ª∂Âú®8.1‰∏≠Â∑≤Áªè‰ªémasterËäÇÁÇπÊã∑Ë¥ùÂà∞nodeËäÇÁÇπ‰∫ÜÔºåÂõ†Ê≠§Áõ¥Êé•ÁîüÊàêkubeconfigÊñá‰ª∂Âç≥ÂèØ„ÄÇ</p>
<p>ÈõÜÁæ§‰∏≠‰∏çÂêåËäÇÁÇπÁöÑÁªÑ‰ª∂ÈÉΩË¶ÅÁî®Âêå‰∏Ä‰∏™ËØÅ‰π¶Êñá‰ª∂„ÄÇ</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.ÁîüÊàêkubeconfigÊñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#Âú®kubeconfigÊñá‰ª∂‰∏≠Â¢ûÂä†ÈõÜÁæ§apiserver‰ø°ÊÅØ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl config set-cluster kubernetes \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--certificate-authority</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/ssl/ca.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--embed-certs</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--server</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.10:6443</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--kubeconfig</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/config/kube-proxy.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#Âú®kubeconfigÊñá‰ª∂‰∏≠Â¢ûÂä†ËØÅ‰π¶Êñá‰ª∂‰ø°ÊÅØ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl config set-credentials kube-proxy \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--client-certificate</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/ssl/kube-proxy.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--client-key</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/ssl/kube-proxy-key.pem</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--embed-certs</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--kubeconfig</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/config/kube-proxy.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#Âú®kubeconfigÊñá‰ª∂‰∏≠Â¢ûÂä†Áî®Êà∑‰ø°ÊÅØ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl config set-context default \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--cluster</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--user</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">kube-proxy</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--kubeconfig</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/config/kube-proxy.kubeconfig</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.ÊåáÂÆöÁîüÊàêÁöÑkubeconfigÊñá‰ª∂‰∏∫ÈõÜÁæ§‰ΩøÁî®</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl config use-context default --kubeconfig=/data/kubernetes/config/kube-proxy.kubeconfig</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.ÁîüÊàêkubeconfigÊñá‰ª∂[root@binary-k8s-node1 ~]\# kubectl config set-cluster kubernetes \--certificate-authority=/data/kubernetes/ssl/ca.pem \--embed-certs=true \--server=&#x22;https://192.168.20.10:6443&#x22; \--kubeconfig=/data/kubernetes/config/kube-proxy.kubeconfig[root@binary-k8s-node1 ~]\# kubectl config set-credentials kube-proxy \--client-certificate=/data/kubernetes/ssl/kube-proxy.pem \--client-key=/data/kubernetes/ssl/kube-proxy-key.pem \--embed-certs=true \--kubeconfig=/data/kubernetes/config/kube-proxy.kubeconfig[root@binary-k8s-node1 ~]\# kubectl config set-context default \--cluster=kubernetes \--user=kube-proxy \--kubeconfig=/data/kubernetes/config/kube-proxy.kubeconfig2.ÊåáÂÆöÁîüÊàêÁöÑkubeconfigÊñá‰ª∂‰∏∫ÈõÜÁæ§‰ΩøÁî®[root@binary-k8s-node1 ~]\# kubectl config use-context default --kubeconfig=/data/kubernetes/config/kube-proxy.kubeconfig"><div></div></button></div></figure></div>
<h4 id="834ÂàõÂª∫systemctlËÑöÊú¨ÁÆ°ÁêÜÊúçÂä°">8.3.4.ÂàõÂª∫systemctlËÑöÊú¨ÁÆ°ÁêÜÊúçÂä°</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /usr/lib/systemd/system/kube-proxy.service</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[Unit]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">Description</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">Kubernetes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">Proxy</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">After</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">network.target</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[Service]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">EnvironmentFile</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/config/kube-proxy.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ExecStart</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/bin/kube-proxy</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">$KUBE_PROXY_OPTS</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">Restart</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">on-failure</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">LimitNOFILE</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">65536</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[Install]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">WantedBy</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">multi-user.targ</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-node1 ~]\# vim /usr/lib/systemd/system/kube-proxy.service[Unit]Description=Kubernetes ProxyAfter=network.target[Service]EnvironmentFile=/data/kubernetes/config/kube-proxy.confExecStart=/data/kubernetes/bin/kube-proxy $KUBE_PROXY_OPTSRestart=on-failureLimitNOFILE=65536[Install]WantedBy=multi-user.targ"><div></div></button></div></figure></div>
<h4 id="835ÂêØÂä®kube-proxyÁªÑ‰ª∂">8.3.5.ÂêØÂä®kube-proxyÁªÑ‰ª∂</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.ÂêØÂä®ÊúçÂä°</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl daemon-reload</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl start kube-proxy</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl enable kube-proxy</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.Êü•ÁúãÁ´ØÂè£</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> netstat -lnpt </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">grep</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-proxy</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp6</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">:::10249</span><span style="--0:#D6DEEB;--1:#403F53">                </span><span style="--0:#ECC48D;--1:#3C63B3">:::</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">                    </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">26954</span><span style="--0:#ECC48D;--1:#3C63B3">/kube-proxy</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp6</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">:::10256</span><span style="--0:#D6DEEB;--1:#403F53">                </span><span style="--0:#ECC48D;--1:#3C63B3">:::</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">                    </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">26954</span><span style="--0:#ECC48D;--1:#3C63B3">/kube-proxy</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.ÂêØÂä®ÊúçÂä°[root@binary-k8s-node1 ~]\# systemctl daemon-reload[root@binary-k8s-node1 ~]\# systemctl start kube-proxy[root@binary-k8s-node1 ~]\# systemctl enable kube-proxy2.Êü•ÁúãÁ´ØÂè£[root@binary-k8s-node1 ~]\# netstat -lnpt | grep kube-proxytcp6       0      0 :::10249                :::*                    LISTEN      26954/kube-proxytcp6       0      0 :::10256                :::*                    LISTEN      26954/kube-proxy"><div></div></button></div></figure></div>
<h3 id="84Âø´ÈÄüÂ¢ûÂä†Êñ∞ÁöÑnodeËäÇÁÇπ">8.4.Âø´ÈÄüÂ¢ûÂä†Êñ∞ÁöÑnodeËäÇÁÇπ</h3>
<p>‰∫åËøõÂà∂ÈÉ®ÁΩ≤ÁöÑÁ®ãÂ∫èÁâπÂà´Â•ΩÁöÑ‰∏Ä‰∏™Âú∞ÊñπÂ∞±Âú®‰∫éÔºåËÉΩÂ§üÂø´ÈÄüÈÉ®ÁΩ≤‰∏Ä‰∏™Êñ∞ÁöÑÊúçÂä°ÔºåÂÅöÊ≥ïÂ∞±ÊòØÁõ¥Êé•Êã∑Ë¥ùÂ∑≤ÁªèÈÉ®ÁΩ≤Â•ΩÁöÑÁõÆÂΩïÂà∞‰∏Ä‰∏™Êñ∞ÁöÑ‰ΩçÁΩÆÔºåÊîπÊîπÂÖ∂‰∏≠ÁöÑÂèÇÊï∞Âç≥ÂèØÂêØÂä®‰ΩøÁî®‰∫Ü„ÄÇ</p>
<h4 id="841Â∞ÜkubeletÂíåkube-proxyÁõÆÂΩïÊã∑Ë¥ùËá≥Êñ∞ÁöÑnodeËäÇÁÇπ">8.4.1.Â∞ÜkubeletÂíåkube-proxyÁõÆÂΩïÊã∑Ë¥ùËá≥Êñ∞ÁöÑnodeËäÇÁÇπ</h4>
<p>Ë¶ÅÊã∑Ë¥ùkubeletÂíåkube-proxyÈÉ®ÁΩ≤ÁõÆÂΩï‰ª•ÂèäsystemctlÂêØÂä®ËÑöÊú¨Êñá‰ª∂„ÄÇ</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> scp -rp /data/kubernetes root@binary-k8s-node2:/data</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> scp /usr/lib/systemd/system/kube</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53"> root@binary-k8s-node2:/usr/lib/systemd/system/</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-node1 ~]\# scp -rp /data/kubernetes root@binary-k8s-node2:/data[root@binary-k8s-node1 ~]\# scp /usr/lib/systemd/system/kube* root@binary-k8s-node2:/usr/lib/systemd/system/"><div></div></button></div></figure></div>
<h4 id="842ÈÖçÁΩÆÂπ∂ÂêØÂä®kubeletÁªÑ‰ª∂">8.4.2.ÈÖçÁΩÆÂπ∂ÂêØÂä®kubeletÁªÑ‰ª∂</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.Âà†Èô§Ê≤°Áî®ÁöÑËØÅ‰π¶Êñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> rm -rf /data/kubernetes/ssl/kubelet-client-</span><span style="--0:#7FDBCA;--1:#097174">*</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.‰øÆÊîπkubeletÈÖçÁΩÆÊñá‰ª∂‰∏≠ÁöÑËäÇÁÇπÂêçÁß∞</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /data/kubernetes/config/kubelet.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">KUBELET_OPTS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">--logtostderr=false </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--v=2 </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--log-dir=/data/kubernetes/logs </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--hostname-override=binary-k8s-node2 </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--network-plugin=cni </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--kubeconfig=/data/kubernetes/config/kubelet.kubeconfig </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--bootstrap-kubeconfig=/data/kubernetes/config/bootstrap.kubeconfig </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--config=/data/kubernetes/config/kubelet-config.yml </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--cert-dir=/data/kubernetes/ssl </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--pod-infra-container-image=pause-amd64:3.0</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#Â∞Ü--hostname-overrideÂÄº‰øÆÊîπ‰∏∫ÂΩìÂâçËäÇÁÇπÂêçÁß∞Âç≥ÂèØ</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.ÂêØÂä®kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl daemon-reload</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl start kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl enable kubelet</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.Âà†Èô§Ê≤°Áî®ÁöÑËØÅ‰π¶Êñá‰ª∂[root@binary-k8s-node2 ~]\# rm -rf /data/kubernetes/ssl/kubelet-client-*2.‰øÆÊîπkubeletÈÖçÁΩÆÊñá‰ª∂‰∏≠ÁöÑËäÇÁÇπÂêçÁß∞[root@binary-k8s-node2 ~]\# vim /data/kubernetes/config/kubelet.confKUBELET_OPTS=&#x22;--logtostderr=false \--v=2 \--log-dir=/data/kubernetes/logs \--hostname-override=binary-k8s-node2 \--network-plugin=cni \--kubeconfig=/data/kubernetes/config/kubelet.kubeconfig \--bootstrap-kubeconfig=/data/kubernetes/config/bootstrap.kubeconfig \--config=/data/kubernetes/config/kubelet-config.yml \--cert-dir=/data/kubernetes/ssl \--pod-infra-container-image=pause-amd64:3.0&#x22;3.ÂêØÂä®kubelet[root@binary-k8s-node2 ~]\# systemctl daemon-reload[root@binary-k8s-node2 ~]\# systemctl start kubelet[root@binary-k8s-node2 ~]\# systemctl enable kubelet"><div></div></button></div></figure></div>
<h4 id="843masterËäÇÁÇπÊéàÊùÉÊñ∞nodeËäÇÁÇπÁöÑËØ∑Ê±Ç">8.4.3.masterËäÇÁÇπÊéàÊùÉÊñ∞nodeËäÇÁÇπÁöÑËØ∑Ê±Ç</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.masterËäÇÁÇπÊü•ÁúãÊéàÊùÉ‰ø°ÊÅØÂàóË°®</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get csr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                                                   </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">SIGNERNAME</span><span style="--0:#D6DEEB;--1:#403F53">                                    </span><span style="--0:#ECC48D;--1:#3C63B3">REQUESTOR</span><span style="--0:#D6DEEB;--1:#403F53">           </span><span style="--0:#ECC48D;--1:#3C63B3">CONDITION</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">node-csr-u_AHUS7T5rku-hnhnGsGi8uGBqlgMquOq_3oq6jrOyE</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">48</span><span style="--0:#ECC48D;--1:#3C63B3">s</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes.io/kube-apiserver-client-kubelet</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">kubelet-bootstrap</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">Pending</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.ÊéàÊùÉÈÄöËøánodeËäÇÁÇπÁöÑkubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl certificate approve node-csr-u_AHUS7T5rku-hnhnGsGi8uGBqlgMquOq_3oq6jrOyE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">certificatesigningrequest.certificates.k8s.io/node-csr-u_AHUS7T5rku-hnhnGsGi8uGBqlgMquOq_3oq6jrOyE</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">approved</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.ÊàêÂäüÂä†ÂÖ•ÈõÜÁæ§</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get node</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                 </span><span style="--0:#ECC48D;--1:#3C63B3">STATUS</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">ROLES</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">VERSION</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">binary-k8s-master1</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">Ready</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">d23h</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">v1.20.4</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">binary-k8s-node1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Ready</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">5</span><span style="--0:#ECC48D;--1:#3C63B3">h54m</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">v1.20.4</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">binary-k8s-node2</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Ready</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">s</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#ECC48D;--1:#3C63B3">v1.20.4</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">4.Êü•ÁúãkubeletÁöÑÁ´ØÂè£</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> netstat -lnpt </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">grep</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">127.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.1:41121</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0:</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">16694</span><span style="--0:#ECC48D;--1:#3C63B3">/kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">127.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.1:10248</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0:</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">16694</span><span style="--0:#ECC48D;--1:#3C63B3">/kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp6</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">:::10250</span><span style="--0:#D6DEEB;--1:#403F53">                </span><span style="--0:#ECC48D;--1:#3C63B3">:::</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">                    </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">16694</span><span style="--0:#ECC48D;--1:#3C63B3">/kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp6</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">:::10255</span><span style="--0:#D6DEEB;--1:#403F53">                </span><span style="--0:#ECC48D;--1:#3C63B3">:::</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">                    </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">16694</span><span style="--0:#ECC48D;--1:#3C63B3">/kubelet</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.masterËäÇÁÇπÊü•ÁúãÊéàÊùÉ‰ø°ÊÅØÂàóË°®[root@binary-k8s-master1 ~]\# kubectl get csrNAME                                                   AGE   SIGNERNAME                                    REQUESTOR           CONDITIONnode-csr-u_AHUS7T5rku-hnhnGsGi8uGBqlgMquOq_3oq6jrOyE   48s   kubernetes.io/kube-apiserver-client-kubelet   kubelet-bootstrap   Pending2.ÊéàÊùÉÈÄöËøánodeËäÇÁÇπÁöÑkubelet[root@binary-k8s-master1 ~]\# kubectl certificate approve node-csr-u_AHUS7T5rku-hnhnGsGi8uGBqlgMquOq_3oq6jrOyEcertificatesigningrequest.certificates.k8s.io/node-csr-u_AHUS7T5rku-hnhnGsGi8uGBqlgMquOq_3oq6jrOyE approved3.ÊàêÂäüÂä†ÂÖ•ÈõÜÁæ§[root@binary-k8s-master1 ~]\# kubectl get nodeNAME                 STATUS   ROLES    AGE     VERSIONbinary-k8s-master1   Ready    <none>   2d23h   v1.20.4binary-k8s-node1     Ready    <none>   5h54m   v1.20.4binary-k8s-node2     Ready    <none>   1s      v1.20.44.Êü•ÁúãkubeletÁöÑÁ´ØÂè£[root@binary-k8s-node2 ~]\# netstat -lnpt | grep kubetcp        0      0 127.0.0.1:41121         0.0.0.0:*               LISTEN      16694/kubelettcp        0      0 127.0.0.1:10248         0.0.0.0:*               LISTEN      16694/kubelettcp6       0      0 :::10250                :::*                    LISTEN      16694/kubelettcp6       0      0 :::10255                :::*                    LISTEN      16694/kubelet"><div></div></button></div></figure></div>
<h4 id="844ÈÖçÁΩÆÂπ∂ÂêØÂä®kube-proxyÁªÑ‰ª∂">8.4.4.ÈÖçÁΩÆÂπ∂ÂêØÂä®kube-proxyÁªÑ‰ª∂</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.‰øÆÊîπkube-proxyÂèÇÊï∞ÈÖçÁΩÆÊñá‰ª∂‰∏≠ÁöÑ‰∏ªÊú∫Âêç</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /data/kubernetes/config/kube-proxy-config.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">KubeProxyConfiguration</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">apiVersion:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kubeproxy.config.k8s.io/v1alpha1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">bindAddress:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">metricsBindAddress:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0:10249</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">clientConnection:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">kubeconfig:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/kubernetes/config/kube-proxy.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">hostnameOverride:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">binary-k8s-node2</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">clusterCIDR:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10.244</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0/16</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.ÂêØÂä®kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl daemon-reload</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl start kube-proxy</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl enable kube-proxy</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3Êü•Áúãkube-proxyÁ´ØÂè£</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> netstat -lnpt </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">grep</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">127.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.1:41121</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0:</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">16694</span><span style="--0:#ECC48D;--1:#3C63B3">/kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">127.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.1:10248</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0:</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">16694</span><span style="--0:#ECC48D;--1:#3C63B3">/kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp6</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">:::10249</span><span style="--0:#D6DEEB;--1:#403F53">                </span><span style="--0:#ECC48D;--1:#3C63B3">:::</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">                    </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">20410</span><span style="--0:#ECC48D;--1:#3C63B3">/kube-proxy</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp6</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">:::10250</span><span style="--0:#D6DEEB;--1:#403F53">                </span><span style="--0:#ECC48D;--1:#3C63B3">:::</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">                    </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">16694</span><span style="--0:#ECC48D;--1:#3C63B3">/kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp6</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">:::10255</span><span style="--0:#D6DEEB;--1:#403F53">                </span><span style="--0:#ECC48D;--1:#3C63B3">:::</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">                    </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">16694</span><span style="--0:#ECC48D;--1:#3C63B3">/kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp6</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">:::10256</span><span style="--0:#D6DEEB;--1:#403F53">                </span><span style="--0:#ECC48D;--1:#3C63B3">:::</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">                    </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">20410</span><span style="--0:#ECC48D;--1:#3C63B3">/kube-proxy</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.‰øÆÊîπkube-proxyÂèÇÊï∞ÈÖçÁΩÆÊñá‰ª∂‰∏≠ÁöÑ‰∏ªÊú∫Âêç[root@binary-k8s-node2 ~]\# vim /data/kubernetes/config/kube-proxy-config.ymlkind: KubeProxyConfigurationapiVersion: kubeproxy.config.k8s.io/v1alpha1bindAddress: 0.0.0.0metricsBindAddress: 0.0.0.0:10249clientConnection:  kubeconfig: /data/kubernetes/config/kube-proxy.kubeconfighostnameOverride: binary-k8s-node2clusterCIDR: 10.244.0.0/162.ÂêØÂä®kubelet[root@binary-k8s-node2 ~]\# systemctl daemon-reload[root@binary-k8s-node2 ~]\# systemctl start kube-proxy[root@binary-k8s-node2 ~]\# systemctl enable kube-proxy3Êü•Áúãkube-proxyÁ´ØÂè£[root@binary-k8s-node2 ~]\# netstat -lnpt | grep kubetcp        0      0 127.0.0.1:41121         0.0.0.0:*               LISTEN      16694/kubelettcp        0      0 127.0.0.1:10248         0.0.0.0:*               LISTEN      16694/kubelettcp6       0      0 :::10249                :::*                    LISTEN      20410/kube-proxytcp6       0      0 :::10250                :::*                    LISTEN      16694/kubelettcp6       0      0 :::10255                :::*                    LISTEN      16694/kubelettcp6       0      0 :::10256                :::*                    LISTEN      20410/kube-proxy"><div></div></button></div></figure></div>
<h2 id="9‰∏∫ÈõÜÁæ§ÈÉ®ÁΩ≤corednsÁªÑ‰ª∂">9.‰∏∫ÈõÜÁæ§ÈÉ®ÁΩ≤corednsÁªÑ‰ª∂</h2>
<h3 id="91ÈÉ®ÁΩ≤corednsÁªÑ‰ª∂">9.1.ÈÉ®ÁΩ≤corednsÁªÑ‰ª∂</h3>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.coredns.yamlÊñá‰ª∂ÂÜÖÂÆπ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cat coredns.yaml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671"># Warning: This is a file generated from the base underscore template file: coredns.yaml.base</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">apiVersion:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ServiceAccount</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">coredns</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">namespace:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-system</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">labels:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">kubernetes.io/cluster-service:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">true</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">addonmanager.kubernetes.io/mode:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Reconcile</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">apiVersion:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">rbac.authorization.k8s.io/v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ClusterRole</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">labels:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">kubernetes.io/bootstrapping:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">rbac-defaults</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">addonmanager.kubernetes.io/mode:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Reconcile</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">system:coredns</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">rules:</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">apiGroups:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">""</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">resources:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">endpoints</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">services</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">pods</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">namespaces</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">verbs:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">list</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">watch</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">apiGroups:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">""</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">resources:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">nodes</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">verbs:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">get</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">apiVersion:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">rbac.authorization.k8s.io/v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ClusterRoleBinding</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">annotations:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">rbac.authorization.kubernetes.io/autoupdate:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">true</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">labels:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">kubernetes.io/bootstrapping:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">rbac-defaults</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">addonmanager.kubernetes.io/mode:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">EnsureExists</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">system:coredns</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">roleRef:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">apiGroup:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">rbac.authorization.k8s.io</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ClusterRole</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">system:coredns</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">subjects:</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ServiceAccount</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">coredns</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">namespace:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-system</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">apiVersion:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ConfigMap</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">coredns</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">namespace:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-system</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">labels:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">addonmanager.kubernetes.io/mode:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">EnsureExists</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">data:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">Corefile:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C5E478;--1:#3C63B3">.</span><span style="--0:#D6DEEB;--1:#403F53">:53 </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">log</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">errors</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">health</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">lameduck</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">5</span><span style="--0:#ECC48D;--1:#3C63B3">s</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">ready</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">kubernetes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">cluster.local</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">in-addr.arpa</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ip6.arpa</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">pods</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">insecure</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">fallthrough</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">in-addr.arpa</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ip6.arpa</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">ttl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">30</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">prometheus</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">:9153</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">forward</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">.</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/resolv.conf</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">cache</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">30</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">loop</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">reload</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">loadbalance</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">apiVersion:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">apps/v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Deployment</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">coredns</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">namespace:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-system</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">labels:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">k8s-app:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-dns</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">kubernetes.io/cluster-service:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">true</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">addonmanager.kubernetes.io/mode:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Reconcile</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">kubernetes.io/name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">CoreDNS</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">spec:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#809191;--1:#616671"># replicas: not specified here:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#809191;--1:#616671"># 1. In order to make Addon Manager do not reconcile this replicas parameter.</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#809191;--1:#616671"># 2. Default is 1.</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#809191;--1:#616671"># 3. Will be tuned in real time if DNS horizontal auto-scaling is turned on.</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">strategy:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C5E478;--1:#3C63B3">type</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">RollingUpdate</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">rollingUpdate:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">maxUnavailable:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">selector:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">matchLabels:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">k8s-app:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-dns</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">template:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">labels:</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">k8s-app:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-dns</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">annotations:</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">seccomp.security.alpha.kubernetes.io/pod:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">runtime/default</span><span style="--0:#D9F5DD;--1:#111111">'</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">spec:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">priorityClassName:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">system-cluster-critical</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">serviceAccountName:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">coredns</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">tolerations:</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">key:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">CriticalAddonsOnly</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#82AAFF;--1:#3C63B3">operator:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Exists</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">nodeSelector:</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">kubernetes.io/os:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">linux</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">containers:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">coredns</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">image:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">coredns:1.6.7</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">imagePullPolicy:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">IfNotPresent</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">resources:</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#82AAFF;--1:#3C63B3">limits:</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">memory:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">512</span><span style="--0:#ECC48D;--1:#3C63B3">Mi</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#82AAFF;--1:#3C63B3">requests:</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">cpu:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">100</span><span style="--0:#ECC48D;--1:#3C63B3">m</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">memory:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">70</span><span style="--0:#ECC48D;--1:#3C63B3">Mi</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">args:</span><span style="--0:#D6DEEB;--1:#403F53"> [ </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">-conf</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">/etc/coredns/Corefile</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">]</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">volumeMounts:</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">config-volume</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#82AAFF;--1:#3C63B3">mountPath:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/coredns</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#82AAFF;--1:#3C63B3">readOnly:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">ports:</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">containerPort:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">53</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">dns</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#82AAFF;--1:#3C63B3">protocol:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">UDP</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">containerPort:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">53</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">dns-tcp</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#82AAFF;--1:#3C63B3">protocol:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">TCP</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">containerPort:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9153</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">metrics</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#82AAFF;--1:#3C63B3">protocol:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">TCP</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">livenessProbe:</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#82AAFF;--1:#3C63B3">httpGet:</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">path:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/health</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">port:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">8080</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">scheme:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">HTTP</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#82AAFF;--1:#3C63B3">initialDelaySeconds:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">60</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#82AAFF;--1:#3C63B3">timeoutSeconds:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">5</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#82AAFF;--1:#3C63B3">successThreshold:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#82AAFF;--1:#3C63B3">failureThreshold:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">5</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">readinessProbe:</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#82AAFF;--1:#3C63B3">httpGet:</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">path:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/ready</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">port:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">8181</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">scheme:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">HTTP</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">securityContext:</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#82AAFF;--1:#3C63B3">allowPrivilegeEscalation:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">false</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#82AAFF;--1:#3C63B3">capabilities:</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">add:</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">NET_BIND_SERVICE</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">drop:</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">all</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#82AAFF;--1:#3C63B3">readOnlyRootFilesystem:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">dnsPolicy:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Default</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">volumes:</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">config-volume</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#82AAFF;--1:#3C63B3">configMap:</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">coredns</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">items:</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">key:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Corefile</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#82AAFF;--1:#3C63B3">path:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Corefile</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">apiVersion:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Service</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-dns</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">namespace:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-system</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">annotations:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">prometheus.io/port:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">9153</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">prometheus.io/scrape:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">true</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">labels:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">k8s-app:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-dns</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">kubernetes.io/cluster-service:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">true</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">addonmanager.kubernetes.io/mode:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Reconcile</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">kubernetes.io/name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">CoreDNS</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">spec:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">selector:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">k8s-app:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">kube-dns</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">clusterIP:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">10.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.2</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">ports:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">dns</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">port:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">53</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">protocol:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">UDP</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">dns-tcp</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">port:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">53</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">protocol:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">TCP</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">metrics</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">port:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">9153</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">protocol:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">TCP</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.ÈÉ®ÁΩ≤coredns</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl apply -f coredns.yaml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">serviceaccount/coredns</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">clusterrole.rbac.authorization.k8s.io/system:coredns</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">clusterrolebinding.rbac.authorization.k8s.io/system:coredns</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">configmap/coredns</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">deployment.apps/coredns</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">service/kube-dns</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.coredns.yamlÊñá‰ª∂ÂÜÖÂÆπ[root@binary-k8s-master1 ~]\# cat coredns.yamlapiVersion: v1kind: ServiceAccountmetadata:  name: coredns  namespace: kube-system  labels:      kubernetes.io/cluster-service: &#x22;true&#x22;      addonmanager.kubernetes.io/mode: Reconcile---apiVersion: rbac.authorization.k8s.io/v1kind: ClusterRolemetadata:  labels:    kubernetes.io/bootstrapping: rbac-defaults    addonmanager.kubernetes.io/mode: Reconcile  name: system:corednsrules:- apiGroups:  - &#x22;&#x22;  resources:  - endpoints  - services  - pods  - namespaces  verbs:  - list  - watch- apiGroups:  - &#x22;&#x22;  resources:  - nodes  verbs:  - get---apiVersion: rbac.authorization.k8s.io/v1kind: ClusterRoleBindingmetadata:  annotations:    rbac.authorization.kubernetes.io/autoupdate: &#x22;true&#x22;  labels:    kubernetes.io/bootstrapping: rbac-defaults    addonmanager.kubernetes.io/mode: EnsureExists  name: system:corednsroleRef:  apiGroup: rbac.authorization.k8s.io  kind: ClusterRole  name: system:corednssubjects:- kind: ServiceAccount  name: coredns  namespace: kube-system---apiVersion: v1kind: ConfigMapmetadata:  name: coredns  namespace: kube-system  labels:      addonmanager.kubernetes.io/mode: EnsureExistsdata:  Corefile: |    .:53 {        log        errors        health {            lameduck 5s        }        ready        kubernetes cluster.local in-addr.arpa ip6.arpa {            pods insecure            fallthrough in-addr.arpa ip6.arpa            ttl 30        }        prometheus :9153        forward . /etc/resolv.conf        cache 30        loop        reload        loadbalance    }---apiVersion: apps/v1kind: Deploymentmetadata:  name: coredns  namespace: kube-system  labels:    k8s-app: kube-dns    kubernetes.io/cluster-service: &#x22;true&#x22;    addonmanager.kubernetes.io/mode: Reconcile    kubernetes.io/name: &#x22;CoreDNS&#x22;spec:  strategy:    type: RollingUpdate    rollingUpdate:      maxUnavailable: 1  selector:    matchLabels:      k8s-app: kube-dns  template:    metadata:      labels:        k8s-app: kube-dns      annotations:        seccomp.security.alpha.kubernetes.io/pod: &#x27;runtime/default&#x27;    spec:      priorityClassName: system-cluster-critical      serviceAccountName: coredns      tolerations:        - key: &#x22;CriticalAddonsOnly&#x22;          operator: &#x22;Exists&#x22;      nodeSelector:        kubernetes.io/os: linux      containers:      - name: coredns        image: coredns:1.6.7        imagePullPolicy: IfNotPresent        resources:          limits:            memory: 512Mi          requests:            cpu: 100m            memory: 70Mi        args: [ &#x22;-conf&#x22;, &#x22;/etc/coredns/Corefile&#x22; ]        volumeMounts:        - name: config-volume          mountPath: /etc/coredns          readOnly: true        ports:        - containerPort: 53          name: dns          protocol: UDP        - containerPort: 53          name: dns-tcp          protocol: TCP        - containerPort: 9153          name: metrics          protocol: TCP        livenessProbe:          httpGet:            path: /health            port: 8080            scheme: HTTP          initialDelaySeconds: 60          timeoutSeconds: 5          successThreshold: 1          failureThreshold: 5        readinessProbe:          httpGet:            path: /ready            port: 8181            scheme: HTTP        securityContext:          allowPrivilegeEscalation: false          capabilities:            add:            - NET_BIND_SERVICE            drop:            - all          readOnlyRootFilesystem: true      dnsPolicy: Default      volumes:        - name: config-volume          configMap:            name: coredns            items:            - key: Corefile              path: Corefile---apiVersion: v1kind: Servicemetadata:  name: kube-dns  namespace: kube-system  annotations:    prometheus.io/port: &#x22;9153&#x22;    prometheus.io/scrape: &#x22;true&#x22;  labels:    k8s-app: kube-dns    kubernetes.io/cluster-service: &#x22;true&#x22;    addonmanager.kubernetes.io/mode: Reconcile    kubernetes.io/name: &#x22;CoreDNS&#x22;spec:  selector:    k8s-app: kube-dns  clusterIP: 10.0.0.2  ports:  - name: dns    port: 53    protocol: UDP  - name: dns-tcp    port: 53    protocol: TCP  - name: metrics    port: 9153    protocol: TCP2.ÈÉ®ÁΩ≤coredns[root@binary-k8s-master1 ~]\# kubectl apply -f coredns.yamlserviceaccount/coredns createdclusterrole.rbac.authorization.k8s.io/system:coredns createdclusterrolebinding.rbac.authorization.k8s.io/system:coredns createdconfigmap/coredns createddeployment.apps/coredns createdservice/kube-dns created"><div></div></button></div></figure></div>
<h3 id="92ËøêË°å‰∏Ä‰∏™busyboxÂÆπÂô®ÊµãËØïdns">9.2.ËøêË°å‰∏Ä‰∏™busyboxÂÆπÂô®ÊµãËØïdns</h3>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl run -it --rm dns-test --image=busybox:1.28.4 sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">If</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">you</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">don</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">t see a command prompt, try pressing enter.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">/ # nslookup kubernetes</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">Server:    10.0.0.2</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">Address 1: 10.0.0.2 kube-dns.kube-system.svc.cluster.local</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">Name:      kubernetes</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">Address 1: 10.0.0.1 kubernetes.default.svc.cluster.local</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">/ # nslookup kube-dns.kube-system</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">Server:    10.0.0.2</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">Address 1: 10.0.0.2 kube-dns.kube-system.svc.cluster.local</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">Name:      kube-dns.kube-system</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">Address 1: 10.0.0.2 kube-dns.kube-system.svc.cluster.local</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">/ # exit</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 ~]\# kubectl run -it --rm dns-test --image=busybox:1.28.4 shIf you don&#x27;t see a command prompt, try pressing enter./ # nslookup kubernetesServer:    10.0.0.2Address 1: 10.0.0.2 kube-dns.kube-system.svc.cluster.localName:      kubernetesAddress 1: 10.0.0.1 kubernetes.default.svc.cluster.local/ # nslookup kube-dns.kube-systemServer:    10.0.0.2Address 1: 10.0.0.2 kube-dns.kube-system.svc.cluster.localName:      kube-dns.kube-systemAddress 1: 10.0.0.2 kube-dns.kube-system.svc.cluster.local/ # exit"><div></div></button></div></figure></div>
<h2 id="10Êâ©ÂÆπmasterËäÇÁÇπÁªÑÂª∫kubernetesÈ´òÂèØÁî®ÈõÜÁæ§">10.Êâ©ÂÆπmasterËäÇÁÇπÁªÑÂª∫kubernetesÈ´òÂèØÁî®ÈõÜÁæ§</h2>
<h3 id="101kubernetesÈ´òÂèØÁî®Êû∂ÊûÑÊ¶ÇÂøµ">10.1.kubernetesÈ´òÂèØÁî®Êû∂ÊûÑÊ¶ÇÂøµ</h3>
<p>kubernetesÈõÜÁæ§ÈÄöËøáÂÅ•Â∫∑Ê£ÄÊü•ÂíåÈáçÂêØÁ≠ñÁï•ÂÆûÁé∞‰∫ÜPodÊïÖÈöúËá™ÊÑàËÉΩÂäõÔºå‰πüÈÄöËøáË∞ÉÂ∫¶ÁÆóÊ≥ïÂÆûÁé∞Â∞ÜPodÂàÜÂ∏ÉÂºèÈÉ®ÁΩ≤ÔºåÂπ∂ÂèØ‰ª•ÈÄöËøáËÆæÁΩÆPodÁöÑÂâØÊú¨Êï∞ÔºåÂÆûÁé∞È´òÂπ∂ÂèëËÉΩÂäõÔºåÂç≥‰ΩøNodeËäÇÁÇπÂá∫Áé∞ÊïÖÈöúÔºåMasterËäÇÁÇπ‰πü‰ºöÂ∞ÜÊïÖÈöúÁöÑNodeËäÇÁÇπ‰∏äÁöÑPodËøÅÁßªÂà∞Ê≠£Â∏∏Â∑•‰ΩúÁöÑNodeËäÇÁÇπ‰∏äÔºåÂÆûÁé∞Â∫îÁî®Â±ÇÁöÑÈ´òÂèØÁî®ÊÄß</p>
<p>ÈíàÂØπKubernetesÈõÜÁæ§ÔºåÈ´òÂèØÁî®ÊÄßÂåÖÊã¨EtcdÊï∞ÊçÆÂ∫ìÈ´òÂèØÁî®„ÄÅMatserËäÇÁÇπÁªÑ‰ª∂ÁöÑÈ´òÂèØÁî®ÔºåEtcdÂèØ‰ª•ÈÄöËøáÈõÜÁæ§ÊñπÂºèÂÆûÁé∞È´òÂèØÁî®ÔºåËÄåÂè™ÊúâÂçïÂè∞MasterËäÇÁÇπÔºå‰∏ÄÊó¶MasterËäÇÁÇπ‰∏äÁöÑÁªÑ‰ª∂Âá∫Áé∞‰∫ÜÊïÖÈöúÔºåÊï¥‰∏™ÈõÜÁæ§Â∞Ü‰ºö‰∏çÂèØÁî®„ÄÇ</p>
<p>MasterËäÇÁÇπÊòØÂ±û‰∫éÊéßÂà∂Êï¥‰∏™ÈõÜÁæ§ÁöÑËßíËâ≤ÔºåÊâÄÊúâÁöÑÁªÑ‰ª∂ÈÉΩÈúÄË¶Å‰∏éMasterËäÇÁÇπÁöÑApiServerËøõË°å‰∫§‰∫íÔºå‰∏çÊñ≠‰∏éNodeËäÇÁÇπ‰∏äÁöÑKubeletÂíåKube-ProxyËøõË°åÈÄö‰ø°Êù•Áª¥Êä§Êï¥‰∏™ÈõÜÁæ§ÁöÑÂ∑•‰ΩúÁä∂ÊÄÅÔºåÂ¶ÇÊûúApiServerÂèëÁîüÊïÖÈöúÔºåÂ∞ÜÊó†Ê≥ï‰∏éNodeËäÇÁÇπËøõË°åÈÄö‰ø°Ôºå‰πüÂ∞±Êó†Ê≥ïÁÆ°ÁêÜÈõÜÁæ§„ÄÇ</p>
<p>Âõ†Ê≠§KubernetesÈõÜÁæ§ÊúÄ‰∏ªË¶ÅÁöÑÂ∞±ÊòØÂØπMasterËäÇÁÇπËøõË°åÈ´òÂèØÁî®ÈÖçÁΩÆ„ÄÇ</p>
<p>MasterËäÇÁÇπ‰∏ªË¶ÅÊúâ‰∏â‰∏™ÊúçÂä°Ôºökube-apiserver„ÄÅkube-controller-manage„ÄÅkube-schedulerÔºåÂΩìÈõÜÁæ§ÊúâÂ§öÂè∞MasterËäÇÁÇπÊó∂ÔºåÂÖ∂‰∏≠kube-controller-manageÂíåkube-schedulerÈÉΩÂèØ‰ª•ÈÄöËøáËá™Ë∫´ÁöÑÈÄâ‰∏æÊú∫Âà∂ÂÆûÁé∞È´òÂèØÁî®Ôºå‰ΩÜÊòØkube-apiserverÂ∞±Ê≤°ÊúâËøôÁßçÊú∫Âà∂ÔºåÂõ†Ê≠§‰∏ªË¶ÅÈíàÂØπkube-apiserverÈÖçÁΩÆÈ´òÂèØÁî®Âç≥ÂèØÔºåkube-apiserverÊèê‰æõÁöÑÊòØHTTP APIÊé•Âè£ÊúçÂä°ÔºåÂõ†Ê≠§ÂèØ‰ª•ÂÉèwebÊúçÂä°ÈÇ£ÁßçÔºå‰ΩøÁî®nginx+keepalivedÊñπÂºèÂÆûÁé∞MasterËäÇÁÇπÈ´òÂèØÁî®ÔºåÂπ∂‰∏î‰πüÂèØ‰ª•Ê∞¥Âπ≥Êâ©ÂÆπ„ÄÇ</p>
<p>ÈÖçÁΩÆkubernetesÈõÜÁæ§È´òÂèØÁî®ÁöÑ‰∏ªË¶ÅÊ≠•È™§Â∞±ÊòØÔºö</p>
<p>1„ÄÅÂ¢ûÂä†‰∏ÄÂè∞ÊàñÂ§öÂè∞MasterËäÇÁÇπÔºåÈÉ®ÁΩ≤MasterËäÇÁÇπÁõ∏ÂÖ≥ÁªÑ‰ª∂ÔºåÂú®Ëøô‰∏™masterËäÇÁÇπ‰∏äÈÖçÁΩÆÁöÑÁõëÂê¨Âú∞ÂùÄËøòÊòØËá™Ë∫´ÁöÑÂú∞ÂùÄÔºõ</p>
<p>2„ÄÅÂú®Êñ∞Â¢ûÁöÑMasterËäÇÁÇπ‰∏äÈÉ®ÁΩ≤etcdÔºå‰ΩøetcdÂä†ÂÖ•Áé∞ÊúâÁöÑetcdÈõÜÁæ§Ôºå‰ΩøetcdÁöÑÊÄßËÉΩÊõ¥Âº∫Ôºõ</p>
<p>3„ÄÅÈÖçÁΩÆnginx+keepalivedÂÆûÁé∞ApiserverÁªÑ‰ª∂È´òÂèØÁî®Ôºõ</p>
<p>4„ÄÅÈÖçÁΩÆÊâÄÊúâÁöÑNodeËäÇÁÇπÔºåÂ∞ÜÊâÄÈÖçÁΩÆÁöÑApiserverÂú∞ÂùÄÊîπÊàêkeepalivedËôöÊãüÂá∫Êù•ÁöÑVIPÂú∞ÂùÄÔºåÂÆûÁé∞ÈõÜÁæ§È´òÂèØÁî®Ôºõ</p>
<p>È´òÂèØÁî®kubernetesÈõÜÁæ§‰∏ÄËà¨3Âè∞masterËäÇÁÇπË∂≥Áü£Ôºå‰ΩÜÊòØetcdÊï∞ÊçÆÂ∫ì‰∏ÄÂÆöË¶ÅÂ§öÂ§öÁõäÂñÑ</p>
<h3 id="102Âú®ÈõÜÁæ§‰∏≠Êñ∞Â¢û‰∏Ä‰∏™etcdËäÇÁÇπ">10.2.Âú®ÈõÜÁæ§‰∏≠Êñ∞Â¢û‰∏Ä‰∏™etcdËäÇÁÇπ</h3>
<p>Êâ©ÂÆπetcdÊ≠•È™§Ôºö</p>
<p>1„ÄÅÈÉ®ÁΩ≤‰∏ÄÂè∞ÂçïËäÇÁÇπÁöÑetcdÔºåËÉΩÂ§üÊ≠£Â∏∏ÂêØÂä®ÊúçÂä°</p>
<p>2„ÄÅÂú®Áé∞ÊúâetcdÈõÜÁæ§‰∏≠Â¢ûÂä†Êñ∞ÁöÑetcdËäÇÁÇπ</p>
<p>3„ÄÅÂ∞ÜÂçïÁÇπÁöÑetcdÈÖçÁΩÆÊàêÈõÜÁæ§Ê®°Âºè</p>
<p>4„ÄÅÂà†Èô§ÂçïÁÇπÈÄ†ÊàêÁöÑÊï∞ÊçÆÊñá‰ª∂</p>
<p>5„ÄÅÊâÄÊúâËäÇÁÇπ‰øÆÊîπÈÖçÁΩÆÊñá‰ª∂Â¢ûÂä†Êñ∞ÁöÑetcdËäÇÁÇπ‰ø°ÊÅØ</p>
<p>6„ÄÅÈáçÂêØÊâÄÊúâetcdËäÇÁÇπ</p>
<h4 id="1021È¶ñÂÖàÊñ∞Â¢ûÂä†‰∏ÄÂè∞ÂçïÁÇπÁöÑetcd">10.2.1.È¶ñÂÖàÊñ∞Â¢ûÂä†‰∏ÄÂè∞ÂçïÁÇπÁöÑetcd</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.ÂÆâË£ÖetcdÁ®ãÂ∫è</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> tar xf etcd-v3.4.9-linux-amd64.tar.gz</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> mkdir /data/etcd/{</span><span style="--0:#82AAFF;--1:#3C63B3">bin,conf,ssl,data}</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-p</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> mv etcd-v3.4.9-linux-amd64/etcd</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53"> /data/etcd/bin/</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.ÂàõÂª∫ÂçïÁÇπÈÖçÁΩÆÊñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /data/etcd/conf/etcd.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#[Service]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_NAME</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">etcd-4</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_DATA_DIR</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">/data/etcd/data</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_LISTEN_PEER_URLS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.11:2380</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_LISTEN_CLIENT_URLS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.11:2379,http://127.0.0.1:2379</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#[cluster]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_INITIAL_ADVERTISE_PEER_URLS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.11:2380</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_ADVERTISE_CLIENT_URLS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.11:2379,http://127.0.0.1:2379</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_INITIAL_CLUSTER</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">etcd-4=https://192.168.20.11:2380</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_INITIAL_CLUSTER_STATE</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">new</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">4.Êã∑Ë¥ùËØÅ‰π¶Êñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> scp root@192.168.20.10:/data/etcd/ssl/</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53"> /data/etcd/ssl/</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">5.Êã∑Ë¥ùsystemctlÁÆ°ÁêÜËÑöÊú¨</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> scp root@192.168.20.10:/usr/lib/systemd/system/etcd.service /usr/lib/systemd/system/</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">6.ÂêØÂä®etcdÊúçÂä°</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl daemon-reload</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53">  systemctl start etcd</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">7.Êü•ÁúãÁ´ØÂè£</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> netstat -lnpt </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">grep</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">etcd</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#ECC48D;--1:#3C63B3">.20.11:2379</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0:</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">15753</span><span style="--0:#ECC48D;--1:#3C63B3">/etcd</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">127.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.1:2379</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0:</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">15753</span><span style="--0:#ECC48D;--1:#3C63B3">/etcd</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#ECC48D;--1:#3C63B3">.20.11:2380</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0:</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">15753</span><span style="--0:#ECC48D;--1:#3C63B3">/etcd</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">8.Êü•ÁúãËäÇÁÇπÁä∂ÊÄÅ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> /data/etcd/bin/etcdctl endpoint health --write-out=table</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">+----------------+--------+------------+-------+</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#82AAFF;--1:#3C63B3">ENDPOINT</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">HEALTH</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#82AAFF;--1:#3C63B3">TOOK</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">ERROR</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">+----------------+--------+------------+-------+</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">127.0.0.1:2379</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#C5E478;--1:#3C63B3">true</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">7.146222ms</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#7FDBCA;--1:#097174">|</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">+----------------+--------+------------+-------+</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.ÂÆâË£ÖetcdÁ®ãÂ∫è[root@binary-k8s-master2 ~]\# tar xf etcd-v3.4.9-linux-amd64.tar.gz[root@binary-k8s-master2 ~]\# mkdir /data/etcd/{bin,conf,ssl,data} -p[root@binary-k8s-master2 ~]\# mv etcd-v3.4.9-linux-amd64/etcd* /data/etcd/bin/2.ÂàõÂª∫ÂçïÁÇπÈÖçÁΩÆÊñá‰ª∂[root@binary-k8s-master2 ~]\# vim /data/etcd/conf/etcd.confETCD_NAME=&#x22;etcd-4&#x22;ETCD_DATA_DIR=&#x22;/data/etcd/data&#x22;ETCD_LISTEN_PEER_URLS=&#x22;https://192.168.20.11:2380&#x22;ETCD_LISTEN_CLIENT_URLS=&#x22;https://192.168.20.11:2379,http://127.0.0.1:2379&#x22;ETCD_INITIAL_ADVERTISE_PEER_URLS=&#x22;https://192.168.20.11:2380&#x22;ETCD_ADVERTISE_CLIENT_URLS=&#x22;https://192.168.20.11:2379,http://127.0.0.1:2379&#x22;ETCD_INITIAL_CLUSTER=&#x22;etcd-4=https://192.168.20.11:2380&#x22;ETCD_INITIAL_CLUSTER_STATE=&#x22;new&#x22;4.Êã∑Ë¥ùËØÅ‰π¶Êñá‰ª∂[root@binary-k8s-master2 ~]\# scp root@192.168.20.10:/data/etcd/ssl/* /data/etcd/ssl/5.Êã∑Ë¥ùsystemctlÁÆ°ÁêÜËÑöÊú¨[root@binary-k8s-master2 ~]\# scp root@192.168.20.10:/usr/lib/systemd/system/etcd.service /usr/lib/systemd/system/6.ÂêØÂä®etcdÊúçÂä°[root@binary-k8s-master2 ~]\# systemctl daemon-reload[root@binary-k8s-master2 ~]\#  systemctl start etcd7.Êü•ÁúãÁ´ØÂè£[root@binary-k8s-master2 ~]\# netstat -lnpt | grep etcdtcp        0      0 192.168.20.11:2379      0.0.0.0:*               LISTEN      15753/etcdtcp        0      0 127.0.0.1:2379          0.0.0.0:*               LISTEN      15753/etcdtcp        0      0 192.168.20.11:2380      0.0.0.0:*               LISTEN      15753/etcd8.Êü•ÁúãËäÇÁÇπÁä∂ÊÄÅ[root@binary-k8s-master2 ~]\# /data/etcd/bin/etcdctl endpoint health --write-out=table+----------------+--------+------------+-------+|    ENDPOINT    | HEALTH |    TOOK    | ERROR |+----------------+--------+------------+-------+| 127.0.0.1:2379 |   true | 7.146222ms |       |+----------------+--------+------------+-------+"><div></div></button></div></figure></div>
<h4 id="1022Âú®Áé∞ÊúâetcdÈõÜÁæ§‰ªªÊÑè‰∏Ä‰∏™ËäÇÁÇπ‰∏äÂ¢ûÂä†Êñ∞etcdËäÇÁÇπ">10.2.2.Âú®Áé∞ÊúâetcdÈõÜÁæ§‰ªªÊÑè‰∏Ä‰∏™ËäÇÁÇπ‰∏äÂ¢ûÂä†Êñ∞etcdËäÇÁÇπ</h4>
<blockquote>
<p>Â¢ûÂä†ËäÇÁÇπÁöÑÂëΩ‰ª§‰∏∫Ôºö<code dir="auto">/data/etcd/bin/etcdctl member add ËäÇÁÇπÂêçÁß∞ --peer-urls="ÈÄö‰ø°Âú∞ÂùÄ"</code></p>
</blockquote>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.Â¢ûÂä†etcd-4ËäÇÁÇπ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> /data/etcd/bin/etcdctl member add etcd-4 --peer-urls=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.11:2380</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">Member</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">aae107adddd0d3d8</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">added</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">to</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">cluster</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">20</span><span style="--0:#ECC48D;--1:#3C63B3">b119eb5f91aa4b</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_NAME</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">etcd-4</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_INITIAL_CLUSTER</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">etcd-2=https://192.168.20.12:2380,etcd-1=https://192.168.20.10:2380,etcd-3=https://192.168.20.13:2380,etcd-4=https://192.168.20.11:2380</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_INITIAL_ADVERTISE_PEER_URLS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.11:2380</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_INITIAL_CLUSTER_STATE</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">existing</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#ËæìÂá∫ÁöÑÈÖçÁΩÆ‰ø°ÊÅØ‰∏ÄÂÆöË¶ÅÂú®Êñ∞ÁöÑetcd-4ËäÇÁÇπÁöÑÈÖçÁΩÆÊñá‰ª∂ÂÜôÂÖ•ÔºåÂê¶Âàô‰ºöÂä†ÂÖ•ÈõÜÁæ§Â§±Ë¥•</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.Êü•ÁúãÈõÜÁæ§ËäÇÁÇπÂàóË°®</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> /data/etcd/bin/etcdctl member list --write-out=table</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">+------------------+-----------+--------+----------------------------+--------------------------------------------------+------------+</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#82AAFF;--1:#3C63B3">ID</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#82AAFF;--1:#3C63B3">STATUS</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#82AAFF;--1:#3C63B3">PEER</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ADDRS</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">                   </span><span style="--0:#82AAFF;--1:#3C63B3">CLIENT</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ADDRS</span><span style="--0:#D6DEEB;--1:#403F53">                   </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">IS</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">LEARNER</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">+------------------+-----------+--------+----------------------------+--------------------------------------------------+------------+</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">12446003b2a53d43</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#82AAFF;--1:#3C63B3">started</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">etcd-2</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">https://192.168.20.12:2380</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">http://127.0.0.1:2379,https://192.168.20.12:2379</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#C5E478;--1:#3C63B3">false</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">51ae3f86f3783687</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#82AAFF;--1:#3C63B3">started</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">etcd-1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">https://192.168.20.10:2380</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">http://127.0.0.1:2379,https://192.168.20.10:2379</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#C5E478;--1:#3C63B3">false</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">667c9c7ba890c3f7</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#82AAFF;--1:#3C63B3">started</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">etcd-3</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">https://192.168.20.13:2380</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">http://127.0.0.1:2379,https://192.168.20.13:2379</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#C5E478;--1:#3C63B3">false</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">aae107adddd0d3d8</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">unstarted</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">https://192.168.20.11:2380</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">                                                  </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#C5E478;--1:#3C63B3">false</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">+------------------+-----------+--------+----------------------------+--------------------------------------------------+------------+</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#ÂèëÁé∞ÂàöÂàöÊñ∞Âä†ÂÖ•ÁöÑetcd-4ËäÇÁÇπÂ§Ñ‰∫éunstartedÁä∂ÊÄÅÔºåÊàë‰ª¨ÈúÄË¶ÅÂÜçÈÖçÁΩÆetcd-4ËäÇÁÇπ‰ΩøÁî®ËÉΩÂ§üÂä†ÂÖ•ÈõÜÁæ§</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.Â¢ûÂä†etcd-4ËäÇÁÇπ[root@binary-k8s-master1 ~]\# /data/etcd/bin/etcdctl member add etcd-4 --peer-urls=&#x22;https://192.168.20.11:2380&#x22;Member aae107adddd0d3d8 added to cluster 20b119eb5f91aa4bETCD_NAME=&#x22;etcd-4&#x22;ETCD_INITIAL_CLUSTER=&#x22;etcd-2=https://192.168.20.12:2380,etcd-1=https://192.168.20.10:2380,etcd-3=https://192.168.20.13:2380,etcd-4=https://192.168.20.11:2380&#x22;ETCD_INITIAL_ADVERTISE_PEER_URLS=&#x22;https://192.168.20.11:2380&#x22;ETCD_INITIAL_CLUSTER_STATE=&#x22;existing&#x22;2.Êü•ÁúãÈõÜÁæ§ËäÇÁÇπÂàóË°®[root@binary-k8s-master1 ~]\# /data/etcd/bin/etcdctl member list --write-out=table+------------------+-----------+--------+----------------------------+--------------------------------------------------+------------+|        ID        |  STATUS   |  NAME  |         PEER ADDRS         |                   CLIENT ADDRS                   | IS LEARNER |+------------------+-----------+--------+----------------------------+--------------------------------------------------+------------+| 12446003b2a53d43 |   started | etcd-2 | https://192.168.20.12:2380 | http://127.0.0.1:2379,https://192.168.20.12:2379 |      false || 51ae3f86f3783687 |   started | etcd-1 | https://192.168.20.10:2380 | http://127.0.0.1:2379,https://192.168.20.10:2379 |      false || 667c9c7ba890c3f7 |   started | etcd-3 | https://192.168.20.13:2380 | http://127.0.0.1:2379,https://192.168.20.13:2379 |      false || aae107adddd0d3d8 | unstarted |        | https://192.168.20.11:2380 |                                                  |      false |+------------------+-----------+--------+----------------------------+--------------------------------------------------+------------+"><div></div></button></div></figure></div>
<h4 id="1023ÈÖçÁΩÆÊñ∞Â¢ûÁöÑetcdËäÇÁÇπÂä†ÂÖ•ÈõÜÁæ§">10.2.3.ÈÖçÁΩÆÊñ∞Â¢ûÁöÑetcdËäÇÁÇπÂä†ÂÖ•ÈõÜÁæ§</h4>
<p>Âú®Â∑≤ÊúâÈõÜÁæ§Â¢ûÂä†ÂÆåÊñ∞ËäÇÁÇπ‰πãÂêéÔºåËøòÈúÄË¶ÅÂ∞ÜÊñ∞ÁöÑetcdËäÇÁÇπÈÖçÁΩÆÊñá‰ª∂Â¢ûÂä†ÈõÜÁæ§Áõ∏ÂÖ≥Â±ûÊÄßÔºåÁÑ∂ÂêéÂà†Èô§Áî±ÂçïÁÇπÊó∂ÈÄ†ÊàêÁöÑetcdÊï∞ÊçÆÊñá‰ª∂ÔºåÊúÄÂêéÂú®ÊâÄÊúâËäÇÁÇπÁöÑÈÖçÁΩÆÊñá‰ª∂‰∏≠Â¢ûÂä†Êñ∞ËäÇÁÇπÁöÑÈÄö‰ø°Âú∞ÂùÄÔºåÈáçÂêØÊâÄÊúâËäÇÁÇπÁöÑetcdÊúçÂä°ÔºåÂà∞Ê≠§Êâ©ÂÆπÊàêÂäü„ÄÇ</p>
<p>‰∏ªË¶ÅÂú®Êñ∞ÁöÑetcdËäÇÁÇπ‰∏≠ÈÖçÁΩÆETCD_NAME„ÄÅETCD_INITIAL_CLUSTER„ÄÅETCD_INITIAL_CLUSTER_TOKEN„ÄÅETCD_INITIAL_CLUSTER_STATEËøô‰∏â‰∏™ÂèÇÊï∞„ÄÇ</p>
<p>ETCD_NAMEÔºöÈõÜÁæ§ËäÇÁÇπÂêçÁß∞</p>
<p>ETCD_INITIAL_CLUSTERÔºöÁî±ÂçïÁÇπÁöÑ‰∏Ä‰∏™ËäÇÁÇπ‰ø°ÊÅØÊîπÊàêÈõÜÁæ§ÊâÄÊúâËäÇÁÇπÁöÑ‰ø°ÊÅØ</p>
<p>ETCD_INITIAL_CLUSTER_TOKENÔºöÂ°´ÂÜôÈõÜÁæ§ÁöÑÂîØ‰∏ÄÊ†áËØÜÔºåË°®Á§∫Âä†ÂÖ•Âì™‰∏™etcdÈõÜÁæ§</p>
<p>ETCD_INITIAL_CLUSTER_STATEÔºöÈõÜÁæ§Áä∂ÊÄÅË∞ÉÊï¥‰∏∫Âä†ÂÖ•Â∑≤Â≠òÂú®ÁöÑÈõÜÁæ§</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.‰øÆÊîπetcdÈÖçÁΩÆÊñá‰ª∂ÔºåÂ¢ûÂä†ÈõÜÁæ§ÈÖçÁΩÆÂèÇÊï∞</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /data/etcd/conf/etcd.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#[Service]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_NAME</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">etcd-4</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_DATA_DIR</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">/data/etcd/data</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_LISTEN_PEER_URLS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.11:2380</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_LISTEN_CLIENT_URLS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.11:2379,http://127.0.0.1:2379</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#[cluster]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_INITIAL_ADVERTISE_PEER_URLS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.11:2380</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_ADVERTISE_CLIENT_URLS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://192.168.20.11:2379,http://127.0.0.1:2379</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_INITIAL_CLUSTER</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">etcd-2=https://192.168.20.12:2380,etcd-1=https://192.168.20.10:2380,etcd-3=https://192.168.20.13:2380,etcd-4=https://192.168.20.11:2380</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_INITIAL_CLUSTER_TOKEN</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">etcd-cluster</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_INITIAL_CLUSTER_STATE</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">existing</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.Âà†Èô§Áî±ÂçïÁÇπÊó∂‰∫ßÁîüÁöÑÊï∞ÊçÆÊñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#Â¶ÇÊûú‰∏çÂà†Èô§ÔºåÂä†ÂÖ•ÈõÜÁæ§Êó∂‰ºöÂ§±Ë¥•</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> rm -rf /data/etcd/data/</span><span style="--0:#7FDBCA;--1:#097174">*</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.ÊâÄÊúâetcdÁöÑÈÖçÁΩÆÊñá‰ª∂‰∏≠Â¢ûÂä†Êñ∞ËäÇÁÇπÁöÑÈÄö‰ø°Âú∞ÂùÄ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">Ê≥®ÊÑèÔºöÊâÄÊúâetcdËäÇÁÇπÁöÑÈÖçÁΩÆÊñá‰ª∂ÈÉΩË¶ÅÂ¢ûÂä†Ëøô‰∏ÄË°åÈÖçÁΩÆ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vim</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/data/etcd/conf/etcd.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">ETCD_INITIAL_CLUSTER</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">etcd-1=https://192.168.20.10:2380,etcd-2=https://192.168.20.12:2380,etcd-3=https://192.168.20.13:2380,etcd-4=https://192.168.20.11:2380</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">4.ÈáçÂêØÊâÄÊúâËäÇÁÇπÁöÑectdÊúçÂä°</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl restart etcd</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl restart etcd</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl restart etcd</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl restart etcd</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">5.ÂÜçÊ¨°Êü•ÁúãÈõÜÁæ§ÁöÑËäÇÁÇπ‰ø°ÊÅØ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> /data/etcd/bin/etcdctl member list --write-out=table</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">+------------------+---------+--------+----------------------------+--------------------------------------------------+------------+</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#82AAFF;--1:#3C63B3">ID</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">STATUS</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#82AAFF;--1:#3C63B3">PEER</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ADDRS</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">                   </span><span style="--0:#82AAFF;--1:#3C63B3">CLIENT</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ADDRS</span><span style="--0:#D6DEEB;--1:#403F53">                   </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">IS</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">LEARNER</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">+------------------+---------+--------+----------------------------+--------------------------------------------------+------------+</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">12446003b2a53d43</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">started</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">etcd-2</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">https://192.168.20.12:2380</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">http://127.0.0.1:2379,https://192.168.20.12:2379</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#C5E478;--1:#3C63B3">false</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">51ae3f86f3783687</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">started</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">etcd-1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">https://192.168.20.10:2380</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">http://127.0.0.1:2379,https://192.168.20.10:2379</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#C5E478;--1:#3C63B3">false</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">667c9c7ba890c3f7</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">started</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">etcd-3</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">https://192.168.20.13:2380</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">http://127.0.0.1:2379,https://192.168.20.13:2379</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#C5E478;--1:#3C63B3">false</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">aae107adddd0d3d8</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">started</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">etcd-4</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">https://192.168.20.11:2380</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">http://127.0.0.1:2379,https://192.168.20.11:2379</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#C5E478;--1:#3C63B3">false</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">+------------------+---------+--------+----------------------------+--------------------------------------------------+------------+</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#etcdÂà∞Ê≠§Êâ©ÂÆπÊàêÂäü</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.‰øÆÊîπetcdÈÖçÁΩÆÊñá‰ª∂ÔºåÂ¢ûÂä†ÈõÜÁæ§ÈÖçÁΩÆÂèÇÊï∞[root@binary-k8s-master2 ~]\# vim /data/etcd/conf/etcd.confETCD_NAME=&#x22;etcd-4&#x22;ETCD_DATA_DIR=&#x22;/data/etcd/data&#x22;ETCD_LISTEN_PEER_URLS=&#x22;https://192.168.20.11:2380&#x22;ETCD_LISTEN_CLIENT_URLS=&#x22;https://192.168.20.11:2379,http://127.0.0.1:2379&#x22;ETCD_INITIAL_ADVERTISE_PEER_URLS=&#x22;https://192.168.20.11:2380&#x22;ETCD_ADVERTISE_CLIENT_URLS=&#x22;https://192.168.20.11:2379,http://127.0.0.1:2379&#x22;ETCD_INITIAL_CLUSTER=&#x22;etcd-2=https://192.168.20.12:2380,etcd-1=https://192.168.20.10:2380,etcd-3=https://192.168.20.13:2380,etcd-4=https://192.168.20.11:2380&#x22;ETCD_INITIAL_CLUSTER_TOKEN=&#x22;etcd-cluster&#x22;ETCD_INITIAL_CLUSTER_STATE=&#x22;existing&#x22;2.Âà†Èô§Áî±ÂçïÁÇπÊó∂‰∫ßÁîüÁöÑÊï∞ÊçÆÊñá‰ª∂[root@binary-k8s-master2 ~]\# rm -rf /data/etcd/data/*3.ÊâÄÊúâetcdÁöÑÈÖçÁΩÆÊñá‰ª∂‰∏≠Â¢ûÂä†Êñ∞ËäÇÁÇπÁöÑÈÄö‰ø°Âú∞ÂùÄÊ≥®ÊÑèÔºöÊâÄÊúâetcdËäÇÁÇπÁöÑÈÖçÁΩÆÊñá‰ª∂ÈÉΩË¶ÅÂ¢ûÂä†Ëøô‰∏ÄË°åÈÖçÁΩÆvim /data/etcd/conf/etcd.confETCD_INITIAL_CLUSTER=&#x22;etcd-1=https://192.168.20.10:2380,etcd-2=https://192.168.20.12:2380,etcd-3=https://192.168.20.13:2380,etcd-4=https://192.168.20.11:2380&#x22;4.ÈáçÂêØÊâÄÊúâËäÇÁÇπÁöÑectdÊúçÂä°[root@binary-k8s-master1 ~]\# systemctl restart etcd[root@binary-k8s-master2 ~]\# systemctl restart etcd[root@binary-k8s-node1 ~]\# systemctl restart etcd[root@binary-k8s-node2 ~]\# systemctl restart etcd5.ÂÜçÊ¨°Êü•ÁúãÈõÜÁæ§ÁöÑËäÇÁÇπ‰ø°ÊÅØ[root@binary-k8s-master1 ~]\# /data/etcd/bin/etcdctl member list --write-out=table+------------------+---------+--------+----------------------------+--------------------------------------------------+------------+|        ID        | STATUS  |  NAME  |         PEER ADDRS         |                   CLIENT ADDRS                   | IS LEARNER |+------------------+---------+--------+----------------------------+--------------------------------------------------+------------+| 12446003b2a53d43 | started | etcd-2 | https://192.168.20.12:2380 | http://127.0.0.1:2379,https://192.168.20.12:2379 |      false || 51ae3f86f3783687 | started | etcd-1 | https://192.168.20.10:2380 | http://127.0.0.1:2379,https://192.168.20.10:2379 |      false || 667c9c7ba890c3f7 | started | etcd-3 | https://192.168.20.13:2380 | http://127.0.0.1:2379,https://192.168.20.13:2379 |      false || aae107adddd0d3d8 | started | etcd-4 | https://192.168.20.11:2380 | http://127.0.0.1:2379,https://192.168.20.11:2379 |      false |+------------------+---------+--------+----------------------------+--------------------------------------------------+------------+"><div></div></button></div></figure></div>
<h4 id="1024ÈÖçÁΩÆkube-apiserverÂ¢ûÂä†Êñ∞ÁöÑetcdËäÇÁÇπ">10.2.4.ÈÖçÁΩÆkube-apiserverÂ¢ûÂä†Êñ∞ÁöÑetcdËäÇÁÇπ</h4>
<p>etcdËäÇÁÇπÊñ∞Â¢ûÂÆåÔºåÈúÄË¶ÅÈÖçÁΩÆ‰∏ãkube-apiserverÁªÑ‰ª∂ÔºåÂ¢ûÂä†Êñ∞ÁöÑetcdËäÇÁÇπ‰ø°ÊÅØ„ÄÇ</p>
<p>Ê≥®ÊÑèÊâÄÊúâk8s masterËäÇÁÇπÈÉΩÂøÖÈ°ª‰øÆÊîπÈÖçÁΩÆkube-apiserver.confÊñá‰ª∂Â¢ûÂä†Êñ∞ÁöÑetcdËäÇÁÇπÔºåÂê¶Âàôetcd‰πü‰∏ç‰ºö‰∏∫k8sÊâÄÁî®„ÄÇ</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.masterËäÇÁÇπ‰øÆÊîπÈÖçÁΩÆÊñá‰ª∂Â¢ûÂä†Êñ∞ÁöÑetcdËäÇÁÇπ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /data/kubernetes/config/kube-apiserver.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">¬∑¬∑¬∑¬∑¬∑¬∑</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--etcd-servers</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">https://192.168.20.10:2379,https://192.168.20.12:2379,https://192.168.20.13:2379,https://192.168.20.11:2379</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">¬∑¬∑¬∑¬∑¬∑¬∑</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.ÈáçÂêØapiserverÁªÑ‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl restart kube-apiserver</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.Êü•ÁúãÁªÑ‰ª∂‰ø°ÊÅØ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get cs -o wide</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">Warning:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">v1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ComponentStatus</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">is</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">deprecated</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">in</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">v1.19+</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                 </span><span style="--0:#ECC48D;--1:#3C63B3">STATUS</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">MESSAGE</span><span style="--0:#D6DEEB;--1:#403F53">             </span><span style="--0:#ECC48D;--1:#3C63B3">ERROR</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">controller-manager</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">Healthy</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">ok</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">scheduler</span><span style="--0:#D6DEEB;--1:#403F53">            </span><span style="--0:#ECC48D;--1:#3C63B3">Healthy</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">ok</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">etcd-2</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">Healthy</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">{</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">health</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">:</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">true</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">etcd-0</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">Healthy</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">{</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">health</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">:</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">true</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">etcd-3</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">Healthy</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">{</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">health</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">:</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">true</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">etcd-1</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">Healthy</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">{</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">health</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">:</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">true</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.masterËäÇÁÇπ‰øÆÊîπÈÖçÁΩÆÊñá‰ª∂Â¢ûÂä†Êñ∞ÁöÑetcdËäÇÁÇπ[root@binary-k8s-master1 ~]\# vim /data/kubernetes/config/kube-apiserver.conf¬∑¬∑¬∑¬∑¬∑¬∑--etcd-servers=https://192.168.20.10:2379,https://192.168.20.12:2379,https://192.168.20.13:2379,https://192.168.20.11:2379 \¬∑¬∑¬∑¬∑¬∑¬∑2.ÈáçÂêØapiserverÁªÑ‰ª∂[root@binary-k8s-master1 ~]\# systemctl restart kube-apiserver3.Êü•ÁúãÁªÑ‰ª∂‰ø°ÊÅØ[root@binary-k8s-master1 ~]\# kubectl get cs -o wideWarning: v1 ComponentStatus is deprecated in v1.19+NAME                 STATUS    MESSAGE             ERRORcontroller-manager   Healthy   okscheduler            Healthy   oketcd-2               Healthy   {&#x22;health&#x22;:&#x22;true&#x22;}etcd-0               Healthy   {&#x22;health&#x22;:&#x22;true&#x22;}etcd-3               Healthy   {&#x22;health&#x22;:&#x22;true&#x22;}etcd-1               Healthy   {&#x22;health&#x22;:&#x22;true&#x22;}"><div></div></button></div></figure></div>
<h3 id="103ÈÉ®ÁΩ≤master-2ËäÇÁÇπ">10.3.ÈÉ®ÁΩ≤master-2ËäÇÁÇπ</h3>
<p>Áî±‰∫éÊâÄÊúâÁªÑ‰ª∂ÈÉΩÊòØ‰∫åËøõÂà∂ÊñπÂºèÈÉ®ÁΩ≤ÁöÑÔºåÂõ†Ê≠§ÂèØ‰ª•Âú®master1‰∏äÂ∞ÜÁõÆÂΩïÁõ¥Êé•Êã∑Ë¥ùËá≥master2‰∏äÂç≥ÂèØ‰ΩøÁî®„ÄÇ</p>
<h4 id="1031ÈÉ®ÁΩ≤docker">10.3.1.ÈÉ®ÁΩ≤docker</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.ÂÆâË£Ödocker</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> tar xf docker-19.03.9.tgz</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> cp docker/</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53"> /usr/bin/</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.Êã∑Ë¥ùmaster1ËäÇÁÇπ‰∏äÁöÑdockerÈÖçÁΩÆÊñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> scp -rp root@binary-k8s-master1:/etc/docker /etc/</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.Êã∑Ë¥ùmaster1ËäÇÁÇπ‰∏äÁöÑdocker</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">systemctlËÑöÊú¨</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> scp -rp root@binary-k8s-master1:/usr/lib/systemd/system/docker.service /usr/lib/systemd/system/</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">4.ÂêØÂä®docker</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl daemon-reload</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl start docker</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl enable docker</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.ÂÆâË£Ödocker[root@binary-k8s-master2 ~]\# tar xf docker-19.03.9.tgz[root@binary-k8s-master2 ~]\# cp docker/* /usr/bin/2.Êã∑Ë¥ùmaster1ËäÇÁÇπ‰∏äÁöÑdockerÈÖçÁΩÆÊñá‰ª∂[root@binary-k8s-master2 ~]\# scp -rp root@binary-k8s-master1:/etc/docker /etc/3.Êã∑Ë¥ùmaster1ËäÇÁÇπ‰∏äÁöÑdocker systemctlËÑöÊú¨[root@binary-k8s-master2 ~]\# scp -rp root@binary-k8s-master1:/usr/lib/systemd/system/docker.service /usr/lib/systemd/system/4.ÂêØÂä®docker[root@binary-k8s-master2 ~]\# systemctl daemon-reload[root@binary-k8s-master2 ~]\# systemctl start docker[root@binary-k8s-master2 ~]\# systemctl enable docker"><div></div></button></div></figure></div>
<h4 id="1032ÈÉ®ÁΩ≤kubernetesÂêÑ‰∏™ÁªÑ‰ª∂">10.3.2.ÈÉ®ÁΩ≤kubernetesÂêÑ‰∏™ÁªÑ‰ª∂</h4>
<p>Áî±‰∫éÊòØ‰∫åËøõÂà∂ÈÉ®ÁΩ≤ÔºåÁõ¥Êé•Êã∑Ë¥ùmaster1ËäÇÁÇπ‰∏äÁöÑ/data/kubernetesÁõÆÂΩïÂç≥ÂèØÔºå/data/kubernetesÁõÆÂΩï‰∏ãÂåÖÂê´‰∫ÜÊâÄÊúâÁöÑmaster‰ª•ÂèänodeÁõ∏ÂÖ≥ÁªÑ‰ª∂</p>
<p>masterËäÇÁÇπÈúÄË¶ÅÂÆâË£ÖÊâÄÊúâÁöÑmasterÁªÑ‰ª∂ÂíånodeÁªÑ‰ª∂„ÄÇ</p>
<p><strong>1.ÂáÜÂ§á‰∫åËøõÂà∂Á®ãÂ∫è</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.Êã∑Ë¥ùÁªÑ‰ª∂Êñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> scp -rp /data/kubernetes root@binary-k8s-master2:/data</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> scp /usr/bin/kubectl root@binary-k8s-master2:/usr/bin</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> scp -rp /usr/lib/systemd/system/kube</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53"> root@binary-k8s-master2:/usr/lib/systemd/system/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> scp -rp .kube root@binary-k8s-master2:/root</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.Â¶ÇÊûúÊ≤°ÊúâÊâ©ÂÆπÊñ∞ÁöÑetcdËäÇÁÇπÁöÑÊÉÖÂÜµÈúÄË¶ÅÊã∑Ë¥ùetcdËØÅ‰π¶</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> scp -rp /data/etcd/ssl root@binary-k8s-master2:/data/etcd/ss</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.Âà†Èô§kubeletÊñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#kubeletÊüê‰∫õÈóÆÈ¢òÈÉΩÊòØÂä®ÊÄÅÁîüÊàêÁöÑÔºå‰∏îÊØè‰∏™ËäÇÁÇπÈÉΩ‰∏çÁõ∏ÂêåÔºåÂõ†Ê≠§ÈúÄË¶ÅÂà†Èô§ÈáçÊñ∞ÁîüÊàê</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> rm -rf /data/kubernetes/config/kubelet.kubeconfig</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> rm -rf /data/kubernetes/ssl/kubelet-client-</span><span style="--0:#7FDBCA;--1:#097174">*</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.Êã∑Ë¥ùÁªÑ‰ª∂Êñá‰ª∂[root@binary-k8s-master1 ~]\# scp -rp /data/kubernetes root@binary-k8s-master2:/data[root@binary-k8s-master1 ~]\# scp /usr/bin/kubectl root@binary-k8s-master2:/usr/bin[root@binary-k8s-master1 ~]\# scp -rp /usr/lib/systemd/system/kube* root@binary-k8s-master2:/usr/lib/systemd/system/[root@binary-k8s-master1 ~]\# scp -rp .kube root@binary-k8s-master2:/root2.Â¶ÇÊûúÊ≤°ÊúâÊâ©ÂÆπÊñ∞ÁöÑetcdËäÇÁÇπÁöÑÊÉÖÂÜµÈúÄË¶ÅÊã∑Ë¥ùetcdËØÅ‰π¶[root@binary-k8s-master1 ~]\# scp -rp /data/etcd/ssl root@binary-k8s-master2:/data/etcd/ss3.Âà†Èô§kubeletÊñá‰ª∂[root@binary-k8s-master2 ~]\# rm -rf /data/kubernetes/config/kubelet.kubeconfig[root@binary-k8s-master2 ~]\# rm -rf /data/kubernetes/ssl/kubelet-client-*"><div></div></button></div></figure></div>
<p><strong>2.‰øÆÊîπÂêÑ‰∏™ÁªÑ‰ª∂ÁöÑÈÖçÁΩÆÊñá‰ª∂</strong></p>
<p>‰∏ªË¶ÅÂ∞±ÊòØ‰øÆÊîπÂêÑ‰∏™ÁªÑ‰ª∂ÁõëÂê¨ÁöÑÊú¨Êú∫ipÂú∞ÂùÄÂíåËäÇÁÇπÂêçÁß∞ÔºåÁîüÊàêÁöÑkubeconfigÊñá‰ª∂‰∏≠ÁöÑapiserverÂú∞ÂùÄÊó†ÈúÄÊõ¥ÊîπÔºå‰øùÊåÅmaster1Âç≥ÂèØÔºåÂõ†‰∏∫ÊúÄÂêéÈ´òÂèØÁî®ÁöÑÊó∂ÂÄôËøòÊòØ‰ºöÊîπÊàêVIPÂú∞ÂùÄÔºåÂΩìÂâçÊó†ÈúÄÊõ¥Êîπ„ÄÇ</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.‰øÆÊîπkube-apiserverÈÖçÁΩÆÊñá‰ª∂‰∏≠ÁöÑIPÂú∞ÂùÄ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /data/kubernetes/config/kube-apiserver.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">¬∑¬∑¬∑¬∑¬∑¬∑</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--bind-address</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#ECC48D;--1:#3C63B3">.20.11</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--advertise-address</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#ECC48D;--1:#3C63B3">.20.11</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">¬∑¬∑¬∑¬∑¬∑¬∑</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.‰øÆÊîπkube-controller-managerÈÖçÁΩÆÊñá‰ª∂‰∏≠ÁöÑIPÂú∞ÂùÄ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /data/kubernetes/config/kube-controller-manager.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">¬∑¬∑¬∑¬∑¬∑¬∑</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--bind-address</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#ECC48D;--1:#3C63B3">.20.11</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">¬∑¬∑¬∑¬∑¬∑¬∑</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.‰øÆÊîπkube-schedulerÈÖçÁΩÆÊñá‰ª∂‰∏≠ÁöÑIPÂú∞ÂùÄ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /data/kubernetes/config/kube-scheduler.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">¬∑¬∑¬∑¬∑¬∑¬∑</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">--bind-address</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#ECC48D;--1:#3C63B3">.20.11</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">¬∑¬∑¬∑¬∑¬∑¬∑</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">4.‰øÆÊîπkubeletÈÖçÁΩÆÊñá‰ª∂‰∏≠ÁöÑIPÂú∞ÂùÄ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">[root@binary-k8s-master2 ~]\# vim /data/kubernetes/config/kubelet.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">¬∑¬∑¬∑¬∑¬∑¬∑</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">--hostname-override=binary-k8s-master2 </span><span style="--0:#F78C6C;--1:#AA0982">\</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">¬∑¬∑¬∑¬∑¬∑¬∑</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">5.‰øÆÊîπkube-apiserverÈÖçÁΩÆÊñá‰ª∂‰∏≠ÁöÑIPÂú∞ÂùÄ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">[root@binary-k8s-master2 ~]\# vim /data/kubernetes/config/kube-proxy-config.yml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">¬∑¬∑¬∑¬∑¬∑¬∑</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">hostnameOverride: binary-k8s-master2</span></div></div><div class="ec-line"><div class="code"><span style="--0:#ECC48D;--1:#9B504E">¬∑¬∑¬∑¬∑¬∑¬∑</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.‰øÆÊîπkube-apiserverÈÖçÁΩÆÊñá‰ª∂‰∏≠ÁöÑIPÂú∞ÂùÄ[root@binary-k8s-master2 ~]\# vim /data/kubernetes/config/kube-apiserver.conf¬∑¬∑¬∑¬∑¬∑¬∑--bind-address=192.168.20.11  \--advertise-address=192.168.20.11 \¬∑¬∑¬∑¬∑¬∑¬∑2.‰øÆÊîπkube-controller-managerÈÖçÁΩÆÊñá‰ª∂‰∏≠ÁöÑIPÂú∞ÂùÄ[root@binary-k8s-master2 ~]\# vim /data/kubernetes/config/kube-controller-manager.conf¬∑¬∑¬∑¬∑¬∑¬∑--bind-address=192.168.20.11 \¬∑¬∑¬∑¬∑¬∑¬∑3.‰øÆÊîπkube-schedulerÈÖçÁΩÆÊñá‰ª∂‰∏≠ÁöÑIPÂú∞ÂùÄ[root@binary-k8s-master2 ~]\# vim /data/kubernetes/config/kube-scheduler.conf¬∑¬∑¬∑¬∑¬∑¬∑--bind-address=192.168.20.11&#x22;¬∑¬∑¬∑¬∑¬∑¬∑4.‰øÆÊîπkubeletÈÖçÁΩÆÊñá‰ª∂‰∏≠ÁöÑIPÂú∞ÂùÄ[root@binary-k8s-master2 ~]\# vim /data/kubernetes/config/kubelet.conf¬∑¬∑¬∑¬∑¬∑¬∑--hostname-override=binary-k8s-master2 \¬∑¬∑¬∑¬∑¬∑¬∑5.‰øÆÊîπkube-apiserverÈÖçÁΩÆÊñá‰ª∂‰∏≠ÁöÑIPÂú∞ÂùÄ[root@binary-k8s-master2 ~]\# vim /data/kubernetes/config/kube-proxy-config.yml¬∑¬∑¬∑¬∑¬∑¬∑hostnameOverride: binary-k8s-master2¬∑¬∑¬∑¬∑¬∑¬∑"><div></div></button></div></figure></div>
<p><strong>3.ÂêØÂä®ÂêÑ‰∏™ÁªÑ‰ª∂</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl daemon-reload</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl start kube-apiserver</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl start kube-controller-manager</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl start kube-scheduler</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl start kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl start kube-proxy</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl enable kube-apiserver</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl enable kube-controller-manager</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl enable kube-scheduler</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl enable kubelet</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl enable kube-proxy</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master2 ~]\# systemctl daemon-reload[root@binary-k8s-master2 ~]\# systemctl start kube-apiserver[root@binary-k8s-master2 ~]\# systemctl start kube-controller-manager[root@binary-k8s-master2 ~]\# systemctl start kube-scheduler[root@binary-k8s-master2 ~]\# systemctl start kubelet[root@binary-k8s-master2 ~]\# systemctl start kube-proxy[root@binary-k8s-master2 ~]\# systemctl enable kube-apiserver[root@binary-k8s-master2 ~]\# systemctl enable kube-controller-manager[root@binary-k8s-master2 ~]\# systemctl enable kube-scheduler[root@binary-k8s-master2 ~]\# systemctl enable kubelet[root@binary-k8s-master2 ~]\# systemctl enable kube-proxy"><div></div></button></div></figure></div>
<h4 id="1033ÊéàÊùÉmaster2ËäÇÁÇπÂä†ÂÖ•ÈõÜÁæ§">10.3.3.ÊéàÊùÉmaster2ËäÇÁÇπÂä†ÂÖ•ÈõÜÁæ§</h4>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.Êü•ÁúãÊéàÊùÉÊñ∞Á≥ªÂàóË°®</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get csr</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                                                   </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">SIGNERNAME</span><span style="--0:#D6DEEB;--1:#403F53">                                    </span><span style="--0:#ECC48D;--1:#3C63B3">REQUESTOR</span><span style="--0:#D6DEEB;--1:#403F53">           </span><span style="--0:#ECC48D;--1:#3C63B3">CONDITION</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">node-csr-fgCu0hUU4sK9-jaLzl8n-H4MVWi314NhzYssddgThOE</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">4</span><span style="--0:#ECC48D;--1:#3C63B3">m45s</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes.io/kube-apiserver-client-kubelet</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">kubelet-bootstrap</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">Pending</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.ÊéàÊùÉÈÄöËøá</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl certificate approve node-csr-fgCu0hUU4sK9-jaLzl8n-H4MVWi314NhzYssddgThOE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">certificatesigningrequest.certificates.k8s.io/node-csr-fgCu0hUU4sK9-jaLzl8n-H4MVWi314NhzYssddgThOE</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">approved</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.Êü•ÁúãÊòØÂê¶Âä†ÂÖ•ÈõÜÁæ§</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get node</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                 </span><span style="--0:#ECC48D;--1:#3C63B3">STATUS</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">ROLES</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">VERSION</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">binary-k8s-master1</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">Ready</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">4</span><span style="--0:#ECC48D;--1:#3C63B3">d21h</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">v1.20.4</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">binary-k8s-master2</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">Ready</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">4</span><span style="--0:#ECC48D;--1:#3C63B3">m33s</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">v1.20.4</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">binary-k8s-node1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Ready</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">d3h</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">v1.20.4</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">binary-k8s-node2</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Ready</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">45</span><span style="--0:#ECC48D;--1:#3C63B3">h</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">v1.20.4</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">4.Êü•ÁúãÊ†∏ÂøÉÁªÑ‰ª∂Áä∂ÊÄÅ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get cs</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">Warning:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">v1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ComponentStatus</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">is</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">deprecated</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">in</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">v1.19+</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                 </span><span style="--0:#ECC48D;--1:#3C63B3">STATUS</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">MESSAGE</span><span style="--0:#D6DEEB;--1:#403F53">             </span><span style="--0:#ECC48D;--1:#3C63B3">ERROR</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">controller-manager</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">Healthy</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">ok</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">scheduler</span><span style="--0:#D6DEEB;--1:#403F53">            </span><span style="--0:#ECC48D;--1:#3C63B3">Healthy</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">ok</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">etcd-1</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">Healthy</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">{</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">health</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">:</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">true</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">etcd-2</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">Healthy</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">{</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">health</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">:</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">true</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">etcd-0</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">Healthy</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">{</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">health</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">:</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">true</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.Êü•ÁúãÊéàÊùÉÊñ∞Á≥ªÂàóË°®[root@binary-k8s-master2 ~]\# kubectl get csrNAME                                                   AGE     SIGNERNAME                                    REQUESTOR           CONDITIONnode-csr-fgCu0hUU4sK9-jaLzl8n-H4MVWi314NhzYssddgThOE   4m45s   kubernetes.io/kube-apiserver-client-kubelet   kubelet-bootstrap   Pending2.ÊéàÊùÉÈÄöËøá[root@binary-k8s-master2 ~]\# kubectl certificate approve node-csr-fgCu0hUU4sK9-jaLzl8n-H4MVWi314NhzYssddgThOEcertificatesigningrequest.certificates.k8s.io/node-csr-fgCu0hUU4sK9-jaLzl8n-H4MVWi314NhzYssddgThOE approved3.Êü•ÁúãÊòØÂê¶Âä†ÂÖ•ÈõÜÁæ§[root@binary-k8s-master2 ~]\# kubectl get nodeNAME                 STATUS   ROLES    AGE     VERSIONbinary-k8s-master1   Ready    <none>   4d21h   v1.20.4binary-k8s-master2   Ready    <none>   4m33s   v1.20.4binary-k8s-node1     Ready    <none>   2d3h    v1.20.4binary-k8s-node2     Ready    <none>   45h     v1.20.44.Êü•ÁúãÊ†∏ÂøÉÁªÑ‰ª∂Áä∂ÊÄÅ[root@binary-k8s-master2 ~]\# kubectl get csWarning: v1 ComponentStatus is deprecated in v1.19+NAME                 STATUS    MESSAGE             ERRORcontroller-manager   Healthy   okscheduler            Healthy   oketcd-1               Healthy   {&#x22;health&#x22;:&#x22;true&#x22;}etcd-2               Healthy   {&#x22;health&#x22;:&#x22;true&#x22;}etcd-0               Healthy   {&#x22;health&#x22;:&#x22;true&#x22;}"><div></div></button></div></figure></div>
<h3 id="104ÈÉ®ÁΩ≤nginxkeepalivedÂÆûÁé∞kubernetesÈ´òÂèØÁî®ÈõÜÁæ§">10.4.ÈÉ®ÁΩ≤Nginx+KeepalivedÂÆûÁé∞kubernetesÈ´òÂèØÁî®ÈõÜÁæ§</h3>
<p>keepalivedÊòØ‰∏ªÊµÅÁöÑÈ´òÂèØÁî®ËΩØ‰ª∂ÔºåÂü∫‰∫éVIPÁªëÂÆöÂÆûÁé∞ÊúçÂä°Âô®ÁöÑÂèåÊú∫ÁÉ≠Â§áÔºåÂèØ‰ª•ÁêÜËß£‰∏∫keepalivedÊòØÈíàÂØπÊúçÂä°Âô®IPÁöÑÈ´òÂèØÁî®ÈõÜÁæ§ÔºåÂ¶ÇÊûúAÊú∫Âô®ÂÆïÊú∫‰∫ÜÔºåBÊú∫Âô®‰ºöÁ´ãÂàªÊàê‰∏∫masterËßíËâ≤ÔºåÊä¢Âç†VIPÂú∞ÂùÄÔºå‰ΩøÂÖ∂‰∏çÈó¥Êñ≠ÁöÑÊèê‰æõÊúçÂä°Ôºå‰ªéËÄåÂΩ¢ÊàêÈ´òÂèØÁî®ÈõÜÁæ§„ÄÇ</p>
<p>‰ΩøÁî®nginx+keepalivedÂÅöÂæók8s masterËäÇÁÇπÈ´òÂèØÁî®ÈõÜÁæ§ÔºåÂè™Ë¶ÅmasterËäÇÁÇπ‰∏äÈù¢Ê≤°ÊúâetcdÁªÑ‰ª∂ÔºåÈÇ£‰πàÊï¥‰∏™ÈõÜÁæ§masterËäÇÁÇπÂè™Ë¶ÅÊúâ‰∏Ä‰∏™Â∑•‰ΩúÊ≠£Â∏∏ÔºåÊï¥‰∏™ÈõÜÁæ§Â∞±‰∏ç‰ºöÂÆïÊú∫„ÄÇ</p>
<p>Áîü‰∫ßÁéØÂ¢É‰∏≠nginx+keepalivedÊòØÁã¨Á´ã‰∫éÈõÜÁæ§‰πãÂ§ñÁöÑ‰∏§Âè∞ÊúçÂä°Âô®ÔºåÈ´òÂèØÁî®ÈõÜÁæ§‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÈÉΩÊòØ‰∏Ä‰∏ª‰∏ÄÂ§áÔºå‰∏§‰∏™ËäÇÁÇπÂ∞±ÂèØ‰ª•Êª°Ë∂≥Ê≠£Â∏∏ÈúÄÊ±ÇÔºåÊ≠£Â•ΩmasterËäÇÁÇπÊúâ2‰∏™ÔºåÂèØ‰ª•Âú®‰∏§‰∏™master‰∏äÈÉΩÈÉ®ÁΩ≤nginxÂíåkeepalivedÂΩ¢ÊàêÈ´òÂèØÁî®ÈõÜÁæ§„ÄÇ</p>
<p>Êàë‰ª¨ÈááÁî®nginxÂõõÂ±ÇË¥üËΩΩÂùáË°°ÔºåÂõõÂ±ÇË¥üËΩΩÂùáË°°ÁöÑ‰ΩúÁî®Â∞±ÊòØÂØπIPËøõË°åË¥üËΩΩÔºå‰∏çÊ∂âÂèäÂ∫îÁî®Â±ÇÔºåÁî±‰∫éÊàë‰ª¨‰ΩøÁî®keepalivedÂÅöÈ´òÂèØÁî®ÈõÜÁæ§ÔºåkeepalivedÂ∞±ÊòØÈíàÂØπIPÂú∞ÂùÄÂÆûÁé∞È´òÂèØÁî®ÔºåÂõ†Ê≠§ÈúÄË¶ÅÈÖçÂêànginxÂõõÂ±ÇË¥üËΩΩÂùáË°°Êù•ÂÆûÁé∞ÔºåÂΩìÁî®Êà∑ËÆøÈóÆkeepalivedÁöÑVIPÊó∂ÔºåÁõ¥Êé•Â∞ÜËØ∑Ê±ÇËΩ¨ÂèëÂà∞ÂØπÂ∫îÁöÑmasterËßíËâ≤‰∏ªÊú∫‰∏äÔºåÂ∞ÜVIPÂú∞ÂùÄËΩ¨Êç¢ÊàêmasterËäÇÁÇπIP+Á´ØÂè£ÔºåËøôÊ†∑‰∏ÄÊù•ÔºåÂç≥‰Ωømaster1ÊåÇÊéâ‰∫ÜÔºåmaster2Êàê‰∏∫‰∫ÜmasterËßíËâ≤ÔºåËØ∑Ê±ÇËΩ¨ÂèëËøõÊù•Ôºå‰πü‰ºöÂ∞ÜVIPËΩ¨Êç¢Êàêmaster2ËäÇÁÇπÁöÑÂú∞ÂùÄÔºåÈ´òÂèØÁî®‰πüÂ∞±ÂÆûÁé∞‰∫Ü„ÄÇ</p>
<p><strong>kube-apiserverÈ´òÂèØÁî®Êû∂ÊûÑÂõæ</strong></p>
<p><img src="https://cdn.agou-ops.cn/others/4166bf6696044bc1b4f47efb7cf03acd.png" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞"></p>
<h4 id="1041ÈÉ®ÁΩ≤nginxË¥üËΩΩÂùáË°°">10.4.1.ÈÉ®ÁΩ≤NginxË¥üËΩΩÂùáË°°</h4>
<p>master1Âíåmaster2‰∏äÁöÑnginxÈÉ®ÁΩ≤ÂíåÈÖçÁΩÆÊñá‰ª∂ÂÜÖÂÆπ‰∏ÄÊ†∑ÔºåËøôÈáåÂè™ÂÜômaster1ÁöÑÊìç‰ΩúÊ≠•È™§„ÄÇ</p>
<p>nginxË¥üËΩΩÂùáË°°ÈááÁî®ÂõõÂ±ÇË¥üËΩΩ„ÄÇ</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.ÂÆâË£ÖnginxÂíåkeepalivedÂèänginxÂõõÂ±ÇË¥üËΩΩÂùáË°°Ê®°ÂùóÁ≠âËΩØ‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53">  yum -y install nginx keepalived nginx-mod-stream</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.‰øÆÊîπnginx‰∏ªÈÖçÁΩÆÊñá‰ª∂Â¢ûÂä†includeÊ®°ÂùóÂºïÂÖ•4Â±ÇË¥üËΩΩÈÖçÁΩÆÊñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /etc/nginx/nginx.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">include</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/nginx/conf.c/</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#ECC48D;--1:#3C63B3">.conf</span><span style="--0:#D6DEEB;--1:#403F53">;      </span><span style="--0:#809191;--1:#616671">#17Ë°åÂ∑¶Âè≥Ôºå‰∏éhttpÊ®°ÂùóÂêåÁ∫ß</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.ÁºñÂÜôÈÖçÁΩÆÊñá‰ª∂</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> mkdir /etc/nginx/conf.c</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /etc/nginx/conf.c/k8s-apiserver.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">stream</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">log_format</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#ECC48D;--1:#3C63B3">main</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">$remote_addr $upstream_addr - [$time_local] $status $upstream_bytes_sent</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">access_log</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/var/log/nginx/k8s-apiserver.log</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">main</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">upstream</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">k8s-apiserver</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">server</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#ECC48D;--1:#3C63B3">.20.11:6443</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">server</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#ECC48D;--1:#3C63B3">.20.12:6443</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">server</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">listen</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16443</span><span style="--0:#D6DEEB;--1:#403F53">;      </span><span style="--0:#809191;--1:#616671">#Áî±‰∫éÊàë‰ª¨ÁöÑnginx‰∏ék8s masterÂú®Âêå‰∏ÄÂè∞Êú∫Âô®‰∏äÔºåÈò≤Ê≠¢Á´ØÂè£ÂÜ≤Á™ÅÔºåÂõ†Ê≠§Êîπ‰∏∫16443Á´ØÂè£</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">proxy_pass</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">k8s-apiserver</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">4.ÂêØÂä®nginx</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> nginx -t</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">nginx:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">the</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">configuration</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">file</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/nginx/nginx.conf</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">syntax</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">is</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ok</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">nginx:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">configuration</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">file</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">/etc/nginx/nginx.conf</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">test</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">is</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">successful</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> nginx</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">5.Êü•ÁúãÁ´ØÂè£</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> netstat -lnpt </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">grep</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">16443</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">tcp</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0:16443</span><span style="--0:#D6DEEB;--1:#403F53">           </span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.0:</span><span style="--0:#7FDBCA;--1:#097174">*</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">LISTEN</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#F78C6C;--1:#AA0982">3181</span><span style="--0:#ECC48D;--1:#3C63B3">/nginx:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">worker</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.ÂÆâË£ÖnginxÂíåkeepalivedÂèänginxÂõõÂ±ÇË¥üËΩΩÂùáË°°Ê®°ÂùóÁ≠âËΩØ‰ª∂[root@binary-k8s-master1 ~]\#  yum -y install nginx keepalived nginx-mod-stream2.‰øÆÊîπnginx‰∏ªÈÖçÁΩÆÊñá‰ª∂Â¢ûÂä†includeÊ®°ÂùóÂºïÂÖ•4Â±ÇË¥üËΩΩÈÖçÁΩÆÊñá‰ª∂[root@binary-k8s-master1 ~]\# vim /etc/nginx/nginx.confinclude /etc/nginx/conf.c/*.conf;      #17Ë°åÂ∑¶Âè≥Ôºå‰∏éhttpÊ®°ÂùóÂêåÁ∫ß3.ÁºñÂÜôÈÖçÁΩÆÊñá‰ª∂[root@binary-k8s-master1 ~]\# mkdir /etc/nginx/conf.c[root@binary-k8s-master1 ~]\# vim /etc/nginx/conf.c/k8s-apiserver.confstream {  log_format  main  &#x27;$remote_addr $upstream_addr - [$time_local] $status $upstream_bytes_sent&#x27;;  access_log /var/log/nginx/k8s-apiserver.log main;  upstream k8s-apiserver {    server 192.168.20.11:6443;    server 192.168.20.12:6443;  }  server {    listen 16443;      #Áî±‰∫éÊàë‰ª¨ÁöÑnginx‰∏ék8s masterÂú®Âêå‰∏ÄÂè∞Êú∫Âô®‰∏äÔºåÈò≤Ê≠¢Á´ØÂè£ÂÜ≤Á™ÅÔºåÂõ†Ê≠§Êîπ‰∏∫16443Á´ØÂè£    proxy_pass k8s-apiserver;  }}4.ÂêØÂä®nginx[root@binary-k8s-master1 ~]\# nginx -tnginx: the configuration file /etc/nginx/nginx.conf syntax is oknginx: configuration file /etc/nginx/nginx.conf test is successful[root@binary-k8s-master1 ~]\# nginx5.Êü•ÁúãÁ´ØÂè£[root@binary-k8s-master1 ~]\# netstat -lnpt | grep 16443tcp        0      0 0.0.0.0:16443           0.0.0.0:*               LISTEN      3181/nginx: worker"><div></div></button></div></figure></div>
<h4 id="1042ÈÉ®ÁΩ≤keepalivedÂèåÊú∫ÁÉ≠Â§á">10.4.2.ÈÉ®ÁΩ≤keepalivedÂèåÊú∫ÁÉ≠Â§á</h4>
<p>Âú®ÈÖçÁΩÆkeepalivedÁöÑÊó∂ÂÄô‰πüÈúÄË¶ÅÈÖçÁΩÆ‰∏Ä‰∏™<strong>vrrp_script</strong>Ê®°ÂùóÔºåkeepalivedÂè™ËÉΩÂÅöÂà∞ÂØπÁΩëÁªúÊïÖÈöúÂíåkeepalivedÊú¨Ë∫´ÁöÑÁõëÊéßÔºåÂç≥ÂΩìÂá∫Áé∞ÁΩëÁªúÊïÖÈöúÊàñËÄÖkeepalivedÊú¨Ë∫´Âá∫Áé∞ÈóÆÈ¢òÊó∂ÔºåËøõË°åÂàáÊç¢„ÄÇ‰ΩÜÊòØËøô‰∫õËøò‰∏çÂ§üÔºåÊàë‰ª¨ËøòÈúÄË¶ÅÁõëÊéßkeepalivedÊâÄÂú®ÊúçÂä°Âô®‰∏äÁöÑÂÖ∂‰ªñ‰∏öÂä°ËøõÁ®ãÔºåÊØîÂ¶ÇËØ¥nginxÔºåkeepalived+nginxÂÆûÁé∞nginxÁöÑË¥üËΩΩÂùáË°°È´òÂèØÁî®ÔºåÂ¶ÇÊûúnginxÂºÇÂ∏∏Ôºå‰ªÖ‰ªÖkeepalived‰øùÊåÅÊ≠£Â∏∏ÔºåÊòØÊó†Ê≥ïÂÆåÊàêÁ≥ªÁªüÁöÑÊ≠£Â∏∏Â∑•‰ΩúÁöÑÔºåÂõ†Ê≠§ÈúÄË¶ÅÊ†πÊçÆ‰∏öÂä°ËøõÁ®ãÁöÑËøêË°åÁä∂ÊÄÅÂÜ≥ÂÆöÊòØÂê¶ÈúÄË¶ÅËøõË°å‰∏ªÂ§áÂàáÊç¢„ÄÇËøô‰∏™Êó∂ÂÄôÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáÁºñÂÜôËÑöÊú¨ÂØπnginxËøõÁ®ãËøõË°åÊ£ÄÊµãÁõëÊéß„ÄÇ</p>
<p><strong>1.MASTERËäÇÁÇπÈÉ®ÁΩ≤</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.ÂÆâË£Ökeepalived</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53">  yum -y install keepalived</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.ÈÖçÁΩÆkeepalived</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /etc/keepalived/keepalived.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">global_defs</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#82AAFF;--1:#3C63B3">notification_email</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#82AAFF;--1:#3C63B3">acassen@firewall.loc</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#82AAFF;--1:#3C63B3">failover@firewall.loc</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#82AAFF;--1:#3C63B3">sysadmin@firewall.loc</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">   </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#82AAFF;--1:#3C63B3">notification_email_from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Alexandre.Cassen@firewall.loc</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#82AAFF;--1:#3C63B3">smtp_server</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">127.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.1</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#82AAFF;--1:#3C63B3">smtp_connect_timeout</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">30</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#82AAFF;--1:#3C63B3">router_id</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">NGINX_MASTER</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vrrp_script</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">check_nginx</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#809191;--1:#616671">#ÂÆö‰πâÂÅ•Â∫∑Ê£ÄÊü•ËÑöÊú¨</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">script</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">/etc/keepalived/check_nginx.sh</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vrrp_instance</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">VI_1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">state</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">MASTER</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#809191;--1:#616671">#Áä∂ÊÄÅ‰∏∫MASTER</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">interface</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ens192</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#809191;--1:#616671">#Â∞ÜVIPÁªëÂÆöÂú®Âì™ÂùóÁΩëÂç°‰∏ä</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">virtual_router_id</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">51</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#809191;--1:#616671">#ÂÆû‰æãIDÔºåÈõÜÁæ§ÊâÄÊúâËäÇÁÇπÈÉΩË¶Å‰øùÊåÅ‰∏ÄËá¥</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">priority</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">100</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#809191;--1:#616671">#‰ºòÂÖàÁ∫ßÔºå255ÊúÄÈ´ò</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">advert_int</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#809191;--1:#616671">#ÊåáÂÆöVRRPÂøÉË∑≥ÂåÖÈÄöÂëäÈó¥ÈöîÊó∂Èó¥ÔºåÈªòËÆ§1Áßí</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">authentication</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">auth_type</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">PASS</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">auth_pass</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1111</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">virtual_ipaddress</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">192.168.20.9/23</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#809191;--1:#616671">#ÂÆö‰πâVIPÂú∞ÂùÄ</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">track_script</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">check_nginx</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.ÁºñÂÜôÊ£ÄÊü•nginxÁä∂ÊÄÅÁöÑÊ£ÄÊü•ËÑöÊú¨</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#ÂΩìnginxÂºÇÂ∏∏Êó∂ÔºåËá™Âä®Â∞ÜÂΩìÂâç‰∏ªÊú∫ÁöÑkeepalivedËøõÁ®ãÂÖ≥Èó≠Ôºå‰ΩøBACKUP‰∏äÁöÑkeepalivedÊàê‰∏∫MASTERÁªßÁª≠Êèê‰æõÊúçÂä°</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /etc/keepalived/check_nginx.sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">nginx_ch</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--1:#3C63B3"><span style="--0:#ECC48D">`</span><span style="--0:#82AAFF">netstat</span><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">-lnpt</span><span style="--0:#ECC48D"> </span></span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--1:#3C63B3"><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">grep</span><span style="--0:#ECC48D"> </span></span><span style="--0:#F78C6C;--1:#AA0982">16443</span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--1:#3C63B3"><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">egrep</span><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">-cv</span><span style="--0:#ECC48D"> grep`</span></span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">if</span><span style="--0:#D6DEEB;--1:#403F53"> [ </span><span style="--0:#C5E478;--1:#3C63B3">$nginx_ch</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">-eq</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> ];</span><span style="--0:#C792EA;--1:#8D46B4">then</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">systemctl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">stop</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">keepalived</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3C63B3">exit</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">else</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3C63B3">exit</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">0</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">fi</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">4.ÂêØÂä®keepalived</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl start keepalived</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl enable keepalived</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">5.Êü•ÁúãVIPÂú∞ÂùÄ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> ip a </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">grep</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ens192</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ens192:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;BROADCAST,MULTICAST,UP,LOWER_UP></span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">mtu</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1500</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">qdisc</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">mq</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">state</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">UP</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">group</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">default</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">qlen</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1000</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">inet</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#ECC48D;--1:#3C63B3">.20.10/23</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">brd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#ECC48D;--1:#3C63B3">.21.255</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">scope</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">global</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">noprefixroute</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ens192</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">inet</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#ECC48D;--1:#3C63B3">.20.9/23</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">scope</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">global</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">secondary</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ens192</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#VIPÂ∑≤ÁªèÂáÜÂ§áÂ∞±Áª™</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.ÂÆâË£Ökeepalived[root@binary-k8s-master1 ~]\#  yum -y install keepalived2.ÈÖçÁΩÆkeepalived[root@binary-k8s-master1 ~]\# vim /etc/keepalived/keepalived.confglobal_defs {   notification_email {     acassen@firewall.loc     failover@firewall.loc     sysadmin@firewall.loc   }   notification_email_from Alexandre.Cassen@firewall.loc   smtp_server 127.0.0.1   smtp_connect_timeout 30   router_id NGINX_MASTER}vrrp_script check_nginx {        #ÂÆö‰πâÂÅ•Â∫∑Ê£ÄÊü•ËÑöÊú¨    script &#x22;/etc/keepalived/check_nginx.sh&#x22;}vrrp_instance VI_1 {    state MASTER          #Áä∂ÊÄÅ‰∏∫MASTER    interface ens192        #Â∞ÜVIPÁªëÂÆöÂú®Âì™ÂùóÁΩëÂç°‰∏ä    virtual_router_id 51      #ÂÆû‰æãIDÔºåÈõÜÁæ§ÊâÄÊúâËäÇÁÇπÈÉΩË¶Å‰øùÊåÅ‰∏ÄËá¥    priority 100          #‰ºòÂÖàÁ∫ßÔºå255ÊúÄÈ´ò    advert_int 1          #ÊåáÂÆöVRRPÂøÉË∑≥ÂåÖÈÄöÂëäÈó¥ÈöîÊó∂Èó¥ÔºåÈªòËÆ§1Áßí    authentication {        auth_type PASS        auth_pass 1111    }    virtual_ipaddress {        192.168.20.9/23          #ÂÆö‰πâVIPÂú∞ÂùÄ    }    track_script {        check_nginx    }}3.ÁºñÂÜôÊ£ÄÊü•nginxÁä∂ÊÄÅÁöÑÊ£ÄÊü•ËÑöÊú¨[root@binary-k8s-master1 ~]\# vim /etc/keepalived/check_nginx.shnginx_ch=&#x60;netstat -lnpt | grep 16443| egrep -cv grep&#x60;if [ $nginx_ch -eq 0 ];then  systemctl stop keepalived  exit 1else  exit 0fi4.ÂêØÂä®keepalived[root@binary-k8s-master1 ~]\# systemctl start keepalived[root@binary-k8s-master1 ~]\# systemctl enable keepalived5.Êü•ÁúãVIPÂú∞ÂùÄ[root@binary-k8s-master1 ~]\# ip a | grep ens1922: ens192: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UP group default qlen 1000    inet 192.168.20.10/23 brd 192.168.21.255 scope global noprefixroute ens192    inet 192.168.20.9/23 scope global secondary ens192"><div></div></button></div></figure></div>
<p><strong>2.BACKUPËäÇÁÇπÈÉ®ÁΩ≤</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.ÂÆâË£Ökeepalived</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53">  yum -y install keepalived</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.ÈÖçÁΩÆkeepalived</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /etc/keepalived/keepalived.conf</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">global_defs</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#82AAFF;--1:#3C63B3">notification_email</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#82AAFF;--1:#3C63B3">acassen@firewall.loc</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#82AAFF;--1:#3C63B3">failover@firewall.loc</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#82AAFF;--1:#3C63B3">sysadmin@firewall.loc</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">   </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#82AAFF;--1:#3C63B3">notification_email_from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Alexandre.Cassen@firewall.loc</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#82AAFF;--1:#3C63B3">smtp_server</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">127.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.1</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#82AAFF;--1:#3C63B3">smtp_connect_timeout</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">30</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#82AAFF;--1:#3C63B3">router_id</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">NGINX_MASTER</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vrrp_script</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">check_nginx</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">script</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">/etc/keepalived/check_nginx.sh</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">vrrp_instance</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">VI_1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">state</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">BACKUP</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#809191;--1:#616671">#Áä∂ÊÄÅ‰∏∫BACKUP</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">interface</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ens192</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">virtual_router_id</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">51</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">priority</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">90</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#809191;--1:#616671">#‰ºòÂÖàÁ∫ßË¶ÅÊØîMASTER‰Ωé</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">advert_int</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">authentication</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">auth_type</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">PASS</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">auth_pass</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1111</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">virtual_ipaddress</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">192.168.20.9/23</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">track_script</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">check_nginx</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.ÁºñÂÜôÊ£ÄÊü•nginxÁä∂ÊÄÅÁöÑÊ£ÄÊü•ËÑöÊú¨</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">#ÂΩìnginxÂºÇÂ∏∏Êó∂ÔºåËá™Âä®Â∞ÜÂΩìÂâç‰∏ªÊú∫ÁöÑkeepalivedËøõÁ®ãÂÖ≥Èó≠Ôºå‰ΩøBACKUP‰∏äÁöÑkeepalivedÊàê‰∏∫MASTERÁªßÁª≠Êèê‰æõÊúçÂä°</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim /etc/keepalived/check_nginx.sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C5E478;--1:#3C63B3">nginx_ch</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--1:#3C63B3"><span style="--0:#ECC48D">`</span><span style="--0:#82AAFF">netstat</span><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">-lnpt</span><span style="--0:#ECC48D"> </span></span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--1:#3C63B3"><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">grep</span><span style="--0:#ECC48D"> </span></span><span style="--0:#F78C6C;--1:#AA0982">16443</span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--1:#3C63B3"><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">egrep</span><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">-cv</span><span style="--0:#ECC48D"> grep`</span></span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">if</span><span style="--0:#D6DEEB;--1:#403F53"> [ </span><span style="--0:#C5E478;--1:#3C63B3">$nginx_ch</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">-eq</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53"> ];</span><span style="--0:#C792EA;--1:#8D46B4">then</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">systemctl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">stop</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">keepalived</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3C63B3">exit</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">else</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3C63B3">exit</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">0</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">fi</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">4.ÂêØÂä®keepalived</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl start keepalived</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl enable keepalived</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.ÂÆâË£Ökeepalived[root@binary-k8s-master2 ~]\#  yum -y install keepalived2.ÈÖçÁΩÆkeepalived[root@binary-k8s-master2 ~]\# vim /etc/keepalived/keepalived.confglobal_defs {   notification_email {     acassen@firewall.loc     failover@firewall.loc     sysadmin@firewall.loc   }   notification_email_from Alexandre.Cassen@firewall.loc   smtp_server 127.0.0.1   smtp_connect_timeout 30   router_id NGINX_MASTER}vrrp_script check_nginx {    script &#x22;/etc/keepalived/check_nginx.sh&#x22;}vrrp_instance VI_1 {    state BACKUP        #Áä∂ÊÄÅ‰∏∫BACKUP    interface ens192    virtual_router_id 51    priority 90        #‰ºòÂÖàÁ∫ßË¶ÅÊØîMASTER‰Ωé    advert_int 1    authentication {        auth_type PASS        auth_pass 1111    }    virtual_ipaddress {        192.168.20.9/23    }    track_script {        check_nginx    }}3.ÁºñÂÜôÊ£ÄÊü•nginxÁä∂ÊÄÅÁöÑÊ£ÄÊü•ËÑöÊú¨[root@binary-k8s-master1 ~]\# vim /etc/keepalived/check_nginx.shnginx_ch=&#x60;netstat -lnpt | grep 16443| egrep -cv grep&#x60;if [ $nginx_ch -eq 0 ];then  systemctl stop keepalived  exit 1else  exit 0fi4.ÂêØÂä®keepalived[root@binary-k8s-master1 ~]\# systemctl start keepalived[root@binary-k8s-master1 ~]\# systemctl enable keepalived"><div></div></button></div></figure></div>
<h4 id="1043‰ΩøÁî®vipËÆøÈóÆkubernetesÊúçÂä°">10.4.3.‰ΩøÁî®VIPËÆøÈóÆkubernetesÊúçÂä°</h4>
<p>ÂèØ‰ª•Ê≠£Á°ÆËé∑ÂèñÂà∞K8sÁâàÊú¨‰ø°ÊÅØÔºåËØ¥ÊòéË¥üËΩΩÂùáË°°Âô®Êê≠Âª∫Ê≠£Â∏∏„ÄÇËØ•ËØ∑Ê±ÇÊï∞ÊçÆÊµÅÁ®ãÔºöcurl -> vip(nginx) -> apiserver„ÄÇ</p>
<p>Êó•Âøó‰∏≠‰πü‰ºöËÆ∞ÂΩïËÆøÈóÆËÆ∞ÂΩï„ÄÇ</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> curl -k https://192.168.20.9:16443/version</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"major"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">1</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"minor"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">20</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"gitVersion"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">v1.20.4</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"gitCommit"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">e87da0bd6e03ec3fea7933c4b5263d151aafd07c</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"gitTreeState"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">clean</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"buildDate"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">2021-02-18T16:03:00Z</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"goVersion"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">go1.15.8</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"compiler"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">gc</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">"platform"</span><span style="--0:#C5E478;--1:#3C63B3">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">linux/amd64</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> tail -f /var/log/nginx/k8s-apiserver.log</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">127.0.0.1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#ECC48D;--1:#3C63B3">.20.11:6443</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> [09/Sep/2021:11:28:15 </span><span style="--0:#ECC48D;--1:#3C63B3">+0800]</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">200</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">79</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">127.0.0.1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#ECC48D;--1:#3C63B3">.20.11:6443</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> [09/Sep/2021:11:28:20 </span><span style="--0:#ECC48D;--1:#3C63B3">+0800]</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">200</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">178</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">192.168.20.10</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#ECC48D;--1:#3C63B3">.20.11:6443</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> [09/Sep/2021:15:20:29 </span><span style="--0:#ECC48D;--1:#3C63B3">+0800]</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">200</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">178</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">192.168.20.10</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#ECC48D;--1:#3C63B3">.20.12:6443,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#ECC48D;--1:#3C63B3">.20.11:6443</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> [09/Sep/2021:16:19:00 </span><span style="--0:#ECC48D;--1:#3C63B3">+0800]</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">200</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#ECC48D;--1:#3C63B3">,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">420</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 ~]\# curl -k https://192.168.20.9:16443/version{  &#x22;major&#x22;: &#x22;1&#x22;,  &#x22;minor&#x22;: &#x22;20&#x22;,  &#x22;gitVersion&#x22;: &#x22;v1.20.4&#x22;,  &#x22;gitCommit&#x22;: &#x22;e87da0bd6e03ec3fea7933c4b5263d151aafd07c&#x22;,  &#x22;gitTreeState&#x22;: &#x22;clean&#x22;,  &#x22;buildDate&#x22;: &#x22;2021-02-18T16:03:00Z&#x22;,  &#x22;goVersion&#x22;: &#x22;go1.15.8&#x22;,  &#x22;compiler&#x22;: &#x22;gc&#x22;,  &#x22;platform&#x22;: &#x22;linux/amd64&#x22;}[root@binary-k8s-master1 ~]\# tail -f /var/log/nginx/k8s-apiserver.log127.0.0.1 192.168.20.11:6443 - [09/Sep/2021:11:28:15 +0800] 200 79127.0.0.1 192.168.20.11:6443 - [09/Sep/2021:11:28:20 +0800] 200 178192.168.20.10 192.168.20.11:6443 - [09/Sep/2021:15:20:29 +0800] 200 178192.168.20.10 192.168.20.12:6443, 192.168.20.11:6443 - [09/Sep/2021:16:19:00 +0800] 200 0, 420"><div></div></button></div></figure></div>
<h4 id="1044ÊµãËØïkeepalivedÈ´òÂèØÁî®">10.4.4.ÊµãËØïkeepalivedÈ´òÂèØÁî®</h4>
<p><strong>1.ÂÅúÊéâmaster1‰∏äÁöÑkeepalivedÔºåÊü•ÁúãVIPÊòØÂê¶‰ºöÂàáÊç¢Âà∞master2ËäÇÁÇπ</strong></p>
<p><img src="https://cdn.agou-ops.cn/others/dba9f62a2a0744c3b3ccc86981ad86a4.png" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞"></p>
<p><strong>2.ÈáçÊñ∞ÂêØÂä®master1‰∏äÁöÑkeepalivedÔºåÊü•ÁúãVIPÊòØÂê¶‰ºöËá™Âä®ÂàáÊç¢Âà∞master1</strong></p>
<p><img src="https://cdn.agou-ops.cn/others/54cdc63de7c040519287127263385c0c.png" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞"></p>
<h3 id="105ÂàáÊç¢kubernetesÈõÜÁæ§‰∏∫È´òÂèØÁî®Ê®°Âºè">10.5.ÂàáÊç¢kubernetesÈõÜÁæ§‰∏∫È´òÂèØÁî®Ê®°Âºè</h3>
<p>ËôΩÁÑ∂Êàë‰ª¨Â¢ûÂä†‰∫ÜMaster2 NodeÂíåË¥üËΩΩÂùáË°°Âô®Ôºå‰ΩÜÊòØÊàë‰ª¨ÊòØ‰ªéÂçïMasterÊû∂ÊûÑÊâ©ÂÆπÁöÑÔºå‰πüÂ∞±ÊòØËØ¥ÁõÆÂâçÊâÄÊúâÁöÑWorker NodeÁªÑ‰ª∂ËøûÊé•ÈÉΩËøòÊòØMaster1 NodeÔºåÂ¶ÇÊûú‰∏çÊîπ‰∏∫ËøûÊé•VIPËµ∞Ë¥üËΩΩÂùáË°°Âô®ÔºåÈÇ£‰πàMasterËøòÊòØÂçïÁÇπÊïÖÈöú„ÄÇ</p>
<p>Áî±‰∫éÂ∑≤ÁªèÂèØ‰ª•ÈÄöËøákeepalivedÁöÑVIPÂú∞ÂùÄËÆøÈóÆÂà∞apiserverÔºåÈ´òÂèØÁî®ÊïàÊûúÂ∑≤ËææÊàêÔºåÁõÆÂâçÂè™ÈúÄË¶ÅÂ∞ÜÈõÜÁæ§ÁöÑÊâÄÊúâËäÇÁÇπÔºàkubectl get nodeÔºâËÉΩÁúãÂà∞ÁöÑ‰∏ÄÂàáËäÇÁÇπÔºåÂ∞ÜÈÖçÁΩÆÊñá‰ª∂‰∏≠ÁöÑapiserverÁöÑÂú∞ÂùÄÊç¢ÊàêVIPÂú∞ÂùÄÂä†Á´ØÂè£ÔºåÊâçËÉΩÁúüÊ≠£ÁöÑÂÆûÁé∞kubernetesÈ´òÂèØÁî®„ÄÇ</p>
<p>‰πãÂâçÂâçÊúü‰ΩøÁî®VIPÊµãËØïkube-apiserverÊ≤°ÈóÆÈ¢òÔºåÂç≥‰ΩøÂú®ÂàáÊç¢È´òÂèØÁî®ÁöÑÊÉÖÂÜµ‰∏ãÔºåÊâÄÊúâËäÇÁÇπ‰πü‰∏ç‰ºöÂ§Ñ‰∫éNotReadyÁä∂ÊÄÅ„ÄÇ</p>
<p><strong>1.ÂàáÊç¢È´òÂèØÁî®ÁéØÂ¢É</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.binary-k8s-master1ËäÇÁÇπÂàáÊç¢</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> sed -ri </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">s#192.168.20.10:6443#192.168.20.9:16443#</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53"> /data/kubernetes/config/</span><span style="--0:#7FDBCA;--1:#097174">*</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> sed -ri </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">s#192.168.20.10:6443#192.168.20.9:16443#</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53"> /root/.kube/config</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl restart  kube-controller-manager kube-scheduler kubelet kube-proxy</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.binary-k8s-master2ÂàáÊç¢</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> sed -ri </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">s#192.168.20.10:6443#192.168.20.9:16443#</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53"> /data/kubernetes/config/</span><span style="--0:#7FDBCA;--1:#097174">*</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> sed -ri </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">s#192.168.20.10:6443#192.168.20.9:16443#</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53"> /root/.kube/config</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl restart  kube-controller-manager kube-scheduler kubelet kube-proxy</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.binary-k8s-node1ÂàáÊç¢</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> sed -ri </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">s#192.168.20.10:6443#192.168.20.9:16443#</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53"> /data/kubernetes/config/</span><span style="--0:#7FDBCA;--1:#097174">*</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl restart kubelet kube-proxy</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">4.binary-k8s-node2ÂàáÊç¢</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> sed -ri </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">s#192.168.20.10:6443#192.168.20.9:16443#</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53"> /data/kubernetes/config/</span><span style="--0:#7FDBCA;--1:#097174">*</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-node2 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> systemctl restart kubelet kube-proxy</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.binary-k8s-master1ËäÇÁÇπÂàáÊç¢[root@binary-k8s-master1 ~]\# sed -ri &#x27;s#192.168.20.10:6443#192.168.20.9:16443#&#x27; /data/kubernetes/config/*[root@binary-k8s-master1 ~]\# sed -ri &#x27;s#192.168.20.10:6443#192.168.20.9:16443#&#x27; /root/.kube/config[root@binary-k8s-master1 ~]\# systemctl restart  kube-controller-manager kube-scheduler kubelet kube-proxy2.binary-k8s-master2ÂàáÊç¢[root@binary-k8s-master2 ~]\# sed -ri &#x27;s#192.168.20.10:6443#192.168.20.9:16443#&#x27; /data/kubernetes/config/*[root@binary-k8s-master2 ~]\# sed -ri &#x27;s#192.168.20.10:6443#192.168.20.9:16443#&#x27; /root/.kube/config[root@binary-k8s-master2 ~]\# systemctl restart  kube-controller-manager kube-scheduler kubelet kube-proxy3.binary-k8s-node1ÂàáÊç¢[root@binary-k8s-node1 ~]\# sed -ri &#x27;s#192.168.20.10:6443#192.168.20.9:16443#&#x27; /data/kubernetes/config/*[root@binary-k8s-node1 ~]\# systemctl restart kubelet kube-proxy4.binary-k8s-node2ÂàáÊç¢[root@binary-k8s-node2 ~]\# sed -ri &#x27;s#192.168.20.10:6443#192.168.20.9:16443#&#x27; /data/kubernetes/config/*[root@binary-k8s-node2 ~]\# systemctl restart kubelet kube-proxy"><div></div></button></div></figure></div>
<p><strong>2.Êü•ÁúãÈõÜÁæ§Áä∂ÊÄÅÂèäËµÑÊ∫ê</strong></p>
<p>Âà∞Ê≠§‰∏∫Ê≠¢kubernetesÈ´òÂèØÁî®ÈõÜÁæ§ÂÆûÁé∞ÂÆåÊØï</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get node</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                 </span><span style="--0:#ECC48D;--1:#3C63B3">STATUS</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">ROLES</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">VERSION</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">binary-k8s-master1</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">Ready</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">5</span><span style="--0:#ECC48D;--1:#3C63B3">d22h</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">v1.20.4</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">binary-k8s-master2</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">Ready</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">25</span><span style="--0:#ECC48D;--1:#3C63B3">h</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">v1.20.4</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">binary-k8s-node1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Ready</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#ECC48D;--1:#3C63B3">d5h</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">v1.20.4</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">binary-k8s-node2</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Ready</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#ECC48D;--1:#3C63B3">d23h</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">v1.20.4</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get cs</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">Warning:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">v1</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ComponentStatus</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">is</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">deprecated</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">in</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">v1.19+</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                 </span><span style="--0:#ECC48D;--1:#3C63B3">STATUS</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">MESSAGE</span><span style="--0:#D6DEEB;--1:#403F53">             </span><span style="--0:#ECC48D;--1:#3C63B3">ERROR</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">controller-manager</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">Healthy</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">ok</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">scheduler</span><span style="--0:#D6DEEB;--1:#403F53">            </span><span style="--0:#ECC48D;--1:#3C63B3">Healthy</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">ok</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">etcd-0</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">Healthy</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">{</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">health</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">:</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">true</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">etcd-1</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">Healthy</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">{</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">health</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">:</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">true</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">etcd-2</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#ECC48D;--1:#3C63B3">Healthy</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">{</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">health</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">:</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">true</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#3C63B3">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 ~]\# kubectl get nodeNAME                 STATUS   ROLES    AGE     VERSIONbinary-k8s-master1   Ready    <none>   5d22h   v1.20.4binary-k8s-master2   Ready    <none>   25h     v1.20.4binary-k8s-node1     Ready    <none>   3d5h    v1.20.4binary-k8s-node2     Ready    <none>   2d23h   v1.20.4[root@binary-k8s-master1 ~]\# kubectl get csWarning: v1 ComponentStatus is deprecated in v1.19+NAME                 STATUS    MESSAGE             ERRORcontroller-manager   Healthy   okscheduler            Healthy   oketcd-0               Healthy   {&#x22;health&#x22;:&#x22;true&#x22;}etcd-1               Healthy   {&#x22;health&#x22;:&#x22;true&#x22;}etcd-2               Healthy   {&#x22;health&#x22;:&#x22;true&#x22;}"><div></div></button></div></figure></div>
<h2 id="11ÊµãËØïkubernetesÈ´òÂèØÁî®ÈõÜÁæ§">11.ÊµãËØïkubernetesÈ´òÂèØÁî®ÈõÜÁæ§</h2>
<p><strong>1.ÂÅúÊéâmaster1‰∏äÁöÑkeepalivedÈ™åËØÅÈõÜÁæ§ÊòØÂê¶ÂèØÁî®</strong></p>
<p>Áä∂ÊÄÅÔºö‚Äúok‚Äù</p>
<p><img src="https://cdn.agou-ops.cn/others/c146811a76994c2eb7ecea1a95bae2ab.png" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞"></p>
<p><strong>2.ÂÅúÊéâmaster1‰∏äÊâÄÊúâk8sÁªÑ‰ª∂È™åËØÅÈõÜÁæ§ÊòØÂê¶ÂèØÁî®</strong></p>
<p>Áä∂ÊÄÅÔºö‚Äúok‚Äù</p>
<p><img src="https://cdn.agou-ops.cn/others/a5cfe03d354441798591ae5add26898e.png" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞"></p>
<h2 id="12Âú®kubernetesÈõÜÁæ§ËøêË°å‰∏ÄÂ•óÊúçÂä°È™åËØÅÈõÜÁæ§ÁöÑÂèØÁî®ÊÄß">12.Âú®kubernetesÈõÜÁæ§ËøêË°å‰∏ÄÂ•óÊúçÂä°È™åËØÅÈõÜÁæ§ÁöÑÂèØÁî®ÊÄß</h2>
<p>ÁÆÄÂçïÈÉ®ÁΩ≤‰∏Ä‰∏™Âü∫‰∫énginxÁöÑwebÊúçÂä°„ÄÇ</p>
<h3 id="121ÂàõÂª∫ËµÑÊ∫êyamlÊñá‰ª∂">12.1.ÂàõÂª∫ËµÑÊ∫êyamlÊñá‰ª∂</h3>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> vim know-system.yaml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">apiVersion:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">apps/v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Deployment</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">deploy-know-system</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">spec:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">replicas:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">3</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">selector:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">matchLabels:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">app:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">know-system-pod</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">template:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">labels:</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">app:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">know-system-pod</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">spec:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">containers:</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">know-system</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">image:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">know-system:v1</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">ports:</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">containerPort:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">80</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3C63B3">nodeName:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">binary-k8s-master1</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">apiVersion:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kind:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">Service</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">know-system-service</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">spec:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">selector:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">app:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">know-system-pod</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3C63B3">type</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#ECC48D;--1:#3C63B3">NodePort</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">ports:</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">port:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">80</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">targetPort:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">80</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 ~]\# vim know-system.yamlapiVersion: apps/v1kind: Deploymentmetadata:  name: deploy-know-systemspec:  replicas: 3  selector:    matchLabels:      app: know-system-pod  template:    metadata:      labels:        app: know-system-pod    spec:      containers:      - name: know-system        image: know-system:v1        ports:        - containerPort: 80      nodeName: binary-k8s-master1---apiVersion: v1kind: Servicemetadata:  name: know-system-servicespec:  selector:    app: know-system-pod  type: NodePort  ports:  - port: 80    targetPort: 80"><div></div></button></div></figure></div>
<h3 id="122ÂàõÂª∫ËµÑÊ∫êÂπ∂ËøõË°åÊµãËØï">12.2.ÂàõÂª∫ËµÑÊ∫êÂπ∂ËøõË°åÊµãËØï</h3>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl apply -f know-system.yaml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">deployment.apps/deploy-know-system</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">service/know-system-service</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get pod,svc</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                                     </span><span style="--0:#ECC48D;--1:#3C63B3">READY</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">STATUS</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">RESTARTS</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">pod/deploy-know-system-b4c9c55d7-5mf2f</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">47</span><span style="--0:#ECC48D;--1:#3C63B3">s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">pod/deploy-know-system-b4c9c55d7-97ckx</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">48</span><span style="--0:#ECC48D;--1:#3C63B3">s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">pod/deploy-know-system-b4c9c55d7-kb97t</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">47</span><span style="--0:#ECC48D;--1:#3C63B3">s</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                          </span><span style="--0:#ECC48D;--1:#3C63B3">TYPE</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#ECC48D;--1:#3C63B3">CLUSTER-IP</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">EXTERNAL-IP</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">PORT</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#82AAFF;--1:#3C63B3">S</span><span style="--0:#D6DEEB;--1:#403F53">)        </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">service/know-system-service</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">NodePort</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#F78C6C;--1:#AA0982">10.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.38</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">80</span><span style="--0:#ECC48D;--1:#3C63B3">:32702/TCP</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">47</span><span style="--0:#ECC48D;--1:#3C63B3">s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">service/kubernetes</span><span style="--0:#D6DEEB;--1:#403F53">            </span><span style="--0:#ECC48D;--1:#3C63B3">ClusterIP</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">10.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">443</span><span style="--0:#ECC48D;--1:#3C63B3">/TCP</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">10</span><span style="--0:#ECC48D;--1:#3C63B3">d</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[root@binary-k8s-master1 ~]\# kubectl apply -f know-system.yamldeployment.apps/deploy-know-system createdservice/know-system-service created[root@binary-k8s-master1 ~]\# kubectl get pod,svcNAME                                     READY   STATUS    RESTARTS   AGEpod/deploy-know-system-b4c9c55d7-5mf2f   1/1     Running   0          47spod/deploy-know-system-b4c9c55d7-97ckx   1/1     Running   0          48spod/deploy-know-system-b4c9c55d7-kb97t   1/1     Running   0          47sNAME                          TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)        AGEservice/know-system-service   NodePort    10.0.0.38    <none>        80:32702/TCP   47sservice/kubernetes            ClusterIP   10.0.0.1     <none>        443/TCP        10d"><div></div></button></div></figure></div>
<p>ËÆøÈóÆ<a href="https://%E9%9B%86%E7%BE%A4%E4%BB%BB%E6%84%8F%E8%8A%82%E7%82%B9+32702%E7%AB%AF%E5%8F%A3%E5%8D%B3%E5%8F%AF%E6%B5%8F%E8%A7%88web%E6%9C%8D%E5%8A%A1%E3%80%82">https://ÈõÜÁæ§‰ªªÊÑèËäÇÁÇπ+32702Á´ØÂè£Âç≥ÂèØÊµèËßàwebÊúçÂä°„ÄÇ</a></p>
<p><img src="https://cdn.agou-ops.cn/others/8c7dc7f2aad14d74a07b8ab6c35e09a9.png" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞"></p>
<h2 id="13ÈÉ®ÁΩ≤kubernetes-dashboard">13.ÈÉ®ÁΩ≤kubernetes dashboard</h2>
<h3 id="131ÈÉ®ÁΩ≤dashboard">13.1.ÈÉ®ÁΩ≤dashboard</h3>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">1.ÈÉ®ÁΩ≤yaml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl apply -f kubernetes-dashboard.yaml</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">namespace/kubernetes-dashboard</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">serviceaccount/kubernetes-dashboard</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">service/kubernetes-dashboard</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">secret/kubernetes-dashboard-certs</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">secret/kubernetes-dashboard-csrf</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">secret/kubernetes-dashboard-key-holder</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">configmap/kubernetes-dashboard-settings</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">role.rbac.authorization.k8s.io/kubernetes-dashboard</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">clusterrole.rbac.authorization.k8s.io/kubernetes-dashboard</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">rolebinding.rbac.authorization.k8s.io/kubernetes-dashboard</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">clusterrolebinding.rbac.authorization.k8s.io/kubernetes-dashboard</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">deployment.apps/kubernetes-dashboard</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">service/dashboard-metrics-scraper</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">deployment.apps/dashboard-metrics-scraper</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">2.ÂàõÂª∫ÊéàÊùÉË¥¶Âè∑</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl create serviceaccount dashboard-admin -n kube-system</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">serviceaccount/dashboard-admin</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl create clusterrolebinding dashboard-admin --clusterrole=cluster-admin --serviceaccount=kube-system:dashboard-admin</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">clusterrolebinding.rbac.authorization.k8s.io/dashboard-admin</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">created</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">3.Êü•ÁúãÁôªÈôÜ‰ΩøÁî®ÁöÑtokenÂ≠óÁ¨¶‰∏≤</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl describe secrets -n kube-system </span><span style="--1:#3C63B3"><span style="--0:#ECC48D">$(</span><span style="--0:#82AAFF">kubectl</span><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">-n</span><span style="--0:#ECC48D"> kube-system get secret </span></span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--1:#3C63B3"><span style="--0:#ECC48D"> </span><span style="--0:#82AAFF">awk</span><span style="--0:#ECC48D"> </span></span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">/dashboard-admin/{print $1}</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#3C63B3">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">Name:</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#ECC48D;--1:#3C63B3">dashboard-admin-token-lnm2r</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">Namespace:</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">kube-system</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">Labels:</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">Annotations:</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes.io/service-account.name:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">dashboard-admin</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#82AAFF;--1:#3C63B3">kubernetes.io/service-account.uid:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">73</span><span style="--0:#ECC48D;--1:#3C63B3">b370c9-b1b4-4418-b02d-fee9b6cf6342</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">Type:</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#ECC48D;--1:#3C63B3">kubernetes.io/service-account-token</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">Data</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">====</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">token:</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#ECC48D;--1:#3C63B3">eyJhbGciOiJSUzI1NiIsImtpZCI6IkgwWGJXQ1duVVI4eFh4Ykw2U25JVk9fa2hDOGZVRTRRMVZyVmdwWXM1Nk0ifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJkYXNoYm9hcmQtYWRtaW4tdG9rZW4tbG5tMnIiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoiZGFzaGJvYXJkLWFkbWluIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiNzNiMzcwYzktYjFiNC00NDE4LWIwMmQtZmVlOWI2Y2Y2MzQyIiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50Omt1YmUtc3lzdGVtOmRhc2hib2FyZC1hZG1pbiJ9.XWJLZDB7mNk_NNpXVv64LrbKy5f1hB2PS5qER5YFATzl3U9ISX05PCrnCEY-6uVSbPkRGZbTQZTBwiGjOfsyLZljvY3cbmGlH2oW2shUS8LDqli4MKA14JyUX1ubbQ8vq9uSqkQMCQBzZTUGIuZt95jw3-IMv2rfZ9ET8_uVuXIoZXbckY6VHFy8QOB6sy1n9j0j4qcOttyKHVXN8Q5KjsIlb44Y5HtiveKxpw_LA81eTwml_aiVvO9rgMKVdSHIg8CY1Mcp06ezz0kD0jsBLt7xaAujSNZnCiXzmpg51xujbR0k-4BVlwPBBpQLaSWGoHR3X7z5E02onXttbbX6-w</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">ca.crt:</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#F78C6C;--1:#AA0982">1359</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">bytes</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">namespace:</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">11</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">bytes</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">4.Êü•ÁúãpodÁöÑÁä∂ÊÄÅ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">[root@binary-k8s-master1 </span><span style="--0:#7FDBCA;--1:#097174">~</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#F78C6C;--1:#AA0982">\#</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl get pod,svc -n kubernetes-dashboard</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                                             </span><span style="--0:#ECC48D;--1:#3C63B3">READY</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">STATUS</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">RESTARTS</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">pod/dashboard-metrics-scraper-7445d59dfd-bg9c8</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">8</span><span style="--0:#ECC48D;--1:#3C63B3">m51s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">pod/kubernetes-dashboard-5ddcdf9c99-nkgqw</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#ECC48D;--1:#3C63B3">/1</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#ECC48D;--1:#3C63B3">Running</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          </span><span style="--0:#F78C6C;--1:#AA0982">8</span><span style="--0:#ECC48D;--1:#3C63B3">m52s</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                                </span><span style="--0:#ECC48D;--1:#3C63B3">TYPE</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#ECC48D;--1:#3C63B3">CLUSTER-IP</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">EXTERNAL-IP</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">PORT</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#82AAFF;--1:#3C63B3">S</span><span style="--0:#D6DEEB;--1:#403F53">)         </span><span style="--0:#ECC48D;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">service/dashboard-metrics-scraper</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">ClusterIP</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">10.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.83</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">8000</span><span style="--0:#ECC48D;--1:#3C63B3">/TCP</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">8</span><span style="--0:#ECC48D;--1:#3C63B3">m52s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">service/kubernetes-dashboard</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#ECC48D;--1:#3C63B3">NodePort</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#F78C6C;--1:#AA0982">10.0</span><span style="--0:#ECC48D;--1:#3C63B3">.0.153</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#ECC48D;--1:#3C63B3">&#x3C;none></span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#F78C6C;--1:#AA0982">443</span><span style="--0:#ECC48D;--1:#3C63B3">:30001/TCP</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">8</span><span style="--0:#ECC48D;--1:#3C63B3">m53s</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="1.ÈÉ®ÁΩ≤yaml[root@binary-k8s-master1 ~]\# kubectl apply -f kubernetes-dashboard.yamlnamespace/kubernetes-dashboard createdserviceaccount/kubernetes-dashboard createdservice/kubernetes-dashboard createdsecret/kubernetes-dashboard-certs createdsecret/kubernetes-dashboard-csrf createdsecret/kubernetes-dashboard-key-holder createdconfigmap/kubernetes-dashboard-settings createdrole.rbac.authorization.k8s.io/kubernetes-dashboard createdclusterrole.rbac.authorization.k8s.io/kubernetes-dashboard createdrolebinding.rbac.authorization.k8s.io/kubernetes-dashboard createdclusterrolebinding.rbac.authorization.k8s.io/kubernetes-dashboard createddeployment.apps/kubernetes-dashboard createdservice/dashboard-metrics-scraper createddeployment.apps/dashboard-metrics-scraper created2.ÂàõÂª∫ÊéàÊùÉË¥¶Âè∑[root@binary-k8s-master1 ~]\# kubectl create serviceaccount dashboard-admin -n kube-systemserviceaccount/dashboard-admin created[root@binary-k8s-master1 ~]\# kubectl create clusterrolebinding dashboard-admin --clusterrole=cluster-admin --serviceaccount=kube-system:dashboard-adminclusterrolebinding.rbac.authorization.k8s.io/dashboard-admin created3.Êü•ÁúãÁôªÈôÜ‰ΩøÁî®ÁöÑtokenÂ≠óÁ¨¶‰∏≤[root@binary-k8s-master1 ~]\# kubectl describe secrets -n kube-system $(kubectl -n kube-system get secret | awk &#x27;/dashboard-admin/{print $1}&#x27;)Name:         dashboard-admin-token-lnm2rNamespace:    kube-systemLabels:       <none>Annotations:  kubernetes.io/service-account.name: dashboard-admin              kubernetes.io/service-account.uid: 73b370c9-b1b4-4418-b02d-fee9b6cf6342Type:  kubernetes.io/service-account-tokenData====token:      eyJhbGciOiJSUzI1NiIsImtpZCI6IkgwWGJXQ1duVVI4eFh4Ykw2U25JVk9fa2hDOGZVRTRRMVZyVmdwWXM1Nk0ifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJkYXNoYm9hcmQtYWRtaW4tdG9rZW4tbG5tMnIiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoiZGFzaGJvYXJkLWFkbWluIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiNzNiMzcwYzktYjFiNC00NDE4LWIwMmQtZmVlOWI2Y2Y2MzQyIiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50Omt1YmUtc3lzdGVtOmRhc2hib2FyZC1hZG1pbiJ9.XWJLZDB7mNk_NNpXVv64LrbKy5f1hB2PS5qER5YFATzl3U9ISX05PCrnCEY-6uVSbPkRGZbTQZTBwiGjOfsyLZljvY3cbmGlH2oW2shUS8LDqli4MKA14JyUX1ubbQ8vq9uSqkQMCQBzZTUGIuZt95jw3-IMv2rfZ9ET8_uVuXIoZXbckY6VHFy8QOB6sy1n9j0j4qcOttyKHVXN8Q5KjsIlb44Y5HtiveKxpw_LA81eTwml_aiVvO9rgMKVdSHIg8CY1Mcp06ezz0kD0jsBLt7xaAujSNZnCiXzmpg51xujbR0k-4BVlwPBBpQLaSWGoHR3X7z5E02onXttbbX6-wca.crt:     1359 bytesnamespace:  11 bytes4.Êü•ÁúãpodÁöÑÁä∂ÊÄÅ[root@binary-k8s-master1 ~]\# kubectl get pod,svc -n kubernetes-dashboardNAME                                             READY   STATUS    RESTARTS   AGEpod/dashboard-metrics-scraper-7445d59dfd-bg9c8   1/1     Running   0          8m51spod/kubernetes-dashboard-5ddcdf9c99-nkgqw        1/1     Running   0          8m52sNAME                                TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)         AGEservice/dashboard-metrics-scraper   ClusterIP   10.0.0.83    <none>        8000/TCP        8m52sservice/kubernetes-dashboard        NodePort    10.0.0.153   <none>        443:30001/TCP   8m53s"><div></div></button></div></figure></div>
<h3 id="132ËÆøÈóÆdashboard">13.2.ËÆøÈóÆdashboard</h3>
<p>ËÆøÈóÆ<a href="https://%E9%9B%86%E7%BE%A4%E4%BB%BB%E6%84%8F%E8%8A%82%E7%82%B9+30001%E7%AB%AF%E5%8F%A3%EF%BC%8C%E7%84%B6%E5%90%8E%E5%A1%AB%E5%86%99%E5%88%9A%E5%88%9A%E6%9F%A5%E5%88%B0%E7%9A%84token%E5%80%BC%EF%BC%8C%E7%82%B9%E5%87%BB%E7%99%BB%E9%99%86%E3%80%82">https://ÈõÜÁæ§‰ªªÊÑèËäÇÁÇπ+30001Á´ØÂè£ÔºåÁÑ∂ÂêéÂ°´ÂÜôÂàöÂàöÊü•Âà∞ÁöÑtokenÂÄºÔºåÁÇπÂáªÁôªÈôÜ„ÄÇ</a></p>
<p><img src="https://cdn.agou-ops.cn/others/2c6c6346e8854ffcb85a23d3569c056e.png" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞"></p>
<p>‰ª™Ë°®Áõò</p>
<p><img src="https://cdn.agou-ops.cn/others/f2dfdb9364bb4b0e875851131d711e34.png" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞"></p>
<blockquote>
<p>:warning:ËΩ¨ËΩΩËá™Ôºö<a href="https://jiangxl.blog.csdn.net/article/details/120428703">https://jiangxl.blog.csdn.net/article/details/120428703</a></p>
<p>‰ªÖÁï•‰Ωú‰øÆÊîπ„ÄÇ</p>
</blockquote> </div> <footer class="astro-3yyafb3n"> <div class="meta sl-flex astro-3yyafb3n">   </div> <div class="pagination-links astro-u2l5gyhi" dir="ltr"> <a href="/cloudnative/k8s/installation/kubeadm-Âø´ÈÄüÈÉ®ÁΩ≤ÊâãÂÜå/" rel="prev" class="astro-u2l5gyhi"> <svg aria-hidden="true" class="astro-u2l5gyhi astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.5rem;"><path d="M17 11H9.41l3.3-3.29a1.004 1.004 0 1 0-1.42-1.42l-5 5a1 1 0 0 0-.21.33 1 1 0 0 0 0 .76 1 1 0 0 0 .21.33l5 5a1.002 1.002 0 0 0 1.639-.325 1 1 0 0 0-.219-1.095L9.41 13H17a1 1 0 0 0 0-2Z"/></svg>  <span class="astro-u2l5gyhi"> Previous <br class="astro-u2l5gyhi"> <span class="link-title astro-u2l5gyhi">Kubeadm Âø´ÈÄüÈÉ®ÁΩ≤ÊâãÂÜå</span> </span> </a> <a href="/cloudnative/k8s/installation/‰ΩøÁî®-kubeadm-ÈÉ®ÁΩ≤Âçïmaster/" rel="next" class="astro-u2l5gyhi"> <svg aria-hidden="true" class="astro-u2l5gyhi astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.5rem;"><path d="M17.92 11.62a1.001 1.001 0 0 0-.21-.33l-5-5a1.003 1.003 0 1 0-1.42 1.42l3.3 3.29H7a1 1 0 0 0 0 2h7.59l-3.3 3.29a1.002 1.002 0 0 0 .325 1.639 1 1 0 0 0 1.095-.219l5-5a1 1 0 0 0 .21-.33 1 1 0 0 0 0-.76Z"/></svg>  <span class="astro-u2l5gyhi"> Next <br class="astro-u2l5gyhi"> <span class="link-title astro-u2l5gyhi">‰ΩøÁî® Kubeadm ÈÉ®ÁΩ≤ÔºàÂçïmasterÔºâ</span> </span> </a> </div>  </footer>  </div> </div>   </main> </div> </div>  </div> </div>  </body></html>